
2003年国家精品课程《自动控制原理》主干教材
2008年自动控制系列课程国家优秀教学团队精品教材
2009年《控制系统工程》国家双语教学示范课程双语教材

普通高等院校“十二五”规划教材




Principles of Automatic Control
自动控制原理
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　



主  编
副主编 主  审


　陈复扬 姜  斌 陶  钢




















d                   防       草         出         版   rJIL        National Defense Industry Press




责任编辑：丁福志
责任校对：钱辉玲
封面设计：徐 鑫














Principles of Automatie Control
自动控制原理
(第2版)


















?上架建议：自动化、自动控制 http:1/www.ndip.cn
ISEN978-7-118-08872-4



电子课件索取：ding@ndip.cn
定 价 ：40.00元




普通高等院校“十二五”规划教材
2003年国家精品课程《自动控制原理》主干教材
2008年自动控制系列课程国家优秀教学团队精品教材
2009年《控制系统工程》国家双语教学示范课程双语教材




自动控制原理
(第2版)

主  编  陈复扬
副主编  姜  斌
主  审  陶  钢





















网 防  二  草  出  版  社
・ 北京 ・




内 容 简 介

　　《自动控制原理》(第2版),比较全面地阐述了自动控制的基本理论及应用。全书共分9 章，主要包括自动控制系统建模、时域分析法、根轨迹法、频域分析法、离散系统分析、非线性系 统分析、线性系统理论、最优控制理论。各章均含有MATLAB  支持下对控制系统进行计算机 辅助分析与设计的典型实例，并免费提供相应的教学课件。为帮助读者更加熟练掌握该书内 容，配套出版了《自动控制原理习题详解与考研辅导》。
　　　本书为2009年《控制系统工程》国家双语教学示范课程双语教材中文版的第2版、2008 年自动控制系列课程国家优秀教学团队主干教材、2003年国家精品课程《自动控制原理》精品 教材 。
　　　本书可作为高等工业院校自动控制、工业自动化、电气自动化、机械、动力、冶金、管理等专 业的教材；亦可供从事自动控制类各专业工程技术人员以及对自动控制感兴趣的读者自学 参考。



图书在版编目(CIP) 数据
　自动控制原理/陈复扬主编.―2版.―北京：国防工业 出版社，2013.8
ISBN 978-7-118-08872-4
　　I.① 自 . . . Ⅱ. ①陈... Ⅲ.①自动控制理论―高 等学校―教材  IV.①TP13
中国版本图书馆CIP 数据核字(2013)第141968号




※
防   。   草    出    版    社 出 版 发 行
(北京市海淀区紫竹院南路23号 邮政编码100048)
北京奥鑫印刷厂印刷 新华书店经售
*
开本787×10921/16  印张2234  字数584千字
2013年8月第2版第1次印刷 印数1―4000册 定价40.00元
(本书如有印装错误，我社负责调换)


国防书店：(010)88540777
发行传真：(010)88540755


发行邮购：(010)88540776
发行业务：(010)88540717








第2版前言



　　　自动控制原理是控制科学与工程一级学科的重要理论基础，是高等学校自动化及相关专业 的一门核心基础理论课程，也是控制学科全国硕士研究生入学考试专业基础课必考科目。学好 自动控制原理，对掌握自动化技术以及在自动化领域继续深造有着重要作用。
　　　第2版对第1版内容进行了基础理论部分的删减与优化，并对A 例 题B 考研题C 课后习题 进行了合理配置，将第1版重新修订分为主教材《自动控制原理》(第2版)和辅导书《自动控制 原理习题详解与考研辅导》分别出版。主教材仍分为9章，第1章~第7章为古典控制理论，第 8章、第9章为现代控制理论。第1章给出自动控制的基本概念；第2章介绍自动控制系统建 模；第3章~第5章介绍线性连续系统的三大分析方法(时域分析法、根轨迹法、频率响应法); 第6章阐述线性离散系统的分析法；第7章介绍非线性系统分析法；第8章阐述了线性系统的状 态空间分析方法；第9章介绍动态系统的最优控制方法。
　　　本书编委均多年讲授《自动控制原理》、《控制系统工程》课程，教学经验丰富，其中三分之一 的编委有在英国、美国、法国、新加坡、香港的求学或工作经历。2009年，本书列选为“《控制系统 工程》国家双语教学示范课程双语教材的中文版”。本书按照本科教学大纲的要求编写，突出了 基础性、先进性、国际性、易读性，以工程应用为背景，全面阐述自动控制的基本理论、基本概念和 基本方法，并配有大量的典型习题、考研试题、课后习题。
在编写和修订过程中：
　　　(1)本书作为面向双语教学的教材，充分考虑教学模式的国际化，具有国外求学经历与工作 经历的编委积极引进国外的教学内容与教学方法，参考了国内外控制理论及应用发展的方向，并 邀请美国弗吉尼亚大学陶钢教授担任主审，提出宝贵意见，编写组经反复讨论编写而成。
　　　(2)根据多年的教学经验及学生的反馈，编写中做到以学生为本，加强能力培养，内容叙述 力求深入浅出、削枝强干、层次分明，以最基本的内容为主线，注重工程概念，便于学生课后复习 或者自学。
　　　(3)主教材中引入MATLAB 辅助分析与设计，以培养学生现代化的分析与设计能力，适应 21世纪教学现代化的发展要求。辅导书配有不同层次和不同用途的例题讲解、考研题分析与课 后习题解答，方便学生熟练掌握和深刻理解自动控制原理的基础理论。
　　　编写团队成员均为2008年“自动控制系列课程”国家优秀教学团队主干成员、2003年首批 国家精品课程《自动控制原理》主要建设者、2009年《控制系统工程》国家双语教学示范课程核 心成员。以该书第1版作为主要成果的教改项目“创建自动化专业系列课程双语教学体系，培



养具有国际竞争力的创新型人才”获得了2011年江苏省高等教育教学成果奖二等奖。
　　　第2版由陈复扬、姜斌负责改版内容设计，陈复扬负责改版内容组织、校对、统稿、定稿。双 语教材中文版第1版由陈复扬、姜斌负责内容设计、组织安排编写，各章编写人员是：陈复扬第1 章；张绍杰第2章；王新华、陈复扬第3章；齐瑞云、姜斌第4章；刘剑慰、陈复扬第5章；盛守照第 6章；丁勇第7章；杨蒲第8章；陆宁云第9章。第1版全书由陈复扬统稿、定稿。
　　　第1版从酝酿到编写以及成稿，是一个不断完善、不断提高的过程。在此感谢胡寿松教授对 编者的多年培养；忠心感谢本书的主审来自美国弗吉尼亚大学的陶钢教授对该书的指导；感谢 2008年自动控制系列课程国家优秀教学团队带头人吴庆宪教授、国防工业出版社责任编辑丁福 志先生对本书的大力支持；同时对在本书编写过程中给予帮助的各位人员表示诚挚的谢意。
　　　在第2版出版之时还要感谢广大读者以及网友对本书的批评与指正，督促我们对第1版进 行了大量仔细的纠错工作，提高了第2版的质量。
由于水平有限，对于本版中存在的错误和不妥之处。恳请广大读者不吝指正。




编者Email:chenfuyang@nuaa.edu.cn
自动控制原理国家精品课程网址：http://cae.nuaa.edu.cn/ftp/index.asp
控制系统工程国家双语教学示范课程网址：http://gc.nuaa.edu.cn/cse







陈复扬
中国南京
2013年5月







目     录



第 1 章  自 动 控 制 的 一 般 概 念 	1
1.1        引 言 	1
1.2        自 动 控 制 简 史 	 1
1.3       自动控制系统的基本概念 	2
1.3.1      自动控制系统 	2
1.3.2      控制方式的分类 	5
1.3.3      开环与闭环控制系统的
比较 	6
1.4      自动控制系统的分类及组成 	7
1.4.1      自动控制系统的分类 	7
1.4.2      自动控制系统的组成 	7
1.5      对控制系统的性能要求 	 8
1.5.1      自动控制系统的性能
要求 	8
1.5.2       自动控制系统的典型外
作用	9
本 章 小 结 	 9
第 2 章 控 制 系 统 的 数 学 模 型  	10
2.1       引言 	10
2.2      控制系统的时域数学模型 	11
2.2.1      控制系统的微分方程 	 11
2.2.2      控制系统的线性近似 	 13
2.3       拉 普 拉 斯 变 换 	16
2.3.1      拉普拉斯变换的定义 	 16
2.3.2      拉普拉斯变换的常用定理 	17
2.3.3      拉普拉斯反变换 	20
2.3.4      微分方程的求解 	22
2.4      控制系统的复域数学模型 	23
2.4.1      传递函数 	23


2.4.2      传递函数的极点和
零点对输出的影响 	 25
2.4.3      典型元部件的传递函数 	26
2.5      控制系统的结构图与信号
流图 	27
2.5.1      控制系统的结构图 	27
2.5.2      控制系统的信号流图 	32
2.5.3      闭环系统的常用传递
函 数 	 36
2.6      控制系统建模的应用研究 	 37
2.6.1      数学模型的实验测定 	 37
2.6.2      利用MATLAB 进行
系统建模 	 38
2.7      控制系统建模的设计实例 	40
本 章 小 结 	42
课 后 练 习 题 	43
第 3 章 线性系统的时域分析法 	 47
3.1       引言 	47
3.2      线性系统的时域性能指标 	47
3.2.1      典型输入信号 	 47
3.2.2      动态性能与稳态性能 	49
3.3      线性系统的稳定性分析 	51
3.3.1      稳定性的基本概念 	 51
3.3.2      线性系统稳定的充分
必要条件 	52
3.3.3      劳斯稳定判据 	54
3.3.4      劳斯稳定判据的
特殊情况 	55
3.3.5      劳斯稳定判据的应用 	 57
3.4      线性系统的快速性分析 	60






3.4.1      一阶系统的时域分析 	60
3.4.2      二阶系统的时域分析 	64
3.5      线性系统的准确性分析 	72
3.5.1      线性系统的稳态误差计算 	73
3.5.2      减小和消除稳态误差
的方法 	 79
3.6      线性系统的时域法校正 	81
3.6.1     比例―微分环节(PD)
校正 	 81
3.6.2      比例―积分环节(PI)
校正 	 84
3.6.3      比例―积分―微分
环节(PID )校正 	84
3.7      线性系统时域法的应用 	85
3.7.1      利用MATLAB 研究
时域法 	 85
3.7.2      时域分析法的设计实例 	87
本 章 小 结 	88
课 后 练 习 题 	89
第 4 章 线 性 系 统 的 根 轨 迹 法 	93
4.1       引言 	93
4.2      根轨迹法的基本概念 	93
4.2.1      闭环零、极点与开环零、
极点的关系	94
4.2.2      根轨迹方程 	96
4.3      根轨迹绘制的基本法则	97
4.3.1      绘制根轨迹的基本法则 	97
4.3.2       闭环极点的确定	104
4.4       广 义 根 轨 迹 	106
4.4.1      参数根轨迹 	106
4.4.2      零度根轨迹 	107
4.5      线性系统的控制性能分析 	 109
4.5.1      闭环零、极点分布与阶跃
响应的定性分析 	 110
4.5.2      主导极点与偶极子的
概念 	110
4.5.3      用主导极点估算系统


的性能 	112
4.6      线性系统的根轨迹法校正 	114
4.6.1      超前校正 	114
4.6.2      滞后校正 	118
4.6.3      超前―滞后校正 	 119
4.7      线性系统根轨迹法的应用	 121
4.7.1      利用MATLAB研究
根轨迹法 	121
4.7.2      根轨迹法的设计实例 	 123
本 章 小 结 	 125
课后练习题 	 125
第 5 章 线 性 系 统 的 频 域 分 析 法 	128
5.1       引 言 	128
5.2       频 率 特 性 	 128
5.2.1      频率特性的基本概念 	 128
5.2.2      频率特性的几何表示
方法 	130
5.3      开环系统的频率特性 	 133
5.3.1      典型环节的频率特性 	 133
5.3.2      开环系统的频率特性 	 143
5.4      线性系统的稳定性分析 	 151
5.4.1      频率域稳定判据 	151
5.4.2      稳定裕度 	157
5.5      闭环系统的频域性能指标 	158
5.5.1      控制系统的带宽 	 159
5.5.2      闭环系统频域性能指标
和时域指标的转换 	159
5.6      线性系统的频域法校正 	 161
5.6.1      串联超前校正 	162
5.6.2      串联滞后校正 	165
5.6.3      串联滞后―超前校正 	 167
5.7      线性系统频域法的应用	171
本章小结 	175
课后练习题 	 175
第 6 章 线 性 离 散 系 统 的 分 析 	 180
6.1       引 言 	180






6.2      离散控制系统的基本概念 	180
6.2.1     离散控制系统的应用	 180
6.2.2       离散控制系统的特点	181
6.2.3     离散控制系统的研究
方法 	182
6.3       信 号 的 采 样 和 保 持 	182
6.3.1      采样过程 	182
6.3.2      采样过程的数学描述 	183
6.3.3      采样定理 	184
6.3.4      零阶保持器 	186
6.4       Z 变 换 理 论 	 188
6.4.1      Z变换的定义 	188
6.4.2      Z变换的求法 	189
6.4.3      Z变换的基本定理 	192
6.4.4      Z反变换 	194
6.5       离散系统的数学模型 	197
6.5.1       离散系统的数学定义 	197
6.5.2      线性常系数差分方程
及其解法 	 197
6.5.3      脉冲传递函数 	199
6.6      离散系统的稳定性分析 	 207
6.6.1      离散控制系统稳定的
充要条件 	207
6.6.2      劳斯稳定判据 	207
6.6.3      采样周期与开环增益
对稳定性的影响 	210
6.6.4      离散系统的稳态误差
分析 	210
本 章 小 结 	 214
课 后 练 习 题 	 214
第 7 章 非 线 性 控 制 系 统 分 析 	 217
7.1       引 言 	217
7.2      非线性控制系统概述 	 217
7.2.1      非线性系统的特点 	217
7.2.2      非线性系统的分析与
设计方法 	220


7.3       常见非线性特性及其对系统
性 能 的 影 响	 220
7.4       描 述 函 数 法 	226
7.4.1      描述函数的基本概念 	 226
7.4.2      典型非线性特性描述
函数 	228
7.4.3       非线性系统的简化 	233
7.4.4      描述函数法进行
非线性系统分析 	 236
7.5      非线性控制系统的设计实例	241
本章小结 	244
课 后 练 习 题 	244
第 8 章 线 性 系 统 的 状 态 空 间
分析与综合 	 247
8.1        引 言 	247
8.2      线性系统的状态空间描述 	248
8.2.1      状态与状态变量 	 248
8.2.2      状态空间表达式 	 248
8.2.3      状态空间表达式的
建立方法 	250
8.2.4      线性连续时不变系统
状态方程的解 	259
8.2.5      系统的传递函数矩阵 	 264
8.2.6      线性系统状态空间
模型的线性变换 	 265
8.2.7      线性离散系统的状态
空间模型 	270
8.3      线性系统的能控性和能观性 	272
8.3.1      线性连续系统的能控性 	272
8.3.2      输出能控性 	274
8.3.3      线性连续系统的能观性 	275
8.3.4      状态空间表达式的能控
和能观标准型转化 	277
8.3.5      线性定常系统的规范
分解 	282
8.3.6      离散系统的能控性和
能观性 	285






8.4      李雅普诺夫稳定性分析 	 288
8.4.1      李雅普诺夫意义下的
稳定性 	289
8.4.2      李雅普诺夫第一法
( 间接法)	 290
8.4.3      李雅普诺夫第二法
( 直接法)	291
8.4.4      李雅普诺夫第二法在线性
定常系统中的应用	294
8.5      线性定常系统的状态综合 	296
8.5.1      两种常用反馈控制结构	297
8.5.2      反馈结构对系统性能的
影响 	298
8.5.3      系统的极点配置 	 300
8.5.4      全维状态观测器 	 302
8.5.5      分离特性 	305
8.6       状态空间分析法的设计实例 	306
本 章 小 结 	 309
课 后 练 习 题 	 309
第 9 章 最 优 控 制 理 论 基 础 	 315
9.1        引 言 	315
9.2       最优控制问题导论 	315
9.3      最优控制中的变分法 	318


9.3.1      微积分基础 	319
9.3.2      泛函与变分法基本概念 	 321
9.3.3      泛函极值问题与欧拉
方程 	322
9.3.4      条件泛函极值与动态
系统的最优控制问题 	 326
9.4      极小值原理及其应用 	 335
9.4.1      经典变分法的局限 	 335
9.4.2      连续系统的极小值原理 	 335
9.4.3      极小值原理的应用	 337
9.5      线性二次型最优控制问题 	343
9.5.1      线性二次型问题 	 343
9.5.2      线性系统状态调节器
问题 	 344
9.5.3      倒立摆的最优控制问题 	 348
9.6       动 态 规 划 	 351
9.6.1      动态规划基本思想 	 351
9.6.2      动态规划法求解离散
最优控制问题 	 353
本 章 小 结 	 354
课 后 练 习 题 	355
参 考 文 献 	356



















VⅢ







第 1 章  自动控制的一般概念


本 章 提 要

　　　本章主要介绍自动控制技术的发展史，进而介绍自动控制原理的基本概念及一系列专有名 词，分析了自动控制系统的分类、组成以及对自动控制系统的性能要求。
1.1  引   言
　　　工程技术是通过理解并控制自然而造福人类的。控制系统工程师通过理解和控制他们周边  环境的一部分，即所谓的系统，为社会提供经济实用的产品。理解和控制，这种双重目标是相辅  相成的，因为对系统的有效控制需要对系统的理解和建模。不过，控制工程也常常不得不考虑对  尚未充分理解的系统实施控制，如对化工过程的控制。控制工程师当前面临的挑战，是对诸如交  通管制系统、化工过程、机器人系统等复杂的、关联性强的现代系统进行建模和控制。所幸的是， 工程师已能对许多感兴趣的实用工业自动化系统实施控制。或许控制工程最显著的特征就是对  各类机器、工业生产过程及经济活动过程等实施控制，以直接造福于社会。
　　　控制工程以反馈理论和线性系统理论为基础，并综合应用了网络理论和通信理论的有关概 念。因此，控制工程并不局限于任一单个工程学科，而是在航空工程、化工工程、机械工程、环境 工程、土木工程、电气工程等工程学科中都有同样广泛的应用。例如， 一个控制系统通常会包括 电子、机械和化工部件。另外，随着对商业、社会和政治系统运动规律的进一步认识，人类对它们 的控制能力也将逐步增强。
1.2  自动控制简史

　　　利用反馈对系统实施控制有着多彩的历史。最早的反馈控制实例可能是公元前300年―公 元前1年在古希腊出现的浮球调节装置。大约在公元前250年，Philon  发明了油灯，该灯使用浮 球调节器来保持燃油的油面高度。生活在公元1世纪前后的亚历山大人Heron,   曾经出版过 一 本名为《气体力学》的书，书中介绍了几种利用浮球调节器控制水位的方法。
　　　近代欧洲最早发明的反馈系统是荷兰人Cornelis Drebbel(1572年―1633年)发明的温度调 节器，Dennis    Papin(1647 年―1712年)则在1681年发明了第一个锅炉压力调节器，该调节器是 一种安全调节装置，与目前压力锅的减压安全阀类似。
　　　人们普遍认为最早应用于工业过程的自动反馈控制器，是James    Watt于1769年发明的飞 球调节器，它被用来控制蒸汽机的转速。俄国人则断言，最早的具有历史意义的反馈系统是由 I.Polzunov   于1765年发明的用于水位控制的浮球调节器。
　　　1868年之前，自动控制系统发展的主要特点是凭借直觉的实证性发明。提高控制系统精度 的不懈努力导致人们要解决瞬态振荡的减振问题，甚至是系统的稳定性问题，因此，发展自动控



制理论便成为当务之急。 J.C―Maxwell   用微分方程建立了一类调节器的模型，发展了与控制 理论相关的数学理论，其工作重点在于研究不同系统参数对系统性能的影响。在同一时期，I.   A.Vyshnegradskii   建立了调节器的数学理论。
　　第二次世界大战之前，控制理论及应用在美国和西欧的发展与它在俄国和东欧的发展采取 了不同的途径。在美国，Bode 、Nyquist 和 Black 等人在贝尔电话实验室电话系统和电子反馈放 大器所做的研究工作，是促进反馈系统应用的主要动力，采用带宽等频域变量术语的频域方法当 初主要用来描述反馈放大器的工作情况。与此相反，在苏联，一些著名的数学家和应用力学家发 展和主导着控制理论，因而，他们倾向于用微分方程描述系统的时域方法。
　　第二次世界大战期间，自动控制理论及应用得到了巨大的发展。战争需要用反馈控制的方 法设计和建造飞机自动驾驶仪、火炮定位系统、雷达天线控制系统以及其他军用系统。这些军用 系统的复杂性和对高性能的追求，要求拓展已有的控制技术。这导致人们更加关注控制系统，同 时也产生了许多新的见解和方法。1940年以前，控制系统设计在绝大部分场合是一门艺术或手 艺，用的是“试凑法”。在20世纪40年代，数学和分析的方法无论在数量还是在实用性方面都有 了很大发展，控制工程因而也发展成为一门工程科学。
　　随着拉普拉斯(Laplace) 变换和频域复平面的广泛应用，频域方法在第二次世界大战之后仍 在控制领域占据着主导地位。20世纪50年代，控制工程理论的重点是发展和应用平面方法，特 别是根轨迹法。到了20世纪80年代，数字计算机用作控制部件已届平常，这些新部件为控制工 程师提供了前所未有的运算速度和精度。在美国，现在安装和使用着逾40万台控制用数字计算 机，它们主要用于过程控制系统，同时也用于多变量同步测量和控制。
　　随着人造卫星和空间时代的到来，控制工程又有了新的推动力。为导弹和空间探测器设计  复杂、高精度的控制系统成了现实需要。此外，由于既要减轻卫星等飞行器的重量，又要对它们  实施精密控制，最优控制因而变得十分重要。正是基于上述需求，最近20年来，由 Liapunov、 Minorsky 等人提出的时域方法受到了极大的关注。由苏联的 L.S.Pontryagin      和美国的  R.Bellman  研究提出的最优控制理论，以及近期人们对鲁棒系统的研究，都为时域方法增色不少。 已经众所周知的是，控制工程在进行控制系统分析与设计时应同时考虑时域和频域两种方法。
1.3 自动控制系统的基本概念

　　自动控制系统实例很多，这里首先介绍几个名词，再通过分析交通信号灯自动控制系统、水 池水位人工控制系统、水池水位阀门连动控制系统、水池水位浮球控制系统等阐述自动控制的基 本概念，并对自动控制系统的控制方式进行分类，分别阐述开环控制闭环控制的优缺点。
　　　定义1.3.1  所谓自动控制就是应用控制装置自动地、有目的地控制或操纵机器/设备或生 产过程，使其具有一定的状态和性能。
定义1.3.2  被控制的机器设备或物体称为被控对象。
定义1.3.3 所用的控制装置称为控制器。
1.3.1   自 动 控 制 系 统
例1.3.1  交通信号灯的自动控制系统。
　　如图1.3.1所示，城市里繁忙的交通路口常见这种无人管理的自动信号灯系统，一般按照一 定的时间间隔以绿/黄/红的顺序反复切换以此来控制在路口通过的交通元(人流和车流)。



　　　　　　　　　　　
图1 .3 . 1 交通信号灯自动控制系统

例1.3.2 水池水位人工控制系统。
　　如图1.3.2所示的水池中，水自水泵源源不断地通过管道和阀门二流进水池，而由各出水管 道流出，供用户使用。要求在用水量随意改变的情况下，保持水池水位的高度不变。
　　　　　　　　　　　
图1 .3 .2 水池水位人工控制系统示意图
　　用人工操作来实现这一目的过程是：操作人员首先测量水池的实际水位H?,  将它和要求的 水位值H 相比较，得出偏差或误差，然后根据偏差值调节进水阀门的打开程度，改变进水量。
　　例如，当用水量增大、水池水位迅速下降时，应开大阀门使进水量大于出水量，使水位回升， 当水池水位回升到要求值时，调节阀门使进水量等于用水量。如果用水量等于零，则应关闭阀门 使水位保持在要求的高度 。
　　通过分析可知，水池水位人工控制系统需要人参与，并且需要人24h 看护该系统，用工成本 较高。随着工程技术人员的开发设计，设计出了水池水位阀门连动控制系统来解决自动控制 问 题 。
例1.3.3 水池水位阀门连动控制系统。
　　如图1.3.3所示的水池水位控制系统中没有人为的外界干预， 一个杠杆力图控制水池里出 水量与进水量一致从而保持水位的不变。显然，它是一个自动控制系统，被控对象是水池，被控 量是水池水位，控制器是杠杆和两个阀门。
　　通过分析其工作原理可知，由于该系统的各种元件会存在误差，误差积累会造成系统无法使 用 ， 所以该系统虽然是自动控制系统 ， 但是设计中存在原理性误差 ， 所以仍需要人参与 。 虽然该 系统不像例1.3.2系统那样需要24h 派人看护，但是仍需要隔一段时间派一个人检查一下水池







　H?  实际 水位



　　给定 H  水位
阀门二


阀门一 杠杆


进水


出水

水池
图1.3.3 水池水位阀门连动控制系统示意图
水位控制情况(如2h 去检查1次),以消除误差，使用户安全用水，不至于出现用户无水用或者水 池水溢出。科技人员设计出水池水位浮球控制系统来消除原理性误差。
例1.3.4 水池水位浮球控制系统。
　　如图1.3.4所示的系统，同样是用装置替代操作人员构成的水池水位控制系统。实际水位 高于给定期望值时，浮球顶起杠杆，从而关小阀门二使进水量小于出水量，水位下降。相反，当实 际水位低于期望值时，浮球下降，作用于杠杆使阀门二打开，使入水量大于出水量，水位上升，最 终达到进出平衡。显然，它也是 一 个自动控制系统，被控对象是水池，被控量是水池水位，控制器 是浮球、杠杆和阀门二。
　　　　　　　　　　　
水池
图1.3.4 水池水位浮球控制系统示意图
　　　由工作原理分析可知，水池水位浮球控制系统则不存在原理性误差，不需要人参与，完全实 现了无人控制 ， 安全使用 。 这就是常用的抽水马桶的工作原理 。
　　为了便于分析控制系统的工作原理，这里以例1.3.2为例，以方块图的形式给出系统的职能 图。水池水位人工控制系统的职能图如图1.3.5所示。
　　　　　　　　　
图1.3.5  水池水位人工控制系统的职能图
　　用一般的控制工程语言代换职能图中的文字，得到自动控制系统的方框图。水池水位人工 控 制 系 统 的 方 框 图 如 图 1 . 3 . 6 所 示 。




　　　　　　　　　
图1 . 3 . 6 水池水位人工控制系统的方框图
　　从 图 1 . 3 . 6 控 制 方 框 图 可 以 看 出 ， 控 制 装 置 应 具 有 三 种 基 本 功 能 ， 分 别 是 测 量 、 计 算 与 执 行 ， 这 些 功 能 需 要 相 应 的 元 件 承 担 。 参 与 控 制 的 信 号 来 自 三 条 通 道 ， 分 别 是 给 定 值 、 被 控 量 与 干 扰 ， 这 是 控 制 的 主 要 依 据 。 基 于 这 些 分 析 ， 可 以 获 得 两 大 类 共 三 种 自 动 控 制 的 基 本 方 式 。 三 种 基 本  控制方式分别是按给定值操纵 、 按干扰补偿 、 按偏差调节 ， 前两种控制方式属于开环控制 ， 第三种  控 制 方 式 属 于 闭 环 控 制 。
1.3.2     控 制 方 式 的 分 类
1. 按 给 定 值 操 纵
　　　由 例 1 . 3 . 1 交 通 信 号 灯 控 制 系 统 的 控 制 方 式 可 以 发 现 ， 系 统 的 输 出 量 ( 被 控 量 ) 对 输 入 量 ( 控 制 量 ― ― 信 号 灯 绿 / 黄 / 红 的 变 色 指 令 ) 没 有 任 何 影 响 ， 干 扰 ( 等 待 通 行 的 交 通 元 ― ― 人 流 / 车 流 ) 对 输 入 量 也 无 任 何 影 响 。 其 工 作 方 框 图 如 图 1 . 3 . 7 所 示 。
　　　　　　　　　　　　
图1 . 3 . 7  按给定值操纵控制方框图
定 义 1 . 3 . 4  按 给 定 值 操 纵 。
一 般 地 ， 将 控 制 输 入 既 不 依 赖 于 输 出 又 不 依 赖 于 干 扰 的 控 制 方 式 称 为 按 给 定 值 操 纵 。
　　　这 种 控 制 方 式 比 较 简 单 ， 但 有 较 大 的 缺 陷 ， 即 系 统 的 精 度 难 以 保 证 。 目 前 ， 在 国 民 经 济 各 部 门中应用的此类控制系统还有自动售货机 、 自动洗衣机 、 产品生产流水线 、 包装机 、 线切割机等 。
2. 按 干 扰 补 偿
　　　由 例 1 . 3 . 3 水 池 水 位 阀 门 连 动 控 制 系 统 的 控 制 方 式 可 以 发 现 ， 尽 管 系 统 的 控 制 量 ( 进 水 速 度 ― ― 进 水 阀 门 的 开 启 大 小 ) 不 依 赖 于 输 出 量 ( 水 池 实 际 水 位 ) , 但 是 干 扰 ( 出 水 量 ) 对 控 制 信 号 的 影 响 却 是 直 接 的 。 其 工 作 方 框 图 如 图 1 . 3 . 8 所 示 。
　　　　　　　　　
图1 . 3 . 8  按干扰补偿控制方框图
定 义 1 . 3 . 5  按 干 扰 补 偿 。
一 般 地 ， 将 利 用 干 扰 信 号 产 生 控 制 作 用 ， 以 补 偿 干 扰 对 被 控 量 的 影 响 的 控 制 方 式 称 为 按 干 扰



补偿 。
　　这种控制方式在精度上比按给定值操纵的方式要好，但由于它对不可测干扰以及对象/各功 能部件内部参数变化给被控量造成的影响，系统自身无法控制，因此，其控制精度仍然受到原理 上的限制。工作机械的恒速控制(如稳定刀具转速)、电流系统的稳压、稳频控制都常用这种补偿 方 式 。
3. 按偏差调节
　　由例1.3.4水池水位浮球控制系统的控制方式可以发现，该系统的控制量是由系统的输出 量和输入量同时决定的。其工作方框图如图1.3.9所示。
干扰
输入量
比较计算  控制信号  执行


图1.3.9 按偏差调节控制方框图
定义1.3.6 按偏差调节。
　　一般地，称这种控制信号往复循环，沿前向通道和反馈通道闭路传送的控制方式为按偏差调 节(又称反馈控制)。
　　反馈控制是自动控制系统中最基本的控制方式，因为它无论是由于干扰造成的，还是由结构 参数的变化引起的，只要被控量出现偏差，系统就能自行纠偏，在原理上提供了实现高精度控制 的可能性，所以这种控制方式在工程中获得了广泛应用。
定义1.3.7  开环控制。
　　图1.3.7按给定值操纵控制方式与图1.3.8按干扰补偿控制方式的原理图中的控制信号只 能单向传输，故统称为开环控制方式。
定义1.3.8  闭环控制。
　　图1.3.9按偏差调节控制方式中控制信号可以在系统中往复循环传输(即信号通道形成了 一个闭环),故称这类控制方式为闭环控制方式。
定义1.3.9  复合控制。
　　由于反馈控制只有在偏差出现后才产生控制作用，因此，系统在强干扰作用下，控制过程中 被控量可能有较大的波动，对于这种工作环境，同时采用按偏差调节和按干扰补偿的开―闭式复 合控制更为合适。
1.3.3      开环与闭环控制系统的比较
表1.3.1分别给出了开环与闭环控制方式的优缺点，供读者在选择控制方式时参考。
表1 . 3 . 1  开环控制与闭环控制方式比较

控制方式	优点	缺点	控制方式	优点	缺点

开环控制	结构简单
经济
无不稳定问题
便于调试
抗干扰能力差
控制精度不高
闭环控制
抗干扰能力强 控制精度高	结构复杂
价格高
有不稳定问题
难以调试






1.4 自动控制系统的分类及组成
1.4.1 自动控制系统的分类
　　自动控制系统有多种分类方法。例如，按控制方式可分为开环控制、反馈控制、复合控制等； 按元件类型可分为机械系统、电气系统、机电系统、液压系统、气动系统、生物系统等；按系统功用 可分为温度控制系统、压力控制系统、位置控制系统等；按系统性能可分为线性系统和非线性系 统、连续系统和离散系统、定常系统和时变系统、确定性系统和不确定性系统等；这里主要按输入 量变化规律又可分为恒值控制系统、随动系统和程序控制系统等。一般地，为了全面反映自动控 制系统的特点，常常将上述各种分类方法组合应用。
1. 恒值控制系统
　　这类控制系统的输入量是一个常值，要求输出量亦等于一个常值，故又称为调节器。但由于  扰动的影响，输出量会偏离输入量而出现偏差，控制系统便根据偏差产生控制作用，以克服扰动  的影响，使输出量恢复到给定的常值。因此，恒值控制系统分析、设计的重点是研究各种扰动对  被控对象的影响以及抗扰动的措施。在恒值控制系统中，输入量可以随生产条件的改变而改变， 但是，一经调整后，输出量就应与调整好的输入量保持一致。例1.3.4水池水位浮球控制系统就  是一种恒值控制系统，其输入量是常值。此外，还有温度控制系统、压力控制系统、液位控制系统  等。在工业控制中，如果被控量是温度、流量、压力、液位等生产过程参量时，这种控制系统则称  为过程控制系统，它们大多数都属于恒值控制系统。
2. 程序控制系统
　　这类控制系统的输入量是按预定规律随时间变化的函数，要求输出量迅速、准确地加以复 现，例1.3.1交通信号灯控制系统便是一例。程序控制系统的输入量是已知的时间函数。恒值 控制系统可视为程序控制系统的特例。
3. 随动系统
　　这类控制系统的输入量是预先未知的随时间任意变化的函数，要求输出量以尽可能小的误 差跟随输入量的变化，故又称为跟踪系统。在随动系统中，扰动的影响是次要的，系统分析、设计 的重点是研究输出量跟随的快速性和准确性。在随动系统中，如果输出量是机械位置或其导数 时，这类系统称为伺服系统。
1.4.2 自动控制系统的组成
　　反馈控制系统是由各种结构不同的元件组成的。从完成“自动控制”这一职能来看，一个系 统必然包含被控对象和控制装置两大部分，而控制装置是由具有一定职能的各种基本元件组成 的。在不同系统中，结构完全不同的元件却可以具有相同的职能，因此，将组成系统的元件按职 能分类主要有以下几种：
　　(1)测量元件。其职能是检测被控制的物理量，如果这个物理量是非电量，一般要再转换为 电量。例如，测速发电机用于检测电动机轴的速度并转换为电压；电位器、旋转变压器或自整角 机用于检测角度并转换为电压；热电偶用于检测温度并转换为电压等。
(2)给定元件。其职能是给出与期望的被控量相对应的系统输入量(即给定值)。
(3)比较元件。其职能是把测量元件检测的被控量实际值与给定元件给出的输入量进行比



较，求出它们之间的偏差。常用的比较元件有差动放大器、机械差动装置、电桥电路等。
　　　(4)放大元件。其职能是将比较元件给出的偏差信号进行放大，用来推动执行元件去控制 被控对象。电压偏差信号可用集成电路、晶闸管等组成的电压放大级和功率放大级加以放大。
　　　(5)执行元件。其职能是直接推动被控对象，使其被控量发生变化。用来作为执行元件的 有阀、电动机、液压马达等。
　　　(6)校正元件。校正元件也叫补偿元件，它是结构或参数便于调整的元件，用串联或反馈的 方式连接在系统中，以改善系统的性能。最简单的校正元件是由电阻、电容组成的无源或有源网 络，复杂的则用电子计算机。
　　　一个典型的反馈控制系统基本组成可用图1.4.1所示的方块图表示。图中，用“O”代表比 较元件，它将测量元件检测到的被控量与输入量进行比较，“一”号表示两者符号相反，即负反馈； “+”号表示两者符号相同，即正反馈。信号从输入端沿箭头方向到达输出端的传输通路称前向 通路；系统输出量经测量元件反馈到输入端的传输通路称主反馈通路。前向通路与主反馈通路 共同构成主回路。此外，还有局部反馈通路以及由它构成的内回路。只包含一个主反馈通路的 系统称单回路系统，有两个或两个以上反馈通路的系统称多回路系统。
　　　　　　　
图1.4.1  反馈控制系统的基本组成
　　　一般地，加到反馈控制系统上的外作用有两种类型： 一种类型是有用输入；另一种类型是扰 动。有用输入决定系统被控量的变化规律；扰动是系统不希望有的外作用，它破坏有用输入对系 统的控制。在实际系统中，扰动总是不可避免的，而且它可以作用于系统中的任何元件上，也可 能一个系统同时受到几种扰动作用。电源电压的波动，环境温度、压力以及负载的变化，飞行中 气流的冲击，航海中的波浪等，都是现实中存在的扰动。
1.5    对控制系统的性能要求

1.5.1   自 动 控 制 系 统 的 性 能 要 求
　　　按照反馈原理设计的自动控制系统，是否都能很好地进行工作，是否都能精确地保持被控量 等于给定值，这并不知道。系统也有可能工作得很坏，甚至会发生被控量的强烈振动，使被控对 象遭到破坏。这将取决于被控对象和控制装置之间各功能元件的特性参数之间是否匹配得当。
　　　在理想情况下，自动控制系统的被控量和给定值，任何时候都相等，完全没有误差，而且不受 干扰的影响，即c(t)=r(t)。
实际系统中，由于机械部分质量、惯量的存在，电路中的电感、电容的存在，并且也由于能源



功率的限制，使得运动部件的加速度不会很大，速度和位移不会瞬间变化，而要经历一段时间，要 有一个过程。通常，把系统受到外加信号(给定值、干扰)作用后，被控量随时间t 变化的全过程 称为系统的动态过程(过渡过程),用c(t) 表示。
　　控制精度是衡量系统技术水平的重要尺度。一个高质量的系统，在整个运行过程中，被控量 对给定值的偏差应该是很小的。考虑到动态过程c(t)  在不同阶段中的特点，工程中常从稳、快、 准三个方面来评价自动控制系统的总体精度。
　　(1)稳定性。稳定性是保证控制系统正常工作的先决条件。 一个稳定的控制系统，其被控 量偏离期望值的初始偏差应随时间的增长逐渐减小并趋于零。线性自动控制系统的稳定性是由 系统结构所决定的，与外界因素无关。
　　(2)快速性。为了很好地完成控制任务，控制系统仅仅满足稳定性要求是不够的，还必须对 其过渡过程的形式和快慢提出要求，一般称为动态性能。因此，对控制系统过渡过程的时间(即 快速性)和最大振荡幅度(即超调量)一般都有具体要求。
　　(3)准确性。理想情况下，当过渡过程结束后，被控量达到的稳态值(即平衡状态)应与期望 值一致。但实际上，由于系统结构，外作用形式以及摩擦、间隙等非线性因素的影响，被控量的稳 态值与期望值之间会有误差存在，称为稳态误差。稳态误差是衡量控制系统控制精度的重要标 志，在技术指标中一般都有具体要求。
1.5.2  自动控制系统的典型外作用
　　在工程实践中，自动控制系统承受的外作用形式多种多样，既有确定性外作用，又有随机性 外作用。对不同形式的外作用，系统被控量的变化情况(即响应)各不相同，为了便于用统一的方 法研究和比较控制系统的性能，通常选用几种确定性函数作为典型外作用。可选作典型外作用 的函数应具备以下条件：
(1)这种函数在现场或实验室中容易得到。
(2)控制系统在这种函数作用下的性能应代表在实际工作条件下的性能。
(3)这种函数的数学表达式简单，便于理论计算。
　　目前，在控制工程设计中常用的典型外作用函数有阶跃函数、斜坡函数、脉冲函数以及正弦 函数等确定性函数。详细阐述见3.2.1节。
本 章 小 结

　　本章介绍了自动控制技术的发展史，使读者理解自动控制原理在自动控制技术中的地位，进 而掌握自动控制原理的基本概念及一系列专有名词，分析了交通信号灯以及水池水位控制系统 等自动控制系统，总结了控制方式的分类及控制系统的组成。分析了对自动控制系统的性能要 求，为以下各章的学习打下基础。








第 2 章 控制系统的数学模型

本 章 提 要

　　　本章研究控制系统的数学建模问题。先介绍时域数学模型――微分方程的建立方法，并讨 论非线性微分方程的线性化问题；再介绍拉普拉斯变换，通过拉普拉斯变换求解线性微分方程， 并得到系统的复域数学模型――传递函数；进而介绍结构图、信号流图以及梅森增益公式；最后 介绍数学模型实验测定方法和用MATLAB  进行系统建模，并结合电力牵引电机控制系统给出 设计实例。
2.1  引   言

　　　工程应用对自动控制的性能指标都具有具体的数量要求，常称为技术指标。因此，只定性地 分析系统的工作原理和大致的运动过程是不够的，还必须深入地掌握系统在外作用下的运动规 律，能够从理论上对系统性能进行定量的分析和计算。要做到这一点，首先要建立系统的数学模 型，它是分析和设计系统的依据。
　　　描述系统动态特性的数学形式叫系统的数学模型。自动控制系统加上输入信号以后，输出 量的运动方程可以用联系输入量和输出量的微分方程加以描述。因为它既能定性又能定量地描 述整个系统的运动方程，所以微分方程是系统的一种数学模型。
　　　实际的控制系统用这种抽象的数学语言――微分方程描述以后，这样的微分方程就好像实 际系统的一个虚构模型，以后研究系统的运动都撇开具体系统，只从数学模型出发。建模时要注 意两个问题：
(1)同一系统，由于描述方法或研究方法的不同，可以采用不同的数学模型。
　　　控制系统建模时，除了常用的微分方程形式的数学模型之外，描述一个系统的数学模型还有 传递函数、结构图、信号流图、根轨迹、差分方程、频率特性曲线、状态空间表达式。本章只研究微 分方程、传递函数和结构图等数学模型的建立及应用，其他形式的数学模型将在以后各章中予以 详述。
(2)不同的系统也可以由完全相同的数学模型来表示。
　　　系统的数学模型可以采用理论分析或实验测定的方法建立。分析法是对系统各部分的 运行机理进行分析，根据它们所依据的物理规律或化学规律分别列写相应的运动方程。实验 法是人为地给系统施加某种测试信号，记录其输出响应，并用适当的数学模型去逼近，这种方 法称为系统辨识。近些年来，系统辨识已发展成一门独立的学科分支。本章主要采用解析法 建立系统的数学模型。模型的简化性和准确性是建立元件或系统数学模型时经常要考虑的 问题。




2.2    控制系统的时域数学模型

2.2.1   控 制 系 统 的 微 分 方 程
　　利用控制系统或组成系统的元件自身的物理规律可以建立描述系统动态特性的微分方程， 用解析法列写系统或元件微分方程的一般步骤如下：
(1)根据系统或元件的具体工作情况，确定系统或元件的输入、输出变量。
　　(2)从输入端开始，按照信号的传递顺序，依据各变量所遵循的物理(或化学)规律，列写出 系统各元部件的动态方程， 一般为微分方程组。
(3)消去中间变量，写出输入、输出变量的微分方程。
　　　(4)将微分方程标准化，即将与输入有关的各项放在等号右侧，与输出有关的各项放在等号 左侧，并按降幂排列，且输出量c(t)  前面的系数为1,方程中除了输入量和输出量及其各阶导数 之外，其他各量都是系统已知的结构参数。
下面举例说明建立微分方程的步骤和方法。
　　　例2.2. 1 图2.2. 1是弹簧―质量―阻尼器机械平移系统。试列出质量m 在外力F(t)   作 用下，位移x(t)  的运动方程。
解  设阻尼器的阻尼力和弹簧的弹力分别为 F?(t)    和 F?(t),     则
,F?(t)=Kx(t),  且 F? (t) 和 F? (t) 的方向均与运动方向 相反。由牛顿运动定律，得
　　　　　　　　　         (2.2.1) 将 F?(t)   和 F?(t)   代入式(2.2.1)中，经整理后即得该系统的微分方程为
　　　　　　　　        (2.2.2) 标准化后得


　　　　　　　　



(2.2.3)


图2.2.1 机械平移系统

　　例2.2.2  图2.2.2是由电阻R、电 感L 和电容C 组成的RLC  电路。试列写以u,(t)   为输 入 ，u(t)   为输出的RLC 电路的微分方程。
　　　　　　　　　　　　　　
图2.2.2 RLC电路
解  设回路电流为i(t),    则根据电路遵循的基尔霍夫电压定律，有
　　　　　　　　　　　　　



　　　　　　　　　　　　　　　　　　
消去上式中的中间变量i(t),   得




整理得









(2.2.4)


(2.2.5)

　　　从上述系统的微分方程可以看出，不同类型的元件或系统可具有形式相同的数学模型。不 考虑系统各参数的物理意义，例2.2.1和例2.2.2系统具有相同的数学模型，均是二阶微分方 程，这些物理系统称为相似系统。相似系统揭示了不同物理现象间的相似关系，可以使设计人员 将对一个系统的分析结果推广到具有相同微分方程模型的其他系统，也为控制系统的计算机仿 真提供了基础。
例2.2.3  试列写图2.2.3所示速度控制系统的微分方程。

　　　　
图2.2.3 速度控制系统
　　解  该系统中给定电压u,(t)   为输入量，电动机转速w(t)  为输出量。从产生偏差的元件开 始，按信号流通方向依次写出组成该系统各元件的微分方程。
　　　(1)测量元件。测速发电机作为测量元件，它可将系统输出角速度w(t)  转换成相应的电压 u,(t),   即
u?(t)=Kw(t)                                                                     (2.2.6)
式中：K, 是测速发电机的传递函数，可看做常数。
(2)比较元件。比较元件将反馈电压 u?(t)   与给定电压 u,(t)   进行比较，并产生偏差电压
u.(t),     即
u(t)=u,(t)―u,(t)                                                                    (2.2.7)
　　　(3)放大元件。放大元件包括电压放大器和功率放大器两部分，作用是对偏差电压u.(t)   进 行电压和功率放大，即
ua(t)=Ku(t)                                                                      (2.2.8)
式中：K 是电压放大器和功率放大器的放大系数，为常数。



　　　(4)执行元件。直流电动机作为执行元件，它将电枢电压ua(t)转换成电动机转子轴的角速 度wm(t),  根据电机原理可知，直流电动机的微分方程为
                 (2.2.9)
(5)减速器。减速器用来减速并增大力矩，其微分方程为
　　　　　　　　　　　　　　　　　　                             (2.2.10) 式 中 ：i 是减速器的传动比，为常数。
　　　联立式(2.2.6)～式(2.2. 10),消去中间变量u,(t) 、u(t) 、ua(t) 、wm(t),        可得电动机转速控 制系统的微分方程为
           (2.2.11)
2.2.2    控 制 系 统 的 线 性 近 似
　　　大多数的物理系统在参数的某些范围内呈现出线性特性，但当对参数范围不加限制时，所有  的系统都是非线性系统。非线性系统比起线性系统，其分析和设计的过程都要复杂得多，故而， 在系统自身特性和对系统控制精度允许的条件下，把非线性系统近似为线性系统来简化分析和 设计的过程。
1. 线性系统的特性
　　　用线性微分方程描述的系统称为线性系统。线性系统的特性可以用其输入和输出的关系来 描述。对于线性系统，若系统输入为r?(t)   时输出为c?(t),     系统输入为r?(t)   时 输 出 为c?(t),    则 系 统输入为r?(t)+r?(t)        时输出为c?(t)+c?(t),         线性系统的这个特性称为可加性。若系统输入为 r?(t)   时 输 出 为c?(t),k     为常数，则在系统输入为kr?(t)    时 输 出 为 kc?(t),     称为齐次性。可加性和 齐次性合称为叠加原理。
　　　线性系统的叠加原理表明，多个外作用同时作用于系统所产生的总输出，等于各个外作用单 独作用时分别产生的输出之和，且外作用的数值增大若干倍时，其输出亦增大相同的倍数。因 此，对线性系统进行分析和设计时，如果有几个外作用同时作用于系统，则可以将它们分别处理， 依次求出各个外作用单独作用时系统的输出，然后将它们叠加；每个外作用在数值上可以只取单 位值，从而大大简化了线性系统的研究工作。
2. 非线性微分方程的线性化
　　　事实上，任何一个元件或系统总是存在一定程度的非线性。例如，弹簧的刚度与其形变有 关，并不一定是常数；电阻R、电 感 L、电 容C 等参数值与周围环境(温度、湿度、压力等)及流经它 们的电流有关，也不一定是常数；电动机本身的摩擦、死区等非线性因素会使其运动方程复杂化 而成为非线性方程等。严格来说，实际系统的数学模型一般都是非线性的，而非线性微分方程没 有通用的求解方法。因此，在研究系统时总是力图将非线性问题在合理、可能的条件下简化为线 性问题处理。如果做某些近似或缩小一些研究问题的范围，可以将大部分非线性方程在一定的 工作范围内近似用线性方程来代替，这样就可以用线性理论来分析和设计系统。虽然这种方法 是近似的，但它便于分析计算，在一定的工作范围内能反映系统的特性，在工程实践中具有实际 意义 。
将非线性微分方程线性化的方法主要有两种：



　　　(1)忽略弱非线性因素。如果元件的非线性因素较弱或者不在系统非线性工作范围以内， 则它们对系统的影响很小，就可以忽略。
　　　(2)小偏差法(切线法、增量线性化法)。小偏差法基于一种假设，就是在控制系统的整个调 节过程中，各个元件的输入量和输出量只是在平衡点附近作微小变化。这一假设是符合许多控 制系统实际工作情况的，因为对闭环控制系统而言，一有偏差就产生控制作用，来减小或消除偏 差，所以各元件只能工作在平衡点附近。
　　　设连续变化的非线性函数为y=f(x), 如图2.2.4所示。取某平衡状态(xo,yo)为工作点， 对应有yo=f(xo) 。  若函数y=f(x)     在(x?,yo)   处连续可微，则在该点附近用泰勒级数展开为
　　　　　　
当增量x―x。很小时，略去其高次幂项，则有
　　　　　　　　　　　
令△y=y-yo,△x=x-xo,                                    ,则线性化方程可记为
△y=K△x
略去增量符号，便得函数y=f(x) 在工作点(xo,yo)附近的线性化方程为 y=Kx










x
图2.2.4 非线性特性的线性化
　　小偏差法线性化的几何意义是：在预期工作点附近，用通过该点的切线近似代替原来的 曲线。
　　　需要注意的是，应用小偏差法线性化时，必须明确预定平衡工作点的参数值，对于不同的工 作点，得出线性微分方程的系数一般是不一样的；如果元件或系统的原有特性接近线性时，线性 化得到的方程对偏差信号变化范围较大时，仍能适用。反之，线性化运动方程只能适用于偏差信 号为微量的情况。
小偏差法线性化的使用条件如下：
(1)在工作点附近信号变化为微量。
　　　(2)在工作点附近能展开成泰勒级数。本质非线性不能应用小偏差线性化，如继电器特性， 因为该特性在原点不连续，不能进行泰勒展开。因此，该类特性不能应用小偏差法线性化，此类



非线性称为本质非线性。
　　例2.2.4  铁芯线圈如图2.2.5(a)所示，试列写以电压ur 为输入，电流i 为输出的铁芯线圈 的微分方程。
解  根据克希荷夫定律，有
ur=u?+Ri                                                                     (2.2.12)


式中：u1 为线圈的感应电势，它正比于线圈中磁通变化率，即
　　　　　　　　　　　　　　　　　　




(2.2.13)

式中，K?  为比例常数。铁芯线圈的磁通是线圈中电流i  的非线性函数，如图2.2.5(b) 所示。将


式(2.2.13)代入式(2.2.12),得


显然，这是一个非线性微分方程。








(2.2.14)

　　　　　　　　　　　　　　　　　　　　　
(a)                                          (b)
图2.2.5 铁芯线圈及磁通?曲线
　　　如果在工作过程中，线圈的电压、电流只在平衡工作点(io,φo)  附近作微小的变化，φ(i) 在 io 的邻域内连续可导，则在平衡点io 邻域内，磁通φ可表示成泰勒级数，即
　　　　　　　　　　　　　
式中：△i=i―io,     当 △i“足够小”时，略去高阶项，取其一次近似，有
　　　　　　　　　　　　　　　　　　
式中：为平衡点i   处 φ(i)  的导数值，令它为C?,  则
φ≈φo+C?△i
φ一φo=△φ≈C?△i
上式表明，经小扰动线性化处理后，线圈中电流增量与磁通增量之间已经近似为线性关系了。将 式(2.2.14)中u,、φ、i 均表示成平衡点附近的增量方程，即
u,=uo     十△u,
i=i+△i
φ≈φo+C?△i




将上述三式代入式(2.2.14),消去中间变量并整理，得
　　　　　　　　　　　　　　　　




(2.2.15)

　　　式(2.2.15)就是铁芯线圈的线性化增量微分方程。在实际使用中，为简便起见，常常略去增 量符号而写成
(2.2.16)
但必须明确，u, 和i 均为相对于平衡工作点的增量(小变化量),而不是本身的真正值。

2.3   拉普拉斯变换

　　　拉普拉斯变换是一种积分变换，它可将时间域内的微分方程变换成复数域内的代数方程，并 在变换时引入了初始条件，可以方便地求解线性定常系统的微分方程；同时，拉普拉斯变换也是 建立系统复数域的数学模型――传递函数的数学基础。
2.3.1   拉普拉斯变换的定义
定义2.3.1 设函数f(t)当 t≥0时有定义，而且积分
                         (2.3.1)
存在，则称F(s)  是 f(t)   的拉普拉斯变换，记作F(s)=L[f(t)],         其中，s 是复变量。F(s)  称为时间 域内的函数f(t)   的象函数，f(t)   称为F(s)  的原函数。
例2.3.1 求阶跃函数f(t)=A・1(t)         的拉普拉斯变换。
解 由拉普拉斯变换定义式(2.3.1),得
　　　　　　　　　　　　　
例2.3.2 求指数函数f(t)=e     “的拉普拉斯变换。 解  由式(2.3.1)得
　　　　　　　　
例2.3.3 求单位脉冲函数f(t)=δ(t)      的拉普拉斯变换。
　　解 拉普拉斯变换的定义式中，积分下限为零，但有0的右极限0+和左极限0-之分。拉普 拉斯变换中，一般采用0-型变换，则
　　　　　　
　　从单位脉冲函数的拉普拉斯变换求解过程中可以发现，若积分下限为0+,则单位脉冲函数 的拉普拉斯变换为0,不能反映出脉冲函数在区间[0-,0+]内的跳跃特性。故在拉普拉斯变换 过程中，若不特别指出，均认为是0-型变换。
为了计算方便，将控制系统中常用函数的拉普拉斯变换列于表2.3.1,以供查阅。



表2.3.1常用函数的拉普拉斯变换表

	象函数F(s)	原函数f(t)		象函数F(s)	原函数f(t)
1	1	δ(t)	8	　　　	sinaot
2	　　　　	1(t)	9	　　　	cosot
3	　　　　	t	10	　　　	1-cosut
4	　　　　	　　	11	　　	e-a sinaot
5	　　　　	e-@	12	　　	e“coswt
6	　　　	　　　	13	　　	　　
7	　　	　　

2.3.2   拉普拉斯变换的常用定理
　　　(1)线性定理。原函数之和的拉普拉斯变换等于各原函数拉普拉斯变换之和，常数可以提 到拉普拉斯变换符号外面，即

L[af?(t)+bf?(t)]=aF?(s)+bF?(s)                                                       (2.3.2)
由拉普拉斯变换的定义，易证。
(2)微分定理。原函数f(t)   的一阶导数的拉普拉斯变换为
　　　　　　　　　　　　　　　                      (2.3.3) 式中：f(O) 为原函数f(t)  在 t=0   时的初始值。
证明  由拉普拉斯变换的定义用分部积分法，令u=e,dv=
,则
　　　　　　　　　
应用式(2.3.3)可以求原函数二阶导数的拉普拉斯变换为
　　　
依此类推，可以求出原函数n 阶导数的拉普拉斯变换为
L[fn(t)]=s"F(s)            一s"-1f(0)―s“2f(0)― …          一f”-1(O)                     (2.3.4)
式中：f(0),…,fn-1)(0)        为 f(t)   的各阶导数在t=0    时刻的初始值。
若原函数f(t)   及其各阶导数的初始值均为零，则
L[fn(t)]=s"F(s)                                                               (2.3.5)
即原函数f(t)   的 n 阶导数的拉普拉斯变换等于其象函数F(s)  乘以s”。



(3)积分定理。原函数f(t)   对时间t 积分的拉普拉斯变换为
(2.3.6)
式中：f=1(0) 为积分在t=0 的值。
证明                               ,用分部积分法，令
　　　　　　　　　　　　　　　　
则
　　　　　
同理，对于f(t)   多重积分的拉普拉斯变换为
　　　　　　　　　　
(2.3.7)

式中：f-2)(0),…,f        一”(0)为f(t)   的各重积分在t=0   时的值。 若原函数f(t)  及其各重积分的初始值都等于零，则有
(2.3.8)
即原函数f(t)   的 n 重积分的拉普拉斯变换等于其象函数F(s)  除以s”。
(4)初值定理。原函数的初值等于其象函数乘以s 的终值，即
(2.3.9)
证明  由微分定理，有
　　　　　　　　　　　　　　
等式两边对s→∞  取极限，有
　　　　　　　　　　　　
　　　　　　　　　　　　　
于是，定理得证。
(5)终值定理。原函数的终值等于其象函数乘以s 的初值，即
(2.3.10)
证明  由微分定理，有
　　　　　　　　　　　　　　　
等式两边对s→0 取极限，有




　　　　
　　　　　　　　　　　　　
于是，定理得证。
　　需要注意的是，若t→∞  时原函数f(t)   的极限不存在，则不能用终值定理。如正弦函数就不 能应用终值定理计算其终值。
(6)位移定理。
①实域中的位移定理。若原函数在时间上延迟z, 则其象函数应乘以e,     即
L[f(t-t)・1(t―t)]=eF(s)                                                                   (2.3.11)
证 明 ,,令t-t=t?,        并考虑到t<0   时
f(t)=0, 所 以f(t)沿时间轴向右平移一个时间r 后，当t<t 时 ，f(t―t) ・ 1(t―r)=0, 有
　　　　　　　
　　　　　　　　　　　　　　　　　　
e"F(s)
②复域中的位移定理。象函数的自变量延迟a, 原函数应乘以e,   即
L[e“f(t)]=F(s―a)                                                               (2.3.12)
证明
　　　(7)相似定理。原函数在时间上收缩(展宽)若干倍，则象函数及其自变量都增加(减小)同 样倍数，即

　　　　　　　　　　　　　　　　　
证 明
　　　　　　　　　　　　　　　
(8)卷积定理。两个原函数卷积的拉普拉斯变换等于两个象函数的乘积，即
　　　　　　　　　　　　　



(2.3.13)






(2.3.14)

　　证明  ,因为t>t    时 ，f(t―t)・1(t         一 T)=0,   因此有
　　　　　　　　　　
于是有
　　　　　　　
　　　　　　　　　　　　　　　　　　



　　　　　　　　　　　　　
令 t-t=t?,        则
　　　　　　　　
　　　　　　　　　　　　　　　　　　　　
F?(s)F?(s)

2.3.3   拉 普 拉 斯 反 变 换
　　定义2 . 3 .2  从象函数F(s) 求原函数 f(t) 的运算称为拉普拉斯反变换，记作f(t)= L-1[F(s)]。 其计算表达式为
(2.3.15)
式中：c 是常数，而且大于F(s)所有极点的实部。
　　　直接用式(2.3.15)求原函数是复杂的。通常采用查拉普拉斯变换表的方法求拉普拉斯反变 换，但这时的拉普拉斯变换式F(s)应是能从表中查到原函数的形式。若不能查到，应将F(s) 展 开成若干部分分式之和，这些部分分式的拉普拉斯变换可以从表中查到。
在控制系统中遇到的象函数，多为如下有理分式形式，即
　　　　　　　　　
　式中：系数ao,a?,…,an-1,an       和bo,b?,…,bm-1,bm     都是实常数；m、n是正整数。按代数定理可将 F(s)  展开为部分分式。分以下两种情况讨论。
　　(1)A(s)=0       无重根。这时，F(s)  可展开为n 个简单的部分分式之和的形式，每个部分分式 都 以A(s)  的一个因式作为其分母，即
(2.3.16)
式中：$1,S?,…,sn是方程A(s)=0  的根；c;为待定常数，称为F(s)在 s;处的留数，可按下列两式 计算，即
                         (2.3.17)
或
(2.3.18)
式 中 ：A'(s)  为 A(s)  对 s 的一阶导数。根据拉普拉斯变换的性质，从式(2.3.16)查拉普拉斯变换
表可求得原函数为
(2.3.19)
例2.3.4  求 的拉普拉斯反变换。



解  F(s)  可以展开成 的形式，按照式(2.3.17)计算，有
　　　　　　　　　　
　　　　　　　　　　
　　　　　　　　　　
因此，根据式(2.3.19),查拉普拉斯变换表，得
(t≥0)
例2.3.5  求 的拉普拉斯反变换。
　　解  F(s)  可展开成 的形式，但是据此式计算过程较复杂。对于 F(s)   的分母是s 的二次多项式且令其等于零的解为共轭复根的形式，可将分母配成二项平方和 的形式，并作为一个整体来求原函数。于是，有
　　　　　　　　　　
查拉普拉斯变换表可求得原函数为
f(t)=e(cost―4sint)                   (t≥0)
(2)A(s)=0       有重根。设A(s)=0      有 r 重 根s?,F(s)     可写为
　　　　　　　
　　　　　　　　　　　
(2.3.20)
式中：s? 为 F(s)  的 r 重根；Sr+1,…,sn  为 F(s)   的 n-r    个单根；其中c++1,…,cn  仍按式(2.3.17)或
式(2.3.18)计算，c,,C―1,…,c?则按下式计算，即
　　　　　　　　　　　　　
　　　　　　　　　　　　　

　　　　　　　　　　　　　
.
(2.3.21)
原函数f(t)   为
f(t)=L- 1[F(s)]=




　　　　
(2.3.22)
例2.3.6 求 的拉普拉斯反变换。
解  根据式(2.3.20),F(s)  可展开为,按照式(2.3.21)计算，有
　　　　　　　　　　　　
　　　　　　　　　　　　
　　　　　　　　　　　　
查拉普拉斯变换表可求得原函数为
　　　　　　　　　　　　　
2.3.4   微 分 方 程 的 求 解
利用拉普拉斯变换法可以方便地求解线性定常系数微分方程，其步骤如下：
(1)对微分方程进行拉普拉斯变换，得到关于s 的代数方程。
(2)根据得到的代数方程，求出象函数F(s)  的拉普拉斯变换表达式。
( 3 ) 将 F(s)  的拉普拉斯变换展开成部分分式。
(4)查拉普拉斯变换表，求得原函数。
例2.3.7 用拉普拉斯变换法求解微分方程
　　　　　　　　　　
解  对微分方程进行拉普拉斯变换，并代入初始条件，得 s2X(s)―sx(0)―x(O)+3sX(s)―3x(O)+2X(s)=0
(s2+3s+2)X(s)=1
则
　　　　　　　　　　　　　
　　　　　　　　　　　　　
　　　　　　　　　　　　　
　　　　　　　　　　　　　
查拉普拉斯变换表，得方程的解为
x(t)=e1-e2?                  (t≥0)




2.4    控制系统的复域数学模型

　　控制系统的微分方程是在时间域描述系统动态性能的数学模型，在给定外作用及初始条件 下，求解微分方程可以得到系统输出响应的全部时间信息。这种方法直观、准确，但是如果系统 的结构改变或某个参数变化时，就要重新列写并求解微分方程，不便于对系统分析和设计。
　　传递函数是在对微分方程进行拉普拉斯变换基础上得到的复数域中的数学模型。传递函数  不仅可以表征系统的动态特性，而且可以用来研究系统的结构或参数变化对系统性能的影响。 经典控制理论中广泛应用的根轨迹法和频域法，就是以传递函数为基础建立起来的，因此，传递 函数是经典控制理论中最基本也是最重要的数学模型。
2.4.1   传 递 函 数
1. 传递函数的定义
　　定义2 .4.1  传递函数是在零初始条件下，线性定常系统输出量的拉普拉斯变换与输入量 的拉普拉斯变换之比。
线性定常系统的微分方程一般为
　　　　　　　　　　
(2.4.1)
式中：c(t)  为输出量；r(t)  为输入量；an,an-1,…,ao     及 bm,bm-1,…,b 。 均为由系统结构、参数决定 的常系数。
在零初始条件下对式(2.4.1)两端进行拉普拉斯变换，可得相应的代数方程为
(as”+a-15??1+…+a?s+ao)C(s)=(bs"”+bm15"?1+…+b?s+b)R(s)                                       (2.4.2)
系统的传递函数为
              (2.4.3)
　　　传递函数是在零初始条件下定义的。零初始条件有两方面含义： 一是指输入作用是在t=0    以后才作用于系统，因此，系统输入量及其各阶导数在t≤0 时均为零；二是指输入作用于系统之 前，系统处于稳定的工作状态，即系统输出量及各阶导数在t≤0    时的值也为零。大多数实际工 程系统都满足这样的条件。零初始条件的规定不仅能简化运算，而且有利于在同等条件下比较 系统性能。所以，这样规定是必要的。
例2 .4 .1  试求例2.2.2中的RLC  电路的传递函数。
解  由例2.2.2中式(2.2.4)可知，RLC  电路的微分方程为
　　　　　　　　　　　　
在零初始条件下，对上式两端取拉普拉斯变换，有
(LCs2+RCs+1)U.(s)=U,(s)
整理可得电路传递函数为



　　　　　　　　　　　　　　
　　另外，可以使用等效复阻抗直接列写RLC 电路的代数方程，然后求其传递函数。用复阻抗 表示的电阻仍为R, 电 感 L 的复阻抗为Ls,  电 容C 的复阻抗为1/Cs,  则
　　　　　　　　　　　
　　需要注意的是，求元件的传递函数时必须考虑负载效应，所求的传递函数应当反映元件正常 带载时工作的特性。例如，电动机空载时的特性不能反映带载运行时的特性，因此，建立控制系 统中电动机的传递函数时，必须考虑负载的情况。
2. 传递函数的性质
　　　(1)传递函数是复变量s 的有理分式，它具有复变函数的所有性质。因为实际物理系统总 是存在惯性，并且能源功率有限，所以实际系统传递函数的分母阶次n 总是大于或等于分子阶次 m, 即 n≥m。
(2)传递函数只取决于系统的结构和参数，与外作用无关，也不反映系统内部的信息。
　　　(3)系统的传递函数与微分方程对应。若给定了系统(元件)的微分方程，只要将其中的微 分运算符d3/dt     用相应的si 代替，就可以得到系统(元件)的传递函数。
　　　(4)传递函数的拉普拉斯反变换即为系统的单位脉冲响应，因此，传递函数能反映系统运动 特性。


因为单位脉冲函数的拉普拉斯变换为1(即R(s)=L[8(t)]=1),   因此有
　　　　　　　　　　　




(2.4.4)

　　　应当注意传递函数的局限性及适用范围。传递函数是从拉普拉斯变换导出的，拉普拉斯变 换是一种线性变换，因此，传递函数只适应于描述线性定常系统。传递函数是在零初始条件下定 义的，所以它不能反映非零初始条件下系统的自由响应运动规律。
3. 传递函数的常用表示形式
　　　传递函数通常表示成式(2.4.3)形式的有理分式，根据系统分析的需要，也常表示成零、极点 形式或典型环节形式。
　　　(1)零、极点形式。将传递函数式(2.4.3)的分子、分母最高次项(首项)系数均化为1,表 示为

(2.4.5)

的形式，因式分解后称为传递函数的零、极点形式。式(2.4.5)中，z;(j=1,2,…,m)         为传递函数 分子多项式等于零的根，称为传递函数的零点；p;(i=1,2,…,n)         为传递函数分母多项式等于零 的根，称为传递函数的极点；K* 称为系统的传递系数或根轨迹增益。
　　在复平面上表示传递函数的零点和极点分布情况的图形，称为传递函数的零极点分布图。 在图中用“。”表示零点，用“×”表示极点。



　　　(2)典型环节形式。将传递函数式(2.4.3)的分子、分母最低次项(尾项)系数均化为1,表示 为

(2.4.6)

的形式，因式分解后称为传递函数的典型环节形式。式(2.4.6)中每个因子都对应一个典型环
节，K 称为系统增益，决定了稳态响应的放大倍数关系。不难得出，K 与K*  的关系为

(2.4.7)

例2.4.2  已知某传递函数为  (1)求系统的增益K;
(2)求系统的微分方程；
(3)画出系统的零极点分布图。
解  (1)系统的增益为
　　　　　　　　　　　　　　　　　
(2)由系统传递函数
　　　　　　　　
得
(s?+5s3+8s2+6s)C(s)=30(s+2)R(s)
零初始条件下，进行拉普拉斯反变换可得系统的微分方程为
　　　　　
　　　　　　　　　　
(3)系统零极点分布如图2.4.1所示。


2.4.2   传递函数的极点和零点对输出的影响



图2.4.1 例2.4.2的零极点分布图

　　　当系统的传递函数G(s) 为有理函数时，它的几乎全部信息都集中表现为它的零点、极点和 传递系数，因此系统的响应也就由它的零点、极点和传递系数来决定。
1. 极点决定了系统自由(固有)运动属性
　　　无论是外部的输入信号(包括扰动信号)还是系统的初始状态，都可激发出由传递函数G(s) 极点决定的自由运动，因此系统的自由运动是系统的固有运动属性，而与外部输入信号无关。传 递函数G(s) 极点的形式，决定了系统自由运动模态的具体形式。
(1)当极点为互不相等的实数根p?,p?,…,pn     时，自由运动的模态形式为ei1,ePz2,…,en。



　　　(2)当极点有共轭复数根如 p;=σ;±jw;      时，自由运动的模态形式将出现e    coso;t或 eisinw;t。
　　　(3)当极点出现实数重根，如m 重实数根p;  时，自由运动的模态形式将出现ePi,te;&, … , tm-1ePi。
　　　(4)当极点出现复数重根，如 m 重复数根p;=σ;±jw;      时，自由运动的模态形式出现 e°icoSw;t,te°:coSw;t,…,tm-1eicoswit       或 eisinw;t,tei          sinw;t,…,tm-1eisinwit。
　　　(5)当极点既有互异的实数根、共轭复数根，又有重实数根、重复数根时，自由运动的模态形 式将是上述几种形式的线性组合。
2. 极点位置决定了系统响应的稳定性和快速性
　　　若系统传递函数的极点的实部均小于零，从s 平面来看，所有极点均位于其左半平面，则其 模态就会随着时间t 的增长而衰减，最终消失。很显然，所有极点中，只要有一个极点的实部不 小于零，即或大于零，或等于零，则其对应的模态随着时间t 的增加或趋于无穷大或呈现等幅振 荡，从而系统响应的自由运动分量就不会消失，系统也就得不到稳态响应。系统响应的自由运动 分量能够消失的称为稳定系统，因此，系统的稳定性由其全部极点的位置来决定。
　　　对于稳定的系统，即所有极点均位于s 左半平面，每个极点所对应的运动模态，随着时间t  衰减的快慢，则由该极点距离虚轴的距离来决定。显然，距离虚轴越远，则衰减得越快，距离虚轴 越近，则衰减越慢。系统响应的快速性，即暂态响应衰减的快慢，就是由极点决定的自由运动模 态衰减的快慢，因此，系统响应的快速性，也就由其全部极点在s 左半平面上的分布决定。
3. 零点决定了运动模态的比例
　　　零点决定了各模态在响应中所占的“比例”,因而，也就影响系统响应曲线的形状，影响系统 响应的快速性。从工程的角度来看，决不能认为系统的动态性质唯一地由或主要地由传递函数 的极点决定，必须注意到零点的作用。
　　　一般来讲，零点离极点较远时，相应于该极点模态所占的比例较大，离极点较近时，相应于该 极点模态所占的比例较小。当零点与极点重合，出现零极点对消现象，此时，相应于该极点的模 态也就消失了(实际上是该模态的比例为零)。因此，零点有阻断极点模态“产生”的作用。


2.4.3   典型元部件的传递函数
　　　自动控制系统中所用的元件有机械的、电子的、液 压的、气动的、光学的等，种类繁多，这里不再赘述，表 2.4.1给出几个常用典型元部件的传递函数，再以运 算放大器为例给出传递函数建立的推导过程。
例2.4.3 列写运算放大器的传递函数。
　　　解  运算放大器可以灵活地实现各种特定函数关 系的运算，并可以对几个信号进行综合，在自动控制系 统中广泛用作有源校正元件和误差检测器，也可直接 用作放大元件。
图2.4.2所示的运算放大器电路中，R, 是反馈电



表2.4.1 常用元部件传递函数

元件名称	传递函数
电位器	U(s)/θ(s)=K
直流测速发电机	U(s)/0m(s)=sK,
电枢控制式
直流电动机	　
减速器	　　　
晶体管放大器	U. (s)/U,(s)=K


阻 ，R, 是输入电阻；u, 是输入电压，u. 是输出电压。运算放大器有同相(十)和反相(一)两个输入 端。带负号的输入端为反相输入，此输入所产生的输出与输入极性相反。带正号的输入为同相 输入，它所产生的输出极性不变。两个输入有差分作用，即输出电压与两个输入端的电压差成正



比，同相输入端与 ur和u. 共地。运算放大器常用的是反相输入端，它利用负反馈原理，把一部 分与输入信号反相的输出信号送回输人端。
　　运算放大器具有高增益K=10?~10?,    而通常u. 小于10V, 因 u=u+―u    二，u=-u./K,         所 以运算放大器的输入电压u:近似等于0,这种反相输入端电位为0的现象，是运算放大器的共同 特点，叫做“虚地”;又因为运算放大器的输入阻抗很高，所以流入放大器的电流i。也近似等于0,
　　　　　　　　　　　　　　　　　　　　　　　　　　　
(2.4.8)
图2.4.2 运算放大器
式(2.4.8)的结论可推广为：运算放大器的传递函数等于
反馈复阻抗Z, 与输入复阻抗Z; 之比。如Z=1/Cs,Z;=R,   则
　　　　　　　　　　　　　　　　　
式中：T=RC   为积分时间常数，此时，运算放大器为积分器。若Z=R,Z;=R,        则
　　　　　　　　　　　　　　　　　
此时的运算放大器为倒相器。

2.5   控制系统的结构图与信号流图

　　控制系统的结构图和信号流图是描述系统各元件之间信号传递关系的数学图形，它们表示 了系统中各变量之间的因果关系以及对各变量所进行的运算，是控制理论中描述复杂系统的一 种简便方法。
2.5.1   控制系统的结构图
　　　系统的结构图是描述系统各组成元件之间信号传递关系的数学图形。在系统方块图中将方 框对应的元部件名称换成其相应的传递函数，并将环节的输入、输出量改用拉普拉斯变换表示 后，就转换成了相应的系统结构图。
　　结构图不仅能表明系统的组成和信号的传递方向，而且能清楚地表示系统信号传递过程中 的数学关系，它是一种图形化的系统数学模型，在控制理论中应用很广。
1. 结构图的组成和绘制
　　　控制系统的结构图是由许多对信号进行单向运算的方框和一些信号流向线组成，它包含四 种基本单元。
　　定义2.5.1 信号线：带有箭头的直线，箭头表示信号的流向，在直线旁标记信号的时间函 数或象函数，如图2.5.1(a) 所示。



　　定义2.5.2 引出点(或测量点):表示信号测量或引出的位置，从同一位置引出的信号在数 值和性质上完全相同，如图2.5.1(b) 所示。
　　定义2.5.3  比较点(或综合点):两个或两个以上的输入信号进行加减运算。“+”号表示 相加，“一”号表示相减。“+”号可省略不写，如图2.5.1(c)所示。
　　定义2.5.4  方框(或环节):表示输入到输出单向传输间的函数关系，方框中写入元部件或 系统的传递函数，如图2.5.1(d)所示。
　　　　　　
(a)                      (b)                               (c)                                   (d)
图2.5.1 结构图的基本组成
　　　绘制系统结构图时，首先考虑负载效应分别列写各元部件的微分方程或传递函数，并将它 们用方框表示；然后根据各元部件的信号流向，用信号线依次将各方框连接便得到系统的结构 图。从结构图上可以用方框进行数学运算，也可以直观了解各元件的相互关系及其在系统中所 起的作用。从系统结构图可以方便地求得系统的传递函数。所以系统结构图也是控制系统的一 种数学模型。
　　　需要指出的是，结构图中的方框与实际系统的元件并非是一一对应的。一个实际元件可以 用一个方框或几个方框表示；而一个方框也可以代表几个元件或是一个子系统，或是一个大的复 杂系统。
　　例2.5.1 图2.5.2中，u, 、u.分别是两级RC 电路的输入、输出电压，试建立相应的电路结 构图。
　　　　　　　　　　　　　　
图2.5.2 两级RC电路
　　　解 设中间变量流过电阻R?  的电流为I?,C?   两端的电压为U?, 流过电阻 R? 的电流为I?, 如图2.5.2所示。则根据克希荷夫定律，可写出以下方程，即
　　　　　　　　　　　　　　
根据各方程可绘出相应的子结构图，分别如图2.5.3(a)～(d)   所示，按信号的传递顺序，将



各子结构图依次连接起来，便得到两级RC 电路的结构图，如图2.5.3(e)所示。
　　　　　　　
(a)                           (b)                           (c)                      (d)

I?                     Ue s
一
一

(e)
图2.5.3 两级RC电路的结构图
2. 结构图的等效变换
　　　结构图是从具体系统中抽象出来的数学结构图形，当只讨论系统的输入、输出特性，而不考 虑它的具体结构时，完全可以对其进行必要的变换。当然，这种变换必须是“等效的”,即在变换 过程中应遵循变换前后变量关系保持等效的原则，具体而言，就是变换前后前向通路中传递函数 的乘积应保持不变，回路中传递函数的乘积应保持不变。
　　复杂系统结构图，其方框间的连接是错综复杂的，但方框间的基本连接方式只有串联、并联 和反馈连接三种。结构图简化的一般方法是移动引出点或比较点，交换比较点，然后进行方框运 算将串联、并联和反馈连接的方框合并。
1)串联方框的等效变换
　　定义2.5.5  传递函数分别为G? (s) 和G? (s) 的两个方框，若G? (s) 的输出量作为G? (s) 的输 入量，则G?(s) 与 G?(s) 称为串联连接。两个方框的串联如图2.5.4(a) 所示。
　　　　　　　
(a)                                                              (b)
图2.5.4  串联方框的等效变换
由图2.5.4(a) 可知
C(s)=G?(s)U(s)=G?(s)G?(s)R(s)
所以两个方框串联后的等效传递函数为
(2.5.1)
其等效结构图如图2.5.4(b)所示。
　　　上述结论可以推广到多个方框串联的情况，即方框串联后的总传递函数等于各个串联方框 传递函数的乘积。
2)并联方框的等效变换
　　　定义2.5.6    传递函数分别为G? (s) 和G? (s) 的两个方框，如果它们有相同的输入量，而输出 量等于两个方框输出量的代数和，则G? (s) 和G? (s) 称为并联连接。图2.5.5(a)表示两个方框并 联的结构。由图2.5.5(a),  有



C(s)=G?(s)R(s)±G?(s)R(s)=[G?(s)±G?(s)]R(s)
所以两个方框并联后的等效传递函数为
G(s)=G(s)±G?(s)
其等效结构图如图2.5.5(b)所示。
　　　　　　　　
(a)                                                  (b)
图2.5.5 并联环节的等效变换
　　　上述结论可以推广到多个方框并联的情况，即方框并联后的总传递函数等于各个并联方框 传递函数的代数和。
3)反馈连接的等效变换
　　定义2.5.7 传递函数分别为G(s) 和H(s) 的两个方框，如图2.5.6(a)所示形式的连接称 为反馈连接。“+”号为正反馈，表示输入信号与反馈信号相加，“+”号可以省略；“一”号表示相 减，为负反馈。由图2.5.6(a) 可知
　　　　　　C(s)=G(s)E(s)=G(s)[R(s)±B(s)]=G(s)[R(s)±H(s)C(s)] 可得
　　　　　　　　　　　　　　　
所以反馈连接后的等效(闭环)传递函数为




其等效结构图如图2.5.6(b) 所示。






(2.5.3)

　　　　　　　
(a)                                                               (b)
图2.5.6 反馈连接的等效变换
当反馈通道的传递函数H(s)=1     时，称系统为单位反馈系统，此时闭环传递函数为
(2.5.4)
4)比较点和引出点的移动
　　在结构图简化过程中，当系统中出现信号交叉时，需要移动比较点或引出点的位置，这时应   注意保持移动前后信号传递的等效性，且比较点和引出点之间一般不宜交换其位置。此外，“一 ” 号可在信号线上越过方框移动，但不能越过比较点和引出点。



表2.5.1汇集了结构图等效变换的基本规则，可供查阅。
表2.5.1结构图等效变换规则

变换方式	原结构图	等效结构图	等效运算关系

串联	　	R(s)
G? (S)G? (s)	C(s)
C(s)=G(s)G? (s)R(s)


并联	G? (s)	C? (s)
R(s)
G? (s)±G? (s)
C(S)

C(s)=[G? (s)±G? (s)]R(s)
	R(s)                     C(s)
G? (s)
C? (s)


反馈	R(s)     E(s)
±↑
B(s)	G(s)

H(s)		 C(s)
　　
　　

比较点 前移	　　	　　
C(s)=R(s)G(s)±Q(s)=
　　

比较点 后移	　　	　　
C(s)=[R(s)±Q(s)]G(s)= R(s)G(s)±Q(s)G(s)

引出点 前移	R(s)                C(s)
G(s)
	 C(s)	　　　
C(s)=G(s)R(s)

引出点 后移	R(s)                C(s)

	 R(s)	　　
C(s)=R(s)G(s)


比较点与
引出点之
间的移动
　　　　　　　C(s) R? (s)           C(s)
R? (s)	　　　


C(s)=R? (s)-R? (s)

例2.5.2  简化图2.5.7所示系统的结构图，求系统的闭环传递函数
解(1)将比较点a 后移，引出点b 前移，即将图2.5.7简化成图2.5.8(a) 所示结构。
　　　(2)对图2.5.8(a) 中 G? 和一1并联，与H?  串联后再与H?G?  并联，简化成图2.5.8(b) 所 示结构。




　　　　　　　
图2.5.7  例2.5.2的结构图
(3)对图2 . 5 . 8(b)   中的回路进行反馈及串联变换，简化成如图2.5.8(c)  所示形式。
　　　　　　　　　　
(a)
　　　　　　　　　
(b)
　　　　　　　　　　
(c)
图2 .5 .8  例2.5.2结构图的简化
( 4 ) 利 用 反 馈 变 换 可 得 系 统 的 闭 环 传 递 函 数 为
　　　　　　　　　　　　
2.5.2     控 制 系 统 的 信 号 流 图
　　　信号流图是表示线性代数方程组的示意图 ， 采用信号流图可以直接对代数方程组求解 。 在 控制工程中 ， 信号流图和结构图一样 ， 可用以表示系统的结构及变量传递过程中的数学关系 。 由 于它的符号简单、便于绘制，而且可以通过梅森公式(不必经过图形简化)直接求得系统的传递函



数，因此特别适合对于复杂结构系统的分析。
1. 信号流图的组成和绘制
组成信号流图中的基本图形符号有两种：节点和支路。
　　　定义2.5.8 节点代表系统中的一个变量(信号),用符号“O”  表示。节点具有叠加的作用， 节点表示的变量等于所有输入支路信号的叠加。
　　　定义2.5.9  支路是连接两个节点的有向线段，其中的箭头表示信号的传递方向。每条支 路都有一定的增益叫支路增益，标在有向线段上。支路增益定量描述信号从支路一端沿箭头方 向传送到另一端的函数关系，相当于结构图中方框的传递函数。若支路增益为正，“+”号常省 略，“一”号必须标出。
根据信号流图的组成，式(2.5.5)所示的方程组可表示为图2.5.9所示的信号流图。
X?(s)=aX?(s)+bX?(s)+cX?(s)
X?(s)=dX?(s)
X?(s)=eX?(s)+fX?(s)
X?(s)=gX?(s)+hX?(s)                                                            (2.5.5)
　　　　　　　　　
图2.5.9 式(2.5.5)对应的信号流图
在信号流图中，常使用如下名词术语：
　　　定义2.5.10  只有输出支路而无输入支路的节点称为源节点或输入节点，图2.5.9中的节 点 X? 为源节点。
定义2.5.11  只有输入支路而无输出支路的节点称为阱节点或输出节点。
　　　定义2.5.12  既有输入支路又有输出支路的节点称为混合节点，图2.5.9中的节点X? 、 X?、X?、X? 均为混合节点。若从混合节点引出一条具有单位增益的支路，可将混合节点变为阱 节点，如图2.5.9中用单位增益引出的节点X?。
　　　定义2.5.13 从源节点开始并且终止于阱节点，与其他节点相交不多于一次的通路称为前 向通路。前向通路上各支路增益的乘积称为前向通路增益，一般用P,  表示，下标k 表示第k 条
前向通路。图2.5.9中共有四条前向通路，其增益分别为P?=adfh,P?=eh,P?=adg,P?= ecdg。
　　　定义2.5.14 起点和终点是同一节点，并且与其他任何节点相交不多于一次的闭合路径称 为回路。回路中各支路增益的乘积，称为回路增益，一般用L   表示。图2.5.9中有两个回路，回 路增益分别为L?=b,L?=dfc。
　　　定义2.5.15  相互间没有任何共同节点的回路，称为不接触回路或互不接触回路。如图 2.5.10中某系统的信号流图，共有三个回路，增益分别为L?=ab,L?=cd,L?=ef,     其中回路L?    和L? 为不接触回路。
　　信号流图可以根据微分方程绘制，由组成系统的微分方程组绘制信号流图的过程与绘制结 构图的过程类似。也可以根据系统的结构图按照结构图与信号流图的对应关系绘制。




　　　　　　　　　　　　　　
图2.5.10 某系统的信号流图
　　例2.5.3 某随动系统的输入和输出分别为θr、θ,系统微分方程组如式(2.5.6)所示，绘制 系统的信号流图。
θ.(t)=θ,(t)-θ.(t)
e?(t)=k?θ.(t)-H?e?(t)
e?(t)=k?e?(t)―H?θ.(t)
　　　　　　　　　　　　　　　
                                    (2.5.6)
解  在零初始条件下对微分方程进行拉普拉斯变换，得
θ.(s)=θ,(s)―θ.(s)
E?(s)=k?θ.(s)―H?E?(s)
E?(s)=k?E?(s)―H?θ.(s)
sE?(s)+E?(s)=E?(s)
s2θ.(s)=E?(s)                                                                                (2.5.7)
根据拉普拉斯变换后的式(2.5.7),按信号的传递顺序，可得到随动系统的信号流图如图2.5.11所示。
　　　　　　　　　
图2.5.11 例2.5.3的信号流图
例2.5.4  绘制图2.5.7所示系统的结构图所对应的信号流图。
　　解  首先，在系统结构图的信号线上，用“O”标注各变量对应的节点；然后，将各节点按原结 构图的顺序从左向右排列，将结构图中的方框用具有相应增益的支路代替，连接有关的节点，就 可以得到系统的信号流图。信号流图如图2.5.12所示。
　　　　　　　　　
图2.5.12 例2.5.4的信号流图



2. 梅森增益公式
　　　对于一些结构复杂的系统，采用结构图等效简化的方法求系统的传递函数是较麻烦的。而 用梅森公式，则可以不作任何结构变换，只要通过对信号流图或结构图的观察和分析，就能直接 写出系统的传递函数。
定义2.5.16  计算任意输入节点和输出节点之间传递函数的梅森增益公式为
                            (2.5.8)
　LL 。-∑LaLL+…;∑La                          为所 有不同回路的回路增益之和；    为所有两两互不接触回路的回路增益乘积之和；
为所有互不接触回路中，每次取其中三个回路增益的乘积之和；n 为从输入节点到输
　出节点间前向通路的条数；P 为从输入节点到输出节点间第k 条前向通路的总增益；△为第k 条前向通路的余子式，即把特征式△中与该前向通路相接触回路的回路增益置为零后，所余下 的部分。
例2 .5 .5   试求图2.5. 13所示系统的传递函

-H?
图2.5.13 例2.5.5的图
解  本系统有三个回路，其回路增益分别为L?=-G?G?G?G?H?,L?=-G?G?H?                              和 L?=
―G?H? 。 其 中L?  和 L?  两回路互不接触，故特征式为
△=1-(L?+L?+L?)+(L?L?)=
1+G?G?G?G?H?+G?G?H?+G?H?+G?G?G?H?H?
　　　有三条前向通路，其增益分别为P?=G?G?G?G?,P?=G?G?G?,P?=G?G? 。        由于各回路均与 前向通路P? 、P? 接触，故余子式△?=△2=1。前向通路P?  与回路L?  不接触，所以余子式△?=1- (L?)=1+G?H? 。     用梅森公式得系统的传递函数为
　　　　　　　　
　　　　　　　　　　　
例2.5.6 已知系统结构图如图2.5.14所示，试求传递函
　　解  本系统有四个回路，其回路增益分别为L?=―H?H?,L?=―G?G?G?H?,L?=G?G?H?, L?=-G?H?;        有两组互不接触回路，即L?  和 L?,L?    和 L?。
有两条前向通路，其前向通路的传递函数和对应的余子式为
P?=G?G?G?,△?=1;P?=H?,△?=1-G?G?H?




　　　　　　　　　
图2.5.14 例2.5.6的结构图
所以，用梅森公式可写出系统的传递函数为
　　　
　　　　　　

2.5.3    闭 环 系 统 的 常 用 传 递 函 数
　　　前文所述的传递函数都是在输入信号作用下讨论的。实际的控制系统不仅会受到控制输入 信号的作用，还会受到干扰信号的作用。图2.5. 15所示是具有扰动作用的闭环系统，图中R(s)    表示控制输入信号，N(s)  表示干扰信号，C(s) 代表系统的输出，e(s)  代表偏差信号。若将R(s)   和 N(s)  分别看作系统的外作用，C(s)  和 ε(s) 看做系统的输出，则图2.5. 15的闭环系统就成为一个 双输入、双输出系统。当两个输入量同时作用于线性系统时，可以分别考虑各外作用的影响，然 后应用叠加原理，即可得到闭环系统的总输出响应。
　　　　　　　　　　　　
图2.5.15 典型反馈控制系统的结构图
1. 系统的开环传递函数
　　定义2 .5 . 17  在图2.5.15中，为分析系统方便起见，常常在 H(s) 的输出端“人为”地断开系 统的主反馈通路。将反馈断开时，前向通路传递函数与反馈通路传递函数的乘积称为系统的开环
传递函数。它等于将反馈断开时系统的反馈信号 B(s)  与输入信号R(s)  之比，即 G(s)G?(s)H(s)。 需要指出，这里的开环传递函数是针对闭环系统而言的，而不是指开环系统的传递函数。
2. 闭环系统的传递函数
1)控制输入作用下的闭环传递函数
　　　定义2 .5 . 18  当只研究系统控制输入作用时，令 N(s)=0,   可求出系统输出 C(s) 对 输 入 R(s)   的闭环传递函数为
(2.5.9)



2)扰动输入作用下的闭环传递函数
　　　定义2.5.19  当只研究系统在扰动输入作用时，令R(s)=0, 可求得输出对扰动作用的闭环 传递函数
(2.5.10)
3)控制输入和扰动同时作用下系统的总输出
　　根据线性系统的叠加原理，系统在多个输入作用下，其总输出等于各输入单独作用所引起的 输出分量的代数和，利用式(2.5.9)和式(2.5.10)可求得系统的总输出为
　　　　　　　　　　
3. 闭环系统的误差传递函数
1)控制输入作用下的误差传递函数
定义2.5.20 在 N(s)=0  的情况下，可求出系统的误差传递函数为
(2.5.11)
2)扰动输入作用下的误差传递函数
　　定义2.5.21 令 R(s)=0, 可求出误差对扰动作用的闭环传递函数，简称扰动误差传递函 数，即
(2.5.12)
3)控制输入和扰动同时作用下系统的总误差
　　　利用式(2.5.11)和式(2.5.12),可求出系统在控制输入和扰动输入同时作用下系统的总误 差为
　　　　　　　　　　
不难发现，四种闭环传递函数Φ(s) 、Φcn(s) 、Φ,(s)   和Φen(s)  具有相同的分母，即
1+G?(s)G?(s)H(s)
通常，把这个分母多项式称为闭环系统的特征多项式。1+G?(s)G?(s)H(      s)=0 称为闭环系统的 特征方程，特征方程的根称为闭环系统的根或极点。
2.6   控制系统建模的应用研究

2.6.1   数学模型的实验测定
　　　由于许多工业对象的结构和内部工艺过程复杂，使得通过解析法分析组成控制系统的各部 分的物理、化学过程，确定系统的微分方程十分困难。另外，在用分析法建立系统模型时，常需要 进行一定的假设和近似，因此，对于复杂的系统，即使在已经用分析法得到数学模型的情况下，仍 需要通过实验测定法加以验证。这种采用实验测定系统或元件的数学模型的方法在工程实践中 应用较广。



1. 数学模型实验测定的主要方法
　　被测系统或对象的动态特性只有当它们处于变动状态下才会表现出来，在稳定状态下是无 法体现的。因此，为了获得动态特性，必须使被研究的过程处于被激励的状态。根据加入的激励 信号和结果的分析方法不同，测试动态特性的实验方法也不相同，主要有以下几种：
　　定义2.6.1  时域测定法的主要过程是被测系统或对象在输入端施加阶跃或脉冲扰动信 号，测量输出量的时间响应曲线，再对响应曲线进行分析，确定被研究对象的传递函数。时域测 定法采用的测试设备简单，测试工作量小，应用广泛，但其测试精度不高。
　　定义2.6.2 频域测定法的主要过程是对被研究对象施加不同频率的正弦波，测出输入信 号与输出信号之间的幅值比和相位差，从而获得被测系统或对象的频率特性。这种方法在原理 和数据处理方面都比较简单，测试精度比时域法高，但需要采用专门的超低频测试设备，测试工 作量较大。
　　定义2 .6.3  统计相关法的主要过程是对被研究对象施加某种随机信号，根据被测对象各 参数的变化，采用统计相关法确定被测系统或对象的动态特性。这种方法可以在被测系统或生 产过程正常运行状态下进行在线辨识，测试结果精度较高，但要求采集大量测试数据，并需要相 关仪和计算机进行数据计算和处理。
2. 测定实验的注意事项
　　在现场进行动态特性的测试，存在许多实际困难，使实验结果不够准确。例如，运行中随机 扰动因素较多，在分析实验数据时，难于分辨其他扰动因素对被控参数的影响；对于非电量的输 入测试信号，很难产生理想的阶跃扰动或理想的矩形脉冲扰动。因此，为了使实验结果尽量准 确，实验时应注意以下问题：
　　　(1)施加扰动前，应将被测对象调整到所需工况，并保持相当长时间的稳定运行，使被控参 数和负荷稳定在所选择的数值上。
　　　(2)扰动测试信号的幅值应足够大，以减少随机扰动对测量误差的相对影响；但扰动量又不 能过大，否则，被控对象的非线性因素影响增大，有时还会影响到被测对象正常运行。通常，扰动 量取为系统输出额定值的8%～10%。
　　　(3)实验应进行到被控参数接近其稳态值，或至少进行到被控参数的变化速度达到最大值 之后。
(4)测试应在主要运行工况下重复进行几次，以消除偶然因素的影响。
(5)应进行正反向的实验，以检验被测对象的非线性特性。
　　　(6)实验时，应特别注意起始状态的测量精度和阶跃测试信号的计时起点，这对于计算被测 对象的延迟大小和传递函数确定的准确性有关。
2.6.2         利 用 MATLAB   进行系统建模
　　　在控制系统的分析和设计中，首先要建立系统的数学模型。在MATLAB  中，常用的系统建模方 法有传递函数模型、零极点模型以及状态空间模型等。下面结合图2.6.1,介绍这些建模方法。
1. 控制系统模型描述
1)系统传递函数模型描述
命令格式：sys             =tf(num,den,Ts)
　　　其中num 、den分别为分子分母多项式降幂排列的系数向量；Ts 表示采样时间，默认时描述 的是连续传递函数。图2.6.1中的G? (s) 可描述为G1=tf([1],[110])。




　　　　　　　
图2.6.1 某系统的结构图
　　　若传递函数的分子分母为因式连乘形式，如图2.6.1中G?(s)  所示，则可以考虑采用conv 命 令进行多项式相乘，得到展开后的分子分母多项式降幂排列的系数向量，再用 tf 命令建模。如 G?(s) 可描述为num=1;den=conv([0.11],[13]);G2=tf(num,den)。
2)系统零极点模型描述
命令格式：sys               =zpk(z,p,k,Ts)
　　其中z、p、k分别表示系统的零点、极点及增益，若无零、极点，则用[]表示；Ts  表示采样时 间，默认时描述的是连续系统。图2.6.1中的G?(s) 可描述为G3=zpk([-2],[0-1],1)。
3)传递函数的部分分式展开
命令格式：[r,p,k]=residue(num,den)
　　　其中r、p、k分别表示部分分式展开的系数、极点和常数项。图2.6.1中G?(s)  的部分分式展 开描述为num=[12];den=[110];[r,p,k]=residue(num,den),                       运行结果为r=[―1;2];p=
[-1;0];k=[] 。    读者可验证其结果。
2. 系统模型的转换
　　　由于在控制系统分析与设计中有时会要求模型有特定的描述形式，MATLAB  提供了传递 函数模型与零极点模型之间的转换命令。
命令格式：[num,den]=zp2tf(z,p,k)
[z,p,k]=tf2zp(num,den)
　　其中zp2tf 可以将零极点模型转换成传递函数模型，而tf2zp 可以将传递函数模型转换成零 极点模型。图2.6.1中的G?(s)  转换成零极点模型为[z,p,k]=tf2zp([1],[110]),G?(s)                     转
换成传递函数模型为[num,den]=zp2tf([-2],[0-1],1)。
3. 系统连接
　　　一个控制系统通常由多个子系统相互连接而成，而最基本的3种连接方式为图2.6.1中所 示的串联、并联和反馈连接形式。
1)两个系统的并联连接
命令格式：sys =parallel(sysl,sys2)
　　对于SISO 系统，parallel 命令相当于符号“+”。对于图2.6.1中由G?(s) 和 G?(s)  并联组成 的子系统G??(s),   可描述为G12=parallel(G1,G2)。
2)两个系统的串联连接
命令格式：sys          =series(sysl,sys2)
　　对于SISO 系统，series 命令相当于符号“*”。对于图2.6.1中由G??(s)  和 G?(s)  串联组成 的开环传递函数，可描述为G=series(G12,G3)。
3)两个系统的反馈连接
命令格式：sys           =feedback(sysl,sys2,sign)



其 中 sign   用于说明反馈性质(正、负)。 sign   默认时为负，即 sign=-1 。    由 于 图 2 . 6 . 1 系 统
为单位负反馈系统，所以系统的闭环传递函数可描述为 sys=feedback(G,1,-1) 。          其 中G  表 示开环传递函数，“1”表示单位反馈，“一1”表示负反馈，可默认。
4. 结构图的等效变换
　　　例2 . 6 . 1  已知多回路反馈系统的结构图如图2.6.2所示，求闭环系统的传递函 其 中 ， ,H?(s)=2,H?(s)=1。
　　　　　　　　
图2.6.2  多回路反馈系统
解  MATLAB     程 序 如 下 ：


G1=tf([1],[110]);
G2=tf([1],[11]);
G3=tf([101],[144]);
numg4=[11];deng4=[16];G4=tf(numg4,deng4); H1=zpk([-1],[-2],1);
numh2=[2];denh2=[1];H3=1;
nh2=conv(numh2,deng4);dh2=conv(denh2,numg4); H2=tf(nh2,dh2);
sysl=series(G3,G4);
sys2=feedback(sysl,H1,+1);
sys3=series(G2,sys2);
sys4=feedback(sys3,H2);
sys5=series(G1,sys4);   sys=feedback(sys5,H3)







%建立各个方块子系统模型

% 先 将 H?  移至G?  之后

%计算由G?、G4 和 H?  回路组成的子系统模型

%计算由H?  构成反馈回路的子系统模型

%计算由H? 构成反馈主回路的系统闭环传递函数

在 MATLAB  中运行M 文件examplel  后，求得系统的闭环传递函数为
Zero/pole/gain:
0.083333(s+1)-2(s+2)(s^2+1)

　　　　　　　　(s+10.12)(s+2.44)(s+2.349)(s+1)(s^2+1.176s+1.023) 式中：“~”表示乘方运算。
2.7     控制系统建模的设计实例

例2 . 7 . 1  电力牵引电机控制系统建模。
大部分现代列车和调度机车都采用电力牵引电机。牵引电机牵引轨道车辆系统的原理如图



2.7.1(a)    所示，其中电枢控制电机采用大功率直流电机，其参数为Km=10,Ra=1,La=1,J=2,
b=0.5,K?=0.1;         功率放大器采用差分放大器，系统具体结构如图2.7.1(b)  所示。要求适当选
择差分放大器的电阻R? 、R? 、R? 、R?,建立控制系统的数学模型，计算系统的传递函,并 给出系统单位阶跃响应曲线。
　　　　　　　
(a)
　　　　　　
图2.7.1  电力牵引电机速度控制系统原理图
解  首先给出图中各部分的传递函数。对于差分放大器，有
　　　　　　　　　　　　　　　　
　　　通常，希望输入控制电压在数值上与预期速度相等，即vin=wa(t),    如 当vn=10V    时，车辆的 稳态速度为w=10rad/s 。  注意到车辆在稳定运行时将有 v.=Kwa,    则
　　　　　　　　　　　　　　　
而车辆稳定运行时有 v?=0, 取
　　　　　　　　　　　　　　　　
若取K,=0.1,     可 得R?/R?=10,R?/R?=10。
　　功率放大器是非线性的，可近似表示为指数函数v?=2e34,     其正常工作点为v10=1.5V,     利 用小偏差法线性化，得

以小增量为新变量，略去“△”符号，并进行拉普拉斯变换得到线性模型为V?(s)=540V?(s) 。    将 电机各参数代入图2.7. 1(b),   可得系统结构图，如图2.7.2所示。
对于图2.7.2所示结构图，可用如下MATLAB   程序对结构图进行简化，求其传递函数：
numl=[10];den1=[11];num2=[1];den2=[20.5];
num3=[540];den3=[1];num4=[0.1];den4=[1];
[na,da]=series(numl,den1,num2,den2);
[nb,db]=feedback(na,da,num4,den4,   一1);
[nc,dc]=series(num3,den3,nb,db);




　　　　　　　
图2.7.2  电力牵引电机速度控制系统结构图
[num,den]=cloop(nc,dc,-1);
printsys(num,den)
运行上述程序得到
num/den=
5400

2         s^2+2.5s+5401.5
　　　也可用梅森增益公式求得传递函,将图中所 示G?(s),G?(s)     代入，并化简得
　　　　
与 MATLAB   所得结果一致。
　　　电力牵引电机控制系统的单位阶跃响应 MATLAB  程序如下：
num=[5400];den=[22.55402];
t=[0:0.0  05:3];%                               s
　　[y,x,t]=step(num,den,t);%        得到3s 内的单 位阶跃响应数据
plot(t,y),grid %绘制仿真曲线
xlabel(‘时间(s)’)%   横坐标说明
ylabel(‘车轮速度’)%纵坐标说明
运行结果如图2.7.3所示。

本  章

　　　本章首先采用微分方程来构建系统模型；对非线性控制系统，采用工作点处的泰勒级数展 开，得到“小偏差”线性近似。使用拉普拉斯变换以及传递函数等数学工具和方法，对线性系统进  行建模分析。根据传递函数的零一极点分布来判定系统对各种输入的响应特性；随后又研究了 复域数学模型结构图和信号流图，详细介绍了梅森增益公式的表达式。梅森增益公式在研究复杂 反馈系统各变量之间的关系时是非常有效的，它不需要对流图进行各种化简或变换就能求得各变 量之间的关系式；最后还讨论了系统数学模型的实验测定方法和数学模型计算机仿真问题，利用仿 真方法可以在不同的环境、不同的系统参数和初始条件下，研究系统的时间响应及其变化情况， 并以电力牵引电机控制系统为例，综合本章各部分内容建立了该系统的传递函数模型。




课后练习题
2-1   设机械系统如图所示，其中x?  是输入位移，x。是输出位移。试分别写出各系统的微分方程。
　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                           (b)                             (c) 2―1题图 机械系统
2-2   试证明图示电网络与机械系统有相同的数学模型。
　　　　　　　　
(a)                                                        (b) 2―2题图 电网络与机械系统
2-3       在液压系统管道中，设通过阀门的流量Q 满足如下流量方程，即
Q=K√P
式中：K 为比例系数；P 为阀门前后的压差。若流量Q 与压差P  在其平衡点(Qo,P?)    附近作微 小变化，试导出线性化流量方程。
2-4   设弹簧特性由下式描述，即
F=12.65y1.1
　式中：F 是弹簧力；y 是变形位移。若弹簧在变形位移0.25附近作微小变化，试推导△F  的线性 化方程。
2-5   设初始条件为零，试用拉普拉斯变换法求解下列微分方程式，并概略绘制x(t)    曲线，指出 各方程式的模态。
(1)2x(t)+x(t)=t。
(2)x(t)+x(t)+x(t)=δ(t)。
(3)x(t)+2x(t)+x(t)=1(t)。



2―6    设系统的传递函数为
　　　　　　　　　　　　　　　　　
且 初 始 条 件c(0)=-1,c(0)=0 。         试 求 单 位 阶 跃 输 入r(t)=1(t)          时，系统的输出响应c(t)。
2-7          求图示有源网络的传递函数U。(s)/U(s)。
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                                             (b)                                                                  (c)
2 ― 7题图 有源网络
2-8     某系统由下列微分方程组描述：
x?(t)=k?r(t)             一 x?(t)
x?(t)=x?(t)+x?(t)
x?(t)=x?(t)+k?r(t)―c(t)
x?(t)=k?x?(t)―c(t)
c(t)=x?(t)
式 中 ：k? 、k? 、k? 均 为 常 量 ；r(t)     为 输 入 ；c(t)      为输出。画出系统的结构图，并求传递函数C(s)/R(s)。 2―9    已知控制系统结构图如图所示，试通过结构图等效变换求系统传递函数C(s)/R(s)。


　　　　　　
(a)
G?(s)
G?(s)





(b)


G?(s) H?(s)

H?(s)
(c)
　　　　　　　　　　
(d)
2 - 9 题 图



2-10      试 绘 制 图 中 结 构 图 对 应 的 信 号 流 图 ， 并 用 梅 森 增 益 公 式 求 每 一 个 外 作 用 对 每 一 个 输 出 的 传 递 函 数 。
　　　　　　　　　　
(a)
　　　　　　　　　
(b)
2 - 1 0 题 图
2-11      试 用 梅 森 增 益 公 式 求 图 所 示 系 统 的 传 递 函 数C(s)/R(s)           和 E(s)/R(s)。
　　　　　　　　　
(a)

　　　　　　　　　　　　
(b)
2 ― 1 1 题 图
2-12      试 用 梅 森 增 益 公 式 求 题 2 - 9 所 示 系 统 的 传 递 函 数 。
2―13     试 用 梅 森 增 益 公 式 求 图 中 各 系 统 信 号 流 图 的 传 递 函 数C(s)/R(s)。






(a)
(b)






C(s)


(c)




(d)





R?(s)Q



(e)                                                                                             (f)

2 - 1 3 题 图






第3章 线性系统的时域分析法

本 章 提 要

　　　本章主要讲述物理系统如何在时间域内进行分析和设计。系统的动态和稳态性能指标是评 判系统设计好坏的标准。首先给出控制系统稳定性的定义，并讨论如何利用劳斯稳定判据进行 判稳；其次对典型控制系统的时域性能指标进行定性和定量描述，分析典型一阶系统、二阶系统 动态时域性能指标的近似计算方法，介绍一般控制系统的稳态精度的计算方法和补偿方法以及 常用的时域校正方法等；最后以某型飞机俯仰通道控制系统为例详细介绍典型时域分析的操作 步 骤 。

3.1  引   言

　　　由第2章的知识可以将一个物理系统抽象化，建立描述其内部物理量(或变量)之间关系的 微分方程、传递函数或结构图，这就为对系统性能进行理论分析和控制系统设计提供了前提。在 此基础上，经典控制常用时域分析法、根轨迹法或频域分析法来分析线性控制系统的性能。显 然，不同的分析方法有不同的特点和适用范围，并且相互之间相辅相成，是构成经典控制理论不 可或缺的组成部分。
　　　由于多数控制系统是以时间作为独立变量的，所以人们往往关心该系统的状态和输出对时  间的响应。对系统施加一给定输入信号，通过研究系统的时间响应来评价系统的性能，这就是控  制系统的时域分析法。它根据描述系统的微分方程或传递函数，直接求解出在某种典型输入作  用下系统输出随时间t 变化的表达式或其他相应的描述曲线来分析系统的稳定性、动态特性和  稳态特性。时域分析法是一种直接在时间域中对系统进行分析的方法，具有直观、准确的优点， 并且可以提供系统时间响应的全部信息。随着计算机和相应仿真软件(如MATLAB)  的发展， 时域分析已成为控制系统设计和仿真验证必不可少的环节。
3.2  线性系统的时域性能指标

　　　为求解系统的时间响应，必须了解输入信号的解析表达式。然而，在大多数情况下，控制系 统的输入信号具有随机性，以无法预测的方式变化。为便于进行分析和设计，以及对各种系统性 能进行比较，需要选择若干典型输入信号。这些信号是根据系统常遇到的输入信号形式，在数学 描述上加以理想化的一些基本输入函数，目的是便于数学分析和实验研究。
3.2.1  典型输入信号
　　　定义3.2.1 为了便于进行分析和设计，同时也为了便于对各种控制系统的性能进行比较， 需要假定一些基本的输入函数形式，称为典型输入信号。典型输入信号，是指根据系统常遇到的



复杂的实际输入信号的近似和抽象，并在数学描述上加以理想化的一些基本输入函数。选择典 型输入信号，有如下优点：
(1)数学处理简单，在给定典型信号作用下，易确定系统的性能指标，便于系统分析和设计。
(2)在典型信号作用下的瞬态响应，往往可以作为分析系统在复杂信号作用下的依据。
(3)便于进行系统辨识，确定未知环节的参数和传递函数。
　　　控制系统中常用的典型输入信号有单位阶跃函数、单位斜坡(速度)函数、单位加速度(抛物 线)函数、单位脉冲函数和正弦函数，如表3.2.1所列。这些函数都是简单的时间函数，便于数学 分析和实验研究。
表3.2. 1 典型输入信号

名称	时域表达式	复域表达式	函数图像

单位脉冲函数
　　

1	　　　　


单位阶跃函数
　　　　　
　　　	　　　　


单位斜坡函数
　　　　　
　　　	　　　　


单位加速度函数
　　　
　　　	　　　　


正弦函数
　　　

　　	　　　　
　　　实际应用时究竟采用哪一种典型输入信号，取决于系统常见的工作状态；同时，在所有可能  的输入信号中，往往选取最不利的信号作为系统的典型输入信号，这种处理方法在许多场合是可  行的。例如，室温调节系统、水位调节系统以及工作状态突然改变或突然受到恒定输入作用的控 制系统，都可以采用阶跃函数作为典型输入信号；跟踪通信卫星的天线控制系统，以及输入信号  随时间逐渐变化的控制系统，斜坡函数是比较合适的典型输入；加速度函数可用来作为宇宙飞船  控制系统的典型输入；当控制系统的输入信号是冲击输入量时，采用脉冲函数最为合适；当系统  的输入作用具有周期性的变化时，可选择正弦函数作为典型输入。同一系统中，不同形式的输入  信号所对应的输出响应是不同的，但对于线性控制系统来说，它们所表征的系统性能是一致的。



通常，以单位阶跃函数作为典型输入作用，则可在一个统一的基础上对各种控制系统的特性进行 比较和研究 。
3.2.2     动态性能与稳态性能
　　　控制系统在输入信号的作用下，其输出量中包含瞬态分量和稳态分量两个分量。对于稳定 的系统，瞬态分量随时间的推移而逐渐消失，稳态分量则从输入信号加入的瞬时起就始终存在。
1. 动态过程与动态性能指标
　　　定义3.2.2    动态过程又称过渡过程或瞬态过程，是指系统在典型输入信号作用下，系统输 出量从初始状态到最终状态的响应过程。由于实际控制系统具有惯性、摩擦以及其他一些原因， 系统输出量不可能完全复现输入量的变化。根据系统结构和参数选择情况，动态过程表现为衰 减、发散或等幅振荡形式。
　　　显然，一个可以实际运行的控制系统，其动态过程必须是衰减的，换句话说，系统必须是稳定 的。动态过程除提供系统稳定性的信息外，还可以提供响应速度及阻尼情况等动态性能。
　　　通常，在阶跃函数作用下，测定或计算系统的动态性能。一般认为，阶跃输入对系统来说是 最严峻的工作状态。如果系统在阶跃函数作用下的动态性能满足要求，那么,系统在其他形式的 函数作用下，其动态性能也是令人满意的。
　　　定义3.2.3      描述稳定的系统在单位阶跃函数作用下，动态过程随时间t  的变化状况的指 标，称为动态性能指标。
　　　为了便于分析和比较，假定系统在单位阶跃输入信号作用前处于静止状态，而且输出量及其 各阶导数均等于零。对于大多数控制系统来说，这种假设是符合实际情况的。典型控制系统的 单位阶跃响应如图3.2.1所示，其动态性能指标通常如下：
　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                                                      (b)
图3 .2 . 1 典型控制系统的单位阶跃响应
定义3.2.4 响应曲线第一次达到其终值一半所需的时间称为延迟时间，用ta 来表示。
　　　定义3.2.5  对于振荡的系统，响应曲线从零第一次上升到终值所需的时间称为上升时间， 用 t, 来表示。而对于非振荡衰减系统，由于按上述定义的上升时间趋向无穷，因此将响应曲线  从终值的10%上升到终值的90%所需的时间定义为上升时间，如图3.2.1(b)所示。上升时间  是系统响应速度的 一 种度量，上升时间越短，响应速度越快。
定义3.2.6    响应曲线超过其终值到达第一个峰值所需的时间称为峰值时间，用tp 来表示。



　　定义3.2.7    响应曲线到达并保持在终值±5%(或±2%)误差带之内所需的最短时间称为 调节时间，用t,  来表示。
　　定义3.2.8      响应曲线与其初始状态的最大偏离量h(tp)与终值h(∞)的差与终值     比 的百分数称为超调量g%,  即
(3.2.1)
若h(tp)<h(∞), 则响应无超调。
　　　上述五个动态性能指标，基本上可以体现系统动态过程的特征。在实际应用中，常用的动态 性能指标多为上升时间t,、调节时间t,和超调量σ%。通常，用t,或tp 评价系统的动态响应的快 速性；用σ%评价系统的阻尼特性，即动态响应的平稳性；而t, 可同时反映系统的动态响应速度 和阻尼特性。在时域分析中，除了简单的一阶、二阶系统外，要精确确定这些动态性能指标的解 析表达式是很困难的，需借助控制系统仿真分析软件来确定各动态性能指标的精确数值。
2. 稳态过程与稳态性能指标
　　定义3.2.9      稳态过程指系统在典型输入信号作用下，当时间t趋于无穷时，系统输出量的 表现方式。稳态过程又称稳态响应，表征系统输出量最终复现输入量的程度，提供系统有关稳态 误差的信息。
　　定义3.2.10 稳态误差是描述系统稳态性能的一种性能指标，通常在阶跃函数、斜坡函数或 加速度函数作用下进行测定或计算。若时间趋于无穷时，系统的输出量不等于输入量或输入量的 确定函数，则系统存在稳态误差。稳态误差是系统控制精度(准确性)或抗扰动能力的一种度量。
3. 基于传递函数的时域响应求解
1)零初始状态响应
　　若已知系统的传递函数为G(s),系统的输入为r(t),如果系统的初始状态为零，可按下列步 骤求解输出时间响应：
(1)取输入r(t)  的拉普拉斯变换，得R(s)=L[r(t)]。
(2)根据传递函数定义有C(s)=R(s)G(s)。
(3)对C(s) 进行部分分式展开，取C(s) 的拉普拉斯反变换，得c(t)=L-1[R(s)G(s)]。
2)非零初始状态响应
按以上步骤求得的输出响应是系统的零状态响应。如要考虑非零初始状态下的响应(即全
响应),可按下列步骤进行：
(1)将传递函数变换成相应的高阶微分方程。
(2)取高阶微分方程的拉普拉斯变换，并考虑初始条件不为零。
(3)从由变换得到的关于s 的代数方程，求解输出响应的拉普拉斯变换C(s)。
(4)对C(s) 进行部分分式展开，然后取拉普拉斯反变换，最后得到c(t)。 例3 .2.1  已知系统传递函数为
(3.2.2)
输入为单位阶跃函数，初始条件分别为
(1)c(O)=c(O)=0
　　　(2)c(0)=-1,c(O)=2 求系统的输出响应。



解  首先考虑第一种情况，c(0)=c(0)=0,        初始条件为零可直接利用传递函数求解。
由于r(t)=1(t),      因 此 ,而
　　　　　　　　　　　　　　
对 C(s) 进行部分分式分解，得
　　　　　　　　　　　　　　　
取拉普拉斯反变换，得
c(t)=2-2.5e1+0.5e?3                     (t≥0)
第二种情况下系统初始条件不为零，先将G(s)变换为微分方程，由 (s2+4s+3)C(s)=(s+6)R(s)
得
c(t)+4c(t)+3c(t)=r(t)+6r(t)
取其拉普拉斯变换，得
s2C(s)―sc(0)―c(0)+4sC(s)―4c(0)+3C(s)=sR(s)+6R(s)
代入初始条件c(0)=-1,c(0)=2,           得




取拉普拉斯反变换，得





c(t)=2―3e'            t≥0


3.3    线性系统的稳定性分析

　　稳定是控制系统的重要性能，也是系统能够正常运行的首要条件。控制系统在实际运行过程 中，总会受到外界和内部一些因素的扰动，如负载和能源的波动、系统参数的变化、环境条件的改变 等。如果系统不稳定，就会在任何微小的扰动作用下偏离原来的平衡状态，并随时间的推移而发 散。因而，如何分析系统的稳定性并提出保证系统稳定的措施，是自动控制理论的基本任务之一。
3.3.1   稳定性的基本概念
　　概念3.3.1  一个控制系统在实际应用中，当受到扰动作用时，就会偏离原来的平衡工作状 态，产生初始偏差。
　　　概念3.3.2 所谓平衡状态是指物体或系统所处的一种状态，处于平衡状态的物体或系统， 除非受到外界的影响，它本身不能有任何自发的变化。而所谓稳定性是指原来处于平衡状态的 系统在扰动作用消失后，经过一段过渡过程后能否恢复到原来的平衡状态或足够准确地恢复到  原来的平衡状态的性能。若扰动消失之后，不能恢复到原平衡状态，而且偏差越来越大的，系统  就是不稳定的。
　　　可以通过图3.3.1来直观的描述稳定的概念。图3.3.1中小球均处于一种平衡状态，此时， 若小球受到外界扰动的作用，分别运动到图中虚线小球位置，当外力去掉后，在自身重力和惯性



　的作用下，图3.3.1(a)中的小球经过几次反复振荡后，会回到原来的平衡位置，我们说这种小球 的运动是稳定的。而图3.3.1(b)中的小球在外力去掉后，无论经过多长时间都不会回到原来的 平衡位置，显然这种小球的运动是不稳定的。
　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                 (b)
图3.3.1 稳定性定义示意图
(a) 稳定；(b) 不稳定。
　　　定义3.3.1 若系统在初始偏差作用下，其过渡过程随着时间的推移，逐渐衰减并趋向于 零，具有恢复到原平衡状态的性能，则称该系统为渐近稳定，简称稳定。若干扰消失后系统不能 恢复到原来的平衡状态，偏差越来越大，则系统是不稳定的。
　　概念3 .3.3  由于线性系统的稳定性是扰动消失之后系统自身的一种恢复平衡状态的能 力，是系统的固有特性，所以线性系统的稳定性只取决于系统本身的结构参数，而与外作用及初 始条件无关。
3.3.2   线性系统稳定的充分必要条件
　　　设某线性系统传递函数为,在单位阶跃信号 作用下，其输出 C(s) 为
　　　　　　　　　　            (3.3.1) 其时域响应c(t)  为
　　　　　　　　　　　     t≥0                                          (3.3.2) 由此可见，线性系统的时域响应可分为两部分：稳态分量和暂态分量。其中稳态分量和输入
　有关，而暂态分量与系统的结构、参数和初始条件有关，是系统齐次方程的解，由系统特征方程决 定，即线性系统的稳定性仅取决于系统自身的固有特性，而与外界条件无关。
　　　一般来说，线性系统的稳定性表现为其时域响应暂态分量的收敛性。如果线性系统的时域 响应暂态分量是收敛的，则此系统就被认为是稳定的。线性系统时域响应暂态分量可由其理想 单位脉冲响应来表示。
　　　设线性系统在初始条件为零时，在理想单位脉冲δ(t) 作用下的系统输出增量为脉冲响应 c(t)。即在扰动信号作用下，输出信号偏离原平衡工作点的增量。若t→ ∞时，脉冲响应为
　　　　　　　　　　　　　　　　　　　
即输出增量收敛于原平衡工作点，则线性系统是稳定的。设闭环传递函数如式(3.3.3)所示，且 设 s;(i=1,2,3,…,n)        为特征方程D(s)=0    的根，而且彼此不等。那么,由于δ(t) 的拉普拉斯变 换为1,所以系统输出增量的拉普拉斯变换为




　　　　　　　　　　　　　
对式(3.3.3)进行拉普拉斯反变换可得
　　　　　　　　　　　　　　　　
若 s; 为实数，则成立的充要条件是s;<0,   如图3.3.2所示。



(3.3.3)


(3.3.4)






(a)                              (b)                                (c)

　　　　　　　　　　
(d)                               (e)                             (f)
图3.3.2 特征根为实根情况下的稳定性
(a) 负实根；(b) 零根；(c) 正实根；(d) 稳定(指数衰减);(e) 临界稳定；(f) 不稳定(指数发散)。
若 s;为复数，则令s;,;=σ±jw,相应项可写成(Aee+A;eeu)。         由于 |e±id |=1, |A; |和
|A;|  为常数，因此，成立的充要条件是σ<0,如图3.3.3所示。


j
σ=0


　0 *
(a)                              (b)



j
σ>0 ×

0


(c)








(d)
图3.3.3 特征根为共轭复根情况下的稳定性
(a) 负 实 部 根 ；(b) 纯虚根；(c) 正 实 部 根 ；(d) 稳 定 ( 衰 减 振 荡 ) ;(e) 临 界 稳 定 ( 等 幅 振 荡 ) ;(f) 不 稳 定 ( 发 散 振 荡 ) 。



　　定理3.3.1  线性系统稳定的充分必要条件是：闭环系统特征方程的所有根均具有负实部； 或者说，闭环传递函数的极点均位于s 左半平面。这一结论对于D(s)=0    具有重根的情况也成  立。显然，线性系统的稳定性与闭环传递函数的零点无关。
　　若有一个闭环传递函数的极点落在s 右半平面，则线性系统不稳定。若闭环传递函数的极 点落在虚轴上，此时为临界稳定。
　　应该指出，由于所研究的系统实质上都是线性化的系统，在建立系统线性化模型的过程中略 去了许多次要因素，同时系统的参数又处于不断地微小变化之中，所以临界稳定现象实际上是观 察不到的。对于稳定的线性系统而言，当输入信号为有界函数时，由于响应过程中的动态分量随 时间推移最终衰减至零，故系统输出必为有界函数；对于不稳定的线性系统而言，在有界输入信 号作用下，系统的输出信号将随时间的推移而发散，但也不意味会无限增大，实际控制系统的输 出量只能增大到一定的程度，此后，或者受到机械制动装置的限制，或者使系统遭到破坏，或者其 运动形态进入非线性工作状态，产生大幅度的等幅振荡。
一般情况下，确定系统稳定性的方法如下：
　　(1)直接对线性系统特征方程求解。根据稳定的充分必要条件判别线性系统的稳定性，需 要求出系统的全部特征根。对于高阶系统，求根的工作量很大，因此，希望使用一种间接判断线 性系统特征根是否全部严格位于s 左半平面的代替方法。
　　(2)劳斯稳定判据。劳斯于1877年提出了判断线性系统稳定性的代数判据，称为劳斯稳定 判据。这种判据以线性系统特征方程的系数为依据，是一种通过判断线性系统特征根所在区域 的间接判稳方法。
　　(3)根轨迹法。根轨迹是一种图解方法，使用十分方便。它是一种根据线性系统开环传递 函数零点和极点确定闭环传递函数极点(即线性系统特征根)的方法，由此可以判断线性系统的 稳定性。具体内容在第4章进行介绍。
　　(4)奈奎斯特稳定判据。奈奎斯特稳定判据是根据线性系统开环传递函数的频域特性，即 奈奎斯特图(或伯德图)进行稳定性判断的方法，也是一种图解方法。具体内容在第5章进行 介绍。
3.3.3  劳斯稳定判据
　　本小节主要介绍与劳斯判据有关的结论及其在判别控制系统稳定性方面的应用。有关劳斯 判据自身的数学论证，从略。
设线性系统的特征方程为
D(s)=aos”+a?s"1+…+an-1s+an=0                          ao>0                            (3.3.5)
式中：ao,a?,…,an     均为实数。
　　定理3.3.2  线性系统稳定的必要条件为：特征方程的各项系数均为正，且不缺项。若不满 足上述条件，系统一定不稳定，但上述条件对于高于二阶的系统并不充分，即高阶系统虽满足必 要条件，但很可能有正实部根存在，系统未必稳定。
　　如某系统的特征方程为s3+3s2+2s+24=0,          显然其满足稳定的必要条件，但是该系统存在 一对正实部的共轭复根s1,2=0.5±j√23/2         和一个负实根s?=-4,      系统不稳定。所以要判断高 于二阶系统的稳定性还需要研究其充分必要条件，这就是劳斯稳定判据。
劳斯稳定判据为表格形式，如表3.3.1所列，称为劳斯表。劳斯表的前两行由系统特征方程



式(3.3.5)的系数直接构成。劳斯表中的第1行(s”),  由特征方程的第1、3、5、…项系数组成；第 2 行(s”一1),由第2、4、6…项系数组成。劳斯表中以后各行的数值，需按表3.3.1所列逐行计 算，凡在运算过程中出现的空位，均置以零，这种过程一直进行到第 n 行为止，第n+1  行仅第一 列有值，且正好等于特征方程最后一项系数an 。表中系数排列呈上三角形。
表3.3.1 劳斯表

s”	ao	a2	a4	a6	…
s”-1	a1	a3	a5	a7	…
s?-2		　　　	　　　	C43	…
s”-3	　　　	　　　	　　　	C44	…
…	:	:



**
s2	C1,n-1	C2,n-1
s1	C1,n
s0	C1,n+1=an
　　　定理3.3.3 按照劳斯稳定判据，由特征方程式(3.3.5)所表征的线性系统稳定的充分且必 要条件是：劳斯表中第1列各值为正。如果劳斯表第1列出现小于零的数值，系统就不稳定，且 第1列各系数符号的改变次数，代表特征方程式(3.3.5)正实部根的数目。
例3.3.1 设系统的特征方程为
6s?+5s?+4s3+3s2+2s+1=0                                                           (3.3.6)
试用劳斯稳定判据判别该系统的稳定性和正实部根的个数。
解 该系统的劳斯表如下所示，即
4
3
　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　　　　　　　　



　　　由于该线性系统的劳斯表第1列元素有两次变号(0.4 →-7 →0.8571),因此该系统不稳定， 且有两个正实部根，也即有两个闭环极点位于s 右半平面。


3.3.4


劳斯稳定判据的特殊情况

　　　当应用劳斯稳定判据分析线性系统的稳定性时，有时会遇到两种特殊情况，使得劳斯表中的 计算无法进行到底，因此需要进行相应的数学处理，处理的原则是不影响劳斯稳定判据的判别 结果。
　　特殊情况1 劳斯表中某行的第1列元素为零，而该行其余各元素不为零，或不全为零。此 时，计算劳斯表下一行的第1个元素时，将出现无穷大，从而使劳斯稳定判据的运用失效。



例3.3.2 设系统的特征方程为
6s?+4s3+3s2+2s+1=0                                                              (3.3.7)
试用劳斯稳定判据判别该系统的稳定性和正实部根的个数。
解  该系统的劳斯表如下所示，即
　　　　　　　　　　　
　　　由劳斯表可知，第3行(s2) 第1列元素为零，其余元素不全为零。此时，其下一行第1列元 素为无穷大。为了克服这一困难，在此用一个无限小的正数ε来代替第3行(s2)  第1列为零的元 素，从而继续列写劳斯表，即
　　　　　　　　　　　　　　
　　　由于 所以该系统劳斯表第1列元素有两次变号，该系统不稳定，且有两个正实部 根。解该方程可得其确有两个正实部根0.1622±j0.6555。
　　　特殊情况2 劳斯表中出现全零行。这种情况表明特征方程中存在一些绝对值相同但符号 相异的特征根。例如，两个大小相等但符号相反的实根和(或)一对共轭纯虚根，或者是对称于实 轴的两对共轭复根。
　　　当劳斯表中出现全零行时，可用全零行上一行的系数构造一个辅助方程F(s)=0,     并将辅助 方程对复变量s 求导，用所得导数方程的系数取代全零行的元素，便可按劳斯稳定判据的要求继 续进行运算，直到得出完整的劳斯计算表。辅助方程的次数通常为偶数，它表明数值相同但符号 相反的根数。所有那些数值相同但符号相异的根，均可由辅助方程求得。
例3.3.3 设系统的特征方程为
s?+2s?-3s3     6s2    4s     8=0                                                         (3.3.8)
试用劳斯稳定判据判别该系统的稳定性，并求出其全部特征根。
解  该系统的劳斯表如下所示，即
　　　　　　　
　　　由此可见，该系统劳斯表第3行(s3)  为全零行，因此，用其上一行(s?)  的元素构成辅助方 程，即



2s?―6s2―8=0
取辅助方程对复变量s 的导数，可得
8s3-12s=0
用导数方程的系数取代全零行相应的元素，继续运用劳斯表的计算规则进行运算，可得
　　　　　　　　　　　　　　　　
由于该劳斯表第1列元素有一次符号改变，因此该系统不稳定，且有一个正实部根。
对辅助方程2s?―6s2―8=0    进行因式分解，可得
(s2+1)(s2-4)=0
由此可得产生全零行的特征方程的根为±j 、±2 。假设该特征方程的另外一个根为a,  则 s?+2s?-3s3―6s2―4s―8=(s-a)×(s?―3s2―4)=0
　　对比等式两边的系数可得a=-2 。  由此可得该特征方程的全部特征根，表明劳斯稳定判据 的判断结果是正确的。
3.3.5   劳 斯 稳 定 判 据 的 应 用
　　劳斯稳定判据根据线性系统的闭环传递函数的分母多项式(即特征方程)的系数来判断系统 的稳定性，在控制系统设计和分析中，主要有以下应用。
应 用 1 利用劳斯稳定判据判断系统的稳定性及特征根的位置分布情况。
　　例3.3.4  已知某系统的结构如图3.3.4所示，试判别系统的稳定性。若系统不稳定，求在 s 右半平面的极点数。
解由结构图可知，系统的前向通路有1条，即
　　　　　　　　　　　　　　
回路有3条，分别为
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
则由梅森公式可得系统的闭环传递函数为




系统的特征方程为




s?+2s?―s-2=0




　　　　　　　　
图3.3.4 某系统结构图
　　　可看出特征方程的系数不全为正，所以系统是不稳定。为了求出s 右半平面的极点数，列劳 斯表为
s?          1     0   -1
s?         2     0   -2                        辅助方程       2s?-2=0
导数方程         8s3=0
s3       0(8) 0(0)           全零行
s2       0(e)     -2        第1列元素为0 用无限小正数ε代替0
s1         16
E
s?        -2
　　　由于劳斯表第1列元素有一次变号，说明特征方程有一个正根。劳斯阵列有一行元素全为 0,说明可能有大小相等、符号相反的实根或一对共轭虚根，或对称于虚根的两对共轭复根。解辅 助方程得
2s?-2=2(s+1)(s-1)(s+j)(s―j)=0
这样特征方程可以写为
(s+2)(s+1)(s―1)(s+j)(s―j)=0
　　　可见，系统在s 右半平面有一个根s=1,   在虚轴上有两个根s=±j,      在s 左半平面有两个根 s=-1,s=-2。
　　应用2 可以选择使系统稳定的可调参数的取值范围或确定使系统稳定的特征参数的取值 区间。
　　　在线性控制系统中，劳斯稳定判据主要用来判断系统的稳定性。如果系统不稳定，则此判据 并不能直接指出使系统稳定的方法；如果系统稳定，则劳斯判据也不能保证系统具备满意的动态 性能。换句话说，劳斯判据不能表明系统特征根在s 平面上相对于虚轴的距离。由前面的分析 可知，若负实部特征方程式的根紧靠虚轴，即e  随时间缓慢衰减，因此，系统动态过程将具有缓 慢的非周期特性或强烈的振荡特性。为了使稳定的系统具有良好的动态响应，常常希望在s 左 半平面上系统特征根的位置与虚轴之间有一定的距离。为此，可在s 左半平面上作一条s=-a
　的垂线，而a 是系统特征根位置与虚轴之间的最小给定距离，通常称为给定稳定度，然后用新变量 S?=s+a    代入原系统特征方程，得到一个以s?  为变量的新特征方程，对新特征方程应用劳斯稳 定判据，可以判别系统的特征根是否全部位于s=-a      垂线之左，或选择可调参数使得系统的特 征根全部位于s=-a      垂线之左。
例3.3.5 设单位反馈系统的开环传递函数为




(3.3.9)

(1)闭环系统稳定时，k 值的范围；
　(2)若要闭环特征方程的根的实部均小于- 1,问k 的取值范围。 解  该系统的闭环特征方程为
　　　　　　　　　　　　　
即
D(s)=s3+9s2+18s+18k=0
(1)列写劳斯表如下：
　　　　　　　　　　　　　　　　
欲使系统稳定，只需
　　　　　　　　　　　　　　　　　　
解得
0<k<9
　　　(2)若要求特征根实部均小于―1,可令s=s?―1,    即将虚轴左移一个单位，则利用劳斯稳定 判据即可求得使所有根位于s=-1     垂线之左的k 的取值范围。将s=s1-1       代入闭环特征方程 可得
　　　　　　　　　D(s?)=(s?-1)3+9(s?-1)2+18(s?-1)+18k=0 整理得
D(s?)=s3+6s2+3s?+18k-10=0
列写劳斯表
　　　　　　　　　　　　　　　
欲使 D(s)  的根全部处于s=-1      之左，则要求
　　　　　　　　　　　　　　　　　　
解得



　　　　　　　　　　　　　　　　　　
即 k 值处于上述范围，可使D(s) 的根实部全小于-1。此时可以认为系统具有1的稳定裕度。

3.4    线性系统的快速性分析

　　　对于控制系统时域行为的响应特性可分为暂态响应与稳态响应，影响系统暂态特性行为的 主要因素来自系统本身的特性，而影响系统稳态特性行为的主要因素来自外加的输入。以下将 针对一阶与二阶系统的时域动态特性进行分析说明，而对于更高阶系统的时域分析，由于目前并 未有完整的数学理论分析与说明，因此，在实际应用中常用一阶或二阶系统来近似表示与分析。
3.4.1    一 阶 系 统 的 时 域 分 析
　　凡以一阶微分方程作为运动方程的控制系统，称为一阶系统。在工程实践中， 一阶系统不乏 其例。有些高阶系统的特性，常可用一阶系统的特性来近似表征。
1. 一阶系统的数学模型
图3 .4 . 1(a) 所示为一简单的RC 电路，其微分方程为
Te(t)+c(t)=r(t)                                                                     (3.4.1)

　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                    (b)
图3.4.1 一阶系统
式中：c(t)  为电路输出电压；r(t)  为电路输入电压；T=RC     为时间常数。该电路在零初始条件下 的传递函数为
(3.4.2)
　　　相应的结构图如图3.4.1(b) 所示。与此类似的系统还有室温调节系统、恒温箱及水位调节 系统等，这些系统的传递函数均可用式(3.4.2)或图3.4.1(b) 来描述，仅时间常数T  的含义有所 区别。
　　应当指出，具有同一微分方程或传递函数的所有线性系统，对同一输入信号的响应是相同 的。当然，对于不同形式或不同功能的一阶系统，其响应特性的数学表达式具有不同的物理 意义。
2. 一阶系统的单位阶跃响应
　　　设一阶系统的输入信号为单位阶跃函数r(t)=1(t),        其拉普拉斯变换为,将 代 入式(3.4.2),得
(3.4.3)



将 C(s)  展开成部分分式，有
                          (3.4.4)
对式(3.4.4)进行拉普拉斯反变换，有
c(t)=1-e/T                  (t≥0)                                                        (3.4.5)
　　　由式(3.4.5)可见，输出量c(t)  的初始值等于0,而最终将趋于1。常数项“1”是由 反变换 得到的，显然，该分量随时间变化的规律与外作用相关，由于它在稳态过程中仍起作用，故称为稳
　态分量(稳态响应)。式(3.4.5)中第二项由反变换得到，它随时间变化的规律取决于传 递函数1/(Ts+1)  的极点，即系统特征方程D( s)=Ts+      1=0  的根(一1/T) 在复平面中的位置， 若根处在复平面的左半平面如图3.4.2(a) 所示，则随着时间t 的增加，它将逐渐衰减，最后趋于 0(图3 .4 . 2(b)),   称为暂态分量(瞬态响应)。可见，阶跃响应曲线具有非振荡特性，故也称为非 周期响应。
　　　　　　　　　　　　　　　　　　　　
(a)                                                   (b)
图3.4.2 一阶系统的单位阶跃响应曲线


由式(3.4.5)可以看出，该指数响应曲线其初始斜率等于1/T,  即
　　　　　　　　　　　　　　　　




(3.4.6)

　　假如系统始终保持初始响应速度不变，那么,当t=T    时，输出量就能达到稳态值。实际上， 从式(3.4.6)可以看出，响应曲线c(t) 的斜率是不断下降的，从t=0    时的1/T 一直下降到t=∞
　时的零值。因此，当t=T  时，指数响应曲线将从零上升到稳态值的63.2%;当t=2T  时，响应曲 线将上升到稳态值的86.5%;当t=3T、4T 和 5T 时，响应曲线分别达到稳态值的95%、98.2% 和99 . 3%。
　　　由于一阶系统的阶跃响应没有超调量，所以其性能指标主要是调节时间ts, 它表征系统过渡 过程进行的快慢。由于t=3T    时，输出响应已达到稳态值的95%;t=4T    时，输出达到稳态值的 98.2%,故一般取
t,=3T         (对 应 △= 5 %  的误差带)
或
t,=4T          ( 对 应 △ = 2 % 的 误 差 带 )
显然，时间常数 T 是表征系统响应特性的唯一参数，系统时间常数越小，输出响应上升得越



快，同时系统调节时间t,也越小，响应过程的快速性也越好。
　　由图3.4.2(b) 可以看出，图3.4.1所示系统的单位阶跃响应在稳态时与输入量之间没有稳 态误差，即
es=1-c(∞)=1-1=0
　　　例3.4. 1 一阶系统结构图如图3.4.3所示。要求系统闭环增益 Kφ=2, 调节时间t.≤0.4s, 试确定参数K? 、K? 的值。
解  由结构图写出闭环系统传递函数，即
　　　　　　　　　　　　　


’令闭环增益  得
K?=0.5
令调节时间
K?≥15
3. 一阶系统的单位脉冲响应
当输入信号为理想单位脉冲函数时，由于R(s)=1,



　　　　
图3.4.3 一阶系统结构图

所以系统输出量的拉普拉斯变换式与系

统的传递函数相同，即
　　　　　　　　　　　　　　　　　　                             (3.4.7) 这时系统的输出称为脉冲响应，其表达式为
　　　　　　　　　　　　　　    (t≥0)                                                           (3.4.8)  其相应曲线如图3.4.4所示。显然， 一阶系统的单位脉冲响应是一条单调下降的指数曲线。
输出量的初始值为 ,当时间趋于无穷时输出量趋于0,所以对应的稳态分量为0。时间常数 T 同样反映了响应过程的快速性，T 越小，响应的持续时间越短，快速性也越好。
4. 一阶系统的单位斜坡响应
设系统的输入信号为单位斜坡函数,代入式(3.4.2)可得
　　　　　　　　　　　　　　　　　                           (3.4.9) 将式(3.4.9)展开成部分分式，即
　　　　　　　　　　　　　　　　                       (3.4.10) 进行拉普拉斯反变换得
c(t)=t-T+Te-1/T(t≥0)                                                                  (3.4.11)
式中：t―T  为响应的稳态分量；Te-     为响应的瞬态分量，当时间t  趋于无穷时衰减到0。由式



　(3.4.10)可得图3.4.5所示的一阶系统单位斜坡响应曲线。 一阶系统的单位斜坡响应的稳态分 量，是一个与输入斜坡函数斜率相同但时间滞后T  的斜坡函数，因此，在位置上存在稳态跟踪误 差 ,其值正好等于时间常数。 一阶系统单位斜 坡响应的瞬态分量为衰减非周期函数。时间常数T 越小，则响应越快，跟踪误差越小，输出量相

对输入信号的滞后时间也越短。
　　　　
图3.4.4 一阶系统的单位脉冲响应曲线




　
图3.4.5 一阶系统的单位斜坡响应曲线


5. 一阶系统的单位加速度响应
　　　设系统的输入信号为单位加速度函数 ,则由式(3.4.2)求得一阶系统的单位加速 度响应为
     t≥0                                    (3.4.12)
由此可得系统的跟踪误差为
e(t)=r(t)―c(t)=Tt-T2(1-e/T)                                t≥0                             (3.4.13)
　　　当时间趋向于无穷时，跟踪误差趋向于无穷大。因此， 一阶系统不能实现对加速度函数的 跟踪。
6. 线性定常系统的重要特性
上述分析表明，当系统的输入量为单位斜坡函数r(t)=t     时，系统输出量用c.(t)  表示，则
c:(t)=t-T+Te/T                        t≥0                                          (3.4.14)
　　　当系统的输入量为单位阶跃函数r(t)=1(t)      (即为单位斜坡函数的导数)时，系统输出量用 h(t) 表示，则
h(t)=c:(t)=1-e1T                         t≥0                                       (3.4.15)
最后，当输入为单位脉冲函数(即单位阶跃函数的导数)时，系统输出量用k(t)  表示，则


　　　　　　　　　　　　　　　



t≥0


(3.4.16)

　　　比较系统对三种输入信号的响应，可以清楚地看出，系统对输入信号导数的响应，等于系统 对该输入信号响应的导数。或者说，系统对输入信号积分的响应，等于系统对该输入信号响应的 积分，其积分常数由零输出初始条件确定。这是线性定常系统的一个重要特性，不仅适用于一阶 线性定常系统，而且适用于任意阶线性定常系统。




3.4.2    二 阶 系 统 的 时 域 分 析
　　凡以二阶微分方程作为运动方程的控制系统，称为二阶系统。在控制系统工程中，不仅二阶  系统的典型应用极为普遍，常见的二阶系统有各种各样的物理系统，如简单的直流电机速度控制  系统、温度控制等。而且不少高阶系统的特性在一定条件下可用二阶系统的特性来表征。因此， 着重研究二阶系统的分析和计算方法，具有较大的实际意义。
1. 二阶系统的数学模型
图3 .4 .6(a) 为一典型二阶随动系统。根据其工作原理可列写如下方程组。
　　　　　
误差测量装置       放大器电动机       齿轮传动
(a)
　　　　　　　　　　　　
(b)
图3.4.6 二阶系统模拟电路及典型结构图
(a) 典型二阶随动系统；(b)  典型二阶系统结构图。
　　　误差测量装置是一对电位计，它们可以将输入和输出位置信号，转换为与位置成正比的电信 号。设输入电位计电刷臂的角位置为θ,,输出电位计电刷臂的角位置为θ .,则误差信号为电位 差，即
e?=KAK,(θ,-θ.)=KAKe                                                             (3.4.17)
　式中：K, 为桥式电位器的传递系数；KA 为放大器的增益常数；e=θ,―θ .   为位置误差。经放大后 直接作用到直流电动机的电枢电路上。
　　　电动机励磁绕组上加有固定电压。如果出现误差信号，电动机就产生力矩以转动输出负载， 并使误差信号减少到0。
当励磁电流固定时，电动机产生的力矩(电磁转矩)为
M(s)=CmIa(s)                                                               (3.4.18)
式中：Cm 为电动机的转矩系数；ia 为电枢电流。
对于电枢电路，有
                    (3.4.19)



式中：La、R。为电动机电枢绕组的电感和电阻；K?  为电动机的反电势常数；θ为电动机轴的角 位移。
电动机的力矩平衡方程为
(3.4.20)
式中：J 为电动机负载和齿轮传动装置折合到电动机轴上的组合转动惯量；f 为电动机负载和齿 轮传动装置，折合到电动机轴上的黏性摩擦系数。
齿轮传动部分的传递方程为
(3.4.21)
　　将以上方程组进行拉普拉斯变换并联立，可以求出系统的开环传递函数(即前向通路传递函 数),因为反馈回路传递函数为1,因此有
　　　
　　　　　　　



如果略去电枢电感L,  可得
　　　　　　



(3.4.22)


(3.4.23)

式中：K?=KsKACm/iR。   为增益             为阻尼系数；K=K?/F      为开环增益；Tm=J/F     为
机电时间常数；5为系统的阻尼比， ;Wn 为系统的无阻尼振荡频率，简称自然频率，
　
　　该随动系统的结构图如图3.4.6(b) 所示。由图3.4.6(b) 可得二阶系统的标准闭环传递函 数为
                   (3.4.24)
2. 二阶系统的单位阶跃响应
令式(3.4.24)的分母多项式等于0,则可得二阶系统的特征方程为
s2+20ns+w22=0                                                            (3.4.25)
其两个根(闭环极点)为
S1.2=-ζ0n±wn√52-1                                                          (3.4.26)
　　　由式(3.4.26)可知，随着阻尼比ζ的不同，二阶系统的闭环极点也不同，可分为以下几种 情况：



　　(1)当0<ζ<1时，方程有一对实部为负的共轭复根，系统的时间响应具有振荡特性，称为 欠阻尼状态。
(2)当5=1时，系统有一对相等的负实根(重根),称为临界阻尼状态。
　　　(3)当ζ>1时，系统有两个不相等的负实根，称为过阻尼状态。临界阻尼和过阻尼状态下， 可等价于两个一阶环节的串联，系统的时间响应均无振荡。
(4)当ζ=0时，系统有一对纯虚根，称为零阻尼状态。系统时间响应为持续的等幅振荡。
　　　(5)当ζ<0时，系统具有一对实部为正的共轭复根，系统时间响应具有发散振荡特性，称为 负阻尼状态。
二阶系统的响应特性完全由ζ和w 两个参数来描述，所以ζ和w, 是二阶系统的重要结构参数。 下面分过阻尼(含临界阻尼)和欠阻尼(含零阻尼)两种情况分析二阶系统的单位阶跃响应。
　　　(1)过阻尼(5≥1)二阶系统单位阶跃响应及其性能指标。此时，  √ 52-1≥0,系统闭环特征 方程具有两个不相等的负实根，如图3.4.7(a)所示，其中
　　　　　　　　　　　
且有T?≥T?,     则在单位阶跃作用下过阻尼二阶系统的输出为
(3.4.27)

j



　　　　　0 方   六
(a)                                                    (b)
图3.4.7 过阻尼情况下二阶系统的单位阶跃响应曲线
　　　由此可见，过阻尼二阶系统可以看成两个时间常数不同的惯性环节(一阶系统)的串联。对 式(3.4.27)进行拉普拉斯反变换，得
(3.4.28)
　　　式(3.4.28)表明，过阻尼情况时稳态分量为1,暂态分量包含两个指数衰减项。暂态分量随 时间的增长衰减到0,最终输出值为1,所以系统不存在稳态误差。其响应曲线如图3.4.7(b)   所示。
　　　图3 .4 . 7(b) 所示的响应具有非周期性，没有振荡和超调。其主要动态性能指标主要是ts。 当ζ≥0.7时，有
) ζ≥0.7                       (3.4.29)
由式(3.4.29)可得图3.4.8所示的过阻尼二阶系统调节时间特性，由图可知，若 Ti≥4T?,
即过阻尼二阶系统第二个闭环极点是第一个闭环极点的数值4倍以上时，系统可等效为具有一 1/T?   闭环极点的一阶系统，此时近似取t,=3T?。



　　　　　　　　　　　　　
图3.4.8 过阻尼二阶系统调节时间特性
　　　由于过阻尼系统响应缓慢，故通常不希望采用过阻尼系统。但是，这并不排除在某些情况 下，例如，在低增益、大惯性的温度控制系统中，需要采用过阻尼系统；另外，在有些不允许时间响 应出现超调，而又希望响应速度较快的情况下，例如，在指示仪表和记录仪表系统中，需要采用临 界阻尼系统。

　　　当ζ=1时， √S2-1=0,       系统闭环特征方程具有两个相等的负实根，如图3.4.9(a)  所示， 其 中
S1,2=―Wn
则在单位阶跃作用下临界阻尼二阶系统的输出为
(3.4.30)
对式(3.4.30)进行拉普拉斯反变换，得
c(t)=1-(1+wt)e'                          t≥0                                              (3.4.31)
　　由式(3.4.31)可知，响应具有非周期性，没有振荡和超调，其响应曲线如图3.4.9(b)  所示。 其动态性能指标主要为
t?=4.75T?                                                                    (3.4.32)
　　　　　　　　　　　　　　　　　　　　　
(a)                                                     (b)
图3.4.9 临界阻尼情况下二阶系统的单位阶跃响应曲线



　　(2)欠阻尼(0≤5<1)二阶系统单位阶跃响应及其性能指标。在欠阻尼的情况下，闭环极点 为共轭复数，即
S1,2=-0n±j√ 1-5wn=σ±jwd
其中
σ=-0n,wa=√ 1-5wn
极点分布如图3.4.10(a) 所示。在单位阶跃信号作用下，系统的输出为
(3.4.33)


对 C(s) 进行拉普拉斯反变换得
　　　　




t≥0
(3.4.34)

式中：β=arccosζ,  如图3.4.10(a) 所示。
　　　图3.4.10(b) 给出了欠阻尼二阶系统的单位阶跃响应曲线。其稳态分量为1,不存在稳态误 差；暂态分量是阻尼正弦振荡过程，阻尼的大小由 ζwn( 即o, 特征根实部)决定；其振荡角频率为 阻尼振荡角频率wa(特征根虚部),其值由阻尼比ζ和自然振荡角频率wn决定。
　　　　　　　　　　　　　　　　　　　　
(a)                                                   (b)
图3.4.10 欠阻尼情况下二阶系统的单位阶跃响应曲线
　　　综上所述，当阻尼比ζ取不同数值时，系统输出c(t)  随 wnt 变化的曲线如图3.4.11所示。 由图可见，在过阻尼和临界阻尼响应曲线中，临界阻尼响应具有最短的上升时间，响应速度最快； 在欠阻尼响应曲线中，阻尼比越小，超调量越大，上升时间越短，一般取ζ=0.4～0.8,此时超调 量适度，调节时间较短；若二阶系统具有相同的ζ和不同的wn,则其振荡特性相同但响应速度不 同 ，wn 越大，则响应速度越快。
欠阻尼二阶系统的动态性能指标的定义及计算公式如下：
　　　(1)上升时间tr 。由于欠阻尼二阶系统是振荡衰减的，因此，其上升时间定义为c(t)  从 0 第 一次上升到c(∞)   所需的时间。因此，有




由于e 蜘n,≠  0,所以






(3.4.35)

sin(wat,+β)=0









会






Wn t
图3.4.11 二阶系统单位阶跃响应曲线
即
wat,+β=nπ
由于是第一次上升到c(∞)   所需的时间为t,,  因此取n=1,   最终得
(3.4.36)
(2)峰值时间tp 。其定义为输出量c(t)  达到第一个峰值所需的时间。 由定义可知，tp 为输出量到达其第一个极值点的时间，因此令
(3.4.37)
即
　　　
(3.4.38)

从而得
watp=nπ


取 n=1,   得
　　　　　　　　　　　　　　　　　　　　
(3)最大超调量o% 。 由定义可知
　　　　　　　　　　　　　　　
式中：c(∞)   为输出的稳态值，由式(3.4.34)可知，c(∞)=1,      而
　　　　　　　　　　　　　
由图3.4. 10(a) 可知



(3.4.39)






(3.4.40)



sinβ=√ 1-5
因此，有
sin(π+β)=-sinβ=-√ 1-5
所以
o%=e/√ 1-3×100%                                           (3.4.41)
　　　由此可见，o% 仅与阻尼比ζ有关。ζ越大，则o% 越小，系统的稳定性越好。?%与ζ间关系 如图3.4.12所示。
　　　(4)调节时间t?。系统输出量与稳态值之差进入并一直保持在允许误差带△内所需要的时 间，其中△取2%或5%。

(3.4.42)
　　　由于式(3.4.42)不容易计算，因此，写出调节时间的表达式是困难的。由图3.4.13可知，响 应曲线总在一对包络线之内。该包络线为
　　　　　　　　　　　　　　　　　　

　　　　　　　　　　　　　　　　　　　　　　　
图3.4.12 ?%与ζ间关系
　　　由于实际响应曲线的收敛速度比包络线的收敛速度要快，因此可用包络线代替实际响应来 估算调节时间。即认为响应曲线的包络线进入误差带时，调整过程结束。由包络线求得的调节 时间为
                      (3.4.43)
当ζ≤0.8时，在工程实际中t, 常用下式近似计算，即
,△=5%
,△=2%                            (3.4.44)



　　　例3.4.2 有一位置随动系统，结构如图3.4.14所示，k=40,z=0.1 。(1)        求系统的开环和 闭环极点；(2)当输入量r(t)  为单位阶跃函数时，求系统的自然振荡角频率wn,阻尼比ζ和系统 的动态性能指标tr、ts 和σ%。
　　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　　　　　　　
(1)由开环传递函数得开环极点为 p?=0,p?=-10。 令闭环传递函数的分母等于0,可得特征方程为 s2+10s+400=0
解得闭环极点为
P1,2         =-5±j19.365
(2)将闭环传递函数与标准形式
　　　　　　　　　　　　　　　　
进行比较，有
w2=400,2n=10
解得
Wn=20,ζ=0.25
则系统的动态指标为
　　　　　　　　　
　　　　　　　　　　　　　
g%=e√ 1-×100%=45%
例3.4.3  已知系统的结构图如图3.4.15所示，若r(t)=2 ・ 1(t) 时，试求：
(1)k=0      时，系统的超调量σ%和调节时间t?;
R(s)                                                                                 C(s)
100                  50+2)
kys

图3.4.15 系统结构图



　　(2)当kf 不等于0时，若要使σ%=20%,试求 k  应为多大，并求出此时的调整时间t? 的值；
(3)比较上述两种情况，说明内反馈kys 的作用。
解 ( 1 ) 当k=0    时，由结构图可知闭环传递函数为
　　　　　　　　　　　　　　　
则有w2=50,2ζwn=2,    所以wn=7.07,ζ=0.14 。   这是一个欠阻尼状态的二阶系统，故 o%=e√ 1- ×100%=64%
　　　　　　　　　　　　　　　
(2)当k≠0 时，可得闭环传递函数为
　　　　　　　　　
可见，wn=7.07,

由题意可知，%= eπ√ 1   -3×100%=20%,    从而可得 ζ=0.46
则k=9 。 调整时间为
　　　　　　　　　　　
　　　(3)比较上述两种情况可以看出，内反馈kg 的作用为增加阻尼比，减小超调量，减小调整 时间。
3.5    线性系统的准确性分析

　　　控制系统的稳态误差，是系统控制准确度(控制精度)的一种度量，通常称为稳态性能。在控  制系统设计中，稳态误差是一项重要的技术指标。对于一个实际的控制系统由于系统结构、输入  作用的类型(控制量或扰动量)、输入函数的形式(阶跃、斜坡或加速度)不同，控制系统的稳态输  出不可能在任何情况下都与输入量一致或相当，也不可能在任何形式的扰动作用下都能准确地  恢复到原平衡位置。此外，控制系统中不可避免地存在摩擦、间隙、不灵敏区、零位输出等非线性  因素，会造成附加的稳态误差。可以说，控制系统的稳态误差是不可避免的，控制系统设计的任  务之一，是尽量减小系统的稳态误差，或者使稳态误差小于某一容许值。显然，只有当系统稳定  时，研究稳态误差才有意义；对于不稳定的系统而言，根本不存在研究稳态误差的可能性。有时， 把在阶跃函数作用下没有原理性稳态误差的系统，称为无差系统；而把具有原理性稳态误差的系  统，称为有差系统。



　　　本节主要讨论线性控制系统由于系统结构、输入作用形式和类型所产生的稳态误差即原理 性稳态误差的计算方法，其中包括系统类型与稳态误差的关系，同时介绍定量描述系统误差的两 类系数，即静态误差系数和动态误差系数。至于非线性因素所引起的系统稳态误差，则称为附加 稳态误差，或结构性稳态误差。
3.5.1   线性系统的稳态误差计算
1. 稳态误差定义与计算
　　　定义3.5.1 系统的误差定义为系统输出量的希望值c,(t)与实际值c(t)之差，用e(t)来 表 示，即
e(t)=c,(t)―c(t)                                                               (3.5.1)
　　定义3.5.2 由于误差信号e(t)是时间的函数，当时间t→ ∞时，对于稳定的系统，误差信号  的瞬态分量将趋向于零，剩下的是误差的稳态分量。把误差的稳态分量定义为系统的稳态误差，
用es 表示，即
(3.5.2)
实质上，稳态误差也可以理解为希望输出的稳态值与实际输出的稳态值之差。
对于控制系统来讲，其典型结构如图3.5.1所示。图3.5.1(a) 为单位反馈系统，图3.5.1


(b) 为非单位反馈系统。
R(s)  E(s)     G(s)

　H(s) (b)






(c)

图3.5.1 典型控制系统结构图
(a) 单位反馈系统；(b) 非单位反馈系统；(c) 等效单位反馈系统。
对于单位反馈系统来说，在零初始条件下，输入信号r(t)  的作用下的稳态误差为
(3.5.3)
　　　对于非单位反馈系统，其等效单位反馈系统结构图如图3.5.1(c) 所示。此时，可写成以下 形式，即
(3.5.4)
　　　由式(3.5.4)求得的是误差的稳态分量，但不能反映输入信号为周期性函数(如正弦函数)时 的稳态误差，具有一定的局限性。当系统的输入信号为周期性函数时，要根据系统误差传递函数 的频率特性进行计算。
　　控制系统除承受输入信号作用外，还经常处于各种扰动作用之下，如图3.5.2所示。例如， 负载转矩的变动，放大器的零位和噪声，电源电压和频率的波动，组成元件的零位输出，以及环境 温度的变化等。因此，控制系统在扰动作用下的稳态误差值，反映了系统的抗干扰能力。在理想  情况下，系统对于任意形式的扰动作用，其稳态输出应该为零，即扰动作用下的误差为
E(s)=0-Cn(s)=―φ(s)N(s)                                                           (3.5.5)




　　　　　　　　　　　
图3.5.2 扰动作用下控制系统结构图
式中：Φn(s)为输出对扰动的闭环传递函数，则在扰动作用下的稳态误差为
　　　　　　　　　　　　
则系统总的稳态误差为在输入作用下的稳态误差和扰动作用下的稳态误差之和，即
es=esn+esr
例3.5. 1 求图3.5.3所示系统的稳态误差值。
解  输入作用下系统的闭环传递函数为
　　　　　　　　　　　　　　　
由劳斯判据可知，该系统是稳定的。 由输入引起的误差为
　　　　　　　　　　
所以稳态误差为
　　　　　　　　　
扰动作用下系统的闭环传递函数为
。
5












(3.5.6)

(3.5.7)













C(s)

由扰动引起的误差为                                        图3.5.3 某控制系统结构图
　　　　　　
所以稳态误差为
　　　　　　　　　　　　　　　　
故由输入和扰动共同引起的误差为
es=es+es=0―0.2=―0.2
2. 系统类型与典型输入下的稳态误差
　　　由输入作用下的稳态误差计算式(3.5.3)可见，控制系统稳态误差数值，与开环传递函数 G(s)H(s)    的结构和输入信号R(s)  的形式密切相关。对于一个给定的稳定系统，当输入信号形式 一定时，系统是否存在稳态误差就取决于开环传递函数描述的系统结构。因此，按照控制系统跟 踪不同输入信号的能力来进行系统分类是必要的。



在一般情况下，开环传递函数分子阶次为m, 分母阶次为n 时可表示为


(3.5.8)


式中：K 为开环增益；t; 和 T;  为时间常数；v为开环系统在s 平面坐标原点上的极点的重数。
　　系统的型别以v 的数值来划分的：v=0,  称为0型系统；v=1,  称为I  型系统；v=2,   称为Ⅱ型 系统。当v>2  时，除复合控制系统外，使系统稳定是相当困难的。因此，Ⅲ型及Ⅲ型以上的系统 几乎不采用。
　　这种以开环系统在s 平面坐标原点上的极点数来分类的方法，其优点在于：可以根据已知的 输入信号形式，迅速判断系统是否存在原理性稳态误差及稳态误差的大小。它与按系统的阶次 进行分类的方法不同，阶次m 与 n 的大小与系统的型别无关，且不影响稳态误差的数值。为了 便于讨论，令
　　　　　　　　　　　　　　　


则有s→0 时 ，G?(s)H?(s)→ 1 。  因此，式(3.5.8)可改写为
　　　　　　　　　　　　　　　
系统稳态误差计算通式则可表示为
　　　　　　　　　　　　　　　　　
1)阶跃输入作用下的稳态误差与静态位置误差系数





(3.5.9)



(3.5.10)

　　若输入信号r(t)=R ・ 1(t), 其中R 为输入阶跃函数的幅值，则。由式(3.5.10)可 以算得各型系统在阶跃输入作用下的稳态误差为

(3.5.11)

　　对于0型系统，在单位阶跃输入作用下的稳态误差为一常数。习惯上，常采用静态位置误差 系数K,   表示各型系统在阶跃输入作用下的稳态误差。根据式(3.5.11)可知
　　　　　　　　　　　　　　
式中：,称为静态位置误差系数。
　　　如果要求系统对于阶跃输入作用不存在稳态误差，则必须选用I  型 及I  型以上的系统。习 惯上，常把系统在阶跃输入作用下的稳态误差称为静差。因而，0型系统可称为有(静)差系统或



零阶无差系统，I 型系统可称为一阶无差系统，Ⅱ型系统可称为二阶无差系统，依此类推。
2)斜坡输入作用下的稳态误差与静态速度误差系数
　　若输入信号r(t)=Rt,        其 中R  为输入斜坡函数的幅值，则  将 R(s) 代 入 式 (3.5.10),得各型系统在斜坡输入作用下的稳态误差为

(3.5.12)

式中 ,称为速度误差系数。
　　　式(3.5.12)表明0型系统在稳态时不能跟踪斜坡输入；对于I 型系统，稳态输出速度恰好与 输入速度相同，但存在一个稳态位置误差，其数值与输入速度信号的斜率R 成正比，而与开环增 益 K 成反比；对于Ⅱ型及Ⅱ型以上的系统，稳态时能准确跟踪斜坡输入信号，不存在位置误差。
3)加速度输入作用下的稳态误差与静态加速度误差系数
　　　若输入信号 ,其中R 为加速度输入函数的速度变化率，则。将R(s)   代 入式(3.5.10),可得各型系统在加速度输入作用下的稳态误差为

(3.5.13)

式中 ,称为加速度误差系数。
　　　式(3.5. 13)表明0型和I  型系统在稳态时不能跟踪加速度输入；对于Ⅱ型系统，存在一个稳 态位置误差，其数值与输入加速度信号的速度变化率R 成正比，而与开环增益 K 成反比；对于Ⅲ 型及Ⅲ型以上的系统，稳态时能准确跟踪加速度输入信号，不存在稳态误差。
　　　反馈控制系统的型别、静态误差系数和输入信号形式之间的关系，统一归纳于表3.5.1。该 表说明，同一控制系统，在不同形式的输入信号作用下具有不同的稳态误差。
注意：表3.5.1只能在系统稳定、单位反馈情况下才能直接使用。
表3.5. 1  输入信号作用下的稳态误差


系统型别	静态误差系数	稳态误差es
	Kp	K,	Ka	阶跃输入R ・ 1(t)	斜坡输入Rt	加速度输
0	K	0	0	　　　　	○	∞
I	∞	K	0	0	　　　　	∞
Ⅱ	∞	∞	K	0	0	　　　　　
Ⅲ	0	∞	○∞	0	0	0
例 3 .5.2  设控制系统结构如图3.5.4所示。其中K?=2,K?=0.25,T?=0.25(s),K?=4。


求：(1)当输入





时，系统的稳态误差；(2)系统的单位阶跃响应表达式。



　　　　　　　　　　
图3.5.4 控制系统结构图
解  系统的闭环传函为
　　　　　　　　　　　　　　　　　
等效单位反馈开环传递函数为
　　　　　　　　　　　　　　　
可见，该系统为Ⅱ型系统，且开环增益K=2,    当 时，查表3.5.1可知，稳态误差

( 2 ) 当        时                                                  ,则单位阶跃响应表
达式为(对上式取拉普拉斯反变换)
c(t)=1+0.208e?.586t―1.207e-3.4141                t≥0
3. 扰动作用下系统的稳态误差分析
　　　由于控制系统经常处于各种扰动作用之下，如负载的变动，电源电压波动及系统工作 环境温度、湿度的变化等。因此，系统在扰动作用下的稳态误差大小就反映了系统抗扰动 的能力。在理想情况下，总希望系统对任何扰动作用的稳态误差为零。但实际上，这是不 可能做到的。
　　对于扰动作用下的稳态误差，同样可以采用终值定理计算。系统典型结构图如图3.5.2所 示。假定系统无输入作用，只有扰动N(s)  作用在系统上。这时，扰动作用下系统的误差为
(3.5.14)
　　下面通过一个实例分析扰动作用下系统稳态误差的计算方法，以及在前向通道串联一积分 环节对稳态误差的影响。
例3.5.3 控制系统如图3 . 5 . 2所示，其中输入信号为r(t)=1(t),          扰 动 信 号 n(t)=
2・1(t)      ,H(s)=2.5。
(1)试求k=40   和 k=20    时，系统在输入和扰动作用下的稳态误差。
　　　(2)在扰动作用点之前的前向通道中引入一个积分环节,对结果有何影响?在扰动作用 之后的前向通道中引入一个积分环节 ,结果又如何?
解  令



　　　　　　　　　　　
(1)在输入R(s)  作用下的误差表达式为(令n(t)=0)
　　　　　
则在单位阶跃信号作用下的稳态误差为
　　　　　
当 k=40    时 ，es=0.004;     当 k=20   时 ，es=0.0078。
　　计算由扰动N(s)  作用引起的稳态误差和稳态输出时，可令输入信号r(t)=0,     扰动作用下的 误差表达式为
　　　　　　　　　　
由题意可知 ,其稳态误差为
　　　　　　
当 k=40    时 ，es=―0.0198;      当 k=20    时 ，es=―0.0392。
可见，减小开环增益将导致扰动作用下系统稳态误差的绝对值增大，稳态输出也增加。
(2)若积分环节   加在扰动作用点之前，则
,H(s)=2.5
从而可知
　　　　　　　　　　
若积分环节加在扰动作用点之后，则
　　　　　　　　　　
从而可知
　　　　　　　　　
当k=40    时 ，es=-0.02;         当 k=20    时 ，es=―0.04。
可见，在扰动作用点之前加入积分环节，可以消除由阶跃扰动作用产生的稳态误差和稳态输



出。而在扰动作用点之后加入积分环节，则对阶跃扰动产生的稳态误差和稳态输出影响不大。
3.5.2   减小和消除稳态误差的方法
　　为了减小或消除系统在输入信号和扰动作用下的稳态误差，可以采取以下措施增大系统开 环增益(或扰动作用点之前系统的前向通道增益)或增加积分环节的个数(提高系统的型别)。但 这两种方法在其他条件不变时，一般都会影响系统的动态性能，乃至系统的稳定性。若在系统中 加入顺馈控制作用，既可以使控制系统获得较高的稳态精度，又具有良好的动态性能。
1. 按扰动进行补偿
　　图3.5.5为按扰动进行补偿的系统结构图。系统除了原有的反馈通道外，还增加了一个由 扰动通过前馈(补偿)装置产生的控制作用，旨在补偿由扰动对系统产生的影响。图中Gn(s) 为 待求的前馈控制装置的传递函数；N(s)  为扰动作用，且可进行测量。
　　　　　　　　　　　
图3.5.5 按扰动进行补偿的复合控制结构
令R(s)=0, 由图3.5.5得扰动引起的系统输出为 p?=G?(s),△?=1
　　p2=―Gn(s)G(s)G?(s),△2=1 L?=-G?(s)G?(s),△=1+G?(s)G?(s)
　　　　　　　　　　　
由梅森公式，得
　　　　　　　　　　　　　
　　　引入前馈后，系统的闭环特征多项式没有发生任何变化，即不会影响系统的稳定性。为了补 偿扰动对系统输出的影响，令上式等号右边的分子为0,即有
G?(s)[G,(s)G?(s)-1]=0
从而有
　　　　　　　　　　　　　　　　　　
　　这是对扰动进行全补偿的条件。由于G(s) 分母的s 阶次一般比分子的s 阶次高，全补偿 的条件在工程实践中只能近似地得到满足。
2. 按输入进行补偿
　　　图3.5.6为按输入进行补偿的系统结构图。图中G,(s)  为待求前馈装置的传递函数。由于 G,(s)  设置在系统闭环的外面，因而不会影响系统的稳定性。在设计时，一般先设计系统的闭环



　部分，使其有良好的动态性能；然后再设计前馈装置G,(s),   以提高系统在参考输人作用下的稳 态精度。
　　　　　　　　　　　　　　　　　　　　　　　　　
图3.5.6 按输入进行补偿的复合控制结构
　　　表明在式 成立的条件下，系统的输出量在任何时刻都可以完全无误差地复现 输入量，具有理想的时间响应特性。为了说明前馈补偿装置能够完全消除误差的物理意义，列写 误差表达式为
　　　　　　　　　　　　　　　
　　　上式表明，在式 成立的条件下，恒有E(s)=0;     前馈补偿装置G,(s)  的存在，相 当于在系统中增加了一个输入信号G,(s)R(s),    其产生的误差信号与原输入信号R(s)  产生的误 差信号相比，大小相等而方向相反。故式 称为输入信号的误差全补偿条件。
　　　由于G(s) 一般具有比较复杂的形式，故全补偿条件的物理实现相当困难。在 工程实践中，大多采用满足跟踪精度要求的部分补偿条件，或者在对系统性能起主要影响的频段 内实现近似全补偿，以使G,(s)的形式简单并易于实现。
例3.5.4  复合控制系统结构图如图3.5.7所示，图中K?、K?、T?、T? 是大于0的常数。
　　　　　　　　　　　　
图3.5.7 复合控制结构图
(1)确定当闭环系统稳定时，参数K?、K? 、T? 、T? 应满足的条件。
　　　(2)当输入r(t)=Vot    时，选择校正装置G.(s),    使得系统无稳态误差(误差定义为R(s)  一 C(s))。
解(1)系统误差传递函数为
　　
由此可得系统的特征方程为



D(s)=T?T?s3+(T?+T?)s2+s+K?K?
列劳斯表：
　　　　　　　　　　　　　
因 K?、K?、T?、T? 均大于0,所以只要
　　　　　　　　　　　　　　　　　
即可满足稳定条件。
(2)在斜坡输入信号作用下其稳态误差为
　　　　　
　　　　　　　
令 es=0,    得
　　　　　　　　　　　　　　　　　　　
由此可见，校正装置 时，可保证无稳态误差。

3.6    线 性 系 统 的 时 域 法 校 正

　　设计控制系统的目的，是将构成控制器的各元件与被控对象适当组合起来，使其满足稳态误 差、阻尼程度和响应速度的性能指标要求。如果通过调整前向增益后仍然不能全面满足设计要 求的性能指标，就需要在系统中加入一些其参数可以根据需要而改变的环节，使系统整个特性发 生变化，从而满足给定的各项性能指标。这就是控制系统设计中的校正问题。
　　　在控制系统设计中，常用的校正方式为串联校正和反馈校正两种。究竟选用哪种校正方式， 取决于系统中的信号性质、技术实现的方便性、可供选用的元件、抗扰性要求、经济性要求、环境  使用条件以及设计者的经验等因素。在性能指标要求较高的控制系统设计中，常常兼用串联校 正与反馈校正两种方式。用这些基本控制规律的某些组合，如比例―微分、比例一积分、比例一 积分―微分等组合控制规律，以实现对被控对象的有效控制。
下面将通过实例来分别对以上三种不同的组合控制校正方法进行分析和设计。
3.6.1   比 例 ― 微 分 环 节(PD) 校 正
例3.6. 1 已知单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　　　　



设系统的输入为单位阶跃函数，试计算放大器增益KA=200  时，系统输出响应的动态性能指标。 当 KA=1500  或 KA=13.5  时，系统的动态性能指标如何变化。
解  由开环传递函数可得系统的闭环传递函数为
　　　　　　　　　　　　　　　　
将 KA=200  代入上式，得
　　　　　　　　　　　　　　　　
由此可得，系统无阻尼振荡频率wn 和阻尼比ζ分别为 wn=31.6,ζ=0.545
根据欠阻尼二阶系统的动态性能指标的计算公式可得
　　　　　　　　　　　　　　　
(s)

　　　　　　　　　　　　　　　　
当 KA=1500  时 ，wn=86.6,ζ=0.2, 相应的动态性能指标为
tp=0.037(s),t?=0.202(s),o%=52.7%
　　　当 KA=13.5  时 ，wn=8.22,ζ=2.1, 系统工作在过阻尼状态，峰值时间、超调量和振荡次数 不存在，其调节时间近似为
t,=3T?=1.44(s)
　　　由此可知，当KA增大时，阻尼比减小，无阻尼振荡频率增加，峰值时间减小，超调量增加，调  节时间无多大变化。而当KA 减小时，阻尼比增加，无阻尼振荡频率减小，超调量减小(或无超  调),调节时间显著增加。也即仅靠调节放大器的增益(所谓的比例环节),是难以兼顾系统的快 速性和平稳性的。为了改善系统的动态性能，可采用比例一微分控制或速度反馈控制进行校正， 从而改善系统的动态性能。
图3.6.1给出了引入比例―微分控制环节的二阶系统结构图，其中 Ta 为微分环节的时间
　　　　　　　　　　　
图3.6.1 具有比例―微分控制的二阶系统结构图
常数。由图可知，该系统的开环传递函数为
　　　　　　　　　　　　　　




式中：为开环增益，其相应的闭环传递函数为
　　　　　　　　　　　　　　　　
式中：等效阻尼比 ζa为
　　　　　　　　　　　　　　　　　　
由此可见，增加比例一微分校正环节增加了系统的阻尼比(ζa>5),    这可以使系统的动态过程超
　调量下降，调节时间缩短，同时开环增益 保持不变，即比例―微分校正环节的引入并不影 响系统的稳态精度，也不改变系统的无阻尼振荡频率wn。由于其在二阶系统中增加了一个闭环 零点，因此，前面给出的动态性能指标公式不再适用。总之，适当选择开环增益和微分环节的时 间常数 Ta,  既可减小稳态误差，又可获得良好的动态性能。
　　采用速度反馈控制的二阶系统的结构图如图3.6.2所示，其中K,  为速度反馈系数。下面用 上述同样的方法分析其对系统性能的影响，由图可得系统的开环传递函数为
　　　　　　　　　　
　式中：为系统的开环增益。显而易见，速度反馈的引入使得开环增益减小了，因而 降低了系统的稳态精度。
其闭环传递函数为
　　　　　　　　　　　　　　　　
式中： 由此可见，速度反馈的引入与比例―微分环节的作用相同，可以增加系 统的阻尼比，而不改变系统的无阻尼振荡频率wn。需要注意的是，在引入速度反馈的同时应 相应增加原系统的开环增益，以补偿由于速度反馈引起的开环增益的减小而带来的稳态精度 的降低。

　　　　　　　　　　　
图3.6.2 具有速度反馈控制的二阶系统结构图
　　　从实现的角度来看，由于比例―微分环节不需要增加额外的传感器，因此结构比较简单，易 于实现，且成本低。而速度反馈控制需要引入相应的测速传感器(如测速发电机),因此成本较 高。从抗干扰的能力来看，微分器对输入信号中的噪声，特别是高频噪声具有放大作用，而速度 反馈信号噪声成分很弱，因速度反馈抗干扰能力更强。




3.6.2    比 例 一 积 分 环 节(PI) 校 正
　　图3.6.3给出了引入比例一积分控制环节的二阶系统结构图，其中T; 为积分环节的时间常 数。由图可知该系统的开环传递函数为
　　　　　　　　　　　　　
　式中：为开环增益。由其开环传递函数可见比例一积分环节的引入提高了系统的型别， 因此会提高系统的稳态精度，减小或消除稳态误差，但是系统型别的提高又会降低系统的稳定  性，因此，需要适当选择开环增益和积分环节的时间常数 T;,既可减小或消除稳态误差，又可获  得良好的动态性能。
　　　　　　　　　　　
图3.6.3 具有比例―积分控制的二阶系统结构图

3.6.3   比 例 一 积 分 ― 微 分 环 节(PID) 校 正
由以上分析可以看出，比例、微分和积分环节的引入可以改善系统的性能，其作用总结如下：
　　　比例环节的引入可以增加系统的无阻尼振荡频率和开环增益，减小阻尼比，因此，可以增加系 统响应的快速性和稳态精度，但是系统的超调量和振荡次数会增加，即动态过程的平稳性降低。
　　微分环节的引入可以增加系统的阻尼比，而不改变系统的无阻尼振荡频率和开环增益，因 此，可以在不改变稳态精度的情况下，改善系统的快速性和动态平稳性，但是微分环节同时还会 引入高频噪声，对系统不利。
　　积分环节的引入可以增加系统的型别，减小或消除稳态误差，但同时会降低系统的稳定性， 从而影响系统的动态性能。
　　比例、微分和积分环节的单独引入可以改善系统的性能，但同时也会给系统带来不利的影 响。因此，将比例―积分一微分综合起来，适当选择三者的系数，就可以达到改善系统动态和稳 态性能的效果。其典型控制系统结构如图3.6.4所示。
　　　　　　　　　　
图3.6.4 具有比例一积分―微分控制的典型系统结构图




3.7    线性系统时域法的应用

3.7.1   利 用MATLAB    研 究 时 域 法
在 MATLAB    中很容易求得闭环系统特征方程所有的根，因此，由根的分布情况判断系统的


稳定性。
设系统的传递函数为












(3.7.1)

用 MATLAB    判断系统的稳定性可由下列语句完成。
num=[1234];
den=[135            79       11];
roots(den)
运行上述命令后可得其特征根为
ans=
-1.8570
-1.0562+1.3126i
-1.0562―1.3126i
0.4847+1.3609i
0.4847-1.3609i
由此可见，该系统具有两个正实部根，系统不稳定。
　　在分析控制系统时，比较关心在典型信号的作用下的性能指标，MATLAB   为此提供了丰富 的函数。
(1)单位脉冲响应函数： y=impule(sys,t)。
(2)单位阶跃冲响应函数： y=step(sys,t)。
(3)任意输入响应函数： y=lsim(sys,u,t,xO)。
当不带输出y 时，各函数可直接绘制响应曲线。其中sys  为系统的传递函数；t  可设定仿真


时间；u 为输入函数；x0 用于设定初始状态，默认为0。
　　　　　　　　　　　　　　




(3.7.2)

下面以式(3.7.2)描述的系统为例，分析该系统的单位脉冲响应、单位阶跃响应和单位斜坡


响应。
　MATLAB  文本如下： num=[172424];
den=[110253024];
sys=tf(num,den);
roots(den)
figure(1)
impulse(sys,10);
grid on;
figure(2)




%分子多项式
%分母多项式
%闭环传递函数模型
%计算特征根判断稳定性
%求取系统的单位脉冲响应



step(sys,10);
grid   on;
figure(3)
u=0.0:0.01:10.0;
t=u;
lsim(sys,u   t   0);
grid   on;
运行上述命令后可得其特征根为	% 求取系统的单位阶跃响应


%定义斜坡信号

% 求取系统的单位斜坡响应
	ans=
―6.9539
―2.0000
―0.5230+1.2050i
―0.5230+1.2050i
可知该系统是稳定的。
　　该系统的单位脉冲响应、单位阶跃响应和单位斜坡响应如图3 . 7 . 1所示。从图3 . 7 . 1(b)   可 得系统的超调量σ%=28 . 8%,调节时间t?=6.09(s)(△=2%)。
　　　　　　　
T/s                                                                   T/s
(a)                                                                    (b)
斜坡响应









0
T/s
(c)
图3.7. 1 系统典型输入作用下的响应曲线
(a) 单位脉冲响应；(b)  单位阶跃响应；(c)  单位斜坡响应。




3.7.2   时域分析法的设计实例
已知某飞机在等速直线水平运动下的小扰动线性化的飞机纵向运动方程为(未考虑油门杆位移) (s+X)△V+X△a+X?△θ=-X。△δ
Z△V+(s+Za)△α―(s+Z?)△θ=-Z。△δ。
M△V+(Ms+M)△α+(s2+Ms)△θ=―M.△δ。
其气动导数如表3.7.1所列，控制系统结构如图3.7.2所示。
表3.7.1 某型飞机的纵向气动导数

M(马赫数)	H/m	Vo/(m/s)	X?/(1/s)
0.8	5000	256.42	0.0084
Z。/(1/s)	M?/(1/s2)	M:/(1/s)	Ma/(1/s2)
0.17877	0.05693	0.55347	5.38778
X。/(1/s)	Xg/(1/s)	Zv/(1/s)	Z./(1/s)
―0.01414	0.03822	0.086	0.90794
M?/(1/s)	M;/(1/s2)	θo/rad	ao/rad
1.15826	15.19072	0.04241	0.04241

　　　　　　　　　　
图3.7.2 典型飞机俯仰角控制系统结构图
要求：(1)求取纵向俯仰通道的传递函数G& 。;(2)已知速率陀螺的增益 K 。=1.0,  求系统稳定的 K。的取值范围；(3)利用MATLAB  分析当k=10    时单位阶跃响应及性能指标。
　　解(1)飞机纵向俯仰通道传递函数。由于速度变化增量△V=0,  且将式(3.7.3)的切向力 (垂直方向)方程删除后(该方程不影响飞机俯仰运动),可得
　　　　　　　　　　　　
将各气动导数代入并进行拉普拉斯变换，可得相应的传递函数形式为
　　　　　　　　　　　　　　　
(2)由图3.7.2可得系统的闭环传递函数为
　　　　　　　



所以D(s)=s?+22.6s3+358.4s2+(384+300K。)s+256K?=0。      列写劳斯表如下：
　　　　　　　　
由此可知，要使系统稳定必须要K?>0   且
K?>0
(3)已知系统的闭环传递函数为
　　　　　　　　　
则编写如下程序获得系统的阶跃响应。


num=[3000     2560];
den=[122.6358.433842560];% sys=tf(num,den);
step(sys,     2);



%分子多项式 分母多项式
%闭环传递函数模型
%求取系统的单位阶跃响应

grid    on;
　　　图3.7.3为俯仰姿态回路的阶跃响应，由图可得系统的超调量σ%=18.9%,调节时间t?= 1.03(s)(△=2%)。
阶跃响应
　　　　　　　　　　　
T/s
图3.7.3 俯仰姿态回路阶跃响应

本 章  小 结
　　　本章首先给出了控制系统稳定性的定义，讨论了利用劳斯稳定判据进行判稳的方法和步骤， 在此基础上，分析了典型一阶系统、二阶系统动态时域性能指标的近似计算方法、一般控制系统  的稳态精度的计算方法和补偿方法以及常用的时域校正方法等。最后以某型飞机俯仰通道控制  系统为例，详细介绍了典型时域分析的操作步骤。通过本章的学习可以熟练掌握以下内容：
(1)掌握劳斯稳定判据，特别是两种特殊情况下劳斯表的处理方法。



　　(2)了解线性定常系统时域性能分析的基本内容，掌握典型输入信号形式及性能指标的定 义；掌握一阶、二阶系统的阶跃响应，熟练运用公式计算其性能指标。
　　　(3)掌握稳态误差的概念，能够熟练计算典型输入及扰动作用下，不同类型系统的稳态误 差。了解减小稳态误差的措施。
(4)结合实际控制性能指标的要求，能够熟练运用PID 进行控制系统的校正。
课后练习题


3-1   设系统结构如图所示，试确定闭环系统的稳定性。 3-2   某反馈控制系统的方框图如图所示，试求：   R(s)
(1)闭环传递函数；
　　　(2)判别系统稳定性，并求不在左半 s 平面 的特征根数。
3―3  已知单位反馈系统的开环传递函数为
　　　　　




C(s)



S+1
3-1题图


　　　　　　　　
3―2题图
(1)系统稳定时，试确定K 的取值范围。
(2)若要求闭环极点在s=-1     左边，试确定K 的取值范围。
3-4   已知一阶环节的传递函数为 ,若采用负反馈的方法将调整时间t,  减小为 原来的0.1倍，并且保证总的放大系数不变，试选择kH 和 k。的值。
　　　　　　　　　　　　　
3-4题图
3-5   图(a) 为系统结构图，图(b) 为某典型单位阶跃响应，试确定k?、k?、a的值。 3―6  已知系统的结构图如图所示，若r(t)=2・1(t)         时，试求：
(1)k=0       时，系统的超调量σ%和调节时间ts;
(2)当k≠0    时，若要使?%=20%,试求kj,  并求出此时的调整时间t, 的值；
(3)比较上述两种情况，说明内反馈kgs 的作用。





R(s)
k?


(a)                                                       (b)
3-5题图
(a) 系统结构图；(b) 阶跃响应曲线。
　　　　　　　　　　
3―6题图
3-7   电机控制系统如图所示。系统参数为T=0.1,J=0.01,k;=10。
(1)设干扰力矩Ta=0,   输入θ,(t)=t,    试问k 和k, 的值对稳态误差的影响。
(2)设输入θ,(t)=t,   试问当干扰力矩Ta 为单位阶跃函数时，k 和k? 的值对稳态误差的影响。
　　　　　　　　　　
3-7题图
3-8   某单位反馈随动系统的开环传递函数为 ,试计算闭环系统的动态 性能指标σ%和t, 值。
3-9     已 知 某 单 位 负 反 馈 系 统 闭 环 传 递 函 数 分 别 为
,试求系统的稳态位置误差系数、稳态速度误差系数和稳态加速度误差系 数，并求r(t)=10+5t        作用下的稳态误差。
3-10   如图所示系统，试求：
(1)当r(t)=0,n(t)       =1(t) 时，系统的静态误差e;
( 2 ) 当r(t)=1(t),n(t)=1(t)           时，系统的静态误差es;
　　　　　　　　　　
3-10题图



(3)若要减少e,   则应如何调整K? 、K?;
(4)如分别在扰动点之前或之后加入积分环节，会有何影响?
3-11   复合系统的方框图如图所示，前馈环节的传递函数  当输入r(t)    为 单 位加速度信号时，为使系统的静态误差为0,试确定前馈环节的参数a 和b。
　　　　　　　　　　　
3-11题图
3-12   已知系统结构如图所示。
(1)要使系统闭环极点配置在―5±5j处，求相应的K? 、K? 值 ；
(2)设计G?(s),   使之在r(t)  单独作用下无稳态误差；
(3)设计G?(s),   使之在n(t)  单独作用下无稳态误差。
　　　　　　　　　　　
3―12题图
3―13  设控制系统结构如图所示，其中K?、K?   为正常数，β为非负常数。试分析：
(1)β值对系统稳定性的影响；
(2)β值对系统阶跃响应动态性能的影响；
(3)β值对系统斜坡响应稳态误差的影响。
3-14   已知控制系统结构图如图所示。
　　　(1)当不存在速度反馈(b=0)   时，试确定单位阶跃输入时系统的阻尼系数、自然频率、最大 超调量以及由单位斜坡输入所引起的稳态误差。
　　(2)确定系统阻尼比等于0.8时的速度反馈常数b 的值，并确定在单位阶跃输入时系统的 最大超调量和单位斜坡输入所引起的稳态误差。


　
3-13题图



R(s)              E(s)
55+4) bs
3-14题图



C(s)



3-15   已知系统结构图如图所示，单位阶跃响应的?%=16.3%,峰值时间tp=1s。 试求：
(1)开环传递函数G(s);
(2)闭环传递函数Φ(s);
(3)根据已知性能指标σ%及tp 确定参数K 及τ;
(4)计算斜坡输入(斜率R=1.5(°)/s) 时系统的稳态误差。
3-16   某控制系统结构如图所示，G?(s)  的单位阶跃响应为
( 1 ) 若r(t)=20×1(t),          求系统稳态输出c(∞);
(2)r(t)=20×1(t),  求系统超调量g%、 调节时间t,和稳态误差es;
　　　( 3 ) 若n(t)为可测量的阶跃扰动信号，为消除扰动对稳态输出的影响，试设计顺馈补偿装置 Gn(s),并画出相应的系统结构图。
　　　　　　　　　　　　　　　　　　　　　　
3―17  系统结构图如图(a) 所示，其单位阶跃响应为c(t),    如 图(b)  所示，系统的稳态位置误差 es=0 。 试确定K 、v和 T 值 。
c(1)
R(s)
10
初始斜率=10

0                          1
(a)                                                              (b)
3―17题图 系统结构图及单位阶跃响应
3-18   已知某单位负反馈系统开环传递函数为,试分别确定系统在 r(t)=sinwt      作用下的稳态误差。
3-19   设复合控制系统结构如图所示。
(1)计算当n(t)=t     时系统的稳态误差；
　　　　　　　　　　
3-19题图
(2)设计K.,  使系统在r(t)=t     作用下无稳态误差。







第   4   章    线性系统的根轨迹法


本  章  提  要

　　　本章研究一种分析和设计线性系统的图解方法―根轨迹法。首先研究闭环零、极点和开环 零、极点的关系，得到根轨迹方程；其次给出以开环增益为可变参数时绘制根轨迹的基本法则；接 着又给出以非开环增益为可变参数时绘制广义根轨迹的方法，讨论如何通过根轨迹定性地分析 和定量地估算系统性能；最后介绍如何应用根轨迹法设计超前、滞后和超前―滞后控制器对系统 进行校正，使其满足瞬态和稳态性能要求。

4.1    引     言

　　　从前面的章节中可知，闭环系统的极点在s 平面的位置决定系统的稳定性和瞬态响应。通 过调整开环系统某些参数，可以使得闭环系统的极点位于s 平面期望的位置，从而满足控制系统 的设计要求。因此，研究系统的某些参数改变时，对系统闭环极点在s 平面分布趋势的影响，有 助于分析和设计控制系统。
　　控制系统的基本性能主要是由其特征方程的根，也就是闭环传递函数的极点决定的。但当 系统高于三阶时，求根是困难的，特别是当研究系统中某些参数变化对特征根的影响时，需要反 复的求根计算，这就更加麻烦了。
　　　本章介绍一种求闭环系统极点的图解方法，称为根轨迹法。根轨迹法由W.R.Evans      提 出 ， 根据系统开环极点和零点，按照一定的规则，画出在某一个或几个参数变化时系统闭环极点分布  变化的趋势。在现代的控制系统设计中，由于MATLAB    提供的便利，控制工程师不再需要手工  精确绘制根轨迹，但是懂得动态补偿如何影响根轨迹的分布和能够绘制根轨迹的草图有助于控 制系统的设计同时能够及时发现计算机仿真中可能出现的错误。
4.2    根轨迹法的基本概念

　　定 义 4 .2.1  根轨迹是指当系统中某个参数(如开环增益K) 从零变到无穷大时，闭环特征 根 在s 平面上移动的轨迹。
例4 . 2 . 1  为了具体说明根轨迹的概念，以图4.2. 1所示的二阶系统为例，分析开环增益K
从零变化到无穷大时，闭环特征根在s 平面上移动的路径及其特点。
C(s)
一         50.25+1)

图4.2.1 二阶系统结构图



解  图4.2.1系统的开环传递函数为
　　　　　　　　　　　　　　
它有两个极点，p?=0,p?=-4,          没有零点，式中K 为开环增益。其闭环传递函数为
　　　　　　　　　　　　　　　
所以系统的特征方程为
D(s)=s2+4s+4K=0
特征方程式的根，即闭环传递函数的极点为
S1=-2+2√ 1-K,sz=-2-2√ 1-K
以上两式表明，特征根s1和 s? 是随着开环增益K 值的改变而变化的。
当 K=0   时 ，s?=0,s?=―4;         当 K=1    时 ，s?=-2,s?=―2;            当 K=2    时 ，s?=-2+j2,s?=
―2―j2; 当 K=∞   时 ，s?=-2+j∞,s?=-2―j∞。
K 从0变化到无穷大时，闭环极点在s 平面上移动的路径如图4.2.2所示。这就是该系统


的根轨迹。
　　　根轨迹图直观地表明了参数K 变化时，闭环极点所发生的 变化，因此，根轨迹全面描述了参数K 对闭环极点的影响。
有了根轨迹就可以分析系统的各种性能：
　　　(1)稳定性。根据开环增益K 从零变化到无穷时，图4.2.2 所示的根轨迹均在左半s 平面，可知该系统对所有 K>0   的 值 是稳定的。
　　　(2)稳态性能。因为开环传递函数有一个极点位于坐标原 点，所以属于I  型系统，阶跃作用下的稳态误差为0。速度误差 系数就是根轨迹上对应的K 值。如果给定了系统在速度信号 作用下的稳态误差要求，则由根轨迹图可以确定闭环极点位置 的容许范围。
　　　(3)动态性能。由图4.2.2可知，当0<K<1     时，两个闭 环极点都是负实数，系统呈过阻尼状态，其阶跃响应为非周期




K→∞         J

K=5
K=2
K=0               K=1
　　　-2   0 K=2
K=5
K→ 0
图4.2.2 例4.2.1系统的 根轨迹图

　过程；当K=1   时，两个负实数的闭环极点重合，系统呈临界阻尼状态，其阶跃过程仍为非周期过 程，但响应速度较0<K<1     时为快；当K>1    时，闭环极点为共轭复数，系统呈欠阻尼状态，阶跃 响应为衰减振荡过程，且超调量将随K 值的增大而加大。
　　　上述分析表明，根轨迹与系统性能之间有着密切的联系。但是，用直接解闭环特征根的办法来 绘制根轨迹是很麻烦的。根轨迹法的思路是：依据控制系统开环与闭环传递函数的确定关系，通过 开环传递函数直接绘制闭环根轨迹。为此，必须先研究闭环零、极点和开环零、极点之间的关系。
4.2.1   闭环零、极点与开环零、极点的关系


控制系统的典型结构图如图4.2.3所示，其闭环传递函数为
　　　　　　　　　　　　　　　　



(4.2.1)




　　　　　　　　　　　　　　　　
图4.2.3 控制系统的典型结构图
式中：G(s)H(s)     为开环传递函数。
一般情况下，前向通道传递函数G(s) 和反馈通道传递函数H(s) 可分别表示为

(4.2.2)


式 中 ：KG 为前向通道增益；K:   为前向通道根轨迹增益。它们之间的关系为




以 及





(4.2.3)


(4.2.4)

式 中 ：K    为反馈通道根轨迹增益。于是，图4.2.3所示系统的开环传递函数又可表示为


(4.2.5)

式 中 ：K*=KKA          称为开环传递函数根轨迹增益，它与开环增益 K  之 间 的 关 系 类 似 于 式
　(4.2.3),仅相差一个比例常数；z;(i=1,2,…,f)          和 z;(j=1,2,…,l)            分别为前向通道和反馈通 道传递函数的零点；p;(i=1,2,…,q)  和 p;(j=1,2,…,h)   分别为前向通道和反馈通道传递函数 的极点。对于有m 个开环零点和n 个开环极点的系统，必有 f+l=m    和 q+h    =n。 将式(4 .2 .
2)和式(4.2.5)代入式(4.2.1),得
　　　　　　　　　

(4.2.6)

比较式(4.2.5)和式(4.2.6),显然可得到如下结论：
(1)闭环系统的根轨迹增益，等于开环系统前向通道的根轨迹增益；对于单位反馈系统，闭



环系统的根轨迹增益就等于开环系统的根轨迹增益。
　　(2)闭环系统的零点由前向通道的零点和反馈通道的极点构成；对于单位反馈系统，闭环零 点就是开环零点。
(3)闭环极点与开环零、极点及根轨迹增益均有关。
　　　根轨迹法的基本任务就在于，如何由已知的开环零、极点分布，通过图解的方法，找出闭环极 点的分布，并绘制出根轨迹。然后，根据给定的开环根轨迹增益，找出相应的闭环极点。 一旦闭 环极点确定之后，闭环传递函数的形式便完全确定，于是就可以分析和估算系统的性能了。
4.2.2    根 轨 迹 方 程
绘制根轨迹，实质上就是求闭环系统特征方程1+G(s)H(s)=0        的根。因此，满足方程式
G(s)H(s)=-1                                                                          (4.2.7)
　的 s 值，都必定是根轨迹上的点。假定开环传递函数中有m 个零点和n  个极点，式(4.2.7)可写 成零、极点形式，即

(4.2.8)

式 中 ：z; 为已知的开环零点；pi为已知的开环极点；K* 可以从零变化到无穷。式(4.2.8)为根轨 迹方程，因此G(s)H(s)     为复变量s 的函数，所以上式为一个矢量方程，直接使用很不方便。根据
-1=1 ・ei(2k+1)π            k=0,±1,±2, …
根轨迹方程可以用以下两个方程表示，即模值方程

(4.2.9)

和相角方程


　　　　　　　



k=0,±1,±2, …


(4.2.10)

复平面上的s 点如果是闭环极点，则它与开环零、极点所组成的矢量必然满足以上两个方程。
　　　从这两个方程可以看出，模值方程和增益 K* 有关，而相角方程和K* 无关。满足相角方程 的 s 值代入模值方程，总可以求得一个对应的 K* 值。而且满足相角方程的s 值，必定也同时满 足模值方程。所以相角方程是决定闭环系统根轨迹的充分必要条件，这就是说绘制根轨迹时只 要依据相角方程，而模值方程只是在确定根轨迹上各点对应的K*  时使用。
如何应用根轨迹方程绘制根轨迹，先看一个例子。设开环传递函数为
　　　　　　　　　　　　　　
其中开环零、极点分布如图4.2.4所示。
　　如果在s 平面任取 一 点s?,  画出从各开环零、极点到s1 的矢量，则可根据相角方程判断s1 是 否在根轨迹上。如果下式成立



41―(θ?+θ?+θ?)=(2k+1)π,k=0,±1,±2, …
则 s1 是根轨迹上的点。上式中，φi 代表矢量z1s1与正实 轴的夹角，θ;(i=1,2,3)      代表各开环极点到s?  矢 量 与 正 实轴的夹角，如图4.2.4所示。
当 s? 点是根轨迹上的一点时，其对应的开环根轨迹


增益K    即可根据模值方程决定
　　　　　　
即
　　　　　　　　　








的零极点分布图

式中：A、B 和C 代表各开环极点到s?  点的矢量模值；D 代表开环零点到s?  点的向量模值，如图
4.2.4所示。
综上所述，应用根轨迹方程绘制根轨迹的基本方法包括以下两步：
　　　(1)在s 平面上找到满足相角方程的所有s; 点，并把这些点连成光滑曲线，即为K* 从 0 变 到无穷时系统的根轨迹。
　　　(2)针对开环传递函数中给定的K* 值，在根轨迹上找出满足模值方程的s;点，这就是所要 求的闭环极点。
　　　显然，在s 平面上用这种逐点试探的方法绘制根轨迹是不现实的。实际上，根轨迹受某些规 律的支配。Evans 发现了这些规律，提出了一套绘制根轨迹的法则，从而使根轨迹的绘制工作大 大简化。
4.3   根轨迹绘制的基本法则

　　本节介绍绘制根轨迹的基本法则和闭环极点的确定方法。在下面的讨论中，假定所研究的 变化参数是开环增益 K( 或K*)。
4.3.1   绘 制根轨迹的基本法则
　　　法 则 1 根轨迹的分支数：根轨迹的分支数等于闭环特征方程的阶数n,或者说等于开环极 点数n。
　　证明  物理可实现的系统，其开环传递函数的极点数n 总是大于或等于零点数m,  所以特征 方程必为n 阶 。n 阶的特征方程必定有n 个特征根，当开环增益K 由0变到无穷时，特征方程的 某些系数发生连续变化，所以这n 个特征根也随K  的变化而连续变化，自然出现n 条根轨迹。
法则2 根轨迹的对称性：根轨迹对称于实轴。
　　　证明 实际系统特征方程的系数都是实数，而具有实系数的代数方程，其根或者是实数或者 是共轭复数，或者是两者的结合，所以根轨迹对称于实轴。
根据对称性，只需绘出上半s 平面的根轨迹，下半s 平面的根轨迹可由对称关系绘出。
　　　法则3 根轨迹的起点与终点：根轨迹起始于开环极点，终于开环零点。若开环零点数  小 于开环极点数n, 则有n―m条根轨迹分支终于无穷远处。
证明 根轨迹的起点是指K*=0    时的根轨迹，由根轨迹方程式(4.2.8)可得



　　　　　　　　　　　　　　　　　
当 K*=0  时，上式右端为无穷大，可见，等式只有当s→pi 时才成立，所以根轨迹起于开环极点。
　　　根轨迹的终点是指K*→∞   时的根轨迹，当K*→∞    时，上式右端为0,可见，等式只有当s→  z;时才成立，所以根轨迹终于开环零点。人们常把这些具有有限数值的开环零点叫做有限 零点。
　　　当 n>m   时，只有m 条根轨迹分支趋向于有限开环零点，还有n―m  条根轨迹分支趋向于何 处 呢 ? 由 于n>m,   当 s→∞  时，上式可以写成
　　　　　　　　　　　　　　　　　
　可见，当K*→∞   时 ，s→∞上式才成立，所以有 n―m  条根轨迹趋向无穷远处。人们常把无穷远 处视为无限开环零点。
法 则 4  实轴上的根轨迹：在实轴上，自右向左数，
凡奇数零极点左边的一段实轴是根轨迹。
　　　证明  设开环零、极点分布如图4.3. 1所示。对  实轴上的任一 点s?  来说，其左方的实数零、极点到s1   点的相角总是零，共轭零、极点到s1 点的相角之和也是 零，只有位于s?  点右边的零、极点到s1 点的相角为π。 由此可知，对实轴上零、极点，自右向左数，只有奇数 零、极点左边的一段实轴满足相角方程，所以是根  轨迹。
法 则 5 根轨迹的渐近线：当开环极点数n 大于开
环有限零点数m 时，将有n-m    条根轨迹分支沿着渐近线趋向无穷远处。渐近线与实轴正方向 的夹角为φa,  与实轴的交点为σa,且 有
k=0,±1,±2,…,n―m-1
和

(4.3.2)
　　证 明 渐近线就是s 值很大时的根轨迹。若sa 为距原点无穷远处的一个特征根，则s  平 面 上所有开环零点z;  和极点p: 到 sa 点矢量的相角可以看作是相等的，即
∠(sa―zi)=∠(sa          一pi)=4a

把上式代入相角方程，得


即





mqa―nqa=(2k+1)π



于是，有
k=0,±1,±2,…,n-m-1
　　　同理，当sa是距原点无穷远处的一个特征根时，则s 平面上所有开环零点z; 和极点p; 到 s。 点的矢量长度都相等，于是，可以认为对无穷远处的闭环极点sa 而言，所有的开环零、极点都汇 集在一起，其位置为 σa 。它就是所求的渐近线与实轴的交点。为了计算 oa, 将模值方程式

　　　　　　　　　　　
根据以上分析，当s=sa=∞  时 ，z;=p;=σa, 则上式可近似写成
　　　　　　　　　　
其 中
(s―σa)”m=s""+(n-m)                   (一 σa)s"m-1+ …
根据两个分母多项式第二项系数相等，得
(n―m)     (一σa)=a?―b?
其 中
　　　　　　　　　　　　　　　
故
　　　　　　　　　　　　　　　　　


图4.3.2绘出了如下不同系统根轨迹的渐近线。
J

180°60°
   0


(a)                              (b)





(c)



j

108° 36°



(d)

图4.3.2 不同系统根轨迹的渐近线
　　　　　　　　　　
　　　　　　
法 则 6  根轨迹的分离点：l 条根轨迹分支在s 平面上相遇后又立即分开的点，称为根轨迹



的分离点(或会合点),分离点的坐标d 是下列方程的解，即
(4.3.3)
　因为根轨迹是对称的，所以根轨迹的分离点或出现在实轴上，或共轭成对地出现在复平面中，但 以实数分离点最为常见。例如，若在实轴上的两个相邻开环极点之间是根轨迹，则在这两个极点 之间至少存在着一个分离点，如图4.3.3中的d?   所示；若在实轴上的两个相邻开环零点之间(其 中一个可以是无限零点)是根轨迹，则在这两个零点之间至少存在一个会合点，如图4.3.3中的 d?  所示。由图4.3.3可见，根轨迹的分离点，实质上是当K ( 或K*) 为某一特定值时，闭环系统
特征方程出现重根的数值。
　　证 明  由式(4.2.6)可知，闭环系统的特征方 程为
　　　
若根轨迹在s 平面上相遇，说明特征方程有重根。设 重根为s=d,    根据代数方程中出现重根的条件，有
　　
因此，以上两式可分别写成
图4.3.3 实轴上根轨迹的分离点


　　　　　　　　　　　　
用式(4.3.4)除式(4.3.5),得
　　　　　　　　　　　　　
由式(4.3.6)即得
　　　　　　　　　　　　　　　　
于是，本法则得证。从上式中解出s, 即为分离点的坐标d。



(4.3.5)



(4.3.6)

　　　应当指出，分离点方程往往是高阶方程，用解析法求解十分不便，因为分离点的位置大致是 知道的，故实际应用时，常用试探法求解。另外，由式(4.3.3)解出的d  值可能有多余的，应舍弃 不在根轨迹上的d 值 。
例如，在图4.2.2的根轨迹中，由于开环传递函数 ,根据式(4.3.3),有
　　　　　　　　　　　　　　　　　　
解出分离点的坐标d=-2,       它正是K=1   时，闭环特征方程的两个重实根。 又如，设开环传递函数



　　　　　　　　　　　
其开环零、极点分布如图4.3.4所示。由法则1～6可知，本例有两条根轨迹分支，起于开环极点 -1+j     和―1―j, 一条终于开环有限零点―2,另一条终于无限零点一∞。在实轴上(一 ∞,-2) 区间的根轨迹部分，必存在一个会合点d 。d  值可按式(4.3.3)解出，即
　　　　　　　　　　　　　　　
经整理得
d2+4d+2=0
这是一个二阶分离点方程，用解析法求得d?=―3.41   和 d?=  -0.59 。  显 然 ，d?   应舍去，分离点 d=-3.41。
　　应用相角方程可画出本例系统的准确根轨迹，如图4.3.4所示，其复数根轨迹是圆的一 部分。
　　　从图4.3.3和图4.3.4可以看出，仅由两个极点 (实数极点或复数极点)和一个有限零点组成的开环系 统，只要有限零点没有位于两个实数极点之间，当K
从零变到无穷时，闭环根轨迹的复数部分，是以有限零 点为圆心，以有限零点到分离点的距离为半径的圆或 圆的一部分。该结论可作为法则应用，因为它在数学 上可以得到严格的证明。
　　　下面说明分离点(会合点)处根轨迹分支之间的互 相夹角问题。如果有l 条根轨迹分支进入分离点，必然
有 l 条根轨迹分支离开分离点，则两条相邻的根轨迹分
支，进入分离点处切线的相互夹角称为会合角，用λ表示，且
(4.3.7)
而每一条离开分离点的根轨迹分支，和相邻的一条进入分离点的根轨迹分支，在分离点处切线的 相互夹角称为分离角，用θ1表示，且
(4.3.8)
λz 和θ1分别如图4.3.5(a) 、(b) 所示。
　　法 则 7  根轨迹的起始角与终止角：起于开环复极点的根轨迹，在起点处的切线与正实轴的 夹角，称为根轨迹的起始角，以 θa 表示。终止于开环复零点的根轨迹，在终点处的切线与正实轴 的夹角，称为根轨迹的终止角，以φu表示。它们可按以下公式求出
(4.3.9)

(4.3.10)
　　应该说明，为了比较准确地画出根轨迹，需要找出开环复数零、极点附近的根轨迹方向，所以 只对复数零、极点才有起始角和终止角的问题。




　　　　







K=∞
-6  -5  -4


j  6
K=0
0

-6


K=∞
K=30


0.5

K=30
K=∞

(a)                                                                     (b)
图4.3.5 分离点处根轨迹之间的夹角
　　证明  设开环系统有m 个零点和n 个极点。在无限靠近待求起始角(或终止角)复极点(或 复零点)的根轨迹上，取一点s1 。由于无限接近于所求起始角的复数极点pi(或所求终止角的复 数零点z?), 因此，除 p? ( 或 z?) 外，所有开环零、极点到s?  点的矢量相角 )和 	,都可以用它们到p ( 或z?) 的矢量相角(或 z;))  和 ( 或 来代替，而p ( 或z) 到 s1点的矢量相角即为起 始角θ(或终止角φ)。根据s?  点必须满足相角方程，应有
　　　　　　　　　　
和
　　　　　　　　　　
移项后，立即得到式(4.3.9)和式(4.3.10)。
例如，开环系统的零、极点分布如图4.3.6所示，由本法则可知，图(a) 中系统的起始角为
θp?=(2k+1)π+∠(p?―z1)-∠(p?-p2)-∠(p?                                  一 p?)
图(b) 中系统的终止角为
4<1=(2k+1)π+∠(z1―p1)+∠(z1―p2)-∠(z?―z2)
　　　　　　　　　
(a)                                                 (b)
图4.3.6  根轨迹的起始角和终止角



　　　法则8 根轨迹与虚轴的交点：若根轨迹与虚轴相交，则交点处的K* 值 和w 值可以令闭环 特征方程中的s=jw,   然后分别取实部和虚部等于0求得。
　　证明 根轨迹与虚轴相交，意味着闭环极点中有一部分极点在虚轴上，即闭环特征方程有纯 虚根士jw,系统处于临界稳定状态。因此，将s=jw  代入闭环特征方程，得
1+G(jw)H(jw)=0
然后分别令其实部和虚部为0,即可解出w 值及系统临界稳定时的开环增益K.。
　　　根据以上这些法则，只需经过简单的计算就可以绘出概略的根轨迹。在控制系统的初步设 计阶段，只要有了概略的根轨迹，就足以用来分析和近似估算系统的性能。因此，熟练地掌握这 些法则，对于分析和设计系统是十分重要的。
　　　如果需要准确地计算系统的性能，就要获得准确的根轨迹，然后在准确的根轨迹上求闭环极 点。由于根轨迹上的点都应满足相角方程，因此，只要在概略根轨迹上或其周围取实验点，将符 合相角方程的各点连成光滑曲线，即得准确的根轨迹。
　　　最后，应当指出，在应用这些法则绘制根轨迹之前，首先应当把开环传递函数写成零、极点形 式。为了便于用图解法进行计算，根轨迹图的横、纵坐标应采用相同的比例尺。
下面举例说明如何应用根轨迹法则绘制根轨迹。
例4.3.1 已知单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　
试绘制K*由0 → ∞时系统的概略根轨迹。
解  开环极点数n=4,p?=0,p  ?=-3,p3,4=-1±            j;没有开环有限零点，m=0,  其开环零、
极点分布如图4.3.7所示。下面按法则依次求出绘制根轨迹的有关参数：
(1)实轴上[-3,0]区间为根轨迹。
　　　　　　　　　　　　

图4.3.7	例4.3.1的开环零极点分布与根轨迹
(2)由于n=4,m=0,n―m=4,	故有4条根轨迹分支，并都趋向无穷远处。
(3)4条根轨迹的渐近线，其
　　　　　　　　　　　
　　　　　　　



可见，4条渐近线为通过―1.25这一点，与正实轴分别成±45°、±135°的4条射线。
(4)求分离点坐标d,  本例没有有限零点，故式(4.3.3)中，有
　　　　　　　　　　　　　　　　　　
于是，分离点方程为
　　　　　　　　　　
用试探法算出d≈-2.3。 分离角为
　　　　　　　　　　　　　　　　　
　　　(5)求起始角。因为开环传递函数有一对共轭复数极点p3.4,需 求 p3.4处根轨迹的起始角， 根据式(4.3.9),有
　　　　　　　　
(2k+1)π-∠(p?           一p?)-∠(p?        一p?)-∠(p?―p4)
通过量角器测量或计算可得
θp?=(2k+1)×180°―135°―26.6°―90°
取 k=0, 则 θp?=-71.6°。 由根轨迹的对称性可知，p?  =71.6°。
(6)求根轨迹与虚轴的交点。由开环传递函数求出系统的特征方程 D(s)=s?+5s3+8s2+6s+K*=0
令上式中的s=jw,   得
D(jw)=(jw)?+5(jw)3+8(jaw)2+6(jw)+K*=0
其实部和虚部两个方程为
　　　　　　　　　　　　　　　　　
联立求解，即得
和
显然，w=0  和 K*=0     不是所求之解，因此根轨迹与虚轴交点处的w=±1.1,     而对应的K*=K:=
8.16。至此，即可绘制出系统的概略根轨迹，如图4.3.7中所示。
4.3.2   闭 环 极 点 的 确 定
　　　根轨迹是随K* 连续变化的，每条根轨迹上的任何一点都对应于某一 K* 值的闭环极点。因 此，对于特定K* 值的闭环极点，应在准确的根轨迹上按模值方程确定。通常，比较简便的方法 是先用实验法确定实数闭环极点的数值，然后用综合除法或根之和根之积的代数方法确定其余 的闭环极点。
例4.3.2  在图4.3.7中，试确定K*=4     时的闭环极点。



解 由 于n=4,m=0,      所以模值方程为
　　　　　　　　　　　　　　　　
即
K*=|s―0|・|s―(-3)|・|s―(-1+j)|・|s―(-1―j)|=4
在实轴上任选s 点，经过几次试探，找出满足上式的闭环实数极点为 S?=―2,S?=―2.52
各矢量模值的取法如图4.3.8所示。
　　　　　　　　　　　　　　　　　　　　　　
图4.3.8 实轴上K*=4  的闭环极点确定方法
因为闭环系统的特征方程为
s?+5s3+8s2+6s+K*=0
将 K*=4,s?=-2,s?=-2.52                 代入特征方程，得
s?+5s3+8s2+6s+4=(s+2)(s+2.52)(s―s?)(s―s?)
于是，有
　　　　　　　　　　　　
应用综合除法，得
(s―S?)(s―s4)=s2+0.48s+0.79
从而解出
S?=―0.24+j0.86,s?=-0.24―j0.86
　在应用综合除法的过程中，通常不可能完全除尽，这是因为在图解过程中不可避免地引入一些 误差。
运用代数方程中根之和、根之积与方程式系数的关系，同样可以求得s?  和 s4 。因为
s?+s?+s?+S?=-5
S1・S?・S3・S4=4
联立解出 s?,4=―0.24±j0.86。
与特定 K* 值对应的闭环极点确定之后，根据闭环零、极点与开环零、极点的确定关系，不难



写出闭环传递函数。例4.3.2中，当K*=4    时的闭环传递函数为
　　　　　　　
有了闭环的零、极点分布，就可以对系统的性能进行定性分析和定量计算了。

4.4   广义根轨迹

　　绘制系统的根轨迹，并非只能以开环增益 K ( 或K*) 为可变参数，它可以是控制系统中的任 何一个参数，如开环某一极点或零点等。因此，在控制理论中，把以非开环增益 K ( 或K*) 为可 变参数绘制的根轨迹称为广义根轨迹或参数根轨迹；而把以开环增益 K( 或K*)  为可变参数绘 制的根轨迹称为常规根轨迹。如果引入等效开环传递函数的概念，则广义根轨迹的绘制方法与 常规根轨迹完全相同。此外，人们还习惯于将零度根轨迹列入广义根轨迹的范围，其零度根轨迹 的由来及绘制法则下面也要介绍。本节主要通过例题讨论广义根轨迹的绘制方法。
4.4.1   参 数 根 轨 迹
　　　如果引入等效开环传递函数的概念，则参数根轨迹的绘制方法与常规根轨迹完全相同。这 里通过两个例题来介绍参数根轨迹的处理方法。
　　　例4 .4 .1  设系统的结构图如图4.4.1所示，图中参数K, 为测速反馈系数。试绘制K, 由 0 → 0 时的根轨迹。

解  由结构图得系统的开环传递函数为
　　　　　　　
　　　本例中变参数K,  并非系统的开环增益，前面有关增 益变化时根轨迹的绘制法则不能直接应用。但是，只要 对闭环系统的特征方程式进行适当的变换，得到一个等 效的开环传递函数，使K,  成为等效开环传递函数的增 益，那么,广义根轨迹的绘制问题就迎刃而解了。
原系统的闭环特征方程式为
s2+2s+10+10K,s=0
用不含 K, 的各项去除特征方程，得



C(s)



1+K,s
图4.4.1 例4.4.1系统的结构图

　　　　　　　　　　　　　　　　　
令
　　　　　　　　　　　
　式中：K;=10K, 。G?(s)       即为等效的开环传递函数。用它构造一个新系统，如图4.4.2所示，则 新系统与原系统具有相同的闭环特征方程，而新系统的开环增益恰为原系统的参数 K,。
　　　根 据G?(s)  的零、极点分布，作 K;   由零变化到无穷时的根轨迹，如图4.4.3所示。它就是 原系统测速反馈系数K, 变化的根轨迹。









R(s)




图4.4.2  等效系统的结构图



j
　　ζ=0.7 K=0.24
　等效开环零点 0
-1-j3
图4.4.3  参数K, 变化时的根轨迹

为进一步说明“等效”的含义，由图4.4.1可知，原系统的闭环传递函数为
　　　　　　　　　　　
由图4.4.2可知，新系统的闭环传递函数为
　　　　　　　　　　　　
　比较Φ(s) 与Φ?(s),   显然，它们仅具有相同的分母，即具有相同的闭环极点，而分子是不同的。因 此，通过等效开环传递函数绘制的根轨迹，只能确定控制系统的闭环极点，其等效的含义仅在于 此。要分析系统的动态性能还要确定系统的闭环零点。必须注意，闭环零点仍然要用原系统的 闭环零点。对于本例原系统没有闭环零点。
　　下面分析参数K, 变化对系统性能的影响。由图4.4.3可以看出，当K, 很小时，闭环一对共轭  复数极点离虚轴较近，系统阶跃响应的超调量较大，振荡较强。这是因为K, 很小时，系统的速度反  馈信号很弱，阻尼程度不够。当K,  加大时，系统阻尼加强，振荡减弱，超调量减小，性能得到改善。 当 K,>0.43     时，两个闭环极点为负实数，系统处于过阻尼状态，阶跃响应具有非周期性。
4.4.2   零 度 根 轨 迹
　　　在复杂的控制系统中，可能会遇到具有正反馈的内回路，如图4.4.4所示。 一般说来，这种 具有正反馈的内回路是不稳定的，因此，整个系统必须通过外回路加以稳定。为了分析系统的性 能，首先要确定内回路的零、极点。当用根轨迹法确定内回路的零、极点时，就相当于绘制正反馈 系统的根轨迹。
　　　　　　　　　　　
图4.4.4 具有正反馈内回路的系统结构图
现讨论如何绘制正反馈内回路的根轨迹。正反馈内回路的特征方程为
1-G(s)H(s)=0
即
G(s)H(s)=1                                                                     (4.4.1)



它就是正反馈系统的根轨迹方程，其模值方程为
G(s)H(s)|=1                                                                    (4.4.2)
相角方程为
∠G(s)H(s)=0+2kπ                                k=0,±1,±2, …                               (4.4.3)
　　　将式(4.4.2)和式(4.4.3)与常规根轨迹的相应公式(4.2.9)和式(4.2.10)对比可知，它们的 模值方程完全相同，仅相角方程有所改变。式(4.4.3)表明，正反馈系统的根轨迹遵循(2k+0)π
　的相角条件，而式(4.2.10)表明，负反馈系统的根轨迹遵循(2k+1)π 的相角条件，所以有时称负 反馈系统的根轨迹为180°根轨迹，而把正反馈系统的根轨迹称为零度根轨迹。
　　既然零度根轨迹与常规根轨迹只是相角方程不同，那么,只要在绘制常规根轨迹的法则中， 修改那些与相角方程有关的部分，就可以用来绘制零度根轨迹。修改部分如下：
　　　(1)实轴上的根轨迹应改为：在实轴上自右向左数，凡偶数零、极点左边的一段实轴是根轨 迹，第一个零、极点右边的实轴也是根轨迹。
(2)根轨迹渐近线与实轴正方向的夹角φa 应改为
               (4.4.4)
(3)计算根轨迹起始角与终止角的公式应改为
k=0,±1,±2, …                              (4.4.5)

k=0,±1,±2, …                           (4.4.6)
绘制零度根轨迹的其他法则与180°根轨迹的法则完全相同。
　　例4 .4.2  设正反馈控制系统的结构如图4.4.5所示，参数K* 的变化范围为0 → ∞,试绘 制系统的根轨迹。
解  由结构图知系统的开环传递函数为
　　　　　　　　　　　　　　　
开环极点数n=3,p?=-1+j,p?=-1-j,p?=-3;                            开环有限零点数m=1,z1=-2,          其开环零、
　极点分布如图4.4.6所示。因为是正反馈系统，所以应该绘零度根轨迹，下面确定绘根轨迹的有 关参数：







R(s)
+


图4.4.5







　　　　　　　　　C(s) (3+3KG2+2+2)



正反馈系统的结构图                   图4.4.6 正反馈系统的根轨迹




　　( 1 ) 由 于n=3, 因此，该系统有三条根轨迹分支分别起于开环极点，其中一条终于有限零点 ― 2,另外两条根轨迹终于无穷远。
(2)渐近线与实轴正方向的夹角φa 按式(4.4.4)计算，即
　　　　　　　　　　　　
上述结果说明，两条渐近线中的一条与正实轴重合，另一条与负实轴重合。
(3)实轴上的根轨迹，根据修改后的法则可知，[ ― 2,+∞]和(一 ∞,-3]区间为根轨迹。
(4)根轨迹的起始角 θn?,按式(4.4.5)计算得
　　　　　　θp=/p?     一z?-/p?     一p2―/p?    一 ps=45°-90°―26.6°=―71.6° 由对称性可知，θp?=71.6°。
(5)确定根轨迹的分离点坐标d,  根据式(4.3.3),有
　　　　　　　　　　　　　
经整理得
(d+0.8)(d2+4.7d+6.24)=0
显然，分离点应位于实轴上，故取d=-0.8;        按式(4.3.8)求出分离角为
　　　　　　　　　　　　　　　　　
　　该正反馈控制系统的概略根轨迹如图4.4.6所示。由根轨迹图可见，坐标原点对应的根轨 迹增益为临界值，可由模值方程求出
　　　　　　　　　
由 于K.=K:/3,        所 以 K 。=1 。 可见，该正反馈系统并不是永远不稳定的，若开环增益K  取 值 在
0与1之间，即使是正反馈系统，仍然能稳定工作，但当K.>1    时，将有一个闭环极点分布在右半
s 平面，系统变为不稳定，当K=1    时，系统临界稳定。分离点处的K:=1.9,Ka=0.63,              可见，当
K 在0～0.63的范围内时，闭环三个极点中有一对共轭复数极点靠近虚轴，其阶跃响应是轻微 的振荡衰减过程。
　　最后应该指出，除了正反馈系统必须绘零度根轨迹以外，某些非最小相角系统也需要绘零度 根轨迹。把在右半s 平面有开环零、极点的系统称为非最小相角系统。如果在非最小相角系统 的开环传递函数中，包含s 最高次幂系数为负的因子，其特征方程必然满足零度根轨迹的相角条 件，所以也应当绘零度根轨迹。
4.5    线性系统的控制性能分析

　　　应用根轨迹法，可以迅速确定出系统在某一可变参数值的闭环零、极点位置，得到相应的闭 环传递函数。 一旦有了闭环传递函数，就可以用拉普拉斯变换法确定出系统的单位阶跃响应和 各项性能指标。但是在系统的初步设计阶段，根据已知的闭环零、极点分布，定性地分析和定量 地估算系统的性能是十分必要的，本节将主要讨论这个问题。




4.5.1   闭环零、极点分布与阶跃响应的定性分析
假设应用根轨迹法写出闭环传递函数为
　　　　　　　　　　　　　　
式中：K    为闭环系统的根轨迹增益；z; 和s;  分别为闭环传递函数的零点和极点，它们可以是实 数，也可以是共轭复数。通过拉普拉斯反变换，可以求出系统的单位阶跃响应为

由此可见，系统的单位阶跃响应是由闭环极点s(k=1,2,…,n)          及系数A   共同决定，而系数A
又与闭环零、极点分布有关。
　　对于一个实际的控制系统，总是希望它的输出量尽可能地按照给定的输入量而变化，要求动 态过程的快速性好，超调量小，振荡次数少。那么,要达到这些要求，闭环零、极点应如何分布呢? 从c(t)  的表达式可以看出以下几点：
(1)首先要求系统稳定，即所有的闭环极点se 必须位于左半s  平面。
(2)要求系统快速性好，应使每个瞬态分量e?  衰减得快，即闭环极点应远离虚轴。
　　　(3)要求系统超调量小，振荡次数少，则离虚轴最近的共轭复数极点，最好位于s  平面中与 负实轴成±45°的夹角线附近。因为由二阶系统的分析可知，共轭复数极点位于±45°线上，对应 的阻尼比ζ=0.707,这时系统阶跃响应的超调量很小，振荡次数少，且快速性也较好。若超过士 45°线，则阻尼比减小，超调量增大，振荡加剧。
(4)要求动态过程尽快消失，还要求系数A   要小，因为 A  越小，对应的分量就越小。由
　　　　　　　　　　　　　　　　　
可知，要使A  小，应使上式分母大、分子小，从而看出，闭环极点之间的距离(sk―S;) 要大，而零点 z; 应靠近极点sk。
　　　一般由于零点数总是少于极点数，故应使零点靠近离虚轴最近的极点。因为离虚轴最近的 极点所对应的瞬态分量Ae2    衰减最慢，对系统的动态过程起决定性作用。如果能使零点靠近 甚至等于极点sk, 则系数A   的值将会很小，甚至等于零。该Ae    分量对动态过程的影响就可 忽略不计。从而对动态过程起决定作用的极点，让位于离虚轴次近的极点，使系统的快速性有所 提高。
　　上述关于闭环零、极点合理分布的原则，为利用闭环零、极点直接对系统动态性能进行分析 提供了依据。
4.5.2   主 导 极 点 与 偶 极 子 的 概 念
　　从上述分析中可知，在闭环极点中离虚轴最近，而且附近又无零点的实数极点或共轭复数极 点，对系统动态性能的影响最大，起着主要的决定性作用，称它们为主导极点。 一般来说，其他极



点的实部是主导极点的实部的6倍以上时，这些极点对系统动态性能的影响可以忽略。在工程 上甚至是主导极点实部的3倍～4倍的其他极点也可以忽略不计。远离虚轴的闭环零点，由于 时间常数很小，对系统的影响也很小，在估算动态性能时，也可忽略。因此，在工程上往往只用主 导极点估算系统的动态性能，从而将高阶系统近似成二阶系统或一阶系统。
　　此外，将一对靠得很近的闭环零点和极点称为偶极子。工程上当某极点sk与某零点z; 之间 的距离，比它们到虚轴的距离小一个数量级时，就认为这一对零、极点为偶极子。当一对零、极点 构成偶极子，又不十分靠近原点时，则对应的分量Ae     很小，而且衰减也较快，故它们对系统动 态过程的影响即可忽略不计。偶极子的概念对控制系统的综合设计是很有用的。可以有目的地 在系统中加入适当的零点，以抵消对动态性能影响较大的不利极点，使系统的性能得到改善。
　　　在工程实践中利用主导极点和偶极子的概念，可以对系统进行近似的分析。例如，某高阶系 统的闭环传递函数为
　　　　　　　　　
闭环系统有4个极点，s?=-1.5,s2=―10,s3,4=―2±j3;  有一个零点，z1=-1.6,  其闭环零、极 点分布如图4.5.1所示。
由上式可以求出，系统的单位阶跃响应为
c(t)=1-0.103e-1.5t―0.165e-10t―1.312e??sin(3t+33.885°)                                (4.5.1)
其响应曲线如图4.5.2中的曲线1所示。计算出该系统的动态性能指标为
tp=1.2(s),t?=1.5(s)
σ%=8.62%,N=0.5              (次)



　　　
图4.5.1 闭环零、极点分布
由式(4.5.1)可见，闭环极点s?=-10



阶跃响应










T/s
图4.5.2 单位阶跃响应曲线
对应的分量衰减很快，所以第三项对动态过程的影响

很小，可忽略不计。故系统的响应可近似为
c(t)=1-0.103e-1.5t―1.312e2sin(3t+33.885°)                                            (4.5.2)
其近似响应曲线如图4.5.2中曲线2所示。并计算出系统的动态性能指标为
tp=1.18(s),t,=1.56(s)
σ%=10.36%,N=0.5              (次)
曲线2和曲线1相比较，除初始阶段相差较大外，其动态过程是很相近的，动态性能指标相



差甚微。
　　如果进一步分析闭环系统的零、极点分布，可以发现，s? 和 z?  靠得很近，且又不靠近原点，已 构成偶极子，这一对零、极点对系统动态过程的作用可以认为是相互抵消的，故可以将它们略去。 于是，高阶系统就可以进一步简化成仅有一对主导极点(-2±j3)的二阶系统，即
　                         (4.5.3) ζ=0.555,wn=3.606
其单位阶跃响应为
c(t)=1-1.202e-2?sin(3t+56.3°)                                                      (4.5.4)
其响应曲线如图4.5.2中曲线3所示。根据欠阻尼二阶系统性能指标的估算公式得
tp=1.05(s),t?=1.5(s)
σ%=12.3%,N=0.5              (次)
　　　比较图4.5.2中曲线3和曲线1,可见，两者很接近，其动态性能指标相差并不大。因此，在 控制系统的初步设计阶段，当闭环系统的零、极点分布满足主导极点和偶极子的条件时，就可以 将高阶系统简化成仅有主导极点的一阶或二阶系统。
4.5.3   用主导极点估算系统的性能
　　　根轨迹法和时域法的实质是一样的，都是用来分析系统的性能。但根轨迹法采用的是图解 的方法，与时域法相比，它避免了烦琐的数学运算，又能看出参数变化对系统性能的影响，用于控 制系统的分析和设计十分方便。更重要的是，对于具有主导极点的高阶系统，用主导极点对系统 进行分析更加简便。因此，根轨迹法常作为一种近似的分析方法，特别适合于工程应用。至于如 何应用主导极点来分析系统的性能，下面举例说明。
例4.5.1 已知单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　　
试用根轨迹法分析系统的稳定性，若主导极点具有阻尼比ζ=0.5,求系统的性能指标。 解  将开环传递函数写成零、极点的形式，即
　　　　　　　　　　　　
式中：K*=2K。
　　　(1)绘制系统的根轨迹。由开环零、极点分布，根据绘制根轨迹的法则，绘制出系统的根轨 迹如图4.5.3所示，绘制根轨迹的相关数据均已标注在图中。
　　　(2)分析系统的稳定性。由根轨迹图可知，当开环增益K>3(K‘>6)        时，根轨迹将有两条 分支伸向右半s 平面，这时闭环系统有一对正实部的共轭复根，系统不稳定。所以要使系统稳 定，开环增益的范围应是0<K<3。
(3)根据阻尼比的要求，确定闭环主导极点s1 和 s2的位置。
　　　首先，在s 平面上作出ζ=0.5时的阻尼线，使其与实轴负方向的夹角β=arccosζ=60°,   阻尼 线与根轨迹的交点为s1 。由根轨迹图可得
S1.2      =―0.33±j0.57



　　　　　　　　　　
图4.5.3 例4.5.1的根轨迹图
利用根轨迹图和模值方程可求出s? 点对应的开环增益K,  因 为
　　　　　　K*=|s?―p11・|s?―p?|・|s?―p?l=0.66×0.88×1.76=1.02 故
K=K*/2=0.51
　　　为了验证s1.2是闭环的主导极点，必须求出K*=1.02     时的第三个闭环极点s? 。 根据系统的 特征方程
D(s)=s3+3s2+2s+K*=0
已 知K*=1.02,s1,2=―0.33±j0.57,             用综合除法可求出s?=-2.34 。    因为2.34/0.33=7. 1,所
以 s1,2是一对共轭闭环主导极点，系统可以近似为二阶系统。由根轨迹图或经过计算得wn=0.
66,ζ=0.5,所以系统的闭环传递函数可近似为
　　　　　　　　　　　　　　　
于是，系统的动态性能指标为
　　　　　　　　　　　　　　　
6%=e√ 1-3×100%=16.3%
　　对于没有主导极点的高阶系统，用根轨迹法分析和设计就十分不便。但随着计算技术的发 展，不仅可以用计算机绘制根轨迹，还可以用计算机对系统进行辅助分析和设计，弥补了根轨迹 法的不足。




4.6    线性系统的根轨迹法校正

　　　根轨迹法校正系统的思想是把校正后的系统近似为一个欠阻尼的二阶原型系统，即闭环系 统只有一对共轭复数极点。这对复极点被视为闭环系统的主导极点，可以通过给定的瞬态性能 指标(超调量、上升时间、调节时间等)计算得到，称为闭环期望极点。根据未校正系统的开环传 递函数绘制根轨迹，如果未校正系统根轨迹通过(或接近)期望极点，说明在开环增益K  为某 一 数值时瞬态性能已满足性能要求，然后考查此处的K 值是否合乎稳态误差要求。如果未校正系 统的根轨迹没有通过(或没有接近)期望极点，那么,说明仅通过调整K 不可能使未校正系统满 足瞬态性能要求。
　　　由此可见，一般情况下，调整增益参数K 不能使系统的瞬态性能和稳态性能同时满足设计 要求。为此，要加入串联校正装置，使校正后系统闭环极点具有最小阻尼比的复数极点与期望极 点相一致或相接近，而其他闭环极点的分布或靠近开环零点构成一对偶极子、或远离虚轴。于 是，除了这对共轭复极点外的其他极点对系统瞬态特性几乎没有影响。但这只是理想情况，实际 校正后系统的零、极点分布很难满足这个要求。因此，通常情况下，需要考虑没有足够远离虚轴 的闭环极点以及没有足够靠近的一对闭环零、极点对系统瞬态性能的影响。
　　本节中，介绍三种主要的校正方式：超前校正、滞后校正和超前―滞后校正。 一个加入校正 装置的控制系统如图4.6. 1所示。
R(s)
G.(s)                      G(s)
一

图4.6.1  加入校正装置的控制系统
校正装置的传递函数可写为
                            (4.6.1)
　其中当a<b   时，零点在极点的右边，称为超前校正；当a>b    时，零点在极点的左边，称为滞后 校正。
4.6.1   超 前 校 正
　　超前校正能够改善系统的稳定性，提高系统的瞬态响应性能。下面通过两个例子来认识超 前校正的作用。
例4.6. 1 考虑一个具有如下开环传递函数的单位反馈系统
　　　　　　　　　　　　　　　　　　
设计一个控制器使闭环系统稳定。
　　解  首先考虑串联一个比例控制器K,  绘 制K  变化时的根轨迹如图4.6.2中的实线所示。 从图中可知，无论如何调整K, 闭环极点始终位于右半平面，即仅通过设计K 不能使闭环系统稳 定。这时考虑串联一个超前校正控制器，即



　　　　　　　　　　　　　　　　　　
此时的开环传递函数为G(s)G(s),     绘制其根轨迹如图4.6.2中的虚线所示。


15

10-
5

0-
―5―
-10
-15L
6









K=0





-5   -4   -3


根轨迹





K=.





　-2    -1 实轴







K=K
K=0×
K=K1




0

图4.6.2  例4.6.1中原系统的根轨迹(实线)和加入超前校正的根轨迹(虚线)
　　在超前校正控制器的作用下，从开环极点0和1出发的根轨迹被拉向了左半平面。设对应 根轨迹与虚轴交点的开环增益 K=K?,     那么,当K>K?     时，闭环极点都位于左半平面，系统稳 定。由此可见，可以通过超前校正将一个不稳定系统校正为稳定系统。
下面再通过一个例子来研究超前校正如何改善系统的瞬态性能。
例4.6.2  考虑一个具有如下开环传递函数的单位反馈系统，即
　　　　　　　　　　　　　　　　　　
设计一个控制器使闭环系统满足如下瞬态响应性能指标：(1)超调量≤20%;(2)上升时间≤
0.25s。
　　解  首先根据瞬态响应性能指标估计闭环期望极点所在的区域。由超调量≤20%得到系统 的阻尼比ζ≥0.5,再由上升时间≤0.25s 得 到w≈1.8/0.25=7.2rad/s。   图4 .6 . 3中用点线画 出了对应ζ=0.5的两条射线和对应wn=7rad/s    的半圆，两条射线之间的区域对应ζ>0.5,半圆 左边的区域对应wn>7rad/s,    这两者的交集即闭环期望极点应该分布的区域。
　　　图4.6.3中实线所示是未校正系统的根轨迹，显然，无论K 为何值，未校正系统的根轨迹不 通过期望区域，若想让其通过，必须将根轨迹拉向左方。考虑加入如下超前校正控制器，即
　　　　　　　　　　　　　　　　　
此时的开环传递函数为G(s)G(s),      绘制其根轨迹如图4.6.3中的虚线所示。
　　　此时，根轨迹通过了期望区域。在根轨迹上选择一点，ζ=0.56和wn=7.7rad/s,      即闭环期 望极点的实部位于一 ζwn=-4.3,      对应K=70 。 根据闭环极点之和等于开环极点之和的关系，确 定第三个极点位于一.11+8.6=-2.4。第三个极点与超前校正装置的零点很靠近，因此，超调量 不会因为零点的存在而增加很多。图4.6.4给出了校正后系统的单位阶跃响应，超调量略微高



出20%。一般来说，在控制系统的前向通道上加入超前校正会增加系统阶跃响应的超调量，因 为闭环传递函数多了一个零点。


根轨迹











实轴
图4.6.3 例4.6.2中原系统的根轨迹(实线)和
加入超前校正的根轨迹(虚线)



　
图4.6.4 例4.6.2中加入超前校正后的阶跃响应

　　在例4.6.2中，先选择了超前校正控制器，然后，观察校正后系统的根轨迹是否通过满足要 求的闭环极点所在复平面区域。如果事前确定了闭环期望极点的位置，可以根据根轨迹的相角 条件设计超前校正控制器的零、极点。下面通过一个例子来学习如何选择超前校正控制器的零 极点使校正后的根轨迹通过指定的闭环极点。
例4.6.3 考虑一个具有如下前向传递函数的单位反馈控制系统，即
　　　　　　　　　　　　　　　　　　
设计一个超前校正控制器使闭环系统的共轭复数极点位于S1,2=-3.5±j3.5√3,         同时噪声抑制 要求超前校正控制器的极点不小于―20。
　　解  由 S1,2=-3.5±j3.5√3       得到ζ=0.5和wn=7,  对应超调量约为20%,上升时间约为0. 26s。为了将超前校正附加零点放在尽可能远离虚轴的地方以减小它对系统响应的影响，将校正 装置的极点放在它所能放置的最远位置b=20 。 未校正系统在s?=-3.5+j3.5√3          处的相角为 ∠G(s?)=-232.4。  为了使校正后系统的根轨迹通过s? (即满足相角条件),超前校正装置需提 供的相角为ψ=∠ (s?+a)-∠(s?+20)=            52.4°,即 从s1到校正装置的零点和极点之间的夹角为 52.4°,如图4.6.5所示。
　　　根据极点的位置和ψ=52.4°可得到零点位于z=-5.4,       再根据幅值条件计算出校正后系统 在s?=-3.5+j3.5√3          处的增益为127,这样得到了超前校正器的传递函数为
　　　　　　　　　　　　　　　　　
　　　校正后系统的根轨迹如图4.6.6所示，通过闭环期望极点，计算出第三个位于负实轴的闭环 极点为―14,其闭环阶跃响应，如图4.6.7所示，由于附加零点的作用，实际超调量大于闭环期望 极点对应的超调量。




根轨迹
　　
实轴
图4.6.5 例4.6.3中根据相角条件确定
校正装置零点位置



根轨迹
　
实轴
图4.6.6  例4.6.3中校正后系统的根轨迹图



1.4

1.2

1

0.8
0.6
0.4
0.2

0
0


阶跃响应













0.2     0.4      0.6      0.8      1             1.2      1.4   1.6   1.8 T/s

图4.6.7 例4.6.3中校正后系统的阶跃响应
　　也可以找到满足ψ=72.6°的其他零、极点组合，得到不同的超前校正传递函数。由于极点 被限制在了不小于-20的位置，其他组合都会使得零点更靠近虚轴，因而会增加超调量。
根据上面几个例子的设计过程，可以归纳出根轨迹法设计超前校正的步骤：
(1)由给定的系统瞬态性能指标确定闭环期望极点在复平面的位置。
(2)绘制未校正系统的根轨迹图，以观察根轨迹的主要分支是否通过(或接近)闭环期望极点。
(3)根据相角条件计算出超前校正装置应该提供的相角ψ。
(4)设计超前校正装置，选择合适的零、极点位置。
　　(5)绘制校正后系统的根轨迹图，确定除了闭环期望极点外的其他闭环极点和零点的位置 并估算这些零极点对系统瞬态性能的影响。如果与要求值相差不大，可适当调整校正装置零点 和极点位置，也可根据除期望极点外其他零、极点的分布，调整期望极点的位置，重复上述设计。



(6)根据闭环系统的阶跃响应，检验系统的性能是否满足设计要求。
4.6.2   滞 后 校 正
　　通过超前校正获得满意的瞬态性能后，还需检查系统是否具有满意的稳态性能，即稳态误差 是否满足要求。如果不满足，则需要设计滞后校正控制器用于改善系统的稳态性能。
已知控制系统的开环传递函数为
　　　　　　　　　　　　　　　
在 K=K?       时，该系统具有满意的瞬态性能，但是系统的稳态性能不符合设计要求。为改善其稳 态性能，设计滞后校正控制器如下，即
　　　　　　　　　　　　　　　　
使校正后的根轨迹的主要分支仍通过(或接近)闭环期望极点，但使得闭环期望极点的增益K 增 大，从而改变系统的稳态性能。为了实现这个目标，对滞后校正装置的零点―a 和极点―b 提 出 如下要求：
　　　(1)零点―a  和极点一b 彼此靠近，这样，它们对闭环期望极点仅提供一个很小的角度，使校 正后系统的根轨迹仍通过(或接近)闭环期望极点，以保证闭环系统瞬态特性不变；
　　　(2)零点 ―a 和极点一b 放置在靠近原点的位置，并且零点在极点的左侧，这样滞后校正装 置可以提供较大的稳态增益。例如，取a=0.01,b=0.001,        则有
　　　　　　　　　　　　　　　
　　　例4.6.4 例4.6.3中只对系统的瞬态特性提出了要求，按照瞬态特性要求设计了超前校 正控制器。串联超前校正控制器后的系统的前向传递函数为
　　　　　　　　　　　　　　　　
这是一个I 型系统，其速度误差系数为
　　　　　　　　　　　
　　假设系统稳态性能指标要求系统的速度误差系数K>100,     为了满足稳态性能要求同时尽 量保持瞬态特性，需要加入滞后校正控制器。若滞后校正控制器能够提供a/b=3    的稳态增益， 则新的速度误差系数
　　　　　　　　　　　　
满足稳态性能要求。
　　　根据上面分析中对滞后校正装置零、极点分布的要求，选择a=0.03     和 b=0.01 。 由于零点 和极点很靠近且值很小，它们对根轨迹主要分支(即闭环主导极点位于的根轨迹分支)的影响将 会很小，从而来维持加入滞后校正的根轨迹仍然通过(或接近)闭环期望极点。串联入滞后校正 控制器后的系统的前向传递函数为




　　　　　　　　　　　　　
用 MATLAB   的 rlocus   函数绘制出校正后系统的根轨迹如图4.6.8所示。根轨迹与ζ=0.5交 于―3.5+6. 1j 。滞后校正控制器附加的零极点附近的根轨迹放大在图4.6.9中。比较图4.6.6 和图4.6.8,可以看出由于滞后校正控制器附加的零、极点使得闭环系统多了一个靠近原点的极 点，会产生一个衰减缓慢的响应。但由于这个极点很靠近滞后校正控制器的零点―0.03,零、极点 的抵消作用会导致响应值很小。但是由于它衰减很慢，有可能会对系统的调节时间造成较大影响。

根轨迹
　　　
实轴
图4.6.8 例4.6.4加入滞后校正后的
完整根轨迹图


根轨迹
0.15厂
　0.1 0.05 0-
005
-0.1
-0.2 -0.18-0.16-0.14-0.12-0.1-0.08-0.06-0.04-0.020 实轴
图4.6.9 例4.6.4加入滞后校正后的根轨迹 靠近原点处的放大图

4.6.3         超 前 ― 滞 后 校 正
　　　从前面的讨论可以看出，超前校正可以改善系统的瞬态性能，滞后校正可以改善系统的稳态 性能。如果需要同时改善系统的瞬态性能和稳态性能，则要同时采用超前校正和滞后校正。这 种情况下，与其将超前校正装置和滞后校正装置作为单个元件同时作用于系统，还不如采用组合 式的超前―滞后校正装置更为经济。这种组合装置综合了超前校正和滞后校正的优点，其传递 函数的一般形式为
　　　　　　　　　　　　
式中：为超前部分；为滞后部分。
超前―滞后校正是超前校正和滞后校正的综合，其设计的基本步骤可归纳如下：
(1)根据瞬态性能要求，确定闭环期望极点。
　　　(2)为使校正后的系统的根轨迹通过或接近闭环期望极点，由根轨迹的相角条件计算出超 前校正应该提供的相角ψ,确定超前部分的零点和极点，并计算γ值。
　　　(3)如果滞后部分使系统的稳态增益增大γ倍，可以满足系统的稳态性能指标，则进入(4); 否则，必须取大的γ值，重新设计超前部分。
　　　(4)绘制超前―滞后校正后系统的根轨迹图，确定闭环主导极点的位置，计算此处的增益， 检查系统的稳态性能是否满足设计要求。
(5)确定其他闭环零、极点的位置，进而估算它们对系统瞬态性能的影响。



例4.6.5 考虑一个具有如下前向传递函数的单位反馈控制系统
　　　　　　　　　　　　　　　　
　试设计一超前―滞后校正控制器，使校正后的系统满足如下性能指标：阻尼比ζ=0.5,无阻尼自 然频率wn=2rad/s,   速度误差系数Kv≥5。
解  (1)由给定的瞬态性能指标，确定闭环期望极点为
S1,2                          =-0n±j√ 1-5wn=-1±1.73j
(2)计算G(s) 在s? 处的相角，即
∠G(s?)=-∠s1-∠(s+1)-∠(s?+4)=-240°
若使校正后系统的根轨迹通过期望极点s?, 超前部分应该提供的相角为
ψ=―180°―(―240°)=60°
　把超前部分的零点放置于一a?=-1       处，以便系统的一个开环极点可与之抵消。连接s? 和 ― 1 并在其左侧画一条与其成60°的直线，找到极点位于一b?=-4,y=b?/a?=4 。      这样加入超前校 正后系统的开环传递函数为
　　　　　　　　　　　　　　　　　
(3)根据幅值条件计算G'(s)在s? 处的增益为
K′=|s?1・|s?+4|2=23.9
对应的速度误差系数为
　　　　　　　　　　　　
　不满足K≥5    的稳态性能要求，需要设计滞后校正改善稳态性能。前面已经计算出γ=4,采用超 前校正的速度误差系数增大4倍后满足稳态性能要求。根据滞后校正的设计方法，将零、极点放在 靠近原点的位置，选择一a?=―0.24,―b?=―0.06 。   于是，得到加入滞后校正的开环传递函数为
　　　　　　　　　　　　　　　
(4)绘制校正后系统的根轨迹如图4.6.10所示，根轨迹与ζ=0.5线的交点为 s?=-0.9+j1.6
校正后系统在s1 点的增益为
　　　　　　　　　　　
于是，校正后系统的开环传递函数为
　　　　　　　　　　　　　　　
速度误差系数为
　　　　　　　　　　
符合设计要求。




　　　　　　　　　　　
实轴
图4.6.10 超前―滞后校正后的根轨迹图
　　　(5)由于开环极点数比零点数多三个，闭环极点之和等开环零点之和。由此求得除了主导 极点外，另外两个极点一个位于s=―0.276    处，与闭环零点s=-0.24        非常靠近。另 一个位于s=    ― 5 .94,它与虚轴的距离是闭环主导极点到虚轴的距离的6倍以上，故这两个闭环极点和一个 闭环零点对瞬态响应的影响不大。
4.7    线性系统根轨迹法的应用

4.7.1    利 用 MATLAB      研 究 根 轨 迹 法
图4.7. 1所示为小型飞行训练机Piper    Dakota,其方向舵输入和俯仰角输出之间的传递函数为
(4.7.1)
式中：θ为俯仰角度；δ。为方向舵角度。要求设计一个自动驾驶装置，使俯仰角输出对方向舵角 度输入的阶跃响应满足上升时间小于1s、超调量小于10%。
图4 . 7 .2给出了方向舵一俯仰角反馈控制系统的方框图。我们的任务是设计控制器G(s)
使得闭环系统输出满足性能要求。下面将应用根轨迹法，并在MATLAB   辅助下完成设计任务。


　　
图4.7. 1 Piper  Dakota训练机






θ,(s)      E(s)         G.(s)



图4.7.2 方向舵―俯仰角反馈控制系统




　　　对于一个标准二阶系统而言，上升时间t,和无阻尼自然频率wn 存在如下近似关系 因此，为了满足 t,≤1s,   需要an≥1.8rad/s 。  另外，超调量小于10%要求阻尼比ζ≥0.6。以上得 到的wn 和ζ的范围将在根轨迹法设计中作为参考，但是由于原系统是一个四阶系统并且有零 点，wn 和ζ的取值需要根据响应情况进行调整。
首先考虑比例控制，即G. (s)=K。 用 MATLAB   绘制根轨迹和画出K=0.3  时的阶跃响应
曲线。在MATLAB  命令窗口输入以下语句：
numG=160*conv([12.5],[10.7]);
denG=conv([1540],[10.030.06]);
sysG=tf(numG,denG);
rlocus(sysG)
K=0.3;
sysL=K*sysG;
sysH=tf(1,1);
sysT=feedback(sysL,sysH);
step(sysT)
　　　图4.7.3和图4.7.4中的虚线表示加入比例控制后系统的根轨迹和阶跃响应。图4.7.3 (b) 为图4.7.3(a) 中根轨迹靠近原点处部分的放大图。从图4.7.3可看出闭环系统一对较快的 复极点的阻尼比ζ总是小于0.4,另一对较慢的复极点则会影响系统的调节时间，使调节时间较 长。本例中所要求的性能指标上升时间和超调量反映在响应开始后的几秒内，主要由较快的一 对复极点决定。这一对复极点的阻尼比较小使得系统响应振荡较剧烈，引起较大的超调量，不满 足性能指标的要求。因此，仅使用比例控制不能满足设计要求。

　　


　2 1.5
0.5 0
-0.5 -1
-1.5
-2L -3


根轨迹










-2.5  -2 -1.5 -1  -0.5   0   0.5 实轴

(a)                                                                       (b)
图4.7.3  比例控制和超前校正下的系统根轨迹图
　　在前面讲到的根轨迹法校正中可知，超前校正能够使根轨迹向左弯曲，从而起到增加阻尼比 的作用。通过试凑法选择合适的零、极点位置，在MATLAB  观察相应的根轨迹。取a=3,b=
20和K=1.5,    得到如下超前校正控制器，即
　　　　　　　　　　　　　　　　　



阶跃响应
　　　　　　　　　　　
T/s
图4.7.4  比例控制和超前校正下的系统阶跃响应
在 MATLAB    命令窗口输入以下语句：
numGc=[13];
denGc=[120];
sysGc=tf(numGc,denGc);
sysGcG=sysGc"sysG;
rlocus(sysGcG)
K=1.5;
sysKGcG=K*sysGcG;
sysH=tf(1,1);
sysT=feedback(sysKGcG,sysH);
step(sysT)
图4 . 7 . 3和图4 . 7 .4中的实线表示加入超前校正后系统的根轨迹和阶跃响应。在K=1.5
　处， 一对较快的复极点对应的阻尼比为0.52,仍然比按照标准二阶系统设计时要求的ζ≥0.6要 小。同时，wn=15rad/s,      比设计期望的要快得多。观察这时闭环系统的阶跃响应曲线，上升时间 约为0 . 9s, 超调量约为8%,已经满足性能指标要求。如果阶跃响应不满足要求，则需要重新选 择超前校正器的零、极点，然后再观察响应曲线，直到满足要求。
4.7.2    根 轨 迹 法 的 设 计 实 例
　　　在本节中，研究机器人复制系统中机械臂的控制问题。机器人复制的概念很好理解，如 4.7.5所示，已组装好的机器人可以自动组装新的机器人。为了快速而准确地控制机器人，重要 的一环是控制好机械臂的动作。本例中要求满足的机械臂控制系统性能指标是：(1)调节时间小 于 2s(2%);(2)      阶跃响应的超调量小于10%;(3)阶跃响应的稳态误差为0。
　　图4 . 7 . 6给出了所设计的机械臂控制系统方框图，设计中既用到了前向通道的控制器 G(s), 也用到了速度反馈。机械臂的传递函数为
　　　　　　　　　　　　　　　　　　



　　　　　　　　　　
图4.7.5  机器人复制系统的概念图
其 中
　　　　　　　　　　
系统存在四个复零点：21,2=-2± j100,z3,4=―6±j300; 四个复极点：P1.2=-1±j50,p3,4=-3 ±j150。
　　　　　　　
图4.7.6 机械臂控制系统方框图
首先考虑不加速度反馈，只在前向通道加入比例控制，即令K?=0,G(s)=K? 。      绘 出K?   从
　零变化到无穷大时闭环系统的根轨迹，如图4.7.7所示。从图中可以观察到对于任何K?>0,    闭 环系统都有两个极点位于右半s 平面。因此仅仅通过调节K? 不能使闭环系统稳定，考虑加入速 度反馈K? 。 这时，系统的开环传递函数为
　　　　　　　　　　　　
现在系统有两个可调参数K?  和 K? 。 设 置 5<K?<10,       使得附加零点靠近原点。当K?=5,K?
变化时，系统的根轨迹如图4.7.8所示。从图中可见，当K?  较小时，闭环极点都位于左半s 平 面，系统稳定。取K?=0.8     和 K?=5,     闭环系统的阶跃响应超调量为12%,调节时间为1.8s 。这 是在比例控制和速度反馈下能得到的最好结果。取K?=7    或 K?=4,    超调量更大。如果想要得 到更好的性能，需要考虑更复杂一些的控制器，如在G(s)    引入附加零、极点，即令
　　　　　　　　　　　　　　　　　
选择a=1   和 b=5,    当 K?=5     和 K?=5     时，闭环系统阶跃响应超调量为8%,调节时间为
1.6s。





　　



400
300
200
100
o
-100
-200
-300
-400L


根轨迹











-10  -8   -6  -4
实轴









9



-2   0    2



图4.7.7  比例控制下机械臂控制系统的根轨迹图
(K?=0,G(s)=K?)



图4.7.8 加入速度反馈后机械臂控制系统的根轨迹图
(K?=5,G(s)=K)



本  章  小  结

　　本章研究了线性系统的根轨迹法。根轨迹法是一种对闭环控制系统进行分析和设计的图解 方法。闭环控制系统特征方程的根随某个参数由零变到无穷大时在复数平面上形成的轨迹，称 为根轨迹。在控制系统的分析中，对特征方程根的分布的研究，具有重要的意义。当特征方程的 次数高于2时，求根过程将变得相当复杂。美国学者W.R.   埃文斯在1948年提出的根轨迹方 法，为简化特征方程的求根过程提供了一种有效的手段。在把根轨迹技术应用于控制系统的分 析时，常取系统的开环增益为可变参数，据此作出的根轨迹，表示闭环控制系统的极点在不同开 环增益值下的分布。控制系统的极点在复数平面上的位置与系统的稳定性和过渡过程性能有密 切的关系。根轨迹的建立，为分析控制系统在不同开环增益值时的行为提供了方便的途径。对 于设计控制系统的校正装置，根轨迹法也是基本方法之一。
课后练习题
4-1   系统的开环传递函数为
　　　　　　　　　　　　　　　
问 ：s? =-1+j       √3 是否是在其根轨迹上，并证明。
4-2   系统的开环传递函数为
　　　　　　　　　　　　　　　　　
用解析法画出k 从0到∞时系统的根轨迹图。 4-3   系统的开环传递函数为
　　　　　　　　　　　　　　　
试证明：S?=-4+j√3         在其根轨迹上，并求出s?=-4+j√3         相对应的 K  值 。 4-4       设系统的开环零、极点分布如下图所示，试粗略画出系统的根轨迹图。









(a)                         (b)                        (c)                       (d)





(e)                      (f)                        (g)                       (h)
4-4题图
4-5   单位负反馈系统G(s)  如下，按步骤计算参数，并画出其根轨迹图。
(1)
　　　
4―6  粗略地画出控制系统的根轨迹图。
,H(s)=s
4-7   已知单位反馈系统的开环传递函数，试绘制参数b 从零变化到无穷大时的根轨迹，并写出
b=2  时的系统闭环传递函数。
　　　　　　　　　　　　　　　　
4-8   单位正反馈的传递函数如下：
　　　　　　　　　　　　　　　　
画出该系统的根轨迹图。
4―9  设反馈控制系统中
　　　　　　　　　　　　　　
要求：
(1)概略绘出系统根轨迹图，并判断闭环系统的稳定性；
　　(2)如果改变反馈通道传递函数，使H(s)=1+2s,      试判断 H(s)  改变后的系统稳定性，研究 由于H(s)  改变所产生的效应。
4-10   单位反馈系统开环传递函数为
　　　　　　　　　　　　　　　
要求闭环系统的最大超调量σ%≤25%,调节时间t?≤10s,   试选择K* 值。
4-11  已知单位负反馈系统的开环传递函数为
(1)根据系统的根轨迹，分析系统的稳定性。
(2)估计超调量σ%=16.3%时的K 值。



4-12   单位负反馈系统的传递函数如下：
　　　　　　　　　　　　　　　
用 MATLAB  软件画出该系统的根轨迹，给出程序。
4-13   已知单位反馈系统的开环传递函数 ,试绘制参数b 从零变化到无穷 大时的根轨迹，并写出s=-2  这一点对应的闭环传递函数。
4-14   已知单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　
要求：(1)绘制系统的根轨迹；(2)确定系统临界稳定时开环增益K 的值；(3)确定系统临界阻 尼比时开环增益K  的值。
4-15   已知系统的开环传递函数为 ,要求绘制根轨迹并确定系统阶 跃响应无超调时开环增益 K 的取值范围。
4-16    单位反馈系统的开环传递函数为,试绘制系统根轨迹，并确定 使系统稳定的K 值范围。
4-17   设单位反馈系统的开环传递函数为 ,试绘制其根轨迹，并求出使系统 产生重实根和纯虚根的K* 值 。
4-18   已知系统的开环传递函数为
　　　　　　　　　　　　　　　
试概略绘出相应的根轨迹，并求出所有根为负实根时开环增益 K 的取值范围及系统稳定时K 的值。






第5章 线性系统的频域分析法

本 章 提 要

　　　本章首先介绍控制系统的频率特性的基本概念，并建立系统频率特性函数，然后研究用伯德 图、奈奎斯特图、尼科尔斯图等图解方法来表示频率特性函数。在讨论了各种典型环节和系统的 频率特性后，着重研究利用奈奎斯特稳定性判据和对数稳态判据进行系统稳定性能分析。本章 还简要分析了开环系统频率特性与闭环系统频率特性的关系，以及它们与系统时域性能指标的 关系；介绍了反馈控制系统的频域校正方法。最后，本章以一个高速列车倾斜控制系统为例，用 频率法进行了分析和设计。
5.1   引   言

　　　本章将研究系统在正弦信号输入下的稳态响应。实验和数学推导都表明，当输入是正弦信 号时，线性定常系统的稳态输出也是正弦信号，输出信号的频率与输入信号频率相同，其幅值和  相角则是该频率的函数。即输入信号的频率发生变化时，系统稳态响应的幅值和相角变化情况， 这也就是系统的频率特性。相应的分析方法，称为系统的频域分析法。这种分析和处理问题的  方法起源于通信科学，20世纪30年代被引入到控制科学，因为不需解微分方程就可对控制系统  的性能进行分析和校正，可以方便地解决许多理论和工程问题，所以迅速成为控制理论的基本方  法之一。与其他方法相比较，频率分析法具有如下特点：
　　　(1)频率特性可以由前述传递函数确定，也可以用实验的方法来确定，对于难以列写微分方 程式的元部件或系统，它便于工程上的使用。
　　　(2)频率响应法借助开环频率特性的图形对系统进行分析，因而具有形象、直观和计算量较 少的特点。
　　　(3)频率特性有明确的物理意义。对于二阶系统，频域性能指标与时域性能指标有确定的 对应关系；对于高阶系统，两者间也存在着近似的对应关系，所以可以把系统参数和结构的变化 与动态过程时域指标联系起来。
　　　(4)频域分析法不仅可以分析动态性能，而且可以兼顾抑制系统噪声。不仅适用于线性定 常系统，而且还可推广到传递函数不是有理数的纯滞后系统，甚至应用到某些非线性系统中。
5.2  频 率 特 性

5.2.1  频率特性的基本概念
　　　系统的频率响应，是指输入为正弦信号情况下的系统稳态响应。考虑线性系统，其传递函数 为 Φ(s) 。 输入为r(t)=Asin(wt+φ)        时，即




　　　　　　　　　　　　　　　
假设系统稳定且有 n 个不同的极点p;,  则
　　　　　　　　　　　　　　　
则输出C(s)  可用部分分式法展开得
　　　　　　　　　　　



(5.2.1)


(5.2.2)



(5.2.3)

式 中 ：a、β为与系统参数及输入相关的常数。对式(5.2.3)作拉普拉斯反变换，可得到系统的时


间响应
　　　　　　　　　　
如果系统是稳定的，则所有的p; 都具有负实部，于是有
　　　　　　　　　　　　　　　　　　
所以，当t→∞  时 ，c(t)  的极限为
　　　　　　　　　　　　　




(5.2.4)


(5.2.5)


(5.2.6)

　可见，c(t)   稳态时为正弦信号，且频率与输入信号频率相同。由于a 、β与系统参数和输入相关， 所以稳态响应的幅值A. 和相角φ。也与系统参数和输入相关。下面来推导幅值和相角的表达 式，即
　　　
(5.2.7)
Φ(s)  的分子分母为实系数多项式，当用s=jw   代换时，多项式中s  的偶次方项，变换成w 多 项 式 的实部项，而s  的奇次方项，变换成虚部项。设为
(5.2.8)
故式(5.2.8)中的a(w)  和 c(w)  为 关 于w 的偶次幂实系数多项式。 b(φ)   和 d(w)   为 关 于w 的 奇 次 幂实系数多项式，即a(w)  和 c(w)  为 关 于w 的 偶 方 程 。b(w)  和 d(w)  为 关 于w 的奇方程。由于






因 而


再由式(5.2.7)得



　　　
　





(5.2.9)
(5.2.10)


(5.2.11)

　　　　　　　　　　



拉普拉斯反变换得
　　　　　　　　　　　
A|Φ(ja)|sin(a+φ+/Φ(jo))                                                       (5.2.12)
与式(5.2.6)相比较，得幅值和相角的表达式为
                         (5.2.13)
定义输出信号与输入信号的幅值之比A(w) 为幅频特性，相位之差φ(w) 为相频特性，即
                      (5.2.14)
其指数表达形式
Φ(jw)=A(w)ei?(m)                                                      (5.2.15)
为系统的频率特性。
　　上述频率特性的定义，既可用于稳定系统，也可适用于不稳定系统。稳定系统的频率特性可  以用实验方法确定，即在系统的输入端分别施加不同频率的正弦信号，然后测量系统稳态输出， 再根据幅值比和相位差确定系统的频率特性。而对于不稳定系统，由于输出响应的稳态难以测 量，所以不能通过实验方法来确定。
　　通过以上分析可知，频率特性表示了系统或环节对不同频率正弦信号的“跟踪”或“复现”能 力，是线性系统在正弦输入信号作用下的稳态输出与输入之比，所以频率特性又叫正弦传递函 数。它和传递函数、微分方程一样能反映系统的运动规律，因而它是线性系统(或部件)的又一形 式的数学模型。而且频率特性与系统传递函数间的转化也较容易，只要用jw替换复变量s, 就能由 传递函数Φ(s)直接得到系统的频率特性函数φ(ja)。三种描述方法间的关系可用图5.2.1说明。
　　　　　　　　　　　　　
图5.2.1 频率特性、传递函数、微分方程三种系统描述方法之间的关系
5.2.2   频率特性的几何表示方法
　　　系统的频率特性Φ(jw) 可以用频率特性函数表示，也可以用图形和曲线表示。采用的频率 特性图形有以下几种：
1. 奈奎斯特图
频率特性函数Φ(jw)是一个关于w 的复函数，可写成
Φ(jw)=X(w)+jY(w)                                                        (5.2.16)



　式中：X(w)=Re[Φ(jw)];Y(w)=Im[Φ(jw)] 。    对于任一给定的频率w, 频率特性为一复数，在复 数平面上表示成一个点。当w 从一∞到+∞连续变化时，频率特性可表示成一条连续曲线。该 曲线就称为奈奎斯特图(简称奈氏图或奈奎斯特曲线),也称为幅相频率特性曲线(简称幅相曲 线)。
频率特性也可以写成式(5.2.15)的复指数形式。与式(5.2.16)比较，有

(5.2.17)

即表示成极坐标形式，所以奈奎斯特图又称为极坐标图。
　　　由于幅频特性为参变量频率w 的偶函数，相频特性为w 的奇函数，则w 从0变化至+∞和从 0变化至一∞这两段关于实轴对称，因此，一般只绘制w 从0变化至+∞段的奈奎斯特曲线。并 且，在曲线中，用箭头表示w 增大时奈奎斯特曲线的变化方向。
下面用例子来说明奈奎斯特曲线的绘制方法。
例5.2.1 RC 滤波网络如图5.2.2所示。
其传递函数为
　　　　　　　　　　　　　
其中T=RC 。 于是，频率特性为
　　　　　　　　　　　　　　　　　
且
　　　　　　　　　　　
分析可知
　　　　　　　　　　　　　
该式表明，RC 网络的奈奎斯特曲线比较规则，是一个以(1/2,0)为圆心、半径为1/2的半圆，如
图5.2.3所示。当然，根据式(5.2.15)的复指数形式也可以绘制出奈奎斯特曲线，此时有 Φ(jw)=A(jw)ei(m)
　　　　　　　　　　　　　　　　　　　　　　　　　
图5.2.2 RC 滤波网络                    图5.2.3 RC 网络的奈奎斯特曲线

其中
　　　　　　




于是，当w=0  时，|Φ(ja) |=1,/ Φφ(jw)=0; 当 w=1/T   时，|Φ(jao) |=1/ √2,/  Φ(ju)=-45°;  当
w→∞ 时，|Φ(jw)|→0,/Φ(jw)=-90°,             且幅值和相位都是随w 增大而单调减小的。绘制图形同
样是图5.2.3。
2. 伯德图
　　　H.W.Bode    在研究反馈放大器时，引入了这种图解方法，因此称为 Bode  图(或伯德图),又 称为对数频率特性曲线。由式(5.2.14)可知，系统频率特性函数，可以分成幅频特性和相频特性 两个函数。因此，可以分别绘制成幅值一频率特性曲线(简称幅频曲线)和相位一频率特性曲线 (简称相频曲线)两条曲线。
　　为了能充分表现从低频到高频的特性，横坐标按lgw 分度。同时，为了使用方便，仍按w 标 注，单位为弧度/秒(rad/s) 。 幅频曲线纵坐标按
L(w)=20lg|φ(jw)|=20lgA(w)                                                        (5.2.18)
线性分度，单位是分贝(dB) 。 对数相频曲线纵坐标按φ(w) 线性分度，单位为度(°)。由此构成的 坐标系被称为半对数坐标系。
　　对数分度和线性分度如图5.2.4所示，在线性分度中，当变量增大或减少1时，坐标间的距 离变化一个单位长度；而在对数分度中，当变量增大或减小10倍时，称为十倍频程(dec),  坐标间 距离变化一个单位。

　　　　　　　
图5.2.4 伯德图的对数分度与线性分度
　　在一个十倍频程内，由于按lgw 分度，所以标 w 值时，刻度是不均匀的。以w 从 1 到 1 0 为 例 ，w 与 lgw 的对应关系如表5.2. 1所列。
表5.2. 1  十倍频中的对数分度

w	1	2	3	4	5	6	7	8	9	10
lgw	0	0.301	0.477	0.602	0.699	0.788	0.845	0.903	0.954	1
　　　采用半对数坐标研究频率特性有许多优点。首先是横坐标采用1gw 分度，所能表示的频率 范围扩宽了；其次幅频特性纵坐标采用20lgA(w) 分度，则可以将幅值的乘除运算化为加减运算， 并能够简化绘制过程。
3. 尼科尔斯图
　　　尼科尔斯图又称为对数幅相曲线。以频率w 为参变量，在直角坐标中，以20lgA(w) 为纵坐 标，单位分贝(dB),   横坐标为φ(w), 单位为度(°),均匀线性分度。图5.2.5为某RC 网络的尼科 尔斯图。



　　　　　　　　　　　　
φ(w)C°)
图5.2.5  的对数幅相曲线

5.3    开环系统的频率特性

5.3.1   典 型 环 节 的 频 率 特 性
　　控制系统种类繁多，但从它们传递函数的形式来看，任何复杂的传递函数，都是由形式有限 的典型环节组成。研究这些典型环节的频率特性，有助于我们掌握各种系统的频率特性。
　　线性系统的开环传递函数的分子、分母为实系数多项式，在实系数范围内对它们进行因式分 解，一般情况下，可以写成

(5.3.1)


这样得到的最小因式，称为典型环节。
由式(5.3.1)可以看出，构成控制系统最基本的典型环节如下：
(1)比例环节 K(K>0)。
(2)积分环节1/s 和微分环节s。
(3)惯性环节和一阶微分环节 Ts+1(T>0)。
(4)振荡环节 和二阶微分环节
(5)非最小相位环节。
　　应该指出，典型环节并不一定和单个元件一一对应， 一个元件可能要用多个典型环节表示， 而一个典型环节也许是表示多个元件。
1. 比例环节
　　　这种环节的输入信号与输出信号间呈比例关系。控制系统中的放大器、减速器等就是比例 环节的例子。




比例环节的传递函数为

频率特性为

幅频特性和相频特性为




G(s)=K

G(jw)=K=Ke?

A(w)=K,φ(w)=0°



(5.3.2)

(5.2.3)

(5.3.4)

　　　可见，其频率特性是与频率无关的常数。奈奎斯特图是实轴上的一个点，如图5.3. 1(a) 所示。
比例环节的对数频率特性为
L(w)=20lgA(w)=20lgK
伯德图如图5.3. 1(b)所示，是两条与频率无关的直线。
　　　　　　　　　　　　　　　　　　　　　　
(a)                                             (b)
图5.3.1 比例环节的奈奎斯特图与伯德图
2. 积分环节和微分环节
1)积分环节
　　输出量是输入量对时间的积分，这种环节称为积分环节。模拟机的积分器、电动机的角速度 与转角之间的传递关系，都是积分环节。
积分环节的传递函数为
　　　　　　　　　　　　　　　　　                               (5.3.5) 频率特性为
　　　　　　　　　　　　　　                          (5.3.6) 幅频特性和相频特性为
 ,φ(w)=―90°                                                        (5.3.7)
其奈奎斯特图如图5.3.2(a) 所示。
积分环节的对数幅频特性为
L(w)=-20lgw
　　　当 w=0.1  时 ，L(w)=20dB;  当 w=1  时 ，L(w)=0dB;  当 w=10  时 ，L(w)=-20dB,    即 w 每 增 加10倍时，L(w) 减小20dB 。故积分环节的对数幅频曲线是一条斜率为―20dB/dec  的直线，该 直线与OdB 线交于w=1   处。伯德图如5.3.2(b) 所示。




　　　　　　　　　　　　　　　　　　　　　
(a)                                                             (b)
图5.3.2 积分环节的奈奎斯特图和伯德图
2 ) 微 分 环 节
　　输出量是输入量对时间的微分，这种环节称为微分环节。在实际系统中，没有 一个元件真正 具有微分环节的特性。但是，在主要的频率特性范围内， 一 些元件可以近似看作微分环节，如速 率陀螺和测速发电机。
微分环节的传递函数为
G(s)=s                                                                                  (5.3.8)
频率特性为
G(jw)=jw=we?0°                                                                           (5.3.9)
幅频特性和相频特性为
A(w)=w,φ(w)=90°                                                                           (5.3.10)
其奈奎斯特图如图5.3.3(a)  所 示 。
　　　因为式(5 . 3 . 9)与式(5 . 3 . 6)互为倒数，所以微分环节的对数幅频和相频都与积分环节仅差 一个负号，即L(w)=20lgw,φ(w)=90° 。       因此，微分环节伯德图与积分环节伯德图关于横轴对 称，如图5.3.3(b)  所 示 。


j
@→0
W

0
w=0

(a)                                                      (b)
图5.3.3 微分环节的奈奎斯特图和伯德图



3. 惯性环节和一阶微分环节
1)惯性环节
凡用一阶常微分方程描述的元件或系统，都包含惯性环节，如RC 网络、电动机和一阶系统等。 惯性环节的传递函数式为




频率特性为




　　　　　　





(5.3.11)


(5.3.12)

幅频特性和相频特性为


　　　　　　　　　　　　



,φ(w)=-arctanTw


(5.3.13)

　　　由例5.2.1可知，惯性环节的奈奎斯特图是一个以(0.5,j0)为圆心、以0.5为半径的半圆， 如图5.3.4(a) 所示。


　　　　　　　　　　



J




0




@
@=0
1

(a)                                          (b)
图5.3.4 惯性环节和一阶微分环节的奈奎斯特图
　　　　　　　　　　　　　　　　　　
惯性环节的对数频率特性为
(5.3.14)

2)一阶微分环节
　　　输出量取决于输入量及其一阶微分，这种环节称为一阶微分环节。具有精确的一阶微分环 节特性的元件是不存在的。不过，有些元件可以近似看作一阶微分环节，如超前校正网络G(s)=
　
一阶微分环节的传递函数式为
G(s)=Ts+1                                                                (5.3.15)
频率特性为
G(jw)=Tjw+1=√T2w2+1earctanTo                                              (5.3.16)
幅频特性和相频特性为
A(w)=√T2w2+1,φ(w)=arctanTo                                                      (5.3.17)
由式(5.3.16)可知，其实部恒为1,虚部从0到无穷变化，奈奎斯特图如图5.3.4(b) 所示。



对数幅频特性为
L(w)=20lg√T2w2+1,φ(w)=arctanTw                                                     (5.3.18)
　　　比较式(5.3.16)和(5.3.12)可知，惯性环节和一阶微分环节互为倒数，它们对数频率特性如 式(5.3.18)与式(5.3.14)所示，相差一个负号。因此，两个环节的伯德图关于横轴对称，如图 5.3.5所示。
　　　　　
(a)                                                                   (b)
图5.3.5 惯性环节和一阶微分环节的伯德图
(a)幅频特性；(b)相频特性。
4. 振荡环节和二阶微分环节
1)振荡环节
凡用二阶常微分方程描述的元件或系统，如果0<5<1,都包含振荡环节，如RLC 网络。


振荡环节的传递函数式为
　　　　　　　　　　　
频率特性为
　　　　　　　　　　
　　　　　　　　　　　　　　
幅频特性为
　　　　　　　　　　　　　
相频特性为
　　　



(5.3.19)




(5.3.20)


(5.3.21)





(5.3.22)



可见，奈奎斯特曲线的起点w=0   时 ，A(0)=1,φ(0)=0°;             终 点w→∞   时 ，A(∞)=0,
　φ(∞)=-180°。特殊点w=wn 时，,即曲线与虚轴的交点为  增大的过程中，φ(w)单调减小。 A(w) 的变化则和ζ取值有关。为分析A(w) 的变化趋势，求其极 值，即令
　　　　　　　　　　　　　　　　　　　
可以得谐振频率
W,=wn√ 1-22                 0<5≤√2/2                                              (5.3.23)
将w, 代入式(5.3.21)中，得谐振峰值
  0<ζ≤ √2/2           (5.3.24)
　而ζ= √ 2/2时，M,=1 。 当0<5< √ 2/2时，,所以wr、M,均为阻尼比ζ的减函数，且w∈  (0,w)   时 ，A(w)单调增加；w ∈(w,,∞)    时 ，A(w) 单调减。当5> √ 2/2时，w, 为虚函数，说明wr、 M, 不存在，A(w) 单调减。不同阻尼比ζ情况下，振荡环节的幅频特性如图5.3.6所示，振荡环 节的奈奎斯特图如图5.3.7所示。


　　　　
图5.3.6 振荡环节的幅频特性




图5.3.7 振荡环节的奈奎斯特图

　　　由式(5.3.24)可知，谐振峰值M,  与阻尼比ζ唯一相关，因此，也就能反映超调量的大小，如 谐振峰值过高，意味着阻尼比ζ小，而超调量大，动态过程的平稳性较差。通常，取1.2<M,<1.5,
系统动态性能较好。
振荡环节的对数幅频特性为
L(w)=-20lg√ [1-(w/wn)2]2+(20/wn)2                                                   (5.3.25)
对数相频特性与式(5.3.22)相同。
　　固定一个ζ值，将w/wn 从0→ ∞取值，计算相应的L(w) 、φ(w), 便可绘制出对应的伯德图， 如图5.3.8所示。
2)二阶微分环节
输出量取决于输入量及其一阶微分和二阶微分，这种环节称为二阶微分环节。纯二阶微分




　　　　　　　　　　
图5.3.8 振荡环节的伯德图
　环节特性的元件也是不存在的，只是在 一 定的频率范围内，有些元件近似具有二阶微分环节的 特性 。
二阶微分环节的传递函数为
G(s)=(s/wn)2+2ζ(s/wn)+10≤ζ<1                                                                         (5.3.26)
频率特性为
G(jw)=(jw/wn)2+2ζ(jw/wn)+1=
             (5.3.27)
幅频特性为
A(w)=√[1-(w/wn)2]2+(2ζ0/wn)2                                                                  ,(5.3.28)
相频特性为

(5.3.29)


因此，有
　　　　　　　　　　　　
　　虽然，二阶微分环节不具有振荡环节的M,  物理量，但是可以作类似的分析，当0<5< √ 2/2 且w ∈(0,w,)     时 ，A(w)  单调减小，至
A(w)=25√ 1-5<1                                                                                (5.3.30)



其中，与式(5.3.23)相同，w,=wn √ 1-252;   当 w∈(w,∞)  时 ，A(w) 单调增。当5> √ 2/2时， A(w) 单调增。二阶微分环节的奈奎斯特曲线如图5.3.9所示。ζ值不同，奈奎斯特图也不同。
二阶微分环节的对数幅频为
L(w)=201g√ [1-(w/wn)2]2+(20/wn)2                                                       (5.3.31)
对数相频特性与式(5.3.29)相同。
　　二阶微分环节的传递函数与振荡环节传递函数互为倒数，所以按对称性，可得二阶微分环节 的伯德图，如图5.3.10所示。



　　　
图5.3.9 二阶微分环节的奈奎斯特图


AL(w)

10
0
　-10 01   180 °φ(w)
90°
0 0.1
图5.3.10

5. 对数幅频渐近特性曲线
　　　前文所述的绘制对数频率特性曲线的方法，是用描点法，即先计算出某些w 所对应的L(w)    值，在对数坐标纸上描出相应的点，再把它们连成光滑曲线。但是描点法费时费力，所以工程上 常用渐近线近似表示，称为对数幅频渐近特性曲线。
对于惯性环节 ,其对数幅频特性如式(5.3.14)所示，为
L(w)=―20lg√T2w2+1
　　　当 时，即Tw<1,     忽 略Tw, 得L(w)≈-20lg√ 1=0dB;              当 ,即Tw>1,     忽 略1,得L(w)≈-20lg                   √T2w2=-20lg(Tw)。
因此，惯性环节的对数幅频渐近特性为

(5.3.32)

即低频时，L(w) 的渐近线是与OdB 线重合的直线，高频时，渐近线是斜率为-20dB/dec  (图中有
时标注为[-20]表示斜率)的直线。两条渐近线相交于横坐标处，称为交接频率或转折频 率，如图5.3.11所示。
用渐近线表示对数幅频特性时，将会存在误差，即
△L(w)=L(w)―L(w)                                                            (5.3.33)



相应的误差曲线如图5.3.12所示，在交接频率w=1/T    处误差最大，约等于―3dB。根据误差曲 线，可修正渐近特性曲线获得准确曲线。



dB4




0











w
[-20]




图5.3.11 惯性环节的对数幅频特性渐近曲线       图5.3.12 惯性环节对数幅频渐近线的误差曲线
　　　由于非最小相位惯性环节的对数幅频特性和惯性环节相同，故对数幅频渐近曲线相同。而 因为一阶微分环节和非最小相位一阶微分环节的对数幅频特性相同，且它们都与惯性环节对数 幅频特性互为倒数，可知一阶微分环节和非最小相位一阶微分环节都与惯性环节的对数幅频渐 近特性曲线关于0dB线(即横轴)互为镜像。
振荡环节 的对数幅频特性如式(5.3.25),为
L(w)=-201g√ [1-(w/wn)2]2+(20/wn)2                                                  (5.3.34)
　　　当wwn      时 ，L(w)≈0dB,    即低频渐近线为0dB线；当w>wn    时，得 ,即高 频渐近线为过(wn,0)点，斜率为-40dB/dec 的直线。两条渐近线相交于w=wn 处，所以wn 称为 振荡环节的交接频率。对数幅频渐近特性为
(5.3.35)

　可见，渐近特性La(w) 与阻尼比ζ无关。而由式(5.3.34)可知，对数幅频特性与ζ相关。所以用 渐近线近似表示对数幅频特性时存在误差，误差大小不仅与w 有关，而且也与ζ有关，即
△L(w,ζ)=L(w)―La(w)=
(5.3.36)

误差曲线△L(w,ζ)  为一曲线簇，如图5.3.13所示。根据误差曲线，可修正渐近特性曲线而获得 准确曲线。
　　　对比对数幅频特性，可知非最小相位振荡环节的对数幅频特性和振荡环节相同，故两者对数 幅频渐近曲线相同。由于二阶微分环节和非最小相位二阶微分环节的对数幅频特性相同，且与 振荡环节对数幅频特性互为倒数，可知二阶微分环节和非最小相位二阶微分环节都与振荡环节



　　　　　　　　　　

图5.3.13 振荡环节对数幅频渐近线的误差曲线
的对数幅频渐近特性曲线关于0dB 线(即横轴)互为镜像。
因为对数幅频渐近线在对数坐标中表现为直线，所以满足直线方程
(5.3.37)
式 中：[w,La(w?)]   和[w?,La(w2)] 为直线上的两点，k(dB/dec) 为直线斜率。
　　　绘制对数相频曲线， 一般根据φ(w) 表达式，确定起始(w→0) 和最终(w→∞)   时的渐近趋势， 并计算和描出中间部分的关键点，最后连成光滑曲线。
6. 非最小相位环节
　　　一个不稳定系统，它的特征方程中必定含有正实部根。相应地，除比例环节外，非最小相位 环节分子或分母含有正实部根，也称为不稳定环节。与之对应，前述各典型环节为最小相位环 节。非最小相位环节共有5种：
(1)比例环节 K(K  <0);
(2)惯性环节(T>0);
(3)一 阶微分环节 Ts-1(T>0);
(4)振荡环节
(5)二阶微分环节s2/w2―2ζs/wn+1(wn>0,0<ζ<1)。
　　对于每一种非最小相位典型环节，都有一种最小相位环节与之对应，其特点是典型环节的某 个参数符号相反。
非最小相位的比例环节G(s)=―K(K>0),         其幅频和相频特性为
A()=k,φ(w)=-180°                                                 (5.3.38)
与对应的最小相位比例环节进行比较，即式(5.3.38)与式(5.3.4)比较可知，两者其幅频特性相 同，相频特性差180°。
非最小相位的惯性环节其幅频和相频特性为




　　　　　　　　　　



,φ(w)=―(π-arctanTw)


(5.3.39)

　与对应的最小相位惯性环节(简称惯性环节)进行比较，即式(5.5.39)与式(5.3. 13)比较可知，非 最小相位环节与对应的最小相位环节，其幅频特性相同，相频特性相反，奈奎斯特曲线关于实轴 对称；对数幅频特性曲线相同，对数相频特性曲线关于0°线对称。类似特性对于振荡环节和非 最小相位振荡环节、 一 阶微分环节和非最小相位 一 阶微分环节、二阶微分环节和非最小相位二阶 微分环节均适用。对应的奈奎斯特图和伯德图如图5 . 3 . 14～图5 . 3 . 17所示。


　　　　　　　　　　
图5.3.14 不稳定惯性环节的奈奎斯特图与伯德图


　　　　　　　　　　




　
图5.3.15 不稳定的一阶微分环节的
奈奎斯特图与伯德图




图5.3.16  不稳定的振荡环节的
奈奎斯特图与伯德图



图5.3.17 不稳定的二阶微分环节的 奈奎斯特图与伯德图


5.3.2    开 环 系 统 的 频 率 特 性
　　用频域分析法分析和设计开环系统 ， 主要是根据系统的开环频率特性进行的 。 而系统 开环频率特性常用奈奎斯特图和伯德图表示 。 所以有必要学习这两种图形的手工便捷绘 制 方 法 。
1. 开环奈奎斯特曲线的绘制
系统开环传递函数的典型环节分解，可将其表示成N  个典型环节串联形式，即



                        (5.3.40)
设典型环节的频率特性为
G;(jw)=A(w)eiφ;(m)                                                         (5.3.41)
则系统开环频率特性为
                   (5.3.42)
系统开环幅频特性和开环相频特性为
                 (5.3.43)
　可见，系统开环频率特性编写为组成开环系统的各典型环节频率特性的合成，在同一频率下，幅 值相乘，相角相加。根据式(5.3.43),对于各个w 值，计算相应的G(jw)H(jw), 便可绘制出系统 的开环奈奎斯特图。实际上， 一般不需要绘制准确的奈奎斯特图，这里介绍绘制概略开环奈奎斯 特曲线的方法。
概略开环奈奎斯特曲线应反映开环频率特性的三个重要因素：
(1)开环奈奎斯特曲线的起点(w=0+)    和终点(w→∞)。
　　　(2)开环奈奎斯特曲线与负实轴的交点G(jw)H(jw±) 。   交点处的频率wr 称为穿越频率， 可根据
Im[G(jwx)H(jwr)]=0                                                           (5.3.44)
或
φ(w)=/G(jwr)H(jwr)=(2k+1)π                              k=0,±1,±2, …                            (5.3.45)
计算，并求出相应的交点G(jwr)H(jwr)。
(3)确定曲线的变化趋势。即分析奈奎斯特曲线的变化范围(象限)、单调性等。
例5.3. 1 某零型单位反馈系统，开环传递函数为
　　　　　　　　　　　　
试概略绘制系统的开环奈奎斯特曲线。 解  系统的开环频率特性为
　　　　　
起点为A(O)=K,φ(0)=0°,            终 点 为A(∞)=0,φ(∞)=―(90°+90°)=-180°,                            令 φ(wr)=
　/G(jw?)=―180°, 得 w? →∞, 可见，曲线最后以―180°趋于原点，与负实轴没有交点。由于惯性 环节的幅频和相频是单调变化的，所以，系统的开环频率特性也是单调变化的，变化范围为第IV 象限和第Ⅲ象限。系统开环奈奎斯特曲线如图5.3.18所示。
例5.3.2 设 某I 型系统开环传递函数为
   K,T?,T?>0
试概略绘制系统的开环奈奎斯特曲线。




　　　　　　　　　　　　
图5.3.18 系统概率开环奈奎斯特曲线
解  系统的开环频率特性为
　　
起点为A(O)=∞,φ(0)=-90°, 终点为A(∞)=0,φ(∞)=―(90°+90°+90°)=―270°。
令φ(wr)=-90―arctanT1wr―arctanT?wx=-180°,               即 arctanTiwr+arctanT?w=90°,           对
上式两边取正切，并运用三角公式，可解得 ,于是，求得
　　　　　　　　　　　　
　　　由于积分环节和惯性环节是单调变化的，所以开环奈奎斯特曲线是单调的变化，相角单调减 小，从第Ⅲ象限到第Ⅱ象限。概略开环奈奎斯特曲线图如图5.3.19中曲线a 所示。
　　　由于曲线从无穷远处起始，可以考虑其低频渐近线。起点以―90°方向起始，所以渐近线与 虚轴平行，可求得渐近线与实轴的交点。由
　　　　


得起始处极限值：Re[G(j(0+)H(j0+)]=-K(T?+T?), 即为渐近线与实轴的交点。
　　　概略绘制开环奈奎斯特曲线如图5.3.19中曲线b 所 示。由于开环奈奎斯特曲线用于系统分析时， 一般不需要 准确知道低频渐近线，取坐标轴为其渐近线即可。
例5.3.3 已知单位反馈系统开环传递函数为
　　　
试绘制系统开环奈奎斯特曲线。 解  系统开环频率特性为
　　　



图5.3.19 系统概略开环幅相曲线



起点为A(O)=∞,φ(0)=-90°, 终点为A(∞)=0,φ(∞)=90°―(90°+90°+90°)=―180°,与负
实轴的交点：令φ(w?)=arctantw,-90―arctanT1wx-arctanT?wx=-180°,   当 时，得
　　　　　　　
变化范围：时，奈奎斯特曲线位于第Ⅲ象限或第Ⅲ象限和第IV象限；时，奈 奎斯特曲线位于第Ⅲ象限和第Ⅱ象限。开环概略奈奎斯特曲线如图5.3.20所示。
　　　系统开环传递函数中含有一阶微分环节，则幅值和相角随w 增大不是一个单调变化过程， 绘制奈奎斯特曲线必然有凹凸现象，因为凹凸程度对系统分析的影响不大，故绘制概略曲线时这 一现象无需准确反映。
通过以上例题，可以归纳出系统奈奎斯特曲线的绘制有以下规律：
　　　(1)奈奎斯特曲线的起点(w=0),   取决于比例环节 K 和系统积分或微分环节个数(即系统 型别),如图5.3.21所示。

v<0,  起点为原点。
v=0,  起点为实轴上的K 点。
　　v>0,  设v=4k+i(k=0,1,2,…;i=1,2,3), 时，为i×  (一90°)-180°的无穷远处。
　　
图5.3.20 系统开环奈奎斯特曲线





则 K>0    时，为i×   (一90°)的无穷远处；K<0

　　　
图5.3.21 v=0,1,2,3   型系统开环概略奈奎斯特曲线

(2)奈奎斯特曲线的终点(w→∞),  取决于开环传递函数的分子、分母多项式的阶数。
　　　设系统开环传递函数的分子多项式阶数为m, 分母多项式阶数为n, 除比例K 外，计分子多 项式中最小相位环节的阶次和为m,  非最小相位环节的阶次和为m2, 分母多项式中最小相位环 节的阶次和为n?, 非最小相位环节的阶次和为n2, 则有
m=m?+m? n=n?+n?
(5.3.46)
特殊地，当开环传递函数为最小相位系统，即只由最小相位典型环节组成时，若




n=m,G(j∞)H(j∞)=K*                                                          (5.3.47)
n>m,G(j∞)H(j∞)=0/(m-n)×90°                                                       (5.3.48)
2. 开环伯德图的绘制
　　　假设系统开环传递函数G(s)H(s) 由 N 个典型环节组成，则由式(5.3.43)可知，开环对数幅 频和对数相频特性，分别为N 个典型环节的对数幅频和对数相频特性之和，即
(5.3.49)

(5.3.50)
　　　因此，可以先作出各典型环节的对数幅频和对数相频曲线，然后进行叠加，即可得到系统开 环伯德图。前文介绍了各典型环节的概略对数幅频曲线图的绘制方法，根据幅频渐近曲线的特 点，可以不必单独绘制出各典型环节幅频曲线再叠加，而是按以下步骤直接绘制：
(1)将开环传递函数进行典型环节分解，即写成式(5.3.1)的形式。
　　　(2)确定一阶环节(包括惯性环节和一阶微分环节)、二阶环节(包括振荡环节和二阶微分环 节)的交接频率，并将各交接频率标注在半对数坐标的w 轴上。设其中最小的交接频率为wmin。
　　　(3)绘制低频段的特性 当wwmin 时为低频段，由于一阶环节和二阶环节的在各自交接 频率前的低频渐近线为OdB,所以，开环幅率特性的低频部分由比例环节K 和积分环节个数v 决 定，对数幅频特性为
　　　　　　　　　　　　　                 (5.3.51)  可见，其开环系统低频渐近线斜率为―20vdB/dec 。为获得低频渐近线，还需确定该直线上的一 点，可以根据式(5.3.51),任选一wo 值，计算相应的La(wo),  得到点(wo,La(wo)) 。 实际绘制中， 经常选取特殊点，如取a=1,     得点(1,20lgK); 或者取w=K,        得点(K,0) 。  过 点(a,La(a)),
可作出开环对数幅频低频渐近线。
　　　(4)延长低频渐近线，直到遇到交接频率，根据交接频率所属的典型环节特性，改变渐近线 的斜率，然后继续延长。如果遇到新交接频率，重复以上过程，直到经过最大的交接频率。例如， 遇到惯性环节时，渐近线的斜率在原有基础上减小20dB/dec 。各典型环节种类与斜率改变量间 的关系如表5.3.1所列。
表5.3.1交接频率处斜率的变化量表

典型环节类别	典型环节传递函数	交接频率	斜率变化量

一阶环节
(T>0)
　　　　　	―20dB/dec

	Ts+1		20dB/dec
	Ts-1


二阶环节
(wn>0,0<5≤1)	　　　


Un	―40dB/dec
	　　　

40dB/dec
	　　　　
	　　　　




　　　当然，如果开环系统的多个典型环节的交接频率相同时，则渐近线在该交接频率处的斜率改 变量是各典型环节的代数和。
例5.3.4  某系统开环传递函数为
　　　　　　　　　　　　　
试绘制系统的开环伯德图。
解(1)将开环传递函数分解成典型环节的形式，即
　　　　　　　　　　　　
可见，系统有5个典型环节：比例环节、一阶微分环节、积分环节、惯性环节、振荡环节。其中，比 例和一阶微分环节为非最小相位环节。
(2)确定各典型环节的交接频率：
w=1――    惯性环的交接频率；
w?=5――   一阶微分环节的交接频率；
w?=20――   振荡环节 的交接频率。
　　　(3)绘制幅频低频渐近特性曲线。因为有一个积分环节，v=1,   所以斜率为―20dB/dec 。 取  w=K÷=K=10,          得渐近线上的一点(10,0)。过该点，从低频开始以―20dB/dec  作低频渐近线。
　　　(4)延长低频渐近线，遇到第一个交接频率w?=1,   斜率减小20dB/dec,  变成―40dB/dec;  再 延长到w?=5,   斜率变成―20dB/dec;   延长到w?=20,   斜率变成―60dB/dec,  再适当延长后结束。
如有必要，可以参照误差曲线，对渐近线进行适当修正。
　　　(5)绘制对数相频曲线，取若干个频率点(一般可取各环节的交接频率),按下式计算相应的 相角，即
　　　　　　　　
应注意最后一项振荡环节的相角，应该参照式(5.3.22)取值。图5.3.22为该系统的开环伯德图。
　　　若系统的开环传递函数是由最小相位环节组成，则称为最小相位系统。相应地，如果开环系 统中含有一个或多个非最小相位环节，则称为非最小相位系统。最小相位系统和对应的非最小 相位系统的幅频特性相同，而相角是不同的，其中最小相位系统的相角变化范围是最小的，这也 是最小相位系统名字的由来。
如例5.3.4中，开环系统相角的变化范围为90°~-270°,共变化360°。而如果是对应的最
小相位系统 ,则其相角计算式为
　　　　　　　　　




　　　　　　　　　　　
图5.3.22 例5.3.4系统的伯德图
可计算出相角变化范围为一90°~―270°,共变化180°,小于原非最小相角系统。
3. 延迟环节和延迟系统
　　　能够使输出量经过恒定的延时不失真的复现输入量的环节，称为延迟环节。如皮带传输机、 输送流体或气体的管道，都可以看做延迟环节，输入输出关系如图5 . 3 . 23所示。该环节的时域  表 达 式 为
c(t)=1(t―t)r(t―t)                                                                           (5.3.52)
对该式运用拉普拉斯变换实数位移定理，得该环节的传递函数为
                             (5.3.53)
频率特性为
G(jw)=eiu=1・/―w=1./-57.3°tω                                                                          (5.3.54)
可见，其幅频特性恒等于1,相频特性是w 的线性函数，所以其幅相曲线为 一 个无限旋转的单位 圆，如图5 . 3 . 24所示。


　　　　
图5.3.23 延迟环节的输入输出曲线



　　　　　　　　　
图5.3.24 延迟环节的奈奎斯特曲线和伯德图

　　　当系统开环传递函数中含有延迟环节，称为延迟系统。如图5 . 3 . 25所示的延迟系统，由惯 性环节和典型环节组成。
由结构图得系统开环传递函数为
　　　　　　　　　　　　　　　　　



频率特性为
　　　　　　　　　　　　　　　　
幅频特性为
　　　　　　　　　　　　　　　　　
相频特性为
φ(w)=-57.3×0.5w―arctanw
　　　延迟系统开环幅相曲线如图5.3.26所示。由图可见，由于延迟环节的加入，使得相角延迟 增加。所以，含有延迟环节的系统，属于非最小相位系统。





R(s)                                                           C(s)
e-05s



图5.3.25 延迟系统结构图
4. 传递函数的频域实验确定



　
图5.3.26 延迟系统的幅相曲线

　　　最小相位系统的一个重要特征是：系统的对数幅频特性曲线与传递函数，存在一一的对应关 系。若已知系统对数幅频特性曲线，那么,就能确定这个系统的传递函数。当然，其对数相频特 性也能被唯一确定。所以，频率响应实验法成为确定系统的传递函数的简便方法。
　　　如图5.3.27所示，连接好被测系统。选择适当的输人正弦信号的幅值，改变正弦信号频率， 从低频到高频，依次记录下相应频率点的系统稳态输出信号的幅值和相位。由输出信号与输入  信号的幅值比和相位差绘制对数频率特性曲线。
Asinwt
被测系统      记录仪器


图5.3.27 频域实验法示意图
　　　从低频到高频，用斜率为0dB/dec,±20dB/dec,±40dB/dec, …              的直线段，分段逼近对数频 率特性曲线，获得对数幅频渐近特性曲线。再由渐近特性曲线推导出系统的传递函数。当然，要 注意，如果实验的被测系统是开环测量，则为开环幅频特性曲线，相应得到开环传递函数。如果 是闭环状态下测量，则最后得到闭环传递函数。确定传递函数的过程，是绘制过程的逆过程，以 下题为例，来说明如何由伯德图确定系统的传递函数。
　　例5.3.5 用频域实验法对某最小相位系统在开环状态下测得对数频率特性如图5.3.28 所示，试确定该系统的开环传递函数。
　　解  (1)确定系统低频特性，即积分环节个数 v 。 因为对数幅频低频渐近线的斜率为 ―20vdB/dec,   由图可知，本系统低频渐近线斜率为20dB/dec,   所 以v=-1,        即系统有一个微分




环节。
　　　(2)确定系统传递函数结构形式，交接频率 和斜率变化。
①w?:  斜率变化-20,对应惯性环节。
　　②w?:  斜率变化―40,对应振荡环节或双惯 性环节系统传递函数。所以
　　
　(3)由给定条件确定传递函数参数。 低频渐近线方程为



图5.3.28 某最小系统对数幅频特性曲线

　　　　　　　　　　　　　

由给定点(1,0)及v=-1	得 K=1,   根据直线方程
La(wa)―L(ws)=k(lgwa―lgws)
及给定点(1,0),(w?,12),	斜 率 k=20,   得
w?=102=3.98≈4
由给定点(100,0),(w?,12),      斜 率k=-40,      得
　　　　　　　　　　　　　　　　
由谐振峰值
　　　　　　　　　　　　
整理得
45?-452+108=0
计算得ζ=0.204,ζ2=0.979。由于0<ζ<0.707时，有谐振峰值，所以取ζ=0.204≈0.2。 所以得系统的传递函数为
　　　　　　　　　　　　

5.4    线 性 系 统 的 稳 定 性 分 析

　　　稳定性是线性系统重要的性能指标。本节将介绍两种频域稳定判别方法，即奈奎斯特稳定 判据和对数稳定判据。前文所介绍的开环奈奎斯特图、伯德图的绘制就是分别为使用这两个判 据作准备。频域稳定判据使用简便，而且易于推广到非线性系统，所以在实践中广泛应用。
5.4.1   频 率 域 稳 定 判 据
1. 稳定判据的导出
奈奎斯特稳定判据是以复变函数中的Cauchy  原理为基础的。这一原理可以用复变量理论



进行严格的数学证明，这里只作一些定性的解释。
1)Cauchy    原 理
Cauchy 原理也称为幅角原理。设s 是复变量，F(s)是有理分式函数，设为
(5.4.1)
式中：z?,p;(i=1,2,…,m;j=1,2,…,n)                   是 F(s)   的零、极点，假设它们在复数平面中的分布如图
5.4.1(a)    所示。假设复变量s 变化，在s 平面中形成一条不通过F(s)  任一零极点的闭合路径I。 相应地，在F(s)  平面中映射成对应的闭合曲线IF,  称 为T 的像或映射，如图5.4.1(b) 所示。
　　　　　　　　　　
(a)                                             (b)
图5.4.1 s 和F(s) 平面的映射关系
(a)s 平面；(b)F(s) 平面。
　　易知，当 s 沿 P  顺时针移动一周时，那些未被包围的零极点到s 的 矢 量(s―z;)  和(s―p;),    其 相角的变化量为0。而被包围的零点形成的矢量(s―z1), 其相角的变化量为―2π。根据式 (5.4.1)可得，方程F(s)  的相角变化量为
(5.4.2)
　即矢量 F(s)  沿曲线TF 绕坐标原点顺时针转动了一圈。同理可证，如果包围在路径T  中 的 是 F(s)  的 极 点p?,   那么,当s 沿 T 顺时针移动一圈时，矢量F(s)  将沿曲线IF  绕坐标原点逆时针方 向转动一圈。
　　　因此，得幅角原理的结论：在s 平面上封闭曲线I 域内共有P 个极点和Z 个零点，且封闭曲  线 T 不穿过F(s)   的任一个极点和零点。当s 顺时针沿封闭曲线I  变化一周时，函数F(s)   在F(s)	 平面上的轨迹IF  将包围原点 R=P-Z             周(其中，零极点个数考虑重根数，R<0      顺时针，
R>0      逆时针)。

2)复变函数F(s)  的选择
我们知道，线性系统的开环传递函数是有理分式函数，设
　　　　　　　　　　　　　　　　　
其对应的闭环传递函数为
　　　　　　　　　　
取 F(s)为以下形式
　　　　　　　　　　





(5.4.3)


(5.4.4)



(5.4.5)



对比式(5.4.3)、式(5.4.4)、式(5.4.5)可知，F(s)  的零点为闭环传递函数Φ(s) 的极点；F(s)  的 极 点为开环传递函数G(s)H(s)    的极点。
　　　由式(5.4.5)可知，在复平面上，F(s) 曲 线IF  与对应的G(s)H(s)     曲 线IcH 间仅相差实数1, 即 TF  向左平移1个单位得到曲线Ic 。  所以由曲线Tc   包 围 ( - 1 ,j0)点的圈数，即得到曲线I'F  包 围F(s)   平面原点(0,j0)的圈数。 IF  和 TcH曲线的关系如图5.4.2所示。
3)s   平面闭合曲线I   的选择
　　　为了能够判断闭环系统的稳定性，需要知道闭环极点在s 平面的右半平面的个数，根据式 (5.4.5)即需知道F(s) 函数的零点在右半平面的个数，若零点个数为0,则系统稳定。为此，要求 闭合曲线I  能够把整个右半平面包围起来，则I   由两部分组成。
　　半径无穷大的半圆s=∞e,θ∈[-90°,+90°]; 虚 轴s=jw,w∈[-∞,  十∞],如图5.4.3(a) 所示。
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                      (b)
图5.4.2 TF 和FcH曲线的关系                  图5.4.3 s 平面闭合曲线P 的选择
当原点有开环极点时，需避开该极点，即在原点附近，取一段半径无穷小的圆弧，
s=ee?                                                                          (5.4.6)
其中，ε为正无穷小，θ∈[-90°,90°],如图5.4.3(b) 所示。
4)G(s)H(s)  闭合曲线的绘制
　　s 平面闭合曲线I  关于实轴对称，故G(s)H(s)     曲 线TcH也关于实轴对称，所以只需绘制TcH  在 Ims≥0    对应的部分，得G(s)H(s)    半闭合曲线，仍记为TcH 。下面来分析映射的IcH 。 上半虚 轴 s=jw,w∈[0,+∞],          对 应G(s)H(s)=G(jw)H(jw),            即为奈奎斯特曲线。半径无穷大的1/4 圆 s=∞e?,θ∈[0°,+90°],           映射成
　　　　　　　　　　　　　　　
式中：m、n 为零极点数。可见映射成一个点。该点和虚轴无穷远处映射的点相同，所以不再重
复考虑。
而当原点有极点时，需分析半径无穷小的圆弧的映射。此时，开环传递函数可写成
(5.4.7)
式中：,当ε为正无穷小时，趋近于∞e-jiu。



,当s=ee       时，写成极坐标形式|K|e∠G?(O)。所 以
G(s)H(s)|                                              ≈○ex        (一 θ)+∠G?(j0)]                                                                                       (5.4.8)


可见，对应的曲线为角度从/G?(j0)  起，圆心角为v×  (一 θ), 半径为∞的圆弧。即可从G(j0+)H(j0+)  点起逆时针绘制半 径无穷大、圆心角为×90°的圆弧。
　　综上可知，开环传递函数含积分环节(原点有极点)时， 系统奈奎斯特曲线分成两段。虚轴s=jw,w∈[0,+∞],         对  应 的G(s)H(s)=G(jw)H(jw) 。        小 圆 弧 s=ee?,θ∈[0°,
　+90°],对应 (s),  即可从G(j0+)H(j0+)      点 起逆时针作半径无穷大、圆心角为v×90°  的圆弧，如图5.4.4 所示。
5)闭合曲线TF 包围原点圈数R 的计算




V=1
　　　　GGj0_)H(j0_) G(j∞)H(j∞)

@


GGo.)HG0+)
图5.4.4 F(s) 平面的半闭合曲线IcH

　　　由式(5.4.5)可知，曲线IF  包 围F(s)   平面原点(0,jO)的圈数等于曲线IcH 包 围 ( - 1 ,j0) 点 的圈数。不过，由于绘制的IcH 是半闭合曲线，所以数包围点(- 1,jO)的圈数不方便。在此，引 入“穿越”的概念，指曲线IcH 穿过(一 1,j0) 点左侧负实轴。其中随w 增大，曲线以相角增大的趋 势进行的穿越，称为正穿越，记作N+;  相角减小的穿越，称为负穿越，计为N 。IcH    起始或终止 于这段负实轴的，计为半次穿越。由此得到奈奎斯特曲线包围(- 1,j0)  点 的 圈 数 为 N=
(N+-N-)。
由于闭合曲线IF  包围原点圈数R 是奈奎斯特曲线包围(一1,j0)点圈数的2倍，所以
R=2N=2(N+-N_)                                                                   (5.4.9)
　　闭环系统稳定的充分必要条件，奈奎斯特曲线不穿越点(-1,j0),  且逆时针包围( ― 1,j0) 点 的圈数R 等于开环传递函数的正实部极点数P。
闭合曲线TcH包围函数F(s)=1+G(s)H(s)          的零点数即闭环控制系统正实部极点数为
Z=P-2N                                                                      (5.4.10)
2. 奈奎斯特稳定判据
　　　奈奎斯特稳定判据：系统的闭环右极点数为Z=P-2N,N         是从(一 1,j0)点出发沿实轴负向 的射线被奈奎斯特曲线穿越的次数，若Z=0,    系统闭环稳定；若Z≠0,    系统闭环不稳定；若奈奎 斯特曲线穿过(一 1,j0)点时，则系统临界稳定。
　　　补充说明1 N=N+-   N,N+    为自上而下的穿越(相角增大的方向)为正穿越；N- 为自下 而上的穿越(相角减小的方向)为负穿越。
　　　补充说明2  若0型以上的系统，奈奎斯特曲线则需要补线，应自G(jw) 曲线的G(jaw)|=o+  起，沿逆时针方向补画一个半径为无穷大，角度为v×90° 的圆弧，为统一奈奎斯特曲线的方向，以 顺时针方向标示箭头，作示意图时以虚线代表半径为无穷大的圆弧。
　　　补充说明3 对于起点(或终点)位于-1之左的实轴的奈奎斯特曲线，称该曲线对负实轴进 行了半次穿越(正负规定同补充说明1)。
例5 .4 .1   已知某单位反馈系统的开环传递函数为



　　　　　　　　　　　　　　　　　　
试绘制其开环幅相曲线，并用奈奎斯特判据判断系统的稳定性。


　　　解  因为该系统为Ⅱ型系统，所以要补线，w从 0 _ 到0+补画180°线，如图5.4.5所示，此时，奈奎斯特曲 线对 ― 1之左的负实轴有1次负穿越，由奈奎斯特判 据得
Z=P-2N=P-2(N+-N)=
0-2×(0-1)=2
系统有2个闭环右极点，该系统闭环不稳定。
例5.4.2  已知某单位反馈系统的开环传递函






w=0+
(一)



Ⅱ型

　　　-1 G(jw)


J



0






w=0-   +1

数为






图5.4.5 例5.4.1系统的奈奎斯特曲线



试用奈奎斯特判据判断系统的稳定性。
　　　解  根据开环传递函数可知该系统有1个 开环右极点，奈奎斯特曲线如图5.4.6所示，由 图可知，奈奎斯特曲线起始于- 1之左的负实 轴，此时具有半次正穿越，由奈奎斯特判据得
Z=P-2N=P-2(N+-N_)=
　　　　　　
该系统闭环稳定。
3. 对数频率稳定判据
由前可知，奈奎斯特稳定判据的关键是根
据开环频率特性曲线(奈奎斯特曲线)确定穿越次数N














图5.4.6  例5.4.2系统的 奈奎斯特曲线
或 G(jw)   曲 线 在 w 由0 → ∞变化时绕

(-1,j0)      点转过的角度。
　　对数频率稳定判据，就是将奈奎斯特稳定判据由奈奎斯特图推广到伯德图上，即用开环对数 频率特性曲线确定N。 由于绘制开环对数频率特性曲线比较容易，同时，对数频率特性曲线还 便于对系统进行设计和校正，因此对数频率稳定判据应用更广。
　　　为了能够应用对数频率特性曲线来确定穿越次数N,  应该找出开环幅相特性曲线与对数频 率特性曲线的对应关系，以便把在奈奎斯特图中求 N 的方法“翻译”到伯德图中去。
　　　幅相特性曲线对(- 1,j0)之左的负实轴的穿越，则完全等同于相频特性曲线，当所对应的对 数幅频特性曲线在w 轴之上时，对φ=-180°线的穿越。
　　对数频率稳定判据：系统的闭环右极点数为Z=P―2N,N       是相频特性曲线(当所对应的对 数幅频特性曲线在w 轴之上时)对φ=-180°线的穿越次数，若Z=0,   系统闭环稳定；若Z≠0,   系 统闭环不稳定；
　　　同前一样，使相角增大的穿越为正穿越，使相角减小的穿越为负穿越。自然使用公式 Z=P  一 2N,N=N+-N-          来判断闭环系统的稳定性。对于非0型系统，使用对数频率稳定判据时，对其 相频特性曲线也有一个“补线”的问题及“半次穿越”的问题。



　　　例5.4.3 将图5.4.7中的开环幅相特性曲线转换为开环对数频率特性曲线，并用对数频 率稳定判据判断该系统的闭环稳定性。
　　　　　　　　　　　　　　　　　　　　　　　　
图5.4.7 例5.4.3系统的奈奎斯特曲线与伯德图
　　　解  根据左图的奈奎斯特曲线可转换为右图的伯德图，根据对数频率稳定判据，a、b、c三 点 均为相频特性曲线对―180°线的穿越，其中c 点为无效穿越，故
Z=P-2N=P-2(N+-N)=0-2×(1-1)=0


该系统闭环稳定。
例5.4.4  已知某单位反馈系统的开环传递函数为
　　　　　　　　　
试用对数频率稳定判据判断系统的稳定性。
　　　解  因为该系统为Ⅱ型系统，所以要补线，在相频特性曲 线中从一180°线向上补画180°到0°线，如图5.4.8所示。此时， 相频特性曲线对一180°线有1次负穿越，由奈奎斯特判据得
Z=P-2N=P-2(N+-N)=0-2×(0-1)=2
系统有2个闭环右极点，该系统闭环不稳定。此结论与例
5.4.1相同，说明无论用哪种判据得出的结论都是正确的。
例5.4.5  已知某单位反馈系统的开环传递函数为




　
图5.4.8 例5.4.4系统的伯德图



　　　　　　　　　
试用对数频率稳定判据判断系统的稳定性。
　　　解  因为该系统为I  型系统，所以要补线，在相频特性 曲线中从-270°线向上补画90°到―180°线，如图5.4.9所 示，此时，相频特性曲线起始于-180°线为半次负穿越，由 奈奎斯特判据得
Z=P-2N=1-2(N+―N                     二 ) =
　　　　　　　　



　
图5.4.9 例5.4.5系统的伯德图

该系统闭环稳定。此例说明含有不稳定环节的闭环系统也可能稳定。




5.4.2   稳定裕度
　　若 Z=P―2N=0    (其中P=0),    则奈奎斯特曲线G(jw)H(jw)   过(―1,j0) 点时，系统临界稳 定，幅频和相频同时满足条件


　　　　　　　　　　　　
系统远离临界稳定条件的程度，可用稳定裕度表示，如图5.4.10所示。



(5.4.11)

　　　　　　　　　　　　　　　　　　　　　　
(a)                                                  (b)
图5.4.10 稳定裕度示意图
(a)h>1,y>1;(b)h(dB)>0,y>1。
1. 相角裕度Y
　　系统截止频率w 处，幅值满足条件A(w.)=|G(jw.)H(jw.) |=1  时，若其相角再减小γ后， 将达到临界稳定条件，即
/G(jw.)H(jwe)-γ=―180°                                               (5.4.12)
所以
γ=180°+/G(jw.)H(jw)                                                   (5.4.13)
则γ称为相角裕度。
当γ>0时，系统稳定；当γ=0时，临界稳定；当γ<0时，系统不稳定。
2. 幅值裕度h
　　设系统穿越频率为wz,wr 满足相角条件φ(wr)=∠G(jow)H(jw)=(2k+1)π,k=0,±1, 士2,…,若幅值再增大h 倍后，将达到临界稳定条件，即
h|G(jw)H(jwr)|=1                                                        (5.4.14)
可得
                      (5.4.15)
若在半对数坐标下，则
h(dB)=―20lg           |G(jw?)H(jwr)|                                    (5.4.16)
h 称为幅值裕度。
当h>1  ( 或h>0dB)  时，系统稳定；当h=1   ( 或h=0dB)   时，系统临界稳定；当h<1  (或h<



OdB)时，系统不稳定。
例5.4.6  已知单位反馈系统，开环传递函数为
　　　　　　　　　　　　　　　　　　
设 K 分别为4和10时，试确定系统的稳定裕度。 解  系统开环频率特性为
　　　　　　　　　　　　　　
由穿越频率wr 的定义得 ― 3arctanwx=-180°,      解得 wx=√3。
当 K=4  时，对应的幅值,所以 由 w. 定义，即,可化成w2+1=K2/3。
解方程得截止频率为
w.=√K2/3- 1=√42/3- 1=1.23
此时，对应的相角/G(jw.)=-152.9° 。    所以相角裕度γ=180°+∠G(jw.)=27.1°。
　　当 K=10   时，穿越频率与K=4   时相同，即w,=√3,    此频率下的幅值为  1.25,h=0.8,          截 止 频 率 w.=√K2/3-1=1.908,                相角为 /G(jw.)=-187.0° 。      相 角 裕 度 y=180°+G(ja.)=-7.0°。
　　　可见，系统当K 取不同值时，系统稳定性发生变化。 K  增大，将使得系统稳定裕度减小，甚 至不稳定，如图5.4.11所示。
　　　　　　　　　　　
图5.4.11 例5.4.6系统的伯德图

5.5   闭 环 系 统 的 频 域 性 能 指 标
　　　应用频率法分析系统的性能，就是研究系统的频域性能指标，包括开环系统的频率指标，如 开环增益、相角裕度、截止频率等，以及闭环系统的频域指标，如谐振峰值、谐振频率和带宽频率



等，并研究将时域性能指标转换成频域性能指标，以指导系统的设计。
5.5.1   控 制 系 统 的 带 宽
　　设闭环系统Φ(s) 的零频率时幅频特性为20lg|Φ(j0)|(dB),        则当幅频特性下降到比零频率 幅频值低3dB 时，所对应的频率为带宽频率，简称带宽ws 。即 当w>w    时，有
20lg|Φ(jw)|<20lg|Φ(j0)|-3                                                             (5.5.1)
系统的带宽，反映了系统响应的快速性，也反映了其对输入信号的复现能力，如图5.5.1所示。


　　　　　　　　　　　
图5.5.1 系统带宽特性
对二阶系统来说，其标准型为
　　　　　　　　　　　　　　　
幅频特性为
　　　　　　　　　　　　　　　
所以Φ(j0)=1,    即 2 0lg|Φ(jO)|=0dB,        则由式(5.5.1)得
　　　　　　　　　
解得二阶系统的带宽频率为
w=wn√ 1-252+√2-4+45
由于二阶系统的上升时间为
　　　　　　　　　　　　　　　　　　
















(5.5.2)












(5.5.3)


(5.5.4)

　若wn 一定，当w  增加时，则tp 减小，即系统的反应速度变快。当然，带宽太宽，会引入噪声，对系 统工作有不利影响。
5.5.2   闭 环 系 统 频 域 性 能 指 标 和 时 域 指 标 的 转 换
　　在5.3.1节介绍过，式(5.5.2)所示的二阶系统，当0<ζ≤ √ 2/2时，有谐振峰值出现，由式 (5.3.24)可知，谐振峰值M, 与ζ相关。同时，由二阶系统超调量公式



o%=eπ/√ 1-3×100%                                              (5.5.5)
可知，超调量o%也与ζ相关，所以频域内指标M, 与时域中指标?%具有关联性。将式(5.3.24)
代入式(5.5.5),可得

(5.5.6)

　已 知M,  和o% 都随ζ增加而减小，所以同一系统，M,  和σ%有 一致性，M,  增大时，σ%也增大。 M, 可以看作是度量系统振荡程度的频域指标。

二阶系统开环传递函数标准型为
　　　　　　　　　　　　　　　　
频率特性为
　　　　　　　　　　　
由截止频率的定义可知
　　　　　　　　　　　　
化简得
　　　　　　　　　　　　　　　　
求 解w:/wn 得
　　　　　　　　　　　　　　　　
根据相角裕度公式(5.4.13)得
　　　　　　
将式(5.5.7)代入式(5.5.8)得
y=arctan[25(√45+1-252)]
可见，相角裕度γ和阻尼比ζ也是一一对应的关系，且ζ越大，γ越大，ζ越小，γ越小。 已知二阶欠阻尼系统调节时间的近估公式为
　　　　　　　　　　　　　　　　　　　　
将式(5.5.7)代入上式得
　　　　　　　　　　　　　　　　
对式(5.5.9)两边取正切，代入式(5.5.10)得
　　　　　　　　　　　　　　　　　　　



















(5.5.7)


(5.5.8)


(5.5.9)







(5.5.10)


(5.5.11)



　　由此可以看出，二阶系统的调节时间ts 与截止频率w。和相角裕度γ有关。截止频率w. 越 大，调节时间t,越小。
　　通过上面的讨论可知，二阶系统的时域指标与相角裕度和截止频率有着准确的对应关系。 对高阶系统而言，不存在这种确定的关系。如果高阶系统的性能主要由一对共轭复数闭环主导 极点来支配，则可以把二阶系统的这种对应关系近似扩展到高阶系统中去。此外，通过对许多高 阶系统的研究，利用统计的方法归纳出如下两个近似公式，即
)35°≤γ≤90°              (5.5.12)
　　　　　　　　　　　　　　　　　　　                             (5.5.13) 其中
　　　　　　　　
应用这两个公式估算高阶系统的时域性能指标，一般偏保守，但这可以给设计留有余地。

5.6   线性系统的频域法校正

　　　自动控制系统是根据它所完成的具体任务设计的。任务不同，对控制系统性能指标的要求 也不同。应用频率法设计控制系统，通常的性能指标是：相角裕度、截止频率或谐振频率、带宽频 率以及稳态误差等。如果给定的指标是时域性能指标，则应转换成相应的频域指标。
　　　因为系统是由被控对象和控制装置两大部分组成的，对这两部分同时进行设计比较合理，可 以充分发挥控制的作用，使被控对象获得良好的技术性能。然而，许多场合还是先有被控对象， 然后进行控制系统设计。
　　　当被控对象的特性和系统的性能指标确定后，便可以进行系统的初步设计。根据被控对象  所需的功率、加速度和可能提供的能源形式，选择合适的执行元件。它可能是一种直流伺服电动  机、交流伺服电动机或液压伺服马达等。根据被控量的性质可选择合适的测量元件，如电位器、 热电偶、压差变送器等。然后选择给定元件和比较元件。根据稳态误差的要求，在比较元件和执  行元件之间配置一个增益可调的放大器，这样就构成了一个控制系统的不可变部分。
　　　多数情况下，这样初步设计出来的系统，仅靠调节放大器的增益，一般不能满足性能指标要 求。如提高增益，虽可使稳态误差降低，但将导致瞬态响应振荡加剧，甚至不稳定。在这种情况 下，需要在系统中引入一些特性易于改变的装置，改变系统的特性，以满足性能指标的要求。这 样的附加装置叫校正装置(或补偿装置),而校正装置的设计工作通常称为对系统进行校正。
　　根据校正装置在系统中的连接方式，分为串联校正和反馈校正两种。为了避免功率损耗，串 联校正装置通常安置在前向通道偏差测量点之后和放大器之间，或安置在放大器之间。根据校 正装置的特性，工程上常用的串联校正有串联超前校正、串联滞后校正和串联滞后一超前校正 等。反馈校正装置接在局部反馈通道上，常用的反馈校正有比例反馈校正和测速反馈校正等。
　　　开环系统的伯德图是分析和设计控制系统的重要工具。分析时可将开环对数幅频特性以穿 越频率附近为中频段，低于中频的为低频段，高于中频的为高频段。开环系统的对数幅频特性曲 线的低频段表征了系统的静态特性，中频段表征了系统的动态特性，而高频段则表征了系统的抗 干扰能力。一个特性较好的系统，其各频段有以下特点：



　　　(1)相角裕度γ为30°~60°;幅值裕度h>6dB,  则系统的稳定性比较好。当中频段以 ―20dB/dec的斜率穿越零分贝线，而且这一斜率占有足够的频带宽度，系统会具有较好的稳定性；
(2)截止频率w。越高，则系统的快速性越好；
(3)低频段的斜率陡，增益高，表示系统的稳态精度好；
(4)高频段衰减得越快，即高频特性负分贝值低，说明系统抗高频噪声干扰的能力越强。 以下介绍如何用伯德图设计校正装置，以达到期望的性能指标。
5.6.1   串 联 超 前 校 正
　　　无源超前网络的电路图如图5.6.1(a) 所示，图中u?  和 u2 分别为网络的输入电压和输出电 压。如果不考虑负载效应，则该网络为线性环节，其传递函数为
(5.6.1)

　　　传递函数的零、极点分布如图5.6.1(b) 所示，可见，实数零点比实数极点更靠近虚轴。由于 超前校正网络的静态特性小于1,使得开环系统的增益减小。为了消除这一影响，所以需提高该 环节增益a 倍，其传递函数为
(5.6.2)

J


0
一     a

(a)                                                       (b)
图5.6.1 无源超前网络及其零级点分布
　　根据式(5.6.2),可以画出无源超前网络aG(s)   的对数频率特性，如图5.6.2所示。由图可 见，超前网络对频率在1/(aT)   和1/T  之间的输入信号具有明显的微分作用，且输出信号的相角 超前于输入信号的相角，超前网络的名称即由此而来。

超前网络的相频!
由 得产生最大超前相角的频率为
　　　　　　　　　　　　　　　　
可见，wm 是和 两个交接频率的几何中心。  将式(5.6.4)代入式(5.6.3),得最大相角为
　　　　　　　　　　　　　　



(5.6.3)



(5.6.4)




(5.6.5)



可见，当w<wm  时，,相角增加；当w>wm   时 ，相角减小，如图5.6.2所示。
　　　式(5.6.5)表明，最大超前角qm 仅与分度系数a 相关。a 值选得越大，超前网络的微分效应越强。但 a 值过大，对抑制噪声不利，所以选用的a 值一般不超过20。在a 处，超前网络的对数幅值为
L(wm)=201g|aG.(jwm)|=10lga                                                       (5.6.6)
φm 和 1 0lga  与 a  的关系曲线，如图5.6.3所示。由图可见，当a 增大到一定程度时， φm 随 a  增 大 而增加的趋势下降。因此，如果要求校正网络提供大于60°的超前角时， 一般采用两极RC 网 络 串联，而不用单级a 过大的RC 网 络 。





图5.6.2  无源超前网络伯德图



12
10







a
图5.6.3 无源超前网络qm 与a 的关系曲线

　　利用超前网络设计系统的基本原理是利用超前网络的或 PD 控制器的相角超前特性，在已 校正系统的截止频率w".处，产生足够大的超前相角，以弥补原系统在该处的相角滞后。只要正 确地将超前网络的交接频率1/(aT)   和 1 /T 选在已校正系统截止频率的两边，就可以使已校正 系统的截止频率和相角裕度满足性能指标的要求。超前校正网络的设计步骤如下：
(1)根据稳态误差要求，确定开环增益 K。
(2)检验原系统相角裕度等性能指标。
　　　(3)根据截止频率w” 的要求，计算超前网络参数；其中设计关键是选择最大超前角频率等 于要求的系统截止频率，即wm=w"。。此时，―L'(w".)=L(wm)=10lga,           计 算 出a  值，并由 T=    	,计算T, 得校正网络参数。


例5 .6 .1   设控制系统如图5 .6 .4所示。其中待校正系统的开环传递函数为G? (s)=
,若要求系统在单位斜坡输入信号下，位置输出稳态误差es≤0.1rad,      开环系统截止频率 w".≥4.4rad/s,     相角裕度γ"≥45°,幅值裕度h"dB≥10dB,     设计串联无源超前网络G.(s)。
R(s)
G.(s)
一

图5.6.4 例5.6.1系统结构图



解  首先调整开环增益。因为原系统为I  型系统，因此可按稳态误差的要求
　　　　　　　　　　　　　　　　　　
确定开环增益。取K=10,   则待校正系统开环传递函数为
(5.6.7)
　　　(1)校验该系统性能指标。根据式(5.6.7),绘制出未校正系统的对数幅频特性，如图5.6.5 所示。由图得未校正系统的截止频率为w'.=3.1rad/s,      可计算得相角裕度为
Y=180°-90°-arctanw.=17.9°
由于截止频率和相角裕度均低于指标要求，考虑到超前网络有使相角超前的特点，故采用串联超 前校正。
　　　(2)确定校正网络参数。试选wm=w".=4.4rad/s,    由图5.6.5可查得原系统在该频率处的 幅值L'(w".)=-6dB 。  所以可令校正网络的幅值10lga=6,   算得a=4,   则
　　　　　　　　　　　　　　　
所以得超前网络传递函数为
　　　　　　　　　　　　　　　　　
校正后系统的开环传递函数为
　　　　　　　　　　　　　
最后进行校验
　　　γ"=180°+arctan(0.456×4.4)―90°―arctan(0.114×4.4)―arctan4.4=49.7° 满足设计要求。
　　　　　　　　　　
图5.6.5 例5.6.1控制系统的伯德图
应当指出，在有些情况下，串联超前校正无效，它受以下两个因素的限制：



　　　(1)闭环带宽要求。若待校正系统不稳定，需要超前网络提供很大的相角超前量，以致a 必 须很大，造成系统带宽过大，通过系统的高频噪声电平很高。
　　　(2)在截止频率附近相角迅速减小的待校正系统， 一般不宜采用串联超前校正。因为随着  频率的增大，待校正系统相角迅速减小，超前校正网络难以较多地增大系统的相角裕度。此时， 可以考虑用多个超前校正网络串联，或者是采用其他校正形式，如滞后校正。
5.6.2   串 联 滞 后 校 正
　　无源滞后校正网络的电路图如图5.6.6(a)所示。如果不考虑负载效应，该网络为线性环 节，其传递函数为
                       (5.6.8)
其中1,T=(R?+R?)C。   传递函数的零、极点分布图如图5.6.6(b) 所示。可见，实 数极点比实数零点更靠近虚轴。
j


　　　　　　　0 方     一

(a)                                                   (b)
图5.6.6 无源滞后网络及其零级点分布
　　根据式(5.6.8),可以绘制出滞后网络的伯德图，如图5.6.7所示。由图可见，该网络对频率 在1/T  和1/(bT)  之间的输入信号具有积分效益，且输出信号的相角滞后于输入信号的相角，因
此称为滞后网络。相角最大值公式与超前网络类似，最大滞后角为qm=arcsin1+b,m=T           历
　　相角滞后特性，会带来系统相角裕度减少的不利影响，所以采用滞后网络进行校正，应避免 最大的相角滞后角发生在校正后系统开环截止频率w"。附近，在设计时总是使第二个交接频率 1/(bT)   远小于w”,一般取
                            (5.6.9)
此时，滞后网络在校正后系统开环截止频率w".处产生的相角滞后为
φ 。(w”)=arctanbTw".―arctanTw".
由两角和的三角公式得
                     (5.6.10)
根据式(5.6.9)和b<1,   式(5.6.10)可简化为
φ.(w".)=arctan[0.1(b―1)]                                                    (5.6.11)
φ.(w”) 和20lgb 与b 的关系曲线，如图5.6.8所示。由图可见，滞后网络的相角滞后在-6°以内。




　　　
图5.6.7 无源滞后网络伯德图



　
图5.6.8  无源滞后网络q.(w”) 和20lgb与
b的关系曲线(1/bT=0.1w".)

　　滞后校正的基本思路是：利用滞后网络或PI 控制器的高频衰减特性，使已校正系统截止频 率下降，从而使系统获得足够的相角裕度，以改善系统的动态性能，并提高抑制高频噪声的能力。
滞后校正网络的设计步骤如下：
(1)根据稳态误差要求，确定开环增益K。
　　　(2)利用已确定的开环增益，画出待校正系统的对数频率特性，确定待校正系统的截止频率 w,  相角裕度γ和幅值裕度h。
(3)根据相角裕度γ"的要求，选择已校正系统的截止频率。此频率处
y"=180°+φ(w" 。)+qe(w".)
取φ.(w".)=-6°,      由上式计算相应的w"。。
(4)根据下式确定滞后网络参数b 和 T, 即
20lgb+L'(w")=0                                                           (5.6.12)
                           (5.6.13)
(5)校验校正后系统的性能指标。
例5.6.2 设一单位反馈控制系统，其开环传递函数为
　　　　　　　　　　　　　　
试设计串联校正装置，要求校正后系统的静态速度误差系数等于30(1/s),  相角裕度不低于40°, 幅值裕度不小于10dB, 截止频率不小于2.3rad/s。
　　解  首先确定开环增益 K 。 由 于 ,故待校正系统开环传递函数为 ;再计算待校正系统的频域指标w=12rad/s,y=-25° 。     系统伯德 图如图5.6.9所示。
显然，待校正系统不稳定，且截止频率附近的相角迅速减小，在这种情况下，采用串联超前校
正是无效的。考虑到本例中待校正系统截止频率远大于要求值，有较大余量，所以采用滞后校 正。现作如下设计：
φ(w".)=γ(w")―180°
由此可知，在图5.6.9中绘出φ(w)曲线。根据性能要求γ"≥40°,且设新截止频率处φ.(w")=    ―6°,则由γ"=180°+φ.(w"),  可得γ(w".)≥46°,φ(w".)=-134° 。     于是，由φ(w)曲线可查得



　　　　　　　　　　
图5.6.9 例5.6.2控制系统的伯德图
w“.=2.7rad/s 。 然后由图查出L'(w".)=21dB 。 因为20lgb+L'(w"”)=0,    可得b=10-21/20=0.09。
再由,得
于是，滞后校正网络的传递函数为
　　　　　　　　　　　　　　　
　　最后，检验已校正系统的性能指标。根据校正后系统的开环传递函数，可在图5.6.9中绘制  对数幅频特性曲线。由图可见，截止频率w".=2.7(rad/s), 由式(5.6. 11)及 b=0.09  可得， φ.(w")=   ―5.2°, 于是，校正后系统的相角裕度γ=41.3°。然后，可以用试算法得校正后系统穿  越频率w" 为6 . 8(rad/s),    可求出校正后系统的幅值裕度为10.5dB, 所有性能指标均满足要求。
　　采用串联滞后校正，可以增大系统的相角裕度，从而减小超调量和振荡次数，改善系统的动 态性能。由于串联滞后网络使开环系统的高频幅值衰减，故提高了系统对高频噪声的抑制能力。 当系统的动态性能满足要求时，采用滞后校正还可以提高开环增益，以改善系统的稳态精度。但 是由于截止频率降低，频带变窄，所以调节时间变长了。另外，为了避免滞后网络负相角的影响， 需要将校正网络的交接频率安置在远离w"。频率很低的地方，这样有可能使滞后网络的时间常数 大到难以实现的程度。
　　　总结串联超前校正和串联滞后校正的优缺点，可见两者各有所长。然而，有时单独使用这两 种中的一种均无效。例如，有的系统采用超前校正，效果不明显，且高频噪声不满足要求，采用滞 后校正，调节时间又太长，这时，可以采用滞后一超前校正。这种方法兼顾滞后和超前两种校正 方法的优点，克服了彼此的缺点。
5.6.3   串联滞后 一 超前校正
　　无源滞后一超前网络的电路图如图5.6.10(a) 所示。如果不考虑负载相应，该网络为线性 环节，其传递函数为
　　　　　　　　　　




令 R?C?=Ta,R?C?=T?,R?C          ?=Ta,   则上式可写成
　　　　　　　　　　　　
因分母多项式具有两个不相等的负实根，则式(5.6.14)可以写成
　　　　　　　　　　　　　　　
比较式(5.6.14)和式(5.6.15)的分母得
　　　T?T?=T?T?   T?+T?=Ta+T?+T.T?
设 T?>T,      由式(5.6.16)得
　　　　　　　　　　　　　　　　　　
其 中a>1,    为衰减因子，则有
T?=aT。
　　　　　　　　　　　　　　　　　　　
以上两式代入式(5.6.15),则得到无源滞后一超前网络传递函数的实用形式，即
　　　　　　　　　　　　　　




(5.6.14)


(5.6.15)


(5.6.16)
(5.6.17)











(5.6.18)

　其 中(Tas+1)/(aTas+1)         是滞后部分，(T?s+1)/(Tas/a+1)            是超前部分，传递函数的零、极点分 布如图5.6. 10(b) 所示。由图可知，滞后部分的零、极点比超前部分的零、极点更靠近虚轴。
　　　　　　　　　　　　　　　　　　　　　
(a)                                                    (b)
图5.6.10 无源滞后一超前网络及其零极点分布
根据式(5.6.18)绘出滞后一超前网络的伯德图如图5.6.11所示。由图可知，当w=w?=
时，校正网络的相角为零。在w<w?   的频段内，校正网络起滞后校正的作用。在w>W1  的频段内，校正网络起超前校正的作用，且相频曲线对w   点斜对称。滞后一超前网络的低频和 高频幅值均为0dB,参照滞后网络可知，该网络幅值衰减的最大值为
L(w)=―20lga                                                                (5.6.19)
频段为1/T 。和1/T,  之间。a 值越大，则第一个交接频率1/(aTa)  和最后一个交接频率a/T,    间 的距离越大。




　　　　　　　　　　
图5.6.11 无源滞后一超前网络的伯德图
　　应该指出，设计滞后一超前校正网络，只需确定Ta、T?  和 a 这三个独立的变量，  一旦确定了 这三个参数，其传递函数和伯德图就完全确定。
　　　滞后一超前校正的基本原理是：利用滞后部分改善系统的稳态性能，而利用超前部分改善系 统的动态性能。设计方法是先设计滞后部分，使它在满足稳态要求的前提下，提供部分相角裕 度；然后再设计超前部分，将超前部分的两个交接频率配置在已校正系统截止频率的两旁，使其 提供性能指标要求的相角裕度的差额，以及给出希望的截止频率，即带宽。当未校正系统不稳 定，且要求校正后系统的响应速度、相角裕度和稳态精度都比较高时，宜采用这种校正方式。

　　　　　　　　　　　　　　　
　要求系统校正后满足下列指标：静态速度误差系数K=30(1/s),          相角裕度γ"≥45°,截止频率 w".≥7(rad/s) 。  试设计一个串联校正网络装置。
　　解  (1)根据稳态误差的要求确定开环增益。由于系统是I  型系统，故根据静态速度误差 系数的要求，取
　　　　　　　　　　　　　　

此时，未校正系统的开环传递函数为
(5.6.20)
　　　(2)根据已确定的开环增益以及式(5.6.20)的传递函数，求得未校正系统的截止频率和相 角裕度分别为w=11.4(rad/s)         和γ=-25°。可见，未校正系统不稳定，需要进行校正。若只采  用超前校正，由于截止频率附近处相角迅速减小，超前校正的效果不明显，且截止频率还会提高， 远 大 于w".≥7(rad/s)      的要求，使实现成本增加，且系统带宽过大，易引入噪声影响；若只采用滞  后校正，则截止频率会下降很多，以至于低于指标要求的7(rad/s),     系统响应迟缓，同样也不理  想，在这种情况下，考虑采用滞后一超前校正。



　正后系统截止频率等于w., 必须用滞后网络降低20dB, 即20lga=20dB,   故求得a=10 。 选择滞 后部分的第二个交接频率远离已校正系统的截止频率，可取
　　　　　　　　　　　　　　
则 Ta=0.71～1.43,     取 Ta=1,   故aTa=10,    于是，滞后部分的传递函数为
　　　　　　　　　　　　　　　
加入滞后部分的系统传递函数为
　　　　　　　　　　　　
此时相角裕度γ=26°。
　　　(4)超前部分的设计。因为设计滞后部分时，a 值已经确定，因此，根据式(5.6.5)可以求出 超前部分提供的最大超前角为
　　　　　　　　　　　　　　　
　为了充分利用超前部分的相角超前作用，令校正后的截止频率w".与产生最大超前角的频率wm 相重合。在原系统∠'(w)曲线上查找10dB 对应的频率，为7(rad/s),    由于超前部分在wm 处的 对数幅值为―10lga=-10dB,      即令wm=w"=7(rad/s),      于是，可得
　　　　　　　　　　　　　　　　　
则
T?=0.45
因此，超前部分的传递函数为
　　　　　　　　　　　　　　　　　
滞后一超前校正网络的传递函数为
　　　　　　　　　　　　　　
(5)校验已校正系统的性能指标。根据加入滞后一超前校正的系统开环传递函数
　　　　　　　　
　计算校正后系统的截止频率为w".=7(rad/s);相角裕度γ"=50° 。 因此，满足了规定的指标。如 果第一次设计不能全面满足指标要求，必须重选w"。,以调整a 和 Ta 值，重新进行设计。
　　　无源校正网络广泛应用于自动控制系统的串联校正和反馈校正。当用于串联校正时，由于 网络的输入阻抗低，输出阻抗高，会引起明显的负载效应，有时需要在网络的输入端和输出端引 入隔离放大器，并提供所需要的增益。实际应用中，还常用由运算放大器和电阻、电容组成的有 源校正网络，由于它本身具有放大能力，且输入阻抗高，输出阻抗低，设计、调整方便，因此应用越 来越广泛。
应当指出，上述设计校正装置的方法实质上是一种试探法，但只要设计者具有一定的经



　验，毋需多次试探，就能设计出满足性能指标要求的控制系统，但答案不是唯一的。在理论设 计完成之后，还需要进行实际系统的调试工作，如果由于系统固有的非线性、变参数和负载效 应等因素影响，未能满足全部性能指标，还需要适当调整校正装置的参数，直到全部满足要求 为止。
5.7   线性系统频域法的应用

　　　频率法是在频域内应用图解法分析控制性能的一种工程方法，它不必求出系统的微分方程 就可以分析系统的动态性能和稳态性能。本节用一个高速列车倾斜控制系统的设计过程来说明 这种设计的特点。
　　　高速列车的倾斜控制系统如图5.7.1所示，试设计一个合适的校正网络，使系统阶跃响应超  调量小于5%,调节时间小于0.6s(2%  准则),并使系统对斜坡输入响应的稳态误差小于15%。 然后，计算系统的实际响应并检查实验结果。
C(s)
　　　　　　　倾斜角 Ss+10Ks+50)
一


图5.7.1 控制系统结构图
　　要使系统对斜坡输入满足稳态精度要求，首先考虑简单的增益放大器G(s)=K,      则系统的 稳态误差为
　　　　　　　　　　　　　　　　　　　
　　　为了提高系统的稳态精度，必须采用高增益，但是过高的增益，对系统的稳定性和动态性能 都会产生不利的影响。下面给出了不同K 下的系统响应及相应的MATLAB  文本(图5.7.2)。
可见，当K=280  时，系统的K,=6.72,es=14.9%,         能满足设计要求，但系统对阶跃输入的o%=
14%,t,=0.9s,       大于设计指标值。因此，必须采用较为复杂的校正网络。
MATLAB 文本程序如下：
clear;
K=[50100200280];
numg=[12];deng=[1605000];
t=0:0.05:5;
for  i=1:4
[nums,dens]=series(K(i),1,numg,deng);
[num,den]=cloop(nums,dens);
[y,x]=step(num,den,t);
Ys(:,i)=y;
end
plot(t,Ys(:,1),       '一',t,Ys(:,2),':',t,Ys(:,3),'-―′,t,Ys(:,4),                              '一');
xlabel('Time(sec)');ylabel('y(t)');
grid



　　　　　　　　　　　
图5.7.2 MATLAB仿真系统的阶跃响应
接下来，用超前校正网络进行系统设计。设超前校正网络的传递函数为
　　　　　　　　　　　　　　　　　
　设计要求：(1)系统对斜坡输入响应的稳态误差小于15%,Kv=6.7;(2)      系统对阶跃输入的超调 量小于5%;(3)按2%准则调节时间t, 不超过0.5s 。根据给定的设计要求，假设系统能够近似 为二阶系统，运用如下有关公式估算：
　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
得ζ=0.7,wn=10.5。
由系统参数估算应具有的相角裕度，得
　明确频域指标后，可以按Bode 图法设计校正网络。先绘制K=280   时原系统的Bode 图 。 MATLAB  文本程序如下：

clear;
Pi=3.14
K=280;numg=[12];deng=[1605000]; [num,den]=series(K,1,numg,deng);    w=logspace(0,2,200);
[mag,phase,w]=bode(num,den,w);
　[Gm,Pm,Weg,Wep]=margin(mag,phase,w); Phi=(70―Pm)*Pi/180;
alpha=(1+sin(Phi))/(1―sin(Phi));
　M=-10*log10(alpha)*ones(length(2),1); [mag,phase,w]=bode(num,den,w);
semilogx(w,20*log10(mag),w,M),grid;









%原系统相角
　%所需附加的相角 %计算a
%用于绘―10lga线

xlabel('frequency[rad/sec]'),ylabel('mag[dB]');
由 MATLAB  程序计算得a=1.8,    且由图5.7.3可知，10lga 线与原系统幅频曲线交点处频




率，即wm=7, 所以






即校正环节传递函数为

　　　　　　　　　　　　　　　　
接下来绘制校正后系统的Bode  图，如图5.7.4所示。


20
10

―10― ―20― 30- ―40― ―50―
-60L

图5.7.3 K=280  时原系统的Bode图
MATLAB  文本程序如下：
clear;
K=280;
numg=[12];deng=[1605000];
numgc=K*[0.191];dengc=[0.1061];
[num,den]=series(numgc,dengc,numg,deng); w=logspace(0,3,200);
[mag,phase,w]=bode(num,den,w);
　[Gm,Pm,Weg,Wep]=margin(mag,phase,w); bode(num,den,w);grid;



　
图5.7.4 校正后系统的Bode图

title(['Gaom,argom=',num2str(Gm),'Phase        margin=',num2str(Pm)]); 绘制校正后系统的阶跃响应。
MATLAB  文本程序如下：
clear;
K=280;
numg=[12];deng=[1605000];
numgc=K*[0.191];dengc=[0.1061];
[nums,dens]=series(numgc,dengc,numg,deng);
[num,den]=cloop(nums,dens); t=[0:0.01:2];
step(num,den,t);
grid;
ylabel('y(t)');



以 得 到 较 好 的 仿 真 结 果 。
　　　由 于 用 滞 后 网 络 会 导 致 截 止 频 率 下 降 ， 而 本 题 要 求 的 调 节 时 间 非 常 严 格 ， 动 态 特 性 可 能 会 满 足 不 了 要 求 。 这 里 尝 试 用 滞 后 网 络 来 设 计 一 下 。
因 为 本 例 要 求 校 正 后 系 统 能 具 有 7 0 ° 以 上 的 相 角 裕 度 ， 即
y=180°―6+/G(jo”.)=70°
得
/G(jw".)=-104°
根 据 图 5 . 7 . 6 原 系 统 的 伯 德 图 ， 设w“=2rad/s,          则 原 系 统 在w”     此 处 的 对 数 幅 值 为 1 0 . 3dB 。   由
20lgb=―10.3,           解    得 b=0.305 。    又  由 ,  得 T=16.39,bT=5 。       所 以 得 校 正 网 络 为
　　　　　　　　　　　　　　　　
　　可 以 绘 制 出 校 正 后 系 统 的 阶 跃 响 应 曲 线 如 图 5 . 7 . 7 所 示 ， 可 见 ， 超 调 量 能 满 足 要 求 ， 但 是 调 节 时 间 增 大 到 6s,     和 预 估 的 情 况 一 致 ， 加 入 滞 后 网 络 后 ， 系 统 反 应 变 迟 缓 。
　
图5 . 7 . 5  校正后系统的阶跃响应                        图5 . 7 . 6  原 系 统  的 Bode       图

　　　　　　　　　　





本  章  小  结

　　　本章主要讨论反馈控制系统的频域分析与设计问题。首先介绍了频率特性的基本概念，推 导了系统频率特性函数的表达式，介绍了频率特性的三种常用的图示方法，包括奈奎斯特图、伯 德图以及尼科尔斯图。然后，从研究各种典型环节的频率特性函数入手，介绍了它们的奈奎斯特  图和伯德图，在此基础上，进而介绍概略绘制开环系统奈奎斯特图和伯德图的方法和步骤。在建  模的基础上研究了奈奎斯特稳定性判据和对数频率稳定判据，进而引入了幅值裕度和相角裕度， 并分析研究了频域和时域指标的对应关系。
　　　如果系统的性能指标达不到要求，就需要考虑用校正网络提高系统的性能。本章简要介绍 了系统设计和系统校正的概念，考查了校正串联网络在控制系统中的作用机理。讨论了几种校 正网络的设计和系统综合方法，主要介绍了相角超前校正网络、相角滞后校正网络，以及滞后一 超前校正网络，并介绍了如何用伯德图方法来设计它们。
　　　本章最后研究了一个高速列车倾斜控制系统实例，用MATLAB  工具分别设计了超前和滞 后两种校正网络，来改善该系统的性能。
课后练习题
5-1    试求下图(a) 、(b) 网络的频率特性。
　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                    (b) 5―1题图
5-2    某系统结构图如图所示，试根据频率特性的物理意义，求下列输入信号作用时，系统的稳 态输出cs(t)   和稳态误差es(t)。
(1)r(t)=sin2t。
(2)r(t)=sin(t+30°)―2cos(2t―45°)。
5-3    控制系统如图所示，干扰信号n(t)=0.1sin20t,       要求系统的稳态误差不大于0.001时，试 确定K 值的可调范围。


E(s)
一

5-2题图
5-4         已知系统开环传递函数



　　　　　　　　　
5―3题图
, 当w=1    时，∠G(jw)=

―180°,|G(ja)|=0.5;          当输入为单位速度信号时，系统的稳态误差为1。试写出系统开环频率



特性表达式G(jw)。
5-5   已知控制系统结构如图所示。当输入r(t)=2sint 时，系统的稳态输出 c? (t)=4sin(t 一 30°)。试确定系统的参数5、wn。


R(s)
SG+260.


C(s)


5-5题图
5-6   已知系统开环传递函数 ,试分别计算w=0.5    和w=2 时开环频率特性的幅值A(w) 和相角φ(w)。
5-7   已知系统开环传递函数 ,试分析并绘制t>T    和 T>t   情况下的概略开环幅相曲线。
5-8   试绘制下列传递函数的幅相曲线。
　　　(1) ;(2)  5-9    概略绘制下列传递函数的幅相曲线。
　　　(1) ;(2) ;(3)  5-10        绘制下列传递函数的渐近对数频率特性曲线。
(2)
(3)                      ;
5-11    四个最小相角系统传递函数的近似对数幅频特性曲线如下图所示，试写出对应的传递 函数G(s)。








(a)

L(w)/dB
10
0
[40]
-20
-28
(c)



L(w)/dB
[20]
0      5     100


(b)


5-11题图



5-12    两个最小相角系统传递函数的近似对数幅频特性曲线如图所示，试写出对应的传递函 数 G(s)。
　　　　　　　
5―12题图
5―13   已知单位反馈系统的开环传递函数及其幅相曲线如下，试根据奈奎斯特判据判断闭环 系统的稳定性。
　　　　　　
(1)          (2)            (3)          (4)            (5)
　　　　　　　　　　　　
(6)          (7)          (8)          (9)         (10)
5- 13题图

(2)
(3)                    ;

(5)

(8)

(9)                (K<1);                                                   (10)
5-14    试用对数稳定判据判断题C5―10 四个系统的稳定性。
5-15        单位负反馈系统的开环传递函数为               ,用奈奎斯特判据确定使闭环系统
稳定的条件。
5-16    已知某系统中                H(s)=1+Ks,          试用频域分析法确定闭环系统临界稳



定时的Kh。
5-17        若单位反馈系统的开环传递函数,试确定使系统稳定K 的临界值。
5-18    设单位反馈系统的开环传递函数,试确定闭环系统稳定的延迟时间t  的 范围。
5-19         已知反馈系统，其开环传递函数为
(1)
　　　　　　　　　　　　　　　　　　　
试用奈奎斯特判据或对数稳定判据判断闭环系统的稳定性，并确定系统的相角裕度和幅值裕度。
5-20    设单位反馈控制系统的开环传递函数为,试确定相角裕度为45°时的a 值 。
5-21        某最小相角系统的开环对数幅频特性如图所示，要求：
(1)写出系统开环传递函数并求出稳定裕度；
(2)将其对数幅频特性向右平移十倍频程；
试讨论对系统性能的影响。
5-22    系统结构图如下，已知 K=1,a=10    时，截止频率 wc=5。 若要求w. 不变，如何改变K
和a 才能使系统相角裕度增加45°。



R(s)
G(s)
一



5―21题图                                5-22题图
5-23        设有单位反馈的火炮指挥仪伺服系统，其开环传递函数为
　　　　　　　　　　　　　　　
若要求系统最大输出速度为2(r/min),    输出位置的容许误差小于2°,试求：
(1)确定满足上述指标的最小K 值，计算该K 值下系统的相角裕度和幅值裕度；
　　　(2)在前向通路中串接超前校正网络 ,计算校正后系统的相角裕度和幅 值裕度，说明超前校正对系统动态性能的影响。
5-24         设单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　　　　　
试设计一串联超前校正装置，使系统满足如下指标：




(1)在单位斜坡输入下的稳态误差
(2)截止频率w.≥7.5(rad/s);
(3)相角裕度γ≥45°。
5-25         设单位反馈系统的开环传递函数为
　　　　　　　　　　　　　　　
要求校正后系统的静态速度误差系数 Kv≥5(rad/s),         相角裕度γ≥45°,试设计串联迟后校正 装置。







第   6   章   线性离散系统的分析


本  章  提  要

　　　离散系统理论与连续系统理论既有本质的区别，又有极大的相似性。本章的内容就是讨论 它们的区别和联系的。本章首先讨论离散信号的数学描述，引入 Z 变换理论及差分方程，建立 线性离散控制系统的数学模型，在此基础上分析离散系统稳定性及计算稳态误差，并分析离散系 统的动态性能与数字校正设计。

6.1    引     言

　　　微处理器及微型计算机的出现，使得数字控制器在工业控制系统中得到越来越广泛的应用。 在控制系统中，只要某处传输或加工的信号是时间的离散函数或是数字信号，前者称为采样控制 系统，后者称为数字控制系统，两者统称为离散控制系统。由于系统中出现了离散信号，因此，上  述各章所介绍的适合于连续线性控制系统的各种分析和校正方法，不再适用于离散控制系统，必 须寻求新的分析校正方法，这正是本章所要介绍的主要内容。
6.2    离散控制系统的基本概念

　　　离散控制系统是一种断续控制方式，最早出现于某些惯性很大或具有较大延迟特性的控制 系统中。
6.2.1    离 散 控 制 系 统 的 应 用
　　　图6 . 2 . 1是工业用炉温自动控制系统的原理方框图。炉子是 一 个具有延迟特性的惯性环  节，时间常数较大。炉温的误差信号经放大后驱动电动机去调整燃料阀门的开度以控制炉温。 若系统的开环放大倍数很大，系统对误差信号将非常敏感，当炉温较低时，电动机将迅速旋转，开  大阀门，给炉子供应更多的燃料。由于炉子本身的时间常数较大，炉温上升很慢，当炉温升高到  给定值时，阀门早已超过规定的开度，因此炉温继续上升，造成超调。电动机将反方向旋转。根 据同样的道理，又会造成炉温的反方向超调，从而引起炉温大幅度的振荡，甚至使系统不稳定。 若系统的开环放大倍数取得很小，系统则很迟钝，只有当误差较大时，产生的控制作用才能克服
给定炉温         放大器与        燃料
执行电机       供应阀


图6.2.1 炉温自动控制系统原理方框图



电动机的非线性“死区”而推动阀门动作。这样虽不引起振荡，但控制作用不及时，调节时间很长 且误差较大。
　　若采用离散控制系统，系统的原理方框图如图6 . 2 . 2所示，在误差信号和电动机之间加 一 个 采样开关，它周期性地闭合和断开。当炉温出现误差时，该信号只有在开关闭合时才能使电动机 旋转，进行炉温调节。当开关断开时，电动机立刻停下来，阀门位置固定，让炉温自动变化，直到 下 一 次采样开关闭合，再根据炉温的误差进行调节。由于电动机时转时停，炉温大幅度超调现象 将受到抑制，即使采用较大的开环倍数，系统仍能保持稳定。
给定炉温  e(t)      K
执行电机


图6.2.2 炉温离散控制系统原理方框图
　　　通过上例可以看出，在惯性很大或具有较大延迟特性的控制系统中，采用连续控制效果并不 理想，而采用断续的离散控制方式反而可取得较好的控制效果。
　　图6 . 2 . 3所示为 一 个典型的离散控制系统原理方框图。系统由采样开关、脉冲控制器、保持 器和被控对象等部分组成 一 个反馈控制系统。
　　　　　　　
图6.2.3  离散控制系统原理方框图
　　随着控制系统复杂性的增加，特别是随着数字计算机技术的发展，离散控制系统在控制精 度、控制速度以及性价比等方面都比模拟控制系统表现出明显的优越性。图6 . 2 . 4所示为以数 字计算机为核心组成的 一 个典型计算机控制系统原理方框图。
　　　　　
图6.2.4 计算机控制系统原理方框图
　　　由于计算机内部参与运算的信号必须是二进制编码的数字信号，因此，计算机控制系统也称 作数字控制系统。通常，需先将连续误差信号e(t)经 模 数 转 换 装 置A/D 进行采样编码，转换成 计算机能够识别的数字信号e*(t),     该信号经数字控制器处理后形成离散控制信号u(t),        再经 过 数 模 转 换 装 置D/A  恢复成连续控制信号 u(t),      作用于被控对象。
6.2.2    离 散 控 制 系 统 的 特 点
　　采样和数控技术在自动控制领域中得到了广泛的应用，其主要原因是采样系统，特别是数字 控制系统较之相应的连续系统具有如下的特点：



　　　(1)由数字计算机构成的数字校正装置，效果比连续式校正装置好，且由软件实现的控制规 律易于改变，控制灵活。
　　　(2)采样信号，特别是数字信号的传递可以有效地抑制噪声，从而提高了系统的抗干扰 能力。
(3)允许采用高灵敏度的控制元件，以提高系统的控制精度。
(4)可用一台计算机分时控制若干个系统，提高了设备的利用率，经济性好。
(5)对于具有传输延迟，特别是大延迟的控制系统，可以引入采样的方式稳定。
6.2.3  离散控制系统的研究方法
　　　由于在离散系统中存在脉冲或数字信号，若仍然沿用连续系统中的拉普拉斯变换方法来建  立系统各个环节的传递函数，则在运算过程中会出现复变量s 的超越函数。为了克服这个障碍， 需要采用Z 变换法建立离散系统的数学模型。我们将会看到，通过Z 变换处理后的离散系统， 可以把用于连续系统中的许多方法，如稳定性分析、稳态误差计算、时间响应分析及系统校正方  法等，经过适当改变后直接应用于离散系统的分析和设计之中。
6.3  信号的采样和保持

　　　将连续信号转变为脉冲信号需要采样器，也称采样开关；而为了控制连续式元件，又需要使 用保持器将脉冲信号转变为连续信号。为了定量研究采样系统，必须对信号的采样过程和保持 过程用数学方法来加以描述。
6.3.1  采样过程
　　　采样就是通过采样开关的作用将连续信号变成脉冲序列的过程，图6.3.1所示为周期采样 方式。周期采样，就是采样开关按一定的时间间隔开闭。该时间间隔称为采样周期，通常用T  表示。

　　　　　
图6.3.1 周期采样
除了周期采样以外，还有其他采样形式。
(1)等周期同步采样。多个采样开关等周期同时开闭。
(2)等周期异步采样。多个采样开关等周期但不同时开闭。
(3)多阶采样。各采样开关以不同的周期开闭。
(4)随机采样。开关动作随机，没有周期性。 本书只讨论开关周期采样的情况。




6.3.2    采 样 过 程 的 数 学 描 述
把连续信号变换成离散信号的过程，叫做采样过程。
　　在理想的采样过程中，连续信号经采样开关的周期性采样后，得到的每个采样脉冲的强度等 于连续信号在采样时刻的幅值。因此，理想采样开关可视为一个脉冲调制器，采样过程可以看做 一个单位脉冲序列 δr(t)   被输入信号e(t)  进行幅值调制的过程，如图6.3.2所示。其中，单位序
为载波信号，e(t)为调制信号。


8(nT) 调制器



　　　　　　　　　



　

图6.3.2 幅值调制过程
当 t≥0    时，输出信号可以表示为
(6.3.1)
式(6.3. 1)为理想采样过程的数学表达式。
　　对于实际采样过程，将连续信号e(t)加到采样开关的输入端，采样开关每隔周期 T 闭 合 一 次，每次闭合时间为 r,于是，在采样开关的输出端得到宽度为 r 的 幅 值 脉 冲 序 列e*(t), 如 图 6 .3 .3所示。
　　　　　　　　　　　　　　　　　　　　　
图6.3.3 实际采样过程
　　　由于采样开关闭合时间z 很小，远远小于采样周期 T,  故 e(t)   在 t  时间内变化甚微，可以近 似认为在该时间内采样值不变。所以e*(t)   可近似视为 一个宽度为 r,  高 度 为e(nT)   的矩形脉冲 序列，即
(6.3.2)



式中：[1(t-   nT)-1(t―nT―z)]   为两个单位阶跃函数之差，表示在nT 时刻，一个高度为1、宽 度为r 的矩形脉冲。当 →0时，该矩形窄脉冲可用nT 时刻的一个冲量为r 的δ函数来近似表 示，即
[1(t-nT)-1(t-nT―t)]=r・δ(t-nT)                                                              (6.3.3)
将式(6.3.3)代入式(6.3.2)可得
                   (6.3.4)
针对具体的离散控制系统，对上式可作如下说明：
　　如果采样信号e*(t) 未经保持器直接加到后续系统中，则每个脉冲的强度，正比于闭合时间 t, 故后面系统的放大倍数将扩大r 才符合实际情况。若使原系统的总增益在采样前后保持不 变，则需要增加一个增益为(1/t)的放大器。
　　如果采样信号e*(t)经保持器直接加到后续系统中，那就可以不考虑脉宽t 对系统增益的 影响，则采样信号可直接按理想采样开关输出的信号来处理。由于大多数的离散控制系统，特别 是数字控制系统均属于这种情况，因此，通常将采样开关视作理想采样开关，而采样信号e*(t)   用 式(6.3.1)来描述。
考虑到δ函数的特点，式(6.3.1)也可写为
(6.3.5)

6.3.3   采样定理
　　连续信号e(t)  经采样后变为采样信号e*(t),    采样信号的信息不等于连续信号的全部信息。 因此，采样信号的频谱与连续信号的频谱相比，要发生变化。研究两类信号之间的相互联系，这 需要用频谱分析的方法。频谱，实质是一个时间函数所含不同频率谐波成分的分布情况。
因为单位脉冲序列δr(t)  是一个周期函数，可以展开为傅里叶函数，并写成其复数形式，即


　　　　　　　　　　　　　　　　　
式中：ws为采样角频率，w?=2π/T;Cn    为傅里叶系数，即
　　　　　　　　　　　　　　　　
由于在区间中，只有在t=0   时δr(t)   才有值，且e?jnu,|=o=1,     故有
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
由式(6.3.1)可得，采样信号为
　　　　　　　　　　　　　
上式两边各进行拉普拉斯变换，得


(6.3.6)


(6.3.7)



(6.3.8)
(6.3.9)


(6.3.10)




                       (6.3.11)
　　　又因为 E(s)=L[e(t)],    令 s=jw, 则 (jw)  为 e(t) 的频率特性， |E(jw)| 为 e(t) 的 幅 频 特 性或称频谱。 一般来说，e(t)   的 频 谱 |E(jw)|     是 一个单 一 的连续频谱，其谐波分量的最高频率 Wmax是无限大的，如图6.3.4(a)所示。但因为当w 较大时， |E(jw)| 将很小，故可认为 wmax是 有 限 值 ，e(t)   的频谱可近似如图6 .3 .4(b)  所 示 。
|E(jw)





0           Wmax     w (b)
图6.3.4 连续信号e(t) 的频谱
(a) 实际频谱；(b)  近似频谱。
E*(jw)    为 e*(t)     的频率特性， |E*(jw)|      为 e*(t)     的频谱。由式(6.3. 11)可得
(6.3.12)
可见，采样后的信号频谱由无数条频谱叠加而成，每一条频谱曲线是采样前信号e(t)   的 频
谱|E(jw)|    平移 nws,   幅值下降为原幅值的 的结果，而且
　　　　　　　　
令 w=w+ws,     代入式(6.3. 12),展开得
　　　　
更为 一般的有
E*(jw+jws)=E*[j(w+nws)]=E*(jw)                                   n=0,±1,±2, …                         (6.3.13)

故 E*(jw)    是 以ws 为周期的周期函数，其频谱 |E*(jw)|	也 是 以ws  为周期的周期函数，如图
6.3.5所示。
特别地，当n=0    时， |E*(jw)|      的频谱分量 |E(jw)|/T
称为主频谱，它就是连续信号e(t)   频
谱 |E(jw)|     的1/T。
　　　从图6.3.5可以看出，当时，各个频谱分量不重叠，通过滤波可以滤除E*(jw) 中 高 于 wmax的频谱，剩下的频谱与E(jw)   形状相同，即可从采样信号e*(t)     中复现出原来的连续信号 e(t);    否 则 ，E*(jw)     中各个频谱波形相互搭接，E*(jw)    就无法通过滤波得到E(jw),     也就无法从 e*(t)    中复现出e(t)。
由以上分析可以得到如下结论：可以从采样信号e*(t)    中完全复现连续信号e(t)    的 条 件 是




　　　　　　　
图6.3.5 采样信号e*(t) 的频谱
w, 必须大于或等于输入采样开关的连续信号e(t)  频谱中的最高频率wmax的2倍，即
ws≥2wmax
这就是著名的香农(Shannon) 采样定理。


6.3.4   零阶保持器
　　　由图6.3.5可知，当采样信号的频谱中各波形互不重叠 时，可以用一个具有图6.3.6所示的幅频特性的理想低通滤波 器无畸变地复现连续信号的频谱，只是各频谱分量都是原来的  1/T 。 然而，这样的理想低通滤波器在实际中是无法实现的。 工程中最常用、最简单的低通滤波器是零阶保持器。
　　　零阶保持器将采样信号在每个时刻的采样值e(nT) 一 直 保持到下一个采样时刻，从而使采样信号e*(t)   变成阶梯信号 eh(t),如图6.3.7所示。因为这种保持器的输出信号en(t)在 每一个采样周期内的值为常数，其导数为0,所以称为零阶保 持器。





图6.3.6 理想低通滤波器的 幅频特性

　　　当零阶保持器输入信号为单位脉冲信号δ(t)  时，其输出是幅值为1、持续时间为 T 的一个 矩形脉冲δh(t),即
　　　
图6.3.7 零阶保持器的输入输出信号



gh(t)=1(t)-1(t-T)                                                               (6.3.15)
对零阶保持器的单位脉冲响应 gh(t)进行拉普拉斯变换，可得零阶保持器的传递函


数为
　　　　　　　　　　　　
令 s=jw, 得到零阶保持器的频率特性为
　　　　　　
式中：T 为采样周期；w, 为采样角频率，
零阶保持器的幅频特性为
　　　　　　　　　　　　　　　
零阶保持器的相频特性为
　　　　　　　　　　　　　　　　　　





(6.3.16)


(6.3.17)





(6.3.18)


(6.3.19)

可见，当w=0  时，                               ,φh(0)=0°;       当 w=ws  时，G|n(jw)|=
,而φh(ws)=π。
零阶保持器的幅频特性和相频特性如图6.3.8所示。
　　　从幅频特性上看，零阶保持器具有低通滤波特  性，但不是理想的低通滤波。零阶保持器除了允许采  样信号的主频分量通过外，还允许部分高频分量通  过。因此，零阶保持器复现出的连续信号eh(t)  与 原 信号e(t)是有差别的。同时，由于离散控制系统的连 续部分也具有低通滤波特性，可将通过零阶保持器的  绝大部分高频频谱滤掉，而且零阶保持器结构简单， 在实际中得到了广泛的应用。但应注意到，从相频特 性上看，零阶保持器产生正比于频率的相位滞后。因 此，零阶保持器的引入，将造成系统稳定性下降。
若将零阶保持器传递函数按幂级数展开，则有


　　　　　　
若取级数的前两项，得
　　　　　　　　　　　　　　
实现它的方法很多，可采用放大器和 RC网络或有源网络来实现，如图6.3.9所示。


(6.3.20)



(6.3.21)




　　　　　　
(a)                                                              (b)
图6.3.9 零阶保持器的实现
(a)RC网络方式；(b) 运算放大器方式。

6.4   Z  变 换 理 论

　　线性连续控制系统可采用线性微分方程来描述，用拉普拉斯变换分析它的暂态性能及稳态 性能。而对于线性离散系统，则可以采用线性差分方程来描述，用Z 变换来分析它的暂态性能 及稳态性能。Z 变换是研究离散系统的主要数学工具，它是由拉普拉斯变换引导出来的，实际上 就是离散信号的拉普拉斯变换。


6.4.1          Z变 换 的 定 义
连续信号f(t)  的拉普拉斯变换为
　　　　　　　　　　　　　　
连续信号f(t)   经过采样后的离散信号f*(t)   为
　　　　　　　　　　　　　　　
它的拉普拉斯变换为
　　　　　　　　　　　　　
可见，式(6.4.2)有s 的超越函数eTs,   不便于计算，故引入一个新的复变量Z 。令
z=es
或
　　　　　　　　　　　　　　　　　　　
则有
　　　　　　　　　　　　　
如果式(6.4.5)所示的级数收敛，则定义F(z)  为 f*(t)    的 Z 变换，记作 Z[f"(t)]=F(z)。










(6.4.1)


(6.4.2)


(6.4.3)


(6.4.4)


(6.4.5)

　　　需要指出的是，F(z)  是f*(t)    的 Z 变换，它只考虑了采样时刻的信号值f(nT) 。  同时，对一 个连续信号f(t)而言，由于在采样时刻f(t)的值就是f(nT), 所以也称F(z) 是 f(t) 的 Z 变 换，即




(6.4.6)

6.4.2         Z变换的求法
1. 级数求和法
对于式(6.4.1)形式的离散信号f*(t),     将其展开得
　　　
　　　　　　f(0)δ(t)+f(T)δ(t-T)+f(2T)δ(t―2T)+…+f(nT)δ(t―nT)+ … 对其进行拉普拉斯变换得
F*(s)=f(0)×1+f(T)e?+f(2T)e?2T+ …+f(nT)eTs+ …                                                (6.4.7)
　　　令 ,可得f"(t)     的 Z 变换展开形式，只要知道f(t)   在各个采样时刻的数值，即可求 得 Z 变换。这种级数展开式是开放形式，有无穷多项，应用少，通常写成闭合形式。
例 6.4.1 求单位阶跃函数1(t)的 Z 变换。
解  由 于 1(t)  在任何采样点的值均为1,则1(nT)=1,     有
Z[1(t)]=z+z?1+z2+ …                     十z”+ …
上式可看作一个等比数列，公比为z?1 。 若满足|z-1|<1,      则有
　　　　　　　　　　　　　
例6.4.2 求指数函数f(t)=e“(a>0)   的 Z 变换。
解  在个采样时刻f(nT)=eaT,         则由式(6.4.6)得
F(z)=1+e“z-1+e-2aTz-2+…emTz”+ …
上式可以看成一个等比数列，公比为(eTz)-1;     若满足|eTz|>1,     则有
　　　　　　　　　　　


2. 部分分式法
一般地，连续函数的拉普拉斯变化具有如下形式：
　　　　　　　　　　　　　　　　　　
将其展开为部分分式和的形式为
　　　　　　　　　　　　　　　　　　
对于上式中的每个分量,其拉普拉斯反变化为A;e,    而对于Ae, F(s)的 Z 变换为
　　　　　　　　　　　　　　　　　
例6.4.3 已知 ,试求其 Z 变换F(z)。










其 Z 变 换,则

(6.4.8)



解  对进行部分分式展开得
　　　　　　　　　　　　　　
则
f(t)=L?1[F(s)]=1-e“
　　　　　　　
　例6.4.4 求 f(t)=sinwt      的 Z 变换F(z)。 解  f(t)    的拉普拉斯变换为
　　　　　　　　　　　　　
则其Z 变换为
　　　　　　　　
　　　　　　　　　　　　
3. 留数计算法
若已知f(t)的F(s) 及其全部极点s;,则 f(t)的 Z 变换为
(6.4.9)

在 s=s;   处的留数。
当F(s)  具有一阶极点s=s;   时，其留数R; 为
(6.4.10)
当 F(s) 具有q 阶重极点s=s;   时，则
(6.4.11)
　例6.4.5 已知 ,试求其Z 变换F(z)。 解  F(s)具有两个一阶极点s?=-1,s?=-2,    则
　　　　　　　　　
　　　　　　　　　　　　　
例6.4.6 求 f(t)=t 的 Z 变换F(z)。 已知 t<0 时 ，f(t)=0。
解  f(t)   的拉普拉斯变换为,在s=0   处有两重极点，所以F(s)   在s=0    的留数为



　　　　　　　　
由式(6.4.9)可得
　　　　　　　　　　　　　　　　　
常用时间函数的Z 变换表如表6.4.1所列。
表6.4. 1 Z 变换表

序号	X(s)	x(t)	X(z)
1	e-nTs	δ(t-nT)	z”
2	1	δ(t)	1
3	　　　　　	1(t)	　　　　　　　
4	　　　　　	t	　　　　　　
5	　　　　　	　　　　　　　	　　　　　　
6	　　　　　	　　　　　　　	　　　　　
7	　　　	a1/T	　　　　　　　
8	　　　　　	e?a	　　　　　　
9	　　　　	tea	　　　　　　
10	　　　　	　　　　　　	　　　
11	　　　　	1―ea	　　　　　
12	　　　　	　　　　　	　　　


13

　　
　　
　　　　　	　　　
　　　
　　　　



14


　　

　　
　　　　　
　　　
　　　
　　　　




(续)

序号	X(s)	x(t)	X(z)


15

　　
　
　　　　　	　　
　　　
　　　　
16	　　　　	sincot	　　　　　
17	　　　　	cosut	　　　　　
18	　　　　	sinhot	　　　　　
19	　　　　	coshout	　　　　　
20	　　　　	1-cosut	　　　　
21	　　　	e?a  sincot	　　　　
22	　　　	e“cosout	　　　　
23	　　　	e-a-e-k	　　　　　

24
　　　
　　	　
　　　　　


6.4.3         Z变换的基本定理
1. 线性定理
若 Z[f? (t)]=F? (z),Z[f? (t)]=F? (z),       且a?、a2 均为常数，则
F(z)=Z[a?f?(t)±a?f?(t)]=a?F?(z)±a?F?(z)
2. 延迟定理(负偏移定理)
设 Z[f(t)]=F(z),             且 t<0     时 ，f(t)=0,f(t)              在时间上产生 kT
f(t―kT), 则有
Z[f(t―kT)]=z*F(z)






(6.4.12)

时间的延迟后得 (6.4.13)

　　式(6.4.13)说明，原函数f(t)   在时域中延迟k 个周期T 后，其Z 变换为原函数f(t)    的Z 变 换F(z) 乘以算子z-k。因此，可将 z?* 算子视作一个延迟环节，它把采样信号f(nT) 延迟了k 个周期T,  如图6.4.1所示。





　　　　　　　　　
图6.4.1 延迟定理示意图
3. 超前定理(正偏移定理) 若 Z[f(t)]=F(z),  则有
(6.4.14)
超前定理示意图如图6.4.2所示。
特别地，若满足m=0,1,…,k―1      时 ，f(mT)=0,     则有
Z[f(t+kT)]=zF(z)                               (6.4.15)
4. 复位移定理
若 Z[f(t)]=F(z),           则
Z[f(t)ea]=F(zeaT)                              (6.4.16)
5. 初值定理
若 Z[f(t)]=F(z),」 )存在，则有
(6.4.17)
6. 终值定理                                             图6.4.2  超前定理示意图 若 Z[f(t)]=F(z),  且F(z) 在以原点为圆心的单位圆
上和圆外均无极点，则有



7. 复微分定理
若 Z[f(t)]=F(z),           则


或








　





(6.4.18)



(6.4.19)


(6.4.20)

8. 卷积定理
离散函数序列的卷积定义为卷积和的形式。设f(kT)    和g(kT)   为两个离散函数序列，则它



们的卷积
　　　　
(6.4.21)
其 Z 变换为


C(z)=Z[c(kT)]=Z[f(kT)*g(kT)]=Z[f(kT)]・Z[g(kT)]= G(z)F(z)
其 中
　　　　　　　　　　　　　　　　



(6.4.22)


(6.4.23)

(6.4.24)

卷积定理指出，两个离散函数序列卷积的Z 变换等于它们各自Z  变换的乘积。
6.4.4   Z 反 变 换
从 Z 变换函数求出原来的采样函数称为Z 反变换，记作
Z1[F(z)]=f*(t)                                                                    (6.4.25)
　　　因 为Z 变换只表征连续函数在采样时刻的特性，并不反映采样时刻之间的特性，所以Z 反 变换只能求出采样函数f*(t)     或f(nt),      而不能求出连续函数f(t)。
　　　例如，两个不同的连续函数f? (t)、f? (t), 但每次采样，两个函数却具有相同的数值，即 fi(t)=f(t),    如图6.4.3所示。因此，它们的 Z 变 换F? (z)=F? (z)。    这说明，F(z) 对应的
f*(t)    是唯一的，而与 F(z)    对应的f(t)    不是唯一的，可以有无穷多个。下面介绍几种常用的Z 变换的方法。








0
图6.4.3 不同的连续信号具有相同的采样信号
1. 长除法
　　用 F(z)   的分子去除分母，可以求出按z”   降幂排列的级数展开式，然后用Z 反变换求出相 应的离散函数的脉冲序列f*(t)。
例6.4.7 设 ,求其Z 反变换f*(t)。




　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　　
解
令 f(0)=0,f(T)=10,f(2T)=30,f(3T)=70, … ,                                则
　　　　　　　　F(z)=f(O)z?+f(T)z-1+f(2T)z?2+f(3T)z?3+ … 对上式求Z 反变换有
f*(t)=108(t―T)+308(t―2T)+708(t―3T)+ …
　需要指出的是，长除法可以以序列形式给出连续函数在各采样时刻的值f(0),f(T),f(2T),…, 但不易得出f(nT)      的一般项表达式。
2. 部分分式法
　　部分分式法主要是将F(z)   展开成若干个Z  变换表中具有的简单分式形式，然后通过查 Z 变换表得到相应的f*(t) 或 f(nT)。  具体方法是，由已知的象函数F(z) 求出其极点z;,再 将 F(z)/z     展开成部分分式和的形式，即


　　　　　　　　　　　　　　　　　
由式(6.4.26)可得F(z)   的表达式为
　　　　　　　　　　　　　　　　　
对式(6.4.27)逐项进行 Z 反变换可得到F(z)   对应的原函数f*(t),     即
　　　　　　　　　　　　
例6.4.8 题目同例6.4.7。
解  对 F(z)/z     进行部分分式展开得
　　　　　　　　　　　　
则
　　　　　　　　　　　　　　　　　
查 Z 变换表(附录)得

　　　　　　　　　
或者写为


(6.4.26)


(6.4.27)


(6.4.28)



f(nT)=10[-1+2”]                  n=0,1,2, …
可见，f(0)=0,f(T)=10,f(2T)=30,f(3T)=70,f(4T)=150, …                                    与上例结论相同，但求出
了 f(nT)    的一般项表达式。
3. 留数法
根据Z 变换定义，有
　　　　　
　　　　　　　　　f(0)+f(T)z?1+f(2T)z?2+f(3T)z?3+ … +f(nT)z”+ ….. 用 z”-1 乘以上式两边得
F(z)z"1=f(0)z"-1+f(T)z”?2+f(2T)z”3+ …+
f[(n―1)T]+f(nT)z-1+f[(n+1)T]z-2+ …
由复变函数理论可知


　　　　　　　　
式中：R;=Res[F(z)z”-1]?             为F(z)z”- 1    在 z=z;    处的留数。
若z=z;   为 F(z)   的一阶极点，则有
　　　　　　　　　　　　　　　
若z=zi 为F(z) 的q 阶极点，则有
　　　　　　　　　　　
例6.4.9 题目同例6.4.7。
解  F(z)   具有两个单极点z?=1,zz=2,       则
　　　　　　　　　　　　
其中
　　　　　　　　　　　　　
　　　　　　　　　　　　　
由式(6.4.29)可得
f(nT)=R?+R?=10(-1+2”)
与上例结论相同。
例6.4.10 求                       的 Z 变换。
解  F(z)   在z=1    处有单极点，在z=0.5    处有二重极点，由式(6.4.30)可得
　　　　　　　　　　
由式(6.4.31)可得


(6.4.29)



(6.4.30)


(6.4.31)




　　　　　
由式(6.4.30)可得
F(nT)=2-(0.5)”1・(n+1)

6.5    离散系统的数学模型

　　为研究分析离散系统的性能，需要建立离散系统的数学模型。离散系统有差分方程、脉冲传 递函数和离散状态空间表达式三种数学模型，本章只介绍前两种。
6.5.1   离 散 系 统 的 数 学 定 义
　　在离散时间系统理论中，所涉及的数字信号总是以序列的形式出现。因此，可以把离散系统 抽象为如下数学定义：
将输入序列r(n),n=0,±1,±2, …              变换为输出序列c(n)   的一种变换关系，称为离散系统，
记作
c(n)=F[r(n)]                                                                      (6.5.1)
式中：r(n)   和 c(n)   可以理解为t=nT     时，系统的输入序列r(nT)    和输出序列c(nT),T       为采样 周期。
　　　如果式(6.5.1)所示的变换关系是线性的，则称为线性离散系统；如果这种变换关系是非线 性的，则称为非线性离散系统。
1. 线性离散系统
　　　如果离散系统式(6.5.1)满足叠加定理，则称为线性离散系统，即有如下关系：若c?(n)= F[r?(n)],c?(n)=F[r?(n)],                     且 有r(n)=ar?(n)±br?(n),                 其 中a  和 b 为任意常数，则
c(n)=F[r(n)]=F[ar?(n)±br?(n)]=
aF[r?(n)]±bF[r?(n)]=
ac?(n)±bc?(n)
2. 线性定常离散系统
　　　输入与输出关系不随时间而改变的线性离散系统，称为线性定常离散系统。例如，当输入序 列 为r(n)   时，输出序列为 c(n);   如果输入序列变为r(n―k),     相应的输出序列为c(n―k);     其 中 k=0,±1,±2, … ,           则这样的系统称为线性定常离散系统。
本章所研究的离散系统为线性定常离散系统，可以用线性定常(常系数)差分方程描述。


6.5.2   线 性 常 系 数 差 分 方 程 及 其 解 法
1. 差分
设连续函数为y(k),   其一阶前向差分为
△y(k)=y(k+1)-y(k)
其二阶前向差分为
△2y(k)=△[△y(k)]=△[y(k+1)-y(k)]=
△y(k+1)     一△y(k)=y(k+2)―2y(k+1)+y(k)






(6.5.2)


(6.5.3)



其一阶后向差分为
Vy(k)=y(k)―y(k-1)                                                                 (6.5.4)
其二阶后向差分为
2y(k)=[Vy(k)]=[y(k)―y(k―1)]=
Vy(k) 一y(k―1)=y(k)―2y(k-1)+y(k―2)                 (6.5.5)
2. 差分方程
　　离散控制系统在n 时刻的输出c(n)   不仅与n  时刻的输入r(n)    有关，而且与 n 时刻以前的 输 入r(n―1),r(n-2), …          及 输 出c(n―1),c(n―2), …          有关。为此，可用n  阶前向差分方程来 描述离散控制系统的输入输出关系，即
c(k+n)+a?c(k+n-1)+…+an-1c(k+1)+anc(k)=
　　　　　　　　b?r(k+m)+b?r(k+m-1)+…+bm-1r(k+1)+bmr(k)                                                    (6.5.6) 也可用n 阶后向差分方程来描述，即
c(k)+a?c(k-1)+…+an-1c(k―n+1)+anc(k-n)=
bor(k)+b?r(k-1)            十 … +bm-1r(k-m+1)+bmr(k-m)                                     (6.5.7)
例6.5. 1 求如图6.5. 1所示系统的差分方程。
　　　　　　　　　　　　
图6.5.1  不同的连续信号具有相同的采样信号
解
c(t)=Ke(t)=Kr(t)―Kc(t)
上式可整理为
c(t)+Kc(t)=Kr(t)
c(t)   在 t=kT    时的值可用一阶前向差分来近似，即
　　　　　　　　　
所以系统的一阶差分方程为
c(k+1)+(KT-1)c(k)=KTr(k)
3. 差分方程的求解
1)迭代法
　　若已知线性离散控制系统的差分方程为式(6.5.6)和式(6.5.7)所示的形式，则由式(6.5.5) 可得出输出序列的递推关系为


　　　　　　　　　　
由式(6.5.7)可得出输出序列的递推关系为
　　　　　　　　　　　　　


(6.5.8)


(6.5.9)



　　　当已知输出序列的初始值时，利用上述递推关系，可以逐步求出系统在给定输入序列作用下 的输出序列。
例6.5.2  已知差分方程为
c(k)=r(k)+5c(k-1)―6c(k―2)
输入序列r(k)=1, 初始条件为c(0)=0,c(1)=1,    试用迭代法求输出序列c(k)(k=0,1,…, 10)。
解  根据初始条件及递推关系得
c(0)=0
c(1)=1
c(2)=r(2)+5c(1)―6c(0)=6
c(3)=r(3)+5c(2)―6c(1)=25
c(4)=r(4)+5c(3)―6c(2)=90
c(5)=r(5)+5c(4)―6c(3)=301
c(6)=r(6)+5c(5)―6c(4)=966
c(7)=r(7)+5c(6)―6c(5)=3025
c(8)=r(8)+5c(7)―6c(6)=9330
c(9)=r(9)+5c(8)―6c(7)=28501
c(10)=,r(10)+5c(9)―6c(8)=86526
2)Z   变换法
　　若已知线性定常离散控制系统的差分方程描述，可根据Z 变换的正、负偏移定理，对差分方 程两边求Z 变换。再根据初始条件和给定输入信号的Z 变 换R(z),    求出系统输出的Z  变换表 达式。对其进行Z 反变换可求得系统的输出序列c(k)。
例6.5.3 已知描述某离散控制系统的差分方程为
c(k+2T)+3c(k+T)+2c(k)=0
且 c(0)=0,c(1)=1,           求差分方程的解。
解  利 用Z 变换的超前定理对差分方程两边求Z 变换，得
　　　　　　　　z2C(z)―z2C(0)―2C(1)+3zC(z)-3zC(0)+2C(z)=0 由 于c(0)=0,c(1)=1,           上式可整理为
z2C(z)+3zC(z)+2C(z)=z
输出的Z 变换表达式为
　　　　　　　　　
对上式进行Z 反变换，可得输出序列为
c(k)=(-1)k-(―2)k                              k=0,1,2, …

6.5.3   脉 冲 传 递 函 数
　　线性连续系统中，将初始条件为零时，系统输出信号的拉普拉斯变换与输入信号的拉普拉斯 变换之比定义为传递函数。对于线性离散系统，可类似定义一种脉冲传递函数。



1. 定义
　　设开环离散控制系统如图6.5.2所示，初始条件为零时，系统输出信号的 Z 变换与输入信 号的Z 变换之比，定义为离散控制系统的脉冲传递函数，或称为z 传递函数，并用G(z)   表示，即
(6.5.10)

　　　　　　　　　
图6.5.2 开环离散系统方框图
　　零初始条件，是指在t<0    时，输入脉冲序列的各采样值r ( 一T),r(-2T), … ,           以及输出脉 冲序列的各采样值c( 一T),c(-2T), …         均为0。
由式(6.5.10)可以求得线性离散控制系统的输出采样信号为
c*(t)=Z1[C(z)]=Z1[G(z)R(z)]                                                         (6.5.11)
　　　实际上，多数离散控制系统的输出都是连续信号c(t),   而不是离散的采样信号c*(t) 。 在此 情况下，可以在系统的输出端虚设一个理想采样开关，如图6.5.2所示，它与输入采样开关同步 动作，而且采样周期相同。必须指出，在这种情况下，虚设的采样开关是不存在的，它只表明脉冲 传递函数所能描述的只是输出连续信号c(t)   的采样信号为c*(t)。
　　　对于线性连续系统，当其输入为单位脉冲函数时，即r(t)=δ(t),         其输出为单位脉冲响应 g(t)。对于图6.5.2所示的离散控制系统，设其输入的采样信号为
　　　　　　　　　　　　　　　
根据叠加原理，系统的输出响应为
　　　
当t=kT   时，可得
                  (6.5.12)
由单位脉冲函数的特点可知，当t<0  时 ，g(t) =0 。 所以，当n>k                     g
[(k―n)T]=0,       即 kT 时刻以后的输入脉冲r[(k+1)T],r[(k+2)T], …                  不会对 kT 时刻的输
出信号产生影响。所以，有
　　　　　　　　      (6.5.13)  式(6.5.13)说明，c(kT)  是两个离散函数序列r(kT)   和g(kT)    的卷积。根据Z 变换的卷积定理， 即
C(z)=G(z)R(z)=R(z)G(z)
式中：,即为单位脉冲响应的采样信号g*(t)   的 Z 变换。又由于在各采样



时刻g(t)=g*(t),         对应于式(6.5.10),可以得到脉冲传递函数的求法为
G(z)=Z[g*(t)]=Z[g(t)]                                                            (6.5.14)
由于g(t)=L-1(G(s)),           所以式(6.5.14)可进一步写为
G(z)=Z{L-1[G(s)]}                                                           (6.5.15)
式(6.5.15)通常简记作
G(z)=Z[G(s)]                                                              (6.5.16)
　　需要强调的是，G(s) 表示某一线性系统本身的传递函数，而G(z) 表示线性系统与采样开关 两者组合体的脉冲传递函数，即描述了两者组合体的动态特性。同时，还应特别注意G(z)    ≠G(s)|s=z。
　　　例6.5.4 对于图6.5.2所示的离散控制系统，若 ,求系统的脉冲传递函数 G(z)。
解  对 G(s)  展开得
　　　　　　　　　　　　　　　　　
g(t)=L?1[G(s)]=1-ea
系统的脉冲传递函数为
　　　　　　　　
　　　由于拉普拉斯变换和Z 变换均为线性变换，所以G(s) 、g(t)   与G(z)    之间存在一一对应关 系，故也可以由G(s)  直接查表求得G(z)。
2. 开环离散系统脉冲传递函数
　　　当开环离散系统由多个环节串联组成时，其脉冲传递函数可根据采样开关的数目和位置的 不同得到不同的结果。
1)串联环节之间有采样开关
两个串联环节之间有采样开关分隔，结构如图6.5.3所示。由脉冲传递函数的定义可知 D(z)=G(z)R(z),C(z)=G?(z)D(z)
式中：G?(z) 、G?(z)  分别是环节G?(s) 、G?(s)   的脉冲传递函数。于是，有
G(z)=G?(z)G?(z)                                                            (6.5.17)
　　式(6.5.17)说明，有采样开关分隔的两个线性环节串联时，其脉冲传递函数等于两个环节各 自的脉冲传递函数之积。这一结论可推广到有采样开关分隔的n 个线性环节串联的情况。
　　　　　　　　　　　
图6.5.3 串联环节之间有采样开关
2)串联之间没有采样开关环节
　　两个串联环节之间没有采样开关分隔，结构如图6.5.4所示。当G(s)=G? (s)G? (s)   时，对 应图6.5.4,可得系统的脉冲传递函数为
G(z)=Z[G?(s)G?(s)]=G?G?(z)                                                     (6.5.18)




　　　　　　　　　　　
图6.5.4 串联环节之间没有采样开关
　　　式(6.5.18)说明，没有采样开关分隔的两个线性环节串联时，其脉冲传递函数等于两个环节 的传递函数之积所对应的Z 变换，这一结论可推广到没有采样开关分隔的n 个线性环节串联的 情况。
　　　比较式(6.5.17)和式(6.4.18)可知，G?G?(z)≠G?(z)G?(z) 。      从这个意义上说，Z 变 换 无 串联性。
例6 . 5 .5   对于图6 . 5 . 3和图6 . 5 . 4所示结构的两个离散控制系统，设
,分别求解系统的脉冲传递函数G(z)。
解 若系统结构如图6.5.3所示，由式(6.5.17)可知，系统的脉冲传递函数为
　　　　　　　
若系统结构如图6.5.4所示，由式(6.7.18)可知，系统的脉冲传递函数为
　　　　　　　　　　　
　　　　　　　　　　　　　　
3)有零阶保持器的开环系统脉冲传递函数
有零阶保持器的开环离散控制系统如图6.5.5(a) 所示。为便于分析，可将图6.5.5(a)  改 画
为图6.5.5(b) 所示的形式。设G?(s)=1―eT         ,则
G?(s)G?(s)=(1-eT)G?(s)=G?(s)-e-TG?(s)
由式(6.5.18)可得系统的脉冲传递函数为
G(z)=G?G?(z)=Z[G?(s)G?(s)]=
Z[G?(s)―eTG?(s)]=Z[G?(s)]-Z[eTG?(s)]=
　　　　　　　　　　　
所以，有零阶保持器的开环系统脉冲传递函数为
                       (6.5.19)
　　例6 .5 .6  对于如图6.5.5(a)所示的离散控制系统，设 ,T=1s,     求解系统 的脉冲传递函数G(z)。
解
　　　　　　　　　　　　　





　　　　　　　　　　
(a)

　　　　　　　　　　
(b)
图6.5.5 有零阶保持器的开环系统脉冲传递函数
则
　　　　　　　　　　　　
系统的脉冲传递函数为
　　　　　　　　
　　　　　　　　　　　
当 T=1s   时，有
　　　　　　　　　　　　　　　
对该例作进一步分析，当系统中没用零阶保持器时，可求得系统的脉冲传递函数为
　　　　　　　　　　　　　　　　






















(6.5.20)






(6.5.21)

比较式(6.5.20)和式(6.5.21),两式的分母相同，分子不相同。可见，加入零阶保持器不影响离 散控制系统的极点，只影响其零点。
3. 离散控制系统的闭环脉冲传递函数
　　在离散控制系统中，由于采样器在闭环系统中可以有多种配置的可能性，因而对于离散控制 系统而言，会有多种闭环结构形式，这就使闭环离散控制系统的脉冲传递函数没有一般的计算公 式，只能根据系统的实际结构具体分析。
图6.5.6所示为最常见的一类闭环离散控制系统结构图。在给定输入r(t)  作用下，系统的


误差为e(t)=r(t)-b(t),               对其进行 Z 变换得E(z)=R(z)-B(z) 。 G(z)E(z),      反馈信号B(z)=E(z)GH(z),           且GH(z)=Z[G(s)H(s)]。
E(z)=R(z)―B(z)=R(z)―E(z)GH(z)
C(z)=G(z)R(z)―GH(z)C(z)
整理得，给定输入作用下系统的闭环脉冲传递函数为
　　　　　　　　　　　　　　　
给定输入作用下系统的闭环误差脉冲传递函数为
　　　　　　　　　　　　　　　


　输出信号 C(z)= 因此，有




(6.5.22)


(6.5.23)



　　　比较式(6.5.22)和式(6.5.23),两式分母均为  1+GH(z),       称为闭环离散控制系统的特征多项式。 方 程 1 +GH(z)=0       称为闭环离散控制系统的特征  方程。
例6.5.7  已知对于如图6.5.6所示的闭环离
散控制系统，若存在传递函数
,T=1(s),        求其闭环脉冲传递函数φ(z)  和闭环误差脉冲传递函数Φ。(z)。 解
　　　　　　　　　　
　　　　　　　　　　
　　　
系统的闭环脉冲传递函数为
　　　　　
系统的闭环误差脉冲传递函数为
　　　　　　　　　　　
对上例进一步分析，若不包含采样器，则系统就是一个连续控制系统，其闭环传递函数为
　　　　　　　　　　
　　　　　　　　　　　　　
显然，经采样后的离散控制系统的闭环脉冲传递函数Φ(z)  不等于不经过采样的连续系统闭环 传递函数的Z 变换，即Φ(z)≠Z[Φ(s)]。
通过以上分析，可以总结出求解离散控制系统闭环脉冲传递函数的一般方法如下：
(1)确定系统的输入变量和输出变量。
　　　(2)根据结构图，将通道在各采样开关处断开，写出采样前系统各连续信号的拉普拉斯变换 表达式。
(3)对各表达式采样后进行Z 变换。
(4)消去中间变量，按定义写出闭环脉冲传递函数。
例6.5.8 图6.5.7所示为数字控制系统的典型结构图，求系统的闭环脉冲传递函数。
解
(1)系统的输入、输出r(t) 、c(t)。




　　　　　　　　　　
图6.5.7 数字控制系统的典型结构图
(2)根据系统结构图，有
E(s)=R(s)―H(s)C(s)=R(s)―G(s)H(s)X*(s)
X(s)=D(s)E*(s)
C(s)=G(s)X*(s)
(3)对上式采样后进行Z 变换，有
　E(z)=R(z)―GH(z)X(z) X(z)=D(z)E(z)
C(z)=G(z)X(z)
(4)消去中间变量X(z) 、E(z),    得
　　　　　　　　　　　　　　　　
整理得系统的闭环脉冲传递函数为
(6.5.24)
　　需要指出的是，对于一个离散控制系统，若对其误差信号e(t)不进行采样，将得不到闭环脉 冲传递函数Φ(z),  而只能写出输出信号的Z 变换表达式C(z)。
　　　采样开关在闭环系统中具有各种配置形式的闭环采样系统典型结构图及其输出C(z)   如表 6.5.1所列。
表6.5.1 典型离散控制系统的结构图及输出信号C(z)

序号	系统结构图	C(z)


1	　　　　　
　　　　


2	　　　　　
　　　


3	　　　　　
　　　　





(续)

序号	系统结构图	C(z)


4	　　　　　
　　　


5	　　　　　
　　　　

6	　　　　
　　

7	　　　　
　　

8		 r(1)
T	G(s)		 c(1)
　　　
	H(s)
T
　　　对于有扰动信号作用的离散控制系统，如图6.5.8所示，可分析扰动与系统输出之间的 关系。
令 r(t)=0, 由系统结构图得
C(s)=G?(s)N(s)+E*(s)G?(s)G?(s)
E*(s)=-C*(s)

　　　　　　　　
图6.5.8 扰动作用下的离散控制系统
对上述两式进行Z 变换，可得
C(z)=G?N(z)+E(z)G?G?(z)
E(z)=―C(z)
消去中间变量E(z),    整理得
(6.5.25)



　　　由于系统对扰动输入没有进行采样，因此，写不出扰动输入下的闭环脉冲传递函数n(z)     的 表达式。
　　　以上讨论了离散系统的两种数学模型：差分方程和脉冲传递函数。通过Z 变换的方法，可 以从差分方程得出脉冲传递函数，也可以从脉冲传递函数得出差分方程。可以看出，两者之间的 关系和连续系统中微分方程和传递函数之间的关系是类似的。
6.6    离散系统的稳定性分析

6.6.1    离 散 控 制 系 统 稳 定 的 充 要 条 件
　　线性连续系统稳定的充要条件是特征方程的根全部位于左半s 平面上。而线性离散系统 中，稳定性是由闭环脉冲传递函数的极点在z 平面上的分布确定的，应该用z 平面来判断其稳定 性。因此，需要分析s 平面和z 平面之间存在的映射关系，以便用连续系统的稳定判据来分析离 散系统的稳定性。
　　设复变量s 在 s 平面上沿虚轴取值，即s=jw,   对应的 z=eT,     它 是z 平面上幅值为1的单位 矢量，其幅角为wT, 随 w 而改变。当w 从 连续变化时，z=eT    的相角由一 π变化到π。
因此，s 平面上的映射在z  平面上的映射是以原点为圆心的单位圆。
　　　设复变量s=σ+jw,     则 z=e=eTeimT 。   若 s 位 于s 平面虚轴左侧时，σ<0,其幅值|z|<1,      此 时 ，s 在 z 平面上的映射点位于以原点为圆心的单位圆内；若s 位 于s 平面虚轴右侧时，σ>0,此 时 |z|>1,s      在 z  平面的上的映射点位于以原点为圆心的单位圆外。可见，s 平面左半部分在z  平面上的映射为以原点为圆心的单位圆的内部区域，如图6.6.1所示。
　　　　　　　　　　　　　　　　　　　　　
图6.6.1 s 平面与z 平面的映射关系
　　　由此可以得到离散控制系统稳定的充分必要条件是：系统特征方程1+GH(z)=0       的根，即 闭环极点，必须都分布在z 平面上以原点为圆心的单位圆内。只要有一个特征根在以原点为圆 心的单位圆外，离散控制系统就不稳定，当有特征根在以原点为圆心的单位圆上，而其他根在以 原点为圆心的单位圆内时，系统处于临界稳定。
6.6.2   劳 斯 稳 定 判 据
由控制系统的时域分析可知，劳斯稳定判据是判断线性连续系统的一种简便的代数判据。



　然而，对于离散控制系统，其稳定边界是z 平面上以原点为圆心的单位圆，而不是虚轴，因而不能 直接应用劳斯判据。因此，需要采用一种新的变换方法，将z 平面上的单位圆映射为新坐标系的 虚轴，而圆内部分映射为新坐标系的左半平面，圆外部分映射为新坐标系的右半平面。这种坐标 变换称为双线性变换，亦称为w 变换。
设
                             (6.6.1)
则有
w=u+jv                                                                    (6.6.2)
若 z=x+jy     是定义在z  平面上的复数，w=u+jv     是定义在w  平面上的复数，则 w=u+jv=

                    (6.6.3)
当 u=0,   即 w 在w 平面虚轴上取值时，则x2+y2-1=0,          即 x2+y2=1,       可映射为z 平面上

以原点为圆心的单位圆。
当 u<0,   即 w 在 w  平面虚轴左侧取值时，则x2+y2-1<0,	即 x2+y2<1,	可映射为z 平面
上以原点为圆心的单位圆内部分。
当u>0,   即 w 在 w 平面虚轴右侧取值时，则x2+y2-1>0,
即 x2+y2>1,
可映射为z 平面
上以原点为圆心的单位圆外部分。
z 平面和w 平面的映射关系如图6.6.2所示。

　　　　　　　　　　
图6.6.2 z 平面和w 平面的映射关系
由此可知，离散控制系统在z 平面上的稳定条件可转化为：经过w 变换后的特征方程，即
(6.6.4)
的所有特征根，均位于w 平面的左半平面。
　　　这种情况正好与在s 平面上应用劳斯稳定判据的情况一样。因此，可根据w 域中的特征方 程的系数，直接应用劳斯判据分析离散控制系统的稳定性。
例6.6.1 设离散控制系统的特征方程为



D(z)=45z3-117z2+119z-39=0
试判断系统的稳定性。
解  令 ,代入D(z)=0      中，整理得
D(w)=w3+2w2+2w+40=0
列劳斯表为


w3 w2


1
2


2
40

w1    -18
w?      40
由劳斯判据可知，系统不稳定，且有两个特征根位于z 平面的单位圆外。
　　　例6.6.2 设有零阶保持器的离散系统如图6.6.3所示，若采样周期分别为 T=1s,T= 0.5s,试在两种情况下确定使系统稳定的K 取值范围。
r(1)                                                              c(1)
SS+1)


图6.6.3 离散控制系统
解 由结构图不难求出，系统的开环脉冲传递函数为
　　　　　
相应的闭环特征方程为
D(z)=1+G(z)=0
(1)当T=1s   时，有
D(z)=z2+(0.368K-1.368)z+(0.264K+0.368)=0
令 ,得w 域特征方程为
　　　　D(w)=0.632Kw2+(1.264―0.528K)w+(2.736―0.104K)=0 根据劳斯判据易得
0<K<2.4
(2)当T=0.5s    时 ，w 域特征方程为
　　　　D(w)=0.197Kw2+(0.768-0.188K)w+(3.124―0.017K)=0 根据劳斯判据易得
0<K<4.37
从该例题可以看出以下几点：
　　　(1)二阶连续系统中，只要 K>0,   系统总是稳定的。但加采样开关后，系统变为二阶离散系 统，随着K 的不断增加，系统会变得不稳定。这说明采样开关的引入，会使系统的稳定性变坏。



　　　(2)采样周期越长，丢失的信息就越多，对离散系统的稳定性及动态性能均不利，甚至可使 系统失去稳定性。如果提高采样频率，丢失的信息就少，离散系统就接近于相应的连续系统，从 而可改善系统的稳定性。但过高的采样频率会增加计算机负担。
6.6.3   采样周期与开环增益对稳定性的影响
　　众所周知，连续系统的稳定性取决于系统的开环增益 K、系统的零极点分布和传输迟延等 因素。但是，影响离散离散系统稳定性的因素，除与连续系统相同的上述因素外，还有采样周期 T 的数值。
K 与 T 对离散系统稳定性有如下影响：
　　　(1)当采样周期一定时，加大开环增益会使离散系统的稳定性变差，甚至使系统变得不 稳定。
　　　(2)当开环增益一定时，采样周期越长，丢失的信息越多，对离散系统的稳定性及动态性能 均不利，甚至可使系统失去稳定性。
6.6.4   离散系统的稳态误差分析
　　稳态误差是离散系统分析和设计的一个重要指标，用离散系统理论分析的稳态误差，仍然是  指采样时刻的值。由于离散控制系统的脉冲传递函数与采样开关的配置有关，没有统一的公式  可用，故通常采用终值定理计算稳态误差。只要系统的特征根全部严格位于z 平面的单位圆内， 即若离散系统是稳定的，则可用Z 变换的终值定理求出采样时刻的稳态误差。
设离散系统如图6.6.4所示，由式(6.5.23)可知，系统的误差传递函数为
　　　　　　　　　　　　　　　
　　　　　　　　　　　　
图6.6.4 典型的闭环离散控制系统
则系统在给定输入作用下误差e*(t)   表达式为
　　　　　　　　　　　　　　　
根据Z 变换的终值定理，系统的稳态误差为
(6.6.5)
　　对于离散控制系统，也可以通过分析其型别与静态误差系数的关系来求解其稳态误差。首 先定义系统的开环脉冲传递函数。对于一个闭环离散控制系统，其反馈信号的Z 变换B(z)   与 误差信号的Z 变换E(z)   之比，称作闭环离散控制系统的开环脉冲传递函数G(z),      即
                           (6.6.6)
对于如图6.6.4所示的典型结构的离散控制系统，其开环脉冲传递函数为
G(z)=GH(z)                                                                  (6.6.7)



若系统为单位反馈，即H(s)=1,  则
G(z)=GH(z)=G(z)                                                                    (6.6.8)
设离散控制系统的开环脉冲传递函数为

(6.6.9)

式中：Kg 为系统的开环根轨迹增益；z; 为系统的开环零点，j=1,2,…,m;pi         为系统非z=1    处 的
开环极点，i=1,2,…,n―v;v          为系统在z=1    处的开环极点数，也称作离散控制系统的型别。
v=0,1,2     时，分别称离散控制系统为0型、I  型、Ⅱ型系统。
由式(6.6.5)可知，系统在给定输入作用下的稳态误差为


　　　　　　　　　　　　　
1. 单位阶跃输入时的稳态误差
当系统输入为阶跃信号时，,则
　　　　　
定义离散控制系统的静态位置误差系数为
　　　　　　　　　　　　　　
则系统的稳态误差可表示为
　　　　　　　　　　　　　　　　　　　

对于0型系                                       ,为一常数。


对 于I  型 及I  型以上系统，K,=∞,e(∞)=0。
2. 单位斜坡输入时的稳态误差
当系统的输入为单位斜坡信号时，, 则
　　　　　　　　
　　　　　　　　　　　
定义离散控制系统的静态速度误差系数为
　　　　　　　　　　　　　　　　
则系统的稳态误差可表示为


(6.6.10)








(6.6.11)


(6.6.12)


















(6.6.13)




　　　　　　　　　　　　　　　　　　　
对于0型系统，K,=0,e(∞)=∞。
　对于I  型系统，K,  为一常数， 对于Ⅱ型及Ⅱ型以上系统，K,=∞,e(∞)=0。
3. 单位加速度输入时的稳态误差
当系统的输入为单位加速度信号时，则
　　　　　　　　　
定义离散控制系统的静态加速度误差系数为
　　　　　　　　　　　　　　　　
则系统的稳态误差可表示为
　　　　　　　　　　　　　　　　　　　
对 于 0 型 及I  型系统，Ka=0,e(∞)=∞。
对于Ⅱ型系统，K。为一常数，
对于Ⅲ型及Ⅲ型以上系统，Ka=∞,e(∞)=0。
不同型别离散控制系统的稳态误差如表6.6.1所列。
表6.6. 1 不同类型系统的稳态误差



(6.6.14)













(6.6.15)


(6.6.16)


　　　	给定输人 系统型别	r(t)=1(t)	r(t)=t	　　　　
0型	　　　　　	∞	∞
I型	0	　　　　　	○
Ⅱ 型	0	0	　　　　　
　　通过以上分析可知，系统的稳态误差除了与输入信号的形式有关外，还直接取决于系统的开 环脉冲传递函数G(z)    中 在z=1    处的极点个数，即取决于系统的型别v 。v 反映了离散控制系 统的无差度。通常称v=0   的系统为有差系统，v=1   的系统为一阶无差系统，v=2   的系统为二阶 无差系统。
　　　此外，采样瞬时的稳态误差还与采样周期T 有关。稳态误差e(∞)    与 K 、Ka  成反比，由表 6.6.2可知，T 越大，e(∞)   越大。
例6.6.3 离散系统如图6.6.5所示，已知系统的输入为r(t)=t,      试求系统的稳态误差。 解  系统连续部分前向通道的传递函数为
　　　　　　




　　　　c(t) S?+a)
一


图6.6.5 离散控制系统
由于系统为单位反馈，所以系统的开环脉冲传递函数为
　　　　　
　　　　　　　　　
可见，系统为I  型系统，速度误差系数为
　　　　　　　　　
　　　　　　　　　　　
　　　　　　　　　　　
系统的稳态误差为
　　　　　　　　　　　　　　　　　
例6.6.4  离散系统如图6.6.6所示，试求系统在单位阶跃信号作用下的稳态误差。
　　　　　　　
图6.6.6 离散控制系统
解  令 ,则
　　　　　　　　　　　　　　　　　　
　　　　
系统的开环脉冲函数为
　　　　　　　　
系统为I  型系统，K,=∞,     在单位阶跃信号作用下，e(∞)=0。



　　对于上例，也可先求出系统误差信号的Z 变换表达式E(z),     利用终值定理，求出相应的稳 态误差。
系统的闭环误差脉冲传递函数为
　　　　　　　　　　　　　　　
在单位阶跃信号作用下，误差信号的Z 变换为
　　　　　　　　　　　　　　　　
由 Z 变换的终值定理可得系统的稳态误差为
　　　　　　　　　
　　　　　　　　　　　　

本  章  小  结

　　　本章首先讨论了离散信号的数学描述，介绍了采样系统的香农采样定理，即为了保证信号的 恢复，其采样信号频率必须大于等于原连续信号所含最高频率的两倍。
　　　为了建立线性离散控制系统的数学模型，本章引进了Z 变换理论及差分方程。可以说，Z 变 换在线性离散系统中所起的作用与拉普拉斯变换在线性连续系统中所起的作用十分类似。本章 介绍的Z 变换的若干定理对求解线性差分方程和分析线性离散系统的性能是十分重要的。
　　　本章最后扼要介绍了线性离散控制系统的综合分析方法。在稳定性分析方面，主要讨论了 利 用z 平面到w 平面的双线性变换，再利用劳斯判据的方法。值得指出的是，离散控制系统的 稳定性除与系统的固有结构和参数有关外，还与系统的采样周期有关，这是与连续控制系统分析 相区别的重要一 点。
课后练习题
6-1   已知采样器的采样周期T=1s, 求对下列连续信号采样后得到的脉冲序列x*(t) 的前8个值。
(1) ;(2)x(t)=1―cos0.785t;
(3)x(t)=1-e-0.5t。
6-2   已知采样器的采样频率w?=3rad/s,     求对下列连续信号采样后得到的脉冲序列的前8个
值。说明是否满足采样定理，如果不满足采样定理会有什么现象。
x?(t)=sint,x?(t)=sin4t,x?(t)=sint+sin3t。
6―3  求下列函数的Z 变换。
(1)                                        ;
(3) ;(4) ,T=1s;
(5)e(t)=te-2t;(6)e(t)=t3。



6-4   求下列函数的Z 反变换。
(1) ;(2)
(3) ;(4)
(5)
6-5   求下列函数所对应脉冲序列的初值和终值。
　　
　　　(3) ;(4) 6-6   求图示系统的开环脉冲传递函数。
　　　　

(a)                                                               (b) 6―6题图
　6-7       求图示系统的闭环脉冲传递函数。 6-8   求图示系统的输出的Z 变 换C(z)。


G?(s)                       G?(s) T
H(s)
6―7题图                                     6―8题图
6―9  图示系统的采样周期 T=1s,    求单位阶跃响应的前8个数值。 6―10  系统如图所示，采样周期T=1s。
( 1 ) 当K=8  时，闭环系统是否稳定?
(2)求系统稳定时K 的临界值。
　　　　c(1) (3+1)

6―9题图                                   6- 10题图









　　c*(t) T
c(t)










　　　　c(1) 5S+)


6―11  判断图示系统的稳定性。
6-12   系统如图所示，采样周期 T=0.2s,      输入信号  求系统稳态误差终值。




　　　
(a)                                                                      (b)
6 ― 11题图
c(1)
1-c                      10(0.5s+1)


6 ― 12题图
6-13   系统如图所示，采样周期 T=0.25s 。   当 r(t)=2+t           时，欲使稳态误差小于0. 1,求 K 值 。
　　　　　　　　
6 ― 13题图
6-14  系统如图所示，采样周期 T=1s 。 求单位阶跃响应的Z 变换式，并求初值和终值。
　　　　
(a)                                                               (b)
6 ― 14题图
6-15   模拟控制器的传递函数为,采用双线性变换法和差分变换法 将其化为z 传递函数。
6―16  数字控制器的z 传递函数为
　　　　　　　　　
写出相应的差分方程，求出单位脉冲响应序列。
6-17       离散系统的特征方程如下，判断系统的稳定性。
(1)45z3-11z2+119z―36=0;                         (2)(z+1)(z+0.5)(z+3)=0;
　　　






第7章  非线性控制系统分析

本 章 提 要
　　　本章研究非线性系统的分析方法，主要介绍描述函数法。首先介绍非线性控制系统的特点， 其次介绍一些常见的非线性特性及其对系统性能的影响；接着讨论对常见非线性特性数学模型  的建立问题，即描述函数的建立，最后研究描述函数法对非线性系统的分析。
7.1   引   言

　　　前面各章讨论了线性系统的分析和设计问题，严格地说，任何一个实际的物理系统总是或多  或少地存在着非线性因素。例如，放大元件的输入信号在一定范围内输入输出呈线性关系，但当  输入信号超过一定范围时，输出就会出现饱和现象，如图7.1.1(a) 所示。又如执行元件电动机， 由于总是存在摩擦力矩和负载力矩，因此，只有当输入电压达到一定数值时才会转动，即存在不  灵敏区。同时，当输入电压超过一定数值时，由于磁性材料的非线性，电动机的输出转矩又会出  现饱和，如图7.1.1(b) 所示。各种传动机构，由于加工精度和装配的缺陷，在传动过程中总存在  着间隙，其输入输出表现为间隙特性，如图7.1.1(c) 所示，可以说，非线性因素在实际系统中普  遍存在。当控制系统中包含一个或一个以上具有非线性特性元件时，称为非线性系统。线性系  统，只是在忽略了非线性因素或在一定条件下进行了线性化处理后的一种理想化的模型，但当实  际系统本身与线性系统差别太大时，这时应采用非线性理论进行研究。

　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                               (b)                                 (c)                             (d)
图7.1.1 几种典型的非线性特性
　　　由于非线性系统与线性系统有本质区别，非线性系统理论远不如线性系统理论成熟和完 善。本章主要介绍一种经典的非线性系统的分析方法：描述函数法。
7.2  非线性控制系统概述
7.2.1  非线性系统的特点
　　　非线性系统分为非本质非线性和本质非线性两种形式，非本质非线性系统是指系统中的非 线性特性，如图7.1.1(a) 所示的饱和特性和图7. 1. 1(c)  所示的间隙特性，在一定条件下可进行



　线性化处理，线性化后的系统可以用线性理论来研究。但是，如果系统的非线性特征明显且不能 进行线性化处理，如图7.1.1(d)所示的继电特性，必须采用非线性系统理论来分析，否则会产生 较大的误差，甚至会导致错误的结论，这类系统称为本质非线性系统。
与线性系统相比，非线性系统有许多特殊的现象，具有以下特点：
1. 叠加原理不能应用
　　　对于一个线性系统，当输入r?(t)  的响应为c?(t),   输 入r?(t)   的响应为c?(t)  时，则在输入r(t)      =ar? (t)+br? (t)  的作用下(其中a、b为常量),系统的输出为c(t)=ac? (t)+bc? (t),  这便是叠加  原理。它表明多个外作用下产生的响应等于每个外作用产生的响应之和，且外作用扩大若干倍， 输出也扩大若干倍。但对于非线性系统，例如，  述关系不成立。
　　线性系统的重要特征是满足叠加原理，非线性系统不具有这样的性质，是否满足叠加原理是 两类系统的本质区别。
2. 运动形式
　　线性系统自由运动的形式与初始条件、外作用的大小无关。如果线性系统在某一初始条件 下的响应是振荡收敛的，则其在任意初始条件下的响应都是振荡收敛的。但对于非线性系统则 不同，自由运动的响应形式可以随着初始条件或外作用的不同而不同。
　　　图7.2. 1所示为一个非线性系统在不同的初始条件下出现的不同响应形式，曲线1为非周 期响应，曲线2为衰减振荡。
3. 稳定性问题
　　　线性系统的稳定性只与系统本身的结构和参数有关，而与初始条件与外作用无关。如果一 个线性系统在某一初始条件和外作用下运动是稳定的，那么,其可能的全部运动都是稳定的，所 以可以说某个线性系统是稳定的或不稳定的。稳定系统代表的系统状态是稳定的，线性系统理 论将保持不变的状态称为平衡状态，也称为平衡点。多数线性系统只有一个平衡状态，而非线性 系统可能存在多个平衡状态。 一个非线性系统在某些平衡状态可能是稳定的，在另外一些平衡 状态却可能是不稳定的，因此，不存在系统是否稳定的笼统概念。非线性系统的稳定性除了与系 统本身的结构和参数有关外，还与外作用和初始条件有关。
例如，一个非线性系统的微分方程为
x(t)=―x(1-x)                                                                     (7.2.1)
当 x≠0    且 x≠1    时，将式(7.2.1)改写为
                            (7.2.2)
对式(7.2.2)两端分别积分可得,其中C 为任意常数，即
设初始条件x(O)=xo  ≠1, 可求得,从而得该非线性微分方程的解为
                 (7.2.3)
由式(7.2.3)可以看出：(1)当0<x?<1     时 ，x(t)   随着时间t 的增大而趋近于0;(2)当x?<0
时 ，x(t)随着时间t的增大而趋近于0;(3)当xo>1 时 ，x(t)随着时间t 的增大而增大，当t=ln



时 ，x(t)趋于无穷大。不同初始条件下该系统的响应如图7.2.2所示。


　
图7.2.1 非线性系统在不同初始条件下的自由运动
1―非周期响应；2―衰减振荡。




图7.2.2 对不同初始条件的响应

　　　由图7.2.2可以看出，该非线性系统有两个平衡状态x=0 和 x=1 。x=0     这个平衡状态是 稳定的，因为在x=0    附近，从x?<1    出发的运动最终都能回到x=0    这个平衡状态；而x=1    这 个平衡状态是不稳定的，因为当x?>1 时，系统的运动发散到无穷远处，当x?<1 时，系统的运动 最终回到x=0   处，它们都不再回到x=1   这个平衡状态。
4.自激振荡问题
　　一个线性系统在没有外作用的情况下，如果产生周期运动，在物理上是不能实现的。例如， 临界稳定的二阶线性系统自由运动x(t)=Asin(wt+φ) 为周期运动形式，但这种周期运动一旦  在系统受到扰动时将被破坏，从而使系统运动或趋向于稳定，或趋向于不稳定，因此实际上该周 期运动不稳定，是不能实现的。
　　　非线性系统在外作用为零的情况下，完全可能产生一定频率和振幅的周期运动，且在系统受 到扰动时，该周期运动仍然稳定，这种稳定的周期运动称为自激振荡，简称自振，相应的相轨迹为 极限环，它是非线性系统理论研究的重要问题。
　　　例如，著名的范德波尔振荡器是一个具有非线性电阻的RLC 电路，为典型的非线性系统，其 自由运动x(t)  可以用二阶非线性微分方程描述x-2p(1―x2)x      十x=0  (其中p>0),   这就是著名 的范德波尔方程。该方程可以表示为x+2p(x2―1)x+x=          0, 与二阶线性系统微分方程十 2ζw,i+w2x=0 相比较，非线性系统的等效阻尼比为p(x2-1)。 当 |x|<1 时，等效阻尼比p(x2-  1)<0,表明系统在运动过程从外界得到能量，因此具有发散的运动形式；当|x|>1     时，等效阻 尼比p(x2-1)>0,       表明系统在运动过程中消耗能量，因此具有收敛的运动形式。由于非线性阻 尼比随着x 值而变化，使得上述两种运动形式交替进行，致使x(t)  的运动既不能无限发散，也不 能无限收敛，所以呈现出稳定的周期运动的形式，即自激振荡，如图7.2.3所示。
　　　自激振荡是非线性系统的特有现象，多数情况下，在系统正常工作时不希望产生，以避免这  种自激振荡对系统产生的破坏作用。但在某些情况下，也可以通过引进自振来改善系统的性能。
5. 对正弦信号响应的复杂性
　　在线性系统中，当输入信号为正弦信号时，其输出的稳态值是与输入信号同频率的正弦信 号，不同在幅值和相角上，可以用频率特性来描述系统的动态特性。但在非线性系统中，当输入




　　　　　　　　　　
图7.2.3  范德波尔振荡器的输出信号
是正弦信号时，输出量除了包含与输入同频率的正弦信号外，还包含倍频、分频等谐波分量。某 些非线性系统在输入信号的幅值不变而频率由小到大或大到小变化时，其输出的幅值与频率之 间可能会发生跳跃谐振和多值响应现象，如图7.2.4所示。
　　　　　　　　　　
图7.2.4 跳跃谐振和多值响应
　　　此外，非线性系统在一定条件下还会出现分形、混沌等一些奇特的现象，在此不再赘述，感兴 趣的读者可以参阅其他文献。
7.2.2  非线性系统的分析与设计方法
　　　非线性系统的研究远比线性系统复杂，涉及多方面的知识，缺乏能统一处理的有效数学工 具，目前还没有一套通用的理论体系和研究方法。
本章主要介绍一种在工程上广泛应用的非线性系统分析方法：描述函数法。
　　　该方法是线性系统频域分析法在非线性系统中的推广。它通过对非线性特性在正弦信号作 用下的输出进行谐波线性化得到描述函数，分析非线性系统的稳定性和自激振荡。这种方法简 单有效，且不受系统阶次的限制。
　　　此外，在非线性系统研究中，数字计算机仿真可以求得非线性系统的精确解，进而分析非线 性系统的性能，已成为研究非线性系统的重要手段。
7.3  常见非线性特性及其对系统性能的影响
　　　实际控制系统中，最常见的非线性特性有死区特性、饱和特性、间隙特性、摩擦特性和继电特 性等。这些非线性特性中有些是组成控制系统的元件所固有的，如死区特性、饱和特性和间隙特 性，一般来说，它们对控制系统的正常工作是不利的；但还有一些非线性特性，如继电特性等，则 是为了改善控制系统的性能而人为加入的，这些非线性特性的加入能使系统具有更为优良的 性能。
本节将从物理概念上对这些常见的非线性特性对系统的影响进行定性分析和简要说明，虽



然不够严谨，但所得的结论对从事实际系统的调试工作具有一定的参考价值。
1. 死区特性
　　死区又称不灵敏区，当输入信号在很小的范围内时输出为0,只有在输入信号超过一定值后 才有输出。 一般控制系统中的测量元件、放大元件和执行元件都存在不灵敏区，例如，作为控制 系统中的检测部件的测速发电机、自整角机，由于其电刷和换向器存在摩擦产生死区。又如，作 为执行机构的伺服电机由于要克服摩擦和负载转矩，因此需要有一定的启动电压，这个电压称作 伺服电机的死区，且摩擦和负载转矩越大，伺服电机的死区也越大。
　　死区特性的典型形式如图7.3. 1所示，当输入信号x(t) 较 小 在 x≤I△| 时，输出 y(t) 为零。 当输入信号大于 一 定值在x>|△|     时，其输出与输入为线性关系，△区域为死区或不灵敏区范围。
其数学表达式为




其 中





(7.3.1)

　　　　　　　　　　　　　　　　　
　　一个系统可能有多个元件都存在死区，则总的死区可以折算。如图7 .3 .2所示的系统，k?、 k?、k? 分别为测量元件、放大元件和执行元件的传递系数，△? 、△2、△?分别为它们的死区。若将放
大元件和执行元件的死区折算到测量元件的位置，则总死区△如下式所示，即
(7.3.2)




k?,△?
测量元件


　k?,△?    放大元件


　k?,△?  执行元件


C(s)


图7.3.1 死区非线性特性                 图7.3.2 包含多个死区特性的非线性系统
　　　由式(7.3.2)可见，处于系统前向通路最前面的测量元件，其死区对系统造成的影响最大，而 放大元件和执行元件死区对系统的不良影响可以通过提高该元件前级的传递系数来减小。
　　　死区特性等效于在系统中加入 一个变增益元件，如图7 . 3 . 3所示。当x≤△  时，系统无输 出，等效增益k?=0;    当 x>△ 时，系统输出为y=k(x―△),      等效增益为k?=k(x―△)/x;        当 x→∞    时 ，k?=k。
　　死区特性对系统最主要的影响是增大了系统的稳态误差，降低了稳态精度。而当输入信号  是斜坡函数时，死区的存在还会造成系统输出量在时间上的滞后，从而降低了系统的跟踪速度。 另一方面，死区的存在会造成系统等效开环增益的下降，减弱了过渡过程的振荡性，从而可提高  系统动态过程的平稳性。因为在过渡过程中，当系统前向通道的信号小于死区，前向通道相当于  断开，外界由于不是不断地给系统提供能量，这样总的能量的交换要小于无死区的情况，所以减  弱了过渡过程的振荡性。同时，死区也能滤除输入端中小幅振荡的干扰信号，提高了系统的抗干





　　　　　　　　　　　　　　　　　　　　　　
(a)                                       (b)
图7.3.3 死区特性的等效增益曲线
扰能力。
2. 饱和特性
　　饱和特性是最常见的一种非线性特性，几乎各类放大器都存在饱和现象。执行元件中的电 动机，不仅具有死区特性，同时当电压超过一定数值时，由于磁性材料的非线性，电动机输出转矩 还会出现饱和特性，如图7.3.4所示。很多元部件由于受到行程和能源功率等条件的限制，也都 具有饱和特性。
　　理想化的饱和特性如图7.3.5(a)  所示，当输入信号在x≤|a|      时，输出与输人成线性关系， 当输入信号大于一定值在x>|a|      时，其输出将保持不变。
　　　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                   (b)


图7.3.4 具有不灵敏区的饱和特性
其数学表达式为



图7.3.5  饱和特性及其等效增益曲线

                         (7.3.3)
饱和特性等效增益曲线如图7.3.5(b) 所示，在―a≤x≤a      的线性区，等效增益为k; 在 x>a
或x<-a       的饱和区，等效增益k?  随着输入x(t)   的变化而变化。
　　　饱和特性对系统动态性能的影响随系统结构不同而不同。首先看饱和特性对稳定系统的性 能影响，分析一个位置伺服系统的时间响应，系统结构图如图7.3.6所示。假设输入信号r(t)=  1(t),   当放大器工作在线性区域时，系统的响应曲线如图7.3.7中的曲线1;当放大器工作在饱和 区时，系统的响应曲线如图7.3.7中的曲线2。
　　　由图7.3.7可见，当系统受到饱和特性的限制后，将使系统在大信号作用之下的等效增益降 低，从而使系统超调量变小，平稳性变好。




　　0.5 -0.05
　0.05 -0.5
电机
放大器


图7.3.6  某位置伺服系统的结构图

　　　　　　　
t/s
图7.3.7 位置伺服系统的响应曲线
　　若线性部分为不稳定的系统，在无饱和现象出现时，输出为振荡发散，当有饱和现象出现后， 系统输出会有所收敛，出现自激振荡现象。例如，某单位反馈位置伺服系统结构图如图7 . 3 . 8所
示，电机的传递函数为 ,此电机由具有增益K=260     的 放 大 器 驱 动。当放大器的输入 |e|>2     时，处于饱和区。当系统无饱和特性存在时，由于线性系统为不稳 定的系统，输出响应曲线如图7 . 3 . 9中的曲线1,为振荡发散；当饱和现象出现后，输出响应曲线 如图7 . 3 . 9中的曲线2,输出响应有所收敛，出现自激振荡现象。
　　　　　　　　
图7.3.8 某单位反馈位置伺服系统结构图

　　　当然，也还可以列举其他由于饱和特性的存在而使系统振荡变大的例子。总之，饱和特性对 系统动态性能的影响是比较复杂的，粗略地可以用线性系统中增益减少对系统性能产生的变化 来分析。由于饱和特性等效增益随着输入信号的加大而减小，因此，饱和特性的存在使系统开环 增益减小，降低了系统的稳态精度。




　　　　　　　　
t
图7.3.9 图7.3.8系统的响应曲线
3. 间隙特性
　　　系统的传动机构，无论传动形式是齿轮、链条、钢索还是杠杆，由于加工精度和装配上的限 制，在传动过程中总存在着间隙，它是控制系统中常见的非线性因素。例如，在齿轮传动中的间 隙，为保证主动轮灵活不发生卡死现象，必须和允许有少量的间隙，但间隙不应过大。由于间隙 的存在，当主动轮正转时，其位置位于两齿中间，如图7.3.10(a) 所示，从动轮是不动的，只有在 主动轴转过间隙b 以后，一对齿轮啮合，从动轴才随主动轴以线性关系转动。即图7.3.10(b) 中 AB 段；当主动轮反向转动时，主动轴先要空转2b 后，即图7.3.10(b)BC   段时，才能推动从动轴 跟随其转动，即图7.3.10(b)CD   段，因此，主从动轮之间存在如图7.3.10(b) 所示的环状间隙 特性。
　　　　　　　　　　　　　　　　　　　　　　　　　
(a)                                                                (b)
图7.3.10 齿轮传动中的间隙及间隙特性
其数学表达式为

(7.3.4)
　　　　　　　　　　　　　　
　　假设间隙特性的输入为正弦信号x(t)=Asinot,     则输出响应y(t)   的波形如图7.3.11所示。 由图中可以看出，输出响应在相位上滞后于输入信号φ角。因此，可以得出这样的结论，间隙非 线性的存在相当于在系统中引入了相角滞后环节，从而使得系统的稳定裕度减小，振荡加剧，动 态性能变坏，甚至会造成间隙自激振荡。





　　　　　　　　　　　
图7.3.11 间隙特性的输入输出波形
　　　间隙特性对稳态性能的影响是增大了系统的稳态误差，降低了控制精度，这相当于死区的 影响。
　　　减小间隙的直接方法有提高齿轮的加工精度，或采用双片齿轮传动。此外，从控制的观点 看，可以采用各种校正装置来补偿间隙对系统性能的影响。
4. 摩擦特性
　　　在机械传动机构中，摩擦是必然存在的物理现象。当传动机构由静止状态启动时，必须克服 机构中的静摩擦力矩，启动后为保持转速或进行加速，必须克服动摩擦力矩。 一般静摩擦力矩要 大于动摩擦力矩，它们与转速的关系如图7.3.12所示，图中M?  为静摩擦力矩，M?  为动摩擦力 矩 ，w 为转速。
　　　摩擦对系统的影响要根据具体情况而定。例如，对于随动系统，从静态方面看，摩擦特性相当 于在系统中引入了死区环节，从而造成系统的稳态误差加大，降低了稳态精度。对动态过程的影 响，主要是在系统运动速度太低时出现低速运动的不平滑性，即使系统响应出现低速爬行现象，如 图7.3.13所示，且静摩擦力与动摩擦力差值越大，越容易产生爬行。实际随动系统在启动、制动中 存在的这种低速爬行现象对系统是有害的，它使系统不能准确地捕捉目标，必须加以消除。



　　　　
图7.3.12 摩擦力矩示意图



图7.3.13 低速爬行现象




5. 继电特性
　　继电特性如图7.3.14所示，其特性中包含了死区、滞环及饱和特性，输入和输出之间不完全 是单值关系，h 为吸合电流，mh 为释放电流。实际继电特性多为图7.3.14(a)所示带滞环和死区 的三位置继电特性。当h=0   时，吸合电流和释放电流都很小，称为理想继电特性，如图7.3.14 (b) 所示。当m=1   时，吸合电流与释放电流相等，称为带死区的三位置继电特性，如图7.3.14 (c) 所示。当m=-1      时，可得具有带滞环的两位置理想继电特性，如图7.3.14(d) 所示。
　　　　　
(a)                          (b)                                (c)                                    (d)
图7.3.14 继电非线性特性
　　　继电特性对系统的影响类似于死区、饱和及非单值非线性特性的综合效果，会使系统振荡加 剧，稳态误差增大，甚至产生自激振荡或不稳定。继电特性能够使被控制的执行装置在最大输入 信号下工作，可以充分发挥其调节能力，故可以利用继电特性实现系统的最优控制，如快速跟 踪等。
　　以上只是对系统前向通道中包含某个典型非线性特性的情况进行了简单、定性讨论，所得结 论在其他情况下不一定适用，在遇到具体问题时还应做具体分析。
7.4    描述函数法

7.4.1   描 述 函 数 的 基 本 概 念
　　　非线性系统通常包含常见的非线性环节。当非线性系统满足一定的假设条件时，非线性环 节在正弦信号作用下的输出信号可用一次谐波分量表示，由此可得到非线性环节的近似等效频 率特性，即描述函数。此时，非线性环节就可用一个线性环节来近似代替，从而，就可以用线性系 统的频域分析法来近似分析非线性系统的性能，这种方法称为描述函数法。
1. 应用描述函数法的基本条件
　　　条 件 1 非线性系统应简化为一个非线性环节N 和一个线性部分G(s) 串联的典型结构，如 图7 .4 . 1所示。
r(t)=0           x(t)


图7.4.1 非线性系统典型结构图
　　条 件 2 非线性环节N 满足奇对称性，即 y(x)=-y(-           x), 以保证非线性环节的正弦响应 不含有直流分量，通常典型的非线性环节均满足此特性。



　　条 件 3  系统的线性部分G(s)具有较好的低通滤波特性。实际系统一般都能满足此特性， 且 G(s) 阶次越高，低通滤波性能越好。该特性可以保证非线性环节的输出y(t)中高次谐波分 量被充分衰减，从而可近似认为y(t)只有基波分量通过。
2. 描述函数的定义
设非线性环节输入输出描述为
y=f(x)                                                                        (7.4.1)
当输入信号x(t)   为正弦信号
x(t)=Asinat                                                                     (7.4.2)
则其输出信号y(t)一般为非正弦的周期信号，将其展开为傅里叶级数，即
　　　　　　    (7.4.3) 式 中A。为直流分量；Ynsin(nwt+qn)    为第n 次谐波分量，且
                          (7.4.4) (7.4.5)
(7.4.6)
(7.4.7)
(7.4.8)
　　根据描述函数法基本条件2,非线性环节 N 为奇对称，则A?=0 。 又根据描述函数法基本条 件3,系统的线性部分G(s) 具有良好的低通滤波特性，则非线性环节输出y(t) 中的高次谐波分
量被大幅度衰减，因此y(t)可以近似用它的一次谐波分量y? (t) 代替，即
y(t)≈y?(t)=A?cosat+B?sinat                                =Y?sin(at+φi)                         (7.4.9)
　　式(7.4.9)表明，当非线性环节输入为正弦信号时，其输出为与输入信号同频率的正弦信号， 不同在幅值和相角上。
　　类似线性系统频率特性的概念，定义非线性环节在正弦信号作用下，非线性环节稳态输出信 号的一次谐波分量和输入信号的复数比为描述函数，它一般为输入正弦信号幅值A  的函数，用
N(A)  表示，其数学表达式为
(7.4.10)
　式 中 ：A 为非线性环节输入正弦信号的幅值；Y? 为非线性环节输出信号的一次谐波分量幅值；φ1 为非线性环节输出信号的一次谐波分量与输入正弦信号的相位差，且
                       (7.4.11)
　　　　　　　　　　　　　　                       (7.4.12)  应当指出，如果非线性环节不包含储能元件，描述函数N  只与输入正弦信号幅值A  有 关 ，



　记为 N(A); 若非线性环节包含储能元件，则描述函数N 为输入正弦信号幅值A 和频率w 的 函 数，记为N(A,w)。


7.4.2   典型非线性特性描述函数
1. 饱和特性
饱和特性及其在正弦信号输入下的输出波形如图7.4.2所示。
　　　　　　　　　
图7.4.2 饱和特性及其输入输出波形
由图7.4.2可得输出信号y(t)的表达式为
　　　　　　　　　　　　　　
式中：K 为饱和特性线性区域斜率；,a  为线性区域范围。 由于饱和特性为单值且关于原点对称的奇函数，所以A?=0,A?=0。 计算 B? 得
　　　　　　　　　　
　　　　　　　　　　　　
























(7.4.13)














(7.4.14)

由于A?=0,   所以  于是，饱和特性的描述函数为
　　　　　　　　　　


　　　　　　　　　　　　　　


(A≥a)


(7.4.15)



根据式(7.4.15),以为自变量、为因变量的函数曲线如图7.4.3所示。
　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　　　　
图7.4.3  饱和非线性特性的描述函数曲线
　　　从图7 .4 .3可以看出，  时 ，; 当1时 ，1;当1 时，即A<a 时，输入正弦信号仅在线性区变化，没有进入饱和区。
2. 死区(不灵敏区)特性
死区特性及其在正弦信号输入下的输出波形如图7.4.4所示。
　　　　　　　　　
图7.4.4 死区非线性特性及其输入输出波形

由图7.4.4可得输出信号y(t)  的表达式为

(7.4.16)

式中：△为死区范围；K 为线性区域斜率；




　由于死区特性为单值奇对称函数，所以A?=0,A?=0。 计 算B?  得
　　　　　　　　　　
　　　　　　　　　　　　
　　　　　　　　　　　　
于是死区特性的描述函数为
　　　　　











(7.4.17)


(A≥△)(7.4.18)

根据式(7.4.18),C为自变量、     为因变量的函数曲线如图7.4.5所示。





　　　　　　　　　　　




1.0
　　　　　　　　　　　　　　　　　　　　　　
图7.4.5  死区非线性特性的描述函数曲线
　　从图7.4.5可以看出，当1,即A<△ 时，这是因为输入正弦信号的幅值未超 出死区，非线性特性无输出所致。
3. 继电特性
具有死区与滞环的继电特性以及在正弦信号输入下的输出波形如图7.4.6所示。
由图7.4.6可得输出信号y(t)的表达式为

(7.4.19)

式中：M 为继电器的输出幅值；   由于具有死区与滞环的继电特性为多值奇对称函数，故A?=0。 计 算A? 、B? 得



　　　　　　　　　　
　　　　　　　　　　　　
(7.4.20)
　　　　　　　　　　
　　　　　　　　　　　　
(7.4.21)

　　　　　　　
图7.4.6 具有死区与滞环的继电特性及其输入输出波形
于是，得具有死区与滞环的继电特性描述函数为
　　　  (7.4.22) 当h=0   时，得理想继电特性描述函数为
　　　　　　　　　　　　　　　　                                (7.4.23) 当 m=1   时，得带死区的继电特性描述函数为
　　　　　　　　　　　    (A≥h)                                         (7.4.24) 当m=-1      时，得带滞环的继电特性描述函数为
     (A≥h)                                (7.4.25)



表7.4.1列出了一些典型的非线性特性及其描述函数N(A)。
表7 .4 . 1 典型非线性特性及其描述函数

非线性类型	输入输出特性	描述函数N(A)



理想继电特性	　


　　　　　　　　　　　



有死区的继电特性	　


　　　　　　　



有滞环的继电特性	　　


　　　　　　



有死区与滞环的继电特性	　　


　　



饱和特性	　


　　　　



有死区的饱和特性	　　

　　　　
,A≥a




(续)

非线性类型	输入输出特性	描述函数N(A)



死区特性	　


　　　　


,A≥△



间隙特性	　　

　　
　　　　　　　　



变增益特性	　　


　　



有死区的线性特性	　


　　　



库仑摩擦加粘性摩擦特性	　　


　　　　　　　　　　
7.4.3   非线性系统的简化
　　　应用描述函数法分析非线性系统时，假设其典型结构为一个非线性环节N 和一个线性部分 G(s) 的串联形式，但实际非线性系统并非完全符合这样的要求。当存在多个非线性环节和多个 线性部分组合而成的形式时，必须通过结构图等效变换的方法将系统化为典型结构，等效变换的 原则是保证非线性环节的输入输出关系不变。
描述函数法一般用于研究非线性系统的稳定性和自激振荡，即系统的内部运动，并不考虑外



作用，所以在进行结构图的等效变换时可令输入r(t)=0。
1. 非线性环节的串联
　　当存在多个非线性环节串联的时候，可以先将串联的多个非线性环节等效为一个非线性环 节，然后再求其描述函数。
　　例7.4. 1 图7.4.7所示系统为一个死区特性和一个死区饱和特性的串联，试将其等效为 一个非线性环节，并求其描述函数N(A)。

　　　　　　　
图7.4.7 两个非线性环节串联
解  首先将两个非线性环节按图7.4.8(a)、(b)形式放置，得到等效非线性环节如图7.4.8
(c) 所示，其中  ,K=K?K? 。   由图中可以看出，当|x|≤△  时 ，y(x)=0;        当△< |x|<a     时，由于x?(x)  和 y(x?)   都位于线性区，所以y(x)   也位于线性区；当|x|≥a      时 ， y(x)  进入饱和区，最后由图7.4.8(c) 查表7.4.1可得等效的非线性特性描述函数为
　　　　
(7.4.26)


　　　　　　　
图7.4.8 非线性环节串联简化的图解方法



　　需要指出的是，两个非线性环节串联的等效非线性环节与两个环节的前后顺序有关，如果改 变前后顺序，则等效非线性环节亦不同，需要重新求出新的等效非线性环节再求其描述函数。
2. 非线性环节的并联
　　　图7 .4 .9(a)所示为死区特性和死区继电特性并联的情况，可先将两个非线性特性进行叠 加，如图7.4.9(b) 所示，然后再对叠加后的非线性特性求描述函数 N(A) 。 也可分别求出各非 线性特性的描述函数，然后叠加得到总的描述函数N(A),    即
N(A)=N?(A)+N?(A)                                                               (7.4.27)
　　　　
(a)                                                                            (b)
图7.4.9 非线性环节并联连接的等效变换
图7 .4 .9(a) 所示的非线性环节描述函数为
　　


　　　　　　



(A≥△)


(7.4.28)

3. 线性部分的等效变换
　　　当非线性系统中存在多个线性环节时，可将多个线性环节合并为一个等效线性环节，等效变 换的原则是保证非线性环节的输入输出不变。
　　例7.4.2 试将图7.4. 10所示非线性系统简化成一个非线性环节和一个等效线性部分相 串联的典型结构，并写出等效线性部分的传递函数G(s)。
G?(s)

H?(s)            N


(a)                                                                      (b)
图7.4.10 例7.4.2非线性系统结构图
　　解  (1)对于图7.4. 10 (a)   所示系统，先将主反馈回路与局部反馈回路合并可简化成图 7.4.11所示结构。
再 将 1 +H?(s)   方框与G?(s)  方框合并得到图7.4. 12所示结构。





r=0                       N                    G?(s)         c                   r=0

1+H?(s)
图7.4.11 图7.4.10(a) 等效结构
等效线性部分的传递函数为
G(s)=G?(s)[1+H?(s)]



一    N                 G?(s)[1+H?(s)]



图7.4.12 图7.4.11等效结构

(7.4.29)

(2)对于图7.4.10(b) 所示系统可简化成图7.4.13所示结构。

　　　　　　　　　　
图7.4.13 图7.4.10 (b) 简化结构
在图7.4. 13中，G?(s) 对应单位反馈，可简化为图7.4.14所示结构。
再将图7.4.14中方框与H?(s)  方框合并得到图7.4.15所示结构。
　　
图7.4.14 图7.4.13简化结构                    图7.4.15 图7.4.14简化结构
等效线性部分的传递函数为
(7.4.30)

描述函数法进行非线性系统分析
　　若非线性系统的结构如图7.4.16所示，N(A) 为非线性环节的描述函数，G(s) 为线性部分 的传递函数。由于非线性环节可以看成一个具有复数放大系数的放大器，所以整个系统就相当 于一个等效的线性系统，可用线性系统的频域响应法来判断系统的稳定性，并分析产生自激振荡 的条件等。
该闭环系统的特征方程为
1+N(A)G(s)=0                                                              (7.4.31)
用频率特性表示为
1+N(A)G(jw)=0                                                            (7.4.32)



r(1)=0        x(t)


图7.4.16 非线性系统等效为线性系统
　　下面分两种情况进行讨论。首先分析当N(A)=1,  即非线性环节不存在时线性系统的稳 定性。
1. 线性系统的稳定性分析
　　　当 N(A)=1      时，线性系统结构如图7.4.17所示，设 G(s) 为最小相位系统，系统的频率特性可以表示为
1+G(jw)=0                                (7.4.33)


或




G(jw)=-1


图7.4.17 线性系统结构图
(7.4.34)

　　　由奈奎斯特判据可知，当开环幅相曲线G(jw) 曲线不包 围(一1,j0)点时，如图7.4.18的曲线1所示，闭环系统是稳 定的。
　　　当 G(jw) 曲线包围(一1,j0)点时，如图7.4.18的曲线2 所示，系统是不稳定的。当G(jw) 曲线穿过(- 1,j0) 点时，如 图7.4.18的曲线3所示，系统临界稳定，产生等幅振荡。
　　　若在上述线性系统的基础上，增加一个放大系数为K 的 放大器，系统结构如图7.4.19(a)  所示，则闭环系统的特征方 程为
1+KG(jw)=0                                (7.4.35)          I图7.4.18 线性系统稳定性分析


或








(7.4.36)








K               G(s)



(a)                                                                      (b)
图7.4.19 线性系统结构图
由奈奎斯特判据可知，当开环幅相曲线G(jw) 不包围点时，系统稳定；当开环幅相曲线



G(jw) 包 围点时，系统不稳定；当G(jw) 曲线穿过 点时，系统临界稳定。 下面讨论当N(A)≠1     时非线性系统的稳定性。
2. 非线性系统的稳定性分析
当 N(A)≠1     时，闭环系统特征方程为
1+N(A)G(jw)=0
或
                           (7.4.37)
式中：称为非线性特性的负倒描述函数，对比式(7.4.37)和式(7.4.36)可知，负倒描述
函数相当于线性系统的临界点
对于线性系统，产生等幅振荡的临界点 是一个固定的点，奈奎斯特判据是根据
G(jw) 曲线与临界点的相对位置来判断闭环系统稳定性。而对于非线性系统，产生等 幅振荡的临界点是一条随A 变化的负倒描述函数曲线，可以在复平面上同时作出线性部分的频
率特性G(jw) 曲线和非线性部分的负倒描述函数 曲线，并在曲线上用箭头表示
　随 A 增大变化的方向，然后可由它们的相对位置来判断非线性系统的稳定性，这就是奈 奎斯特稳定判据在非线性系统中的推广应用。
设线性部分G(s)  为最小相位系统，判断非线性系统稳定性的方法如下：
曲线，如图7.4.20(a)  所示，则非线性系统稳定。
曲线，如图7.4.20(b)  所示，则非线性系统不稳定。
　　( 3 ) 若G(ja) 曲线曲线相交，如图7.4.20(c)所示，则非线性系统产生周期运动。 若该周期运动是稳定的，则系统出现自激振荡，且该周期运动的频率和振幅可用交点处G(jao) 曲  线上对应的 曲线上相应的A 值来表示。
3. 周期运动的稳定性分析
　　　当 G(jw)  曲线与曲线相交，每个交点对应一个周期运动。但并非每个周期运动都是 稳定存在的，只有稳定的周期运动才是非线性系统的自激振荡，并能够观察到。
　　　稳定的周期运动是指系统在受到外界小扰动作用下偏离原来的周期运动，当该扰动消失后， 系统的运动仍然能恢复到原来的周期运动。
不稳定的周期运动是指系统在受到外界小扰动作用下不能重新回到原来的周期运动。
　　　如图7.4.20(c) 所示系统，G(jw)曲 线 与曲线有两个交点M?  和 M?,  分别对应两个 不同振幅和频率的周期运动，这两个周期运动是否稳定下面来具体分析。




　　　　　　　　　　　　　　　　　
(a)                                (b)                                (c)
图7.4.20 非线性系统稳定性分析及周期运动的稳定性判断
　　(1)分析M? 点的情况：设M1点处的周期运动振幅为A?、频率为w,  即M? 点处周期运动为 A? sinw?t。假设此时系统受到外界干扰，使振幅A?   略有增大，工作点将沿移到B 点，由 于此时 G(jw)   曲 线 不 被 B  点包围，系统稳定，振荡过程收敛，振幅减小，工作点将沿
由 B 点回到M?  点。反之，假设干扰使振幅A?  减小，工作点将沿移到C 点，此
　时，由于G(jw) 曲线包围C 点，系统不稳定，振荡过程发散，使振幅变大，工作点又将沿由  C点回到M? 点。这说明M?  点的周期运动A?sinwt   不管受到振幅增大或减小的扰动都能维持， 所以M? 点对应的周期运动稳定。
　　　(2)研究M? 点的情况：设M? 点对应的周期运动为A?sino?t,   若外界干扰使振幅A? 略有增 大，工作点将沿 移到D 点，此时，G(jw)曲线包围D 点，系统不稳定，振荡过程发散，振幅 将继续增大，工作点将沿 远 离M?  点。反之，若干扰使振幅A?  减小，工作点将沿
　移到E 点，此时，G(jw)曲线不包围E 点，系统稳定，振荡过程衰减，使振幅减小，工作点 将沿 远离M2。这说明，M? 点对应的周期运动A?sino?t   只要受到干扰使振幅有稍微的 增大或减小，都不能回到M2 点，所以M2 点对应的周期运动是不稳定的。


　　综上所述，可以归纳出判断非线性系统周期运动稳定性  的简便方法：在复平面上，将线性部分G(jw) 曲线包围的区域  看成不稳定区域，不被G(jw)曲线包围的区域看成稳定区域，
如图7.4.21所示。若交点处 曲线沿着振幅A 增加的 方向由不稳定区到稳定区，则该交点代表的周期运动是稳定 的，即可以产生自激振荡。若交点处曲线沿着振幅
A增加的方向由稳定区到不稳定区，则该交点代表的周期运







稳定 区域

-1/N(4)





不稳定 区域



G(jw)


J

0

动是不稳定的，即不能产生自激振荡。
图7.4.21 周期运动的稳定性判断
　　　如果非线性系统产生自激振荡，则振荡的振幅和角频率 可以采用图解法得到，即振荡的角频率由G(jw) 在交点处的



频率确定，振荡的振幅由在交点处的A 值确定。 也可采用解析法，即由下式联立求解得到
(7.4.38)
　　例7.4.3 已知非线性系统的结构如图7.4.22所示，其中死区的继电特性参数h=0.7,M= 1.7。试用描述函数法分析该系统是否存在自振，若存在，求出自振的振幅A 和频率w。
M
c(1)
h                    50.01s+1)6.025+1)





图7.4.22 例7.4.3非线性系统结构图
解  由表7.4.1可知，带死区的继电特性描述函数为
    (A≥h)                                           (7.4.39)
　　　在实际应用中，常引入相对描述函数的概念，即将描述函数中部分非线性参数分离出来，乘 到线性部分中去，描述函数剩余部分的非线性参数都以相对值的形式出现。如上述带死区的继 电特性描述函数可表示为
(7.4.40)
　式中： 称为尺度系数 称为相对描述函数。 该系统特征方程变为
1+G(jw)N(A)=1+K?G(jw)N?(A)=0                                                       (7.4.41)
即
                         (7.4.42)
式中：称为相对负倒描述函数。
本系统的相对负倒描述函数为
    (A≥h)                    (7.4.43)
当 A→h  时 ，;当A→∞   时 ，




令                         时 ,             生极值为―1.57。
线性部分的频率特性为
              (7.4.44)
　　　令 Im[K?G(jw)]=0,      得(1―0.005w2)w=0,     求 得w=200    和 w=0   (舍去)、w=-200      ( 舍 去)。
在复平面上分别作出 K?G(ja)   曲线和曲线，如图7.4.23所示。
250  300
-1/N?(4)
-1.57-1

　　　　　K?G(jo) 150



曲线
图7 . 4 . 23中，在 时取得最大值，且当 时 ，从 一 ∞ →
- 1 . 57;当时 ，。这两段直线均在负实轴上重合。为表达 清楚，在图中用两条直线表示。
　　　由图7.4.23可知，K?G(jw) 在频率w=200  时与 曲线有两个交点M?  和 M?, 系 统 可能产生两个振幅不同但频率相等的周期运动。根据曲线或计算可知，M? 点 ,振幅
　A?=1.08×0.7=0.76;          交 点M?  ,振幅A?=2.62×0.7=1.83 。     根据周期运动稳定  性判断方法可得，M? 点对应的周期运动不稳定，M? 点对应的周期运动稳定，即M2 点产生自振， 自振振幅A=1.83,    自振频率w=200rad/s。
7.5   非线性控制系统的设计实例

　　　例7.5. 1 大容量汽轮机调节系统由于中间再热机组很多，系统调节部套和油管道复杂，故 存在着大量的非线性因素，易于出现自激振荡，从而对系统产生不利影响。某国产200MW  汽轮 机调节系统系统简化框图如图7 .5 . 1所示，其中a=1,K=1,         系统等效开环传递函数
。当油动机错油门油口宽度bh=5mm  (正常情况)和bh=2.5mm    (遇到 不利的工作条件，如滑阀卡涩、油口堵塞等)时，G(s) 的各项系数如下表所列。





(1)当bh=5mm  时

	Ti/s	5	K?/s
空负荷	1.886×10-2	0.221	18.8
满负荷	1.41×10-2	0.300	18.8



(2)当bh=2.5mm   时

	Ti/s	5	K?/s
空负荷	2.666×10-2	0.159	37.6
满负荷	2.000×10-2	0.213	37.6


　　试用描述函数法分析以上两种情况下系统的运动。若产生自振，求出自振频率及振幅，要求 通过MATLAB  编程绘图。

r(t)=0
G(s)
a=1


图7.5.1 某国产汽轮机调节系统简化框图
解 饱和特性的描述函数为
　　　　　　　　　　    (A≥a)                             (7.5.1) 取 ,对 N(u) 求导得
　　　　　　　      (7.5.2) 注意到A>a   时，,N(u) 为 u 的增函数，N(A) 为A 的减函数，亦 为A 的减函数，代入给定参数a=1,K=1,      得
曲线如图7.5.2所示。
(1)油动机错油门油口宽度bh=5mm  (正常情况)。
代入表中参数得空负荷和满负荷时系统线性部分的传递函数分别为
　　　
满负荷：
由 Im[G(jw?)]=0, 得上述两种情况下穿越频率wr 分别为53.02和70.9。空负荷时，G(s)
的幅相曲线Ic  与负实轴的交点为G(jw)|u?=53.02=-0.8;       满负荷时，G(jw)|a?=70.9=―0.44。
分别作出线性部分G(s) 的 T?  曲线如图7.5.2(a) 所示。由图7.5.2(a) 可知，I?   曲线不包围
曲线，此时系统稳定。
(2)油动机错油门油口宽度b=2.5mm   (非正常情况)
此时，空负荷和满负荷时系统线性部分的传递函数分别为
　　　　　　　　　　　




　　　　　　　　　　　　

　　　　　　　　　　　　　　　　　　　　　　
实轴                                        实轴
(a)                                                                                      (b)
图7.5.2 例7.5.1系统的和T?  曲线
(a) 正常情况；(b) 非正常情况。
1―空负荷；2―满负荷。
　　作 出TG曲 线 和曲线。由图7 . 5 . 2(b)  可见，该系统G(jw)  和一 ・有一交点，为稳 定极限环，出现自激振荡。由 Im[G(jw)N(A)]=0,           得空负荷和满负荷时的穿越频率分别为
wx=37.6    和 wx=50 。Ic      曲线与负实轴的交点为G(jwr)=-3.14    5 和 G(jw   )=-1.765 。     同 时 ，
,得振幅分别为A=4    和 A=2.2。
　　　由图7.5.2可见，当油动机错油门油口宽度正常时，汽轮机调节系统是稳定的；但当其宽度  变小会导致系统产生自激振荡。为了防止自振的产生，在进行系统设计过程中，应尽可能保证系 统有足够的稳定裕度，尽量缩短管道长度，降低非线性程度(如减小过封度、提高传动机构刚度、 缩小间隙和改善润滑),且在安装和调试时，应检查各部套的尺寸及动作关系，严格按规定进行  操作。

　绘制系统的TG 和曲 线 的MATLAB clc;clear;
%正常情况
G1=tf([18.8],[0.00035570.0083610]);   G2=tf([18.8],[0.00019880.00846610]);
A=1.0001:0.001:1000;


程序如下：


%建立系统的TF 模型(空负荷)
%建立系统的TF 模型(满负荷) %构造饱和特性的负倒描述函数

　x=real(-1./((2*(asin(1./A)+(1./A).'sqrt(1―(1./A).-2)))/pi+j*0)); y=imag(-1./((2*(asin(1./A)+(1./A).'sqrt(1―(1./A).2)))/pi+j*0));

figure(1);
nyquist(G1);hold   on;
nyquist(G2);hold   on; plot(x,y);hold    off;
axis([-30-44]);


%绘制系统G1的奈奎斯特图
%绘制系统G2 的奈奎斯特图 %画负倒描述函数曲线
%设定坐标值范围



%非正常情况
G3=tf([37.6],[0.0007070.00845610]);                             %建立系统的TF  模型(空负荷) ・
G4=tf([37.6],[0.00040.0085210]);                                  %建立系统的TF  模型(满负荷)
figure(2)
nyquist(G3);hold       on;%绘制系统G3 的奈奎斯特图
nyquist(G4);hold       on;%绘制系统G4 的奈奎斯特图
plot(x,y);hold      off;                                                     %画负倒描述函数图
axis([-60-66]);                                                               %设定坐标值范围

本  章  小  结

　　本章研究了分析非线性系统的方法，即描述函数法。首先介绍了非线性系统区别与线性系 统的特点，其次介绍了 一 些常见的非线性特性并简单分析了它们对系统性能的影响。接着介绍 了描述函数法，该方法是 一种工程近似方法，是线性理论频域法的推广。它是通过对非线性特性 建立数学模型即描述函数，然后采用线性系统的频域响应方法来近似分析非线性系统稳定性和 自激振荡，并通过解析法可以计算出自激振荡的振幅和角频率。另外，还讨论了该方法应用的前 提条件。最后介绍了采用MATLAB     编程进行非线性系统仿真的示例。
课 后 练 习 题
7―1   已知三个非线性系统的非线性环节 一 样，线性部分分别为
　　
试问：用描述函数法分析时，哪个系统分析的准确度高。
7-2   将图示非线性系统简化成环节串联的典型结构图形式，并写出等效线性部分的传递函数 G(s)。
r=0         一      N                            G?(s)      c

H?(s)

(a)                                                                              (b)
7 - 2 题 图
　7-3    判断图中各非线性系统是否稳定，曲 线 与G(jw)   曲线的交点是否为自振点，图中 G(jw) 为最小相位系统的幅相曲线。
7-4    已知某非线性系统如图所示，其中 ,要求：
(1)试用描述函数法分析系统是否存在自激振荡；
( 2 ) 若K  可变，试求系统临界稳定时的K  值 。










(a)                                                  (b)                                                    (c)                                             (d)
　　
(e)                                                    (f)                                                  (g)                                                    (h)

Im                                                       Im


G(ja)
v=2



　　Re 0
-1/N(A)
-1/N(A)


Re
G(jca) v=0


(i)                                                        ()
7―3题图

K=1
r=0                           -               G(s)                  C
一                                                                                     1


7 - 4题图
7-5       若要求如图所示非线性系统输出量c 的 自 振 振 幅A=0.1、  频 率w=10,  试确定参数 T 及
K  的 值(T 、K 均大于0)。
　　　　　　　　
7 - 5题图
7-6    已知某非线性系统如图所示，试用描述函数法分析周期运动的稳定性，并确定系统输出信 号振荡的振幅和频率。





1
C
0 0.2        53+1)



7―6题图
　7-7       已知某非线性系统如图所示，非线性元件的描述函数 ,其中M=1,K=0.5 。  试 分析系统周期运动的稳定性，并求出稳定周期运动的振幅A 和频率 以及输出c(t)的表达式。
7-8   试用描述函数法说明如图所示系统必然存在自振，并确定输出信号c 的自振振幅和频率， 分别画出信号c、x、y的稳态波形。


r=0



7- 7题图                                    7-8题图
7―9    已知非线性系统结构图如图所示，其中饱和特性参数a=1,k=2,   带死区的继电特性参数
为 M=1.7,h=1.4。   试用描述函数法分析系统是否存在自振。若存在，求出自振振幅和频率。
　　　　　　　　
7-9题图
7-10   已知某非线性系统如图所示，描述该系统的动态方程如下：
e(t)=r(t)―c(t);
t)   (k>0)
(1)试求G?(s)   和G?(s),    画出非线性环节的输入输出特性关系曲线。
(2)用描述函数法分析系统的稳定性，若存在自振求出自振振幅和频率。 r=0       e(t)    G?(s)  x(1)      非线性环节 y(1)       G?(s)        C


7- 10题图






第8章 线性系统的状态空间分析与综合



本 章 提 要
　　　本章介绍线性系统的状态空间分析与综合方法。主要介绍线性系统的状态空间描述、线性 系统的可控性与可观性以及线性系统可控性与可观性判据等、线性定常系统的线性变换、线性定 常系统的反馈结构及设计状态观测器，并详细介绍李雅普诺夫稳定性分析方法。
8.1  引   言
　　　通过本书前述各章，学习了控制系统分析与校正中的根轨迹法、频率响应法等重要方法，它 们都是以传递函数或频率特性的形式来描述控制系统的，属于经典控制理论范畴。虽然在实际 应用中，这些方法概念清晰，计算与操作简单，易被工程技术人员所理解与接受，但是面对诸如航 空航天、化工生产、数控加工、智能机器人等结构复杂的系统时，经典控制理论方法表现出诸多的 缺陷和局限性：首先，经典控制理论采用传递函数描述控制系统，只能够得到系统输出与输入之 间的外部特性，因而无法获知系统内部状态的全部信息；其次，经典控制理论仅限于研究零初始 条件下的单输入单输出线性定常系统，对于实际工程中大量存在的时变、多输入多输出非线性系 统，却根本无法得到令人满意的控制效果；最后，经典控制理论所采用的设计方法，在实际中往往 依赖设计人员的工程经验，通过“试凑”来选择合适的控制器，因而难以使系统获得在某种意义下 的最优性能。
　　　为了解决经典控制理论应用中存在的问题，以状态和状态空间概念为基础的现代控制理论 方法成为了新的有力工具。现代控制理论通过运用状态空间方法描述系统输入、状态变量和输 出间的因果关系，因而克服了传递函数描述系统特性的不足，可以用于分析多输入多输出、非线 性时变系统。这种方法通过把系统的高阶微分方程或传递函数改写为一阶微分方程组，使得系 统的数学模型变为矩阵矢量的简单形式。同时，不论被控系统复杂或是简单，高阶或是低阶，定 常或是时变，其状态空间表达式的形式都完全相同。虽然采用现代控制理论分析设计涉及大量 计算，但是借助于计算机，便可实现在时域中直接求解状态方程和分析系统性能。此外，在系统 设计时，基于现代控制理论，不仅能够构建传统的输出反馈，还能利用系统内部的状态变量进行 状态反馈，并在一定的条件下任意配置闭环系统极点。这些都是经典控制理论无法做到的。
　　　现代控制理论作为经典控制理论的发展，兴起于20世纪50年代，这个时期由于计算机技 术、航空航天技术的飞速发展，控制理论出现了许多重大的突破与创新，其中状态空间方法的应 用、极大值原理以及卡尔曼滤波技术，对于现代控制理论的形成和发展具有决定性意义。由于现 代控制理论的应用与推动，这一时期取得了众多令人瞩目的科技成就，苏联1957年成功发射世 界第一颗人造卫星，1962年首次实现太空编队飞行，1966年发射“月球”9号探测器成功实现软 着陆，美国1969年“阿波罗”11号成功实现载人登月等等。



　　　现代控制理论仍属于时域分析法，主要包括线性系统理论、系统辨识与建模、最优滤波理论、 最优控制以及自适应控制等内容。与经典控制理论相比，虽然在数学工具、理论技术和研究方法  上有着本质的不同，但在动态系统分析时，两者又可以互为补充，结合使用。因此，经典控制理论 的很多方法可以有效地渗透于现代控制理论研究之中。本章主要讨论线性系统状态空间模型的 建立和三种标准型的变换、状态方程式的求解、控制系统的能控性和能观性、用状态反馈任意配 置系统的闭环极点、李雅普诺夫第二方法等内容。
8.2    线性系统的状态空间描述

8.2.1   状 态 与 状 态 变 量
　　状态是系统在时间域中的行为或运动信息的集合。 一个系统的状态能够描述该系统在过 去、现在以及未来的情况，它可以是一组数字、一条曲线或者一个方程等。对于控制系统而言，系 统的状态是用一组状态变量来描述的。
　　　状态变量是指足以完全表征系统运动状态的一组独立(最小个数)变量。 一个n 阶微分方程 表述的系统对应n 个独立变量，但是对于究竟选择哪些变量作为独立变量，并不是唯一的，也就 是说，对于同一个系统，可以用不相同的一组状态变量来描述，但要保证各变量之间相互独立。

下面来看一个简单的例子，如图8.2.1所示的小车运动系统。
　　　忽略小车同地面之间的摩擦力，根据牛顿第二定律，可以 写出如下方程，即


(8.2.1)
式 中 ：f(t)    为小车推力；x(t)   为小车位移；m 为小车质量。 进一步，可以得到小车速度和位置的运动方程为



x(1) v(1)
f(1)
m


图8.2.1 小车运动系统

　　　　　　　　　　　　　　　
(8.2.2)
　因此，选择小车的速度v(t)   和位置x(t)    作为一组状态变量，就可以完全描述系统中小车的行 为。利用上述方程，若已知小车在初始时刻t。的状态[v(t?),x(to)]         以及小车推力，就可以确定 小车未来任意时刻的行为(状态)。
　　　由这个小车运动系统可以看出， 一组特定的状态变量表征了系统的一个特定状态，只需知道 系统的初始状态和系统输入，就可以确定系统未来的行为。以状态变量为坐标轴可以构成状态 空间，随着时间的变化，系统的状态在空间中形成的曲线被称为状态轨迹。
8.2.2   状 态 空 间 表 达 式
　　在现代控制理论中，系统的行为是由状态空间表达式来描述的。考虑一个基本的单输入线 性时不变n  阶系统，它应有 n 个独立的状态变量，假设这 n 个状态变量为x?(t),x2(t), … ,
xn(t),    系统的输入为u(t),    根据系统的动态特性，可以得到如下n 个微分方程，即



x?(t)=a?z?(t)+a12x?(t)+…+ax(t)+b?u(t)
x?(t)=a21x?(t)+a?2x?(t)+…+a?nx(t)+b?u(t)

(8.2.3)
这种描述了系统的状态变量的 一 阶导数与状态变量、输入变量之间关系的数学表达式被称为状 态方程。进 一步，可以把这个系统的状态方程写成如下矩阵形式，即
x(t)=Ax(t)+bu(t)                                                                              (8.2.4)
其 中
　　　　　　　　　　　
定 义 矩 阵A 为 系 统n×n     阶 的 系 统 矩 阵 ，b 为 系 统 的n×1      阶输入矩阵(控制矩阵),显然，对于 n 个输入的多输入系统，输入矩阵b 是 n×n     阶 的 。
　　　此外，描述系统的输出变量与状态变量、输入变量之间关系的数学表达式被称为输出方程。 假设上述系统是单输出系统，用y(t)   表示系统输出，它的输出方程可以写成
y(t)=c?x?(t)+c?x?(t)+ …                         十 cπxn(t)+du(t)
对应的矩阵形式为
y(t)=cx(t)+du(t)                                                                               (8.2.5)
式 中 ：c 为 系 统 的 1 ×n 阶输出矩阵(观测矩阵);d 为 1 × 1 阶 前 馈 矩 阵 ( 输 入 输 出 传 递 矩 阵 ) 。 对 于多输入多输出系统，系统的输出矩阵式和前馈矩阵均为n×n    阶 。
　　　到此为止，系统的状态方程和输出方程就构成了 一 个系统的状态空间表达式(状态空间描 述),也称为系统的动态方程。为了便于观察和分析，常用方框图形式来表示系统的动态方程，被 称为系统的结构图。由式(8 . 2 . 4)和式(8 . 2 . 5)描述的单输入单输出系统的结构图如图8 . 2 . 2 所 示 。
　　　　　　　　　　　
图8.2.2 单输入单输出系统的状态结构图

图中，用双线箭头表示所传递的信号是矢量，用单线箭头表示所传递的信号是标量，I  为 单
　位 阵 ，s 为拉普拉斯算子， 方 框 代 表 了n  个积分器。值得注意的是，在矢量矩阵乘法中，通常顺 序是不能任意颠倒的。
　　　和古典控制理论不同，状态空间描述考虑了“输入 ― 状态一输出”这一过程，它注意到了被输 入 一输出描述所忽略了的状态。输入引起了状态的变化，而状态才决定了输出的变化。因此，状



态空间描述是对系统的结构特性的反映，而输入一输出描述只是对系统的端部特性的反映。然 而，具有相同端部特性的系统，却可以具有不同的结构特性。这表明，状态空间描述是对系统的 一种完全的描述。系统的状态空间表达式，当状态变量的数目或输出的数目有变化――增加或 减少，并不增加方程表达形式的复杂性，这是状态空间描述的一个优点。
8.2.3   状 态 空 间 表 达 式 的 建 立 方 法
1. 根据系统机理建立状态空间表达式
　　对于一个实际系统，可以按照系统运行所遵循的机理建立相应的数学方程(组),然后选择相 关的状态变量，化为系统的状态空间表达式。
　　例8.2. 1 已知如图8.2.3所示的RLC 的电路系统，系统输入输出分别为e, 和ec,试选择 两组状态变量并建立相应的状态空间表达式，并就所选状态变量间关系进行讨论。
　　　　　　　　　　　　　　
图8.2.3 RLC的电路系统
解  根据回路电压定律
　　　　　　　　　　　　　　　　
电路输出量为
　　　　　　　　　　　　　　　　　　　
(1)设状态变量为电感器电流和电容器电压，即x1=i,    ,则状态方程为
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　


输出方程为

其矩阵―矢量形式为




ec=X2

　　　　　　　　　　　　
简记为
　　　　　　　　　　　　　　　　　　




其 中
　　　　　　
(2)设状态变量为电容器电流和电荷，即 x?=i, ,则有
　　　　　　　
　　　通过(1)和(2)两组状态变量的选择，说明了系统的状态空间表达式不唯一，选择不同的状态 变量，会得到不同的状态空间表达式。但是既然两组状态空间表达式描述的是同一个系统，它们 之间就应该存在某种变换关系。
　　　
　　　　　　　　　　　　　　　　　
对应矩阵一矢量形式为
x=Px
其 中

　　　以上说明只要选择非奇异矩阵P, 便可完成两组状态变量之间的变换x=Px 。 若选择不同 的变换矩阵P,  就能够变换出一组新的状态变量，说明系统状态变量选择的不唯一性。
例8.2.2  已知如图8.2.4所示的质量弹簧阻尼系统，系统输入输出分别为 u(t)   和 y(t),
试建立相应的状态空间表达式。
解  由牛顿定律、胡克定律以及弹簧定律易得
　　　　　　　　　　
选择状态变量 ,x?=y,     则
　　　


X?=x1
写成矩阵一矢量形式为
x=Ax+bu


图8.2.4 质量弹簧阻尼系统

y=cx
其 中
　　　　　　



2. 根据其他形式的数学模型建立状态空间表达式
　　　对于线性定常连续系统而言，微分方程和传递函数是常见的两种数学模型，因此，可以从系 统已有的其他数学模型导出其状态空间表达式，从而揭示系统内部的重要特性。
1)由微分方程建立状态空间模型
情 况 1 系统输入项中不含导数项。
在这种情况下，一个单输入单输出n 阶线性时不变系统可用如下微分方程描述，即 y(”)+an?y"-1)+…+a?y+aoy=bou
若选择状态变量x?=y,x?=y,x?=y,…,xn=y(n-1),                 则可以得到如下方程组，即
x?=x?
x?=x3

xn- 1=xn                                                                   (8.2.6)
xn=y(m)=-an-1xn-…-a?x?―aox?+bou
令
　　　
可以进一步得到方程组的矩阵一矢量形式，即
x=Ax+bu

　　按式(8.2.6)绘制的结构图称为状态变量图，如图8.2.5所示，每个积分器的输出都是对应 的状态变量，状态方程由各积分器的输入一输出关系确定。
  x?=y

a?


图8.2.5 系统状态变量图
　　例8.2.3   已知系统的微分方程为y+  节 + 4y+ 5y=  3u,试选择状态变量，并写出状态空 间表达式。
解  选择状态变量y=x?,y=x?,"=x?,              则有
　　　　　　　　　　　　　　　




状态空间表达式为
　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
情况2 系统输入项中含有导数项。
这种情况下的单输入单输出n 阶线性时不变系统可用如下微分方程描述，即 y(m)+an-1y(n-1)+…+a?j+aoy=bnu(n+bn?un?1)+…+b?u+bou
选择如下一组状态变量，即
x?=y―hou
x;=xi-1―h;-1u                 i=2,3,…,n
式中：ho,h?,…,hn-1   是 n 个待定常数。
对xn 求导并考虑方程，可以得到
in=y(n)―hou(m)―…-hn1u=
(-an-1y(m-1)-…-a1y―aoy+bu”+b-1u”1+…+b?ü+bou)                            一
hou(n)    …-hn?ü
将 y”-1),…,j,y         均 用x; 及 u 的各阶导数替换，可以得到
in=―aox?―a?x?-…an-1xn+(b―ho)u(n+(b-1―h?―an-1ho)u(n-1)+ …+ (b?―hn-1-an-1hn2-…-a?ho)u+(bo―an1hn-1-…-a?ho)u
若令
ho=bn
　　　　　　　　　　　　　　　　　
hn-1=b?―a?hn-2-…-a?h?  hn=b?―an-1hn1-…-a?h?
可以得到系统的状态空间表达式为
x=Ax+bu y=cx+du
其中
　　　　　　　　　　　　　




　　　　　　　　　　　　　　　　　　　
c=[1    00    …  0]
d=h?
例8.2.4 已知系统的微分方程为y+23+3y+5y     =5ü   +7u, 试选择状态变量，并写出状
态空间表达式。
解  选择状态变量x?=y― hou,x?=x?―h?u           ,x?=x?―h?u,其 中
ho=b?=5
h?=b?―a?ho=0-2×5=―10
h?=b?―a?h?―a?ho=0-2×(-10)-3×5=5
　　　　　　h?=bo―a?h?―a?h?-a?h 。=7-2×5-3×(―10)―5×5=2 则状态空间表达式为
　　　　　　　　　　　　
　　　　　　　　　　　　　　　　
2)由系统传递函数建立状态空间模型
单输入单输出线性时不变系统的传递函数模型可以表示为
(8.2.7)
应用综合除法可将式(8.2.7)化为
(8.2.8)
式中：bn描述了输入输出之间的直接转移关系，即为系统状态空间模型中的输入输出矩阵。
　　　当G(s) 的分母阶数大于分子阶数时，则bn=0,  是严格有理真分式，其分子各次项的系 数分别为
βo=bo―aobn
β1=b?―a?bn
　　　　　　　　　　　　　　　　　　　　　
βn-1=bn-1-an-1bn
因此，系统状态空间模型中的剩余三个系数矩阵均由严格有理真分式确定。



情况1 的串联分解形式。
取中间变量z,将 分解为如图8.2.6所示的串联结构，则满足 z(n)+an-1z(n-1)+…+a?z+aoz=u
y=βn-12("-1)+…+βiz+βz
　　　　　　
图8.2.6 的串联分解结构
若取状态变量
x?=z,z?=              之，x?=z,…,xn=2("-1)
则系统的状态方程可以表示为
　　　　　　　　　　　　　
可以得到系统状态空间表达式的矩阵一矢量形式为 x=Ax+bu
y=cx
其中
　　　　　
　　注意：若系统的状态空间表达式中，A、b矩阵如以上这种形式，则称A 矩阵为友矩阵，并把此 状态空间表达式叫做能控标准型。
若选取状态变量为
Tn=y
x;=xi+1+a;y―biu                    i=1,2,…,n―1
则系统的状态空间模型为
　　　　　　　　　　　




Y=[00



…    0    1]X

　　此时，状态方程中的A 矩阵为友矩阵的转置矩阵，把A、c矩阵具有以上这种形式的状态空 间表达式称为能观标准型。
这里可以看到系统的能控标准型和能观标准型具有如下的对偶关系，即
A.=AT,bc=c。,c.=b。
式中：下标c 表示能控标准型；o 表示能观测标准型；T  为转置符号。关于能控和能观测的概念， 在8.3节中还会深入论述。
例8.2.5  设二阶系统微分方程为“+2ξwny+wny=τü+u,       试列写能控标准型、能观测标
准型动态方程，并分别确定状态变量与输入、输出量的关系。
解  由微分方程可以得到系统的传递函数为
　　　　　　　　　　　　　　
因此，系统的能控标准型动态方程的各矩阵为


　　　　　　　









C.=[1


t]

引入中间变量z 将系统串联分解得到
z+2Gun    之 +w2z=u
y=z+z
对 y 求导并考虑上述关系式，则有
y=ü+z=(1―2nt)z―w2tz+tu
令 xa  =z,xc?=z,  可导出状态变量与输入、输出量的关系为
　　　　　　　　　　　　　　
　　　　　　　　　　　　　　
能观测标准型动态方程中各矩阵为
C 。=[01]

状态变量与输入、输出量的关系为
To1=y+2wny-τu,Xo2=y
情 况 2 D(s) 中只含单实数极点。
设λ1,λ2,…,λn为系统的单极点，则
D(s)=(s―λ1)(s―λ2)…(s―λn)
因此，系统的传递函数可以表示为
　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　




其中



为 在极点λ;处的留数。 若取状态变量为








(8.2.9)

　　　　　　　　　　　　　　
可以得到系统的状态空间表达式为
　　　　　　　　　　　　　　　
y=[c1        C?     … ・  cn]x
若取状态变量为
　　　　　　　　　　　　　　
可以得到系统的状态空间表达式为
　　　　　　　　　　　　　　
y=[1         1    …     1]x
　例8 .2.6  设系统传递函数为 ,试写出状态空间表达式。 解  系统的传递函数可以表示为
　　　　　　　　　　
采用留数法求上式中的各待定系数，即
　　　　　　　　　　　　　　
　　　　　　　　　　　　　　
可得系统的状态空间表达式为
　　　　　　　　　　　　　　




　　　　　　　　　　　　　　　　
情 况 3 含有重实数极点。
设λ1为D(s) 的三重根，则
D(s)=(s―λ1)3(s―λ2)…(s―λn)
因此，系统的传递函数可以表示为
　　　　　　
按照情况2中的两种方法选取状态变量，可分别得出矩阵一矢量形式的状态空间表达式为
　　　　　　　　　　　
y=[c11        C12     C13 C4     … ・    cn]x
　　　　　　　　　　　
11         …   1]
式中：系数c; 按照式(8.2.9)计算，重根对应的系数为
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　
(8.2.10)
　例8.2.7 设系统传递函数为 ,试写出状态空间表达式。 解  系统的传递函数可以表示为
　　　　　　
按照式(8.2.10)求上式中的各待定系数
C11=[G(s)・(s―2)3]|s=2=19
　　　　　　　　　　　　　



　　　　　　　　　　　　　
可得系统的状态空间表达式为
　　　　　　　　　　　　　　　　
y=[19         13    2]x
8.2.4   线性连续时不变系统状态方程的解
1. 齐次状态方程的解
齐次状态方程指输入为零的状态方程，即
x(t)=Ax(t)
　它反映了系统自由运动的状况(即没有输入作用的状况)。对于齐次状态方程求解有三种常见解 法：幂级数法、拉普拉斯变换法和凯莱―哈密顿定理法。
1)幂级数法
设 x(O)=bo,x(t)=ax(t)         的解为
x(t)=bo+b?t+b?t2+ …+bat+ …                                                        (8.2.11)
则
x(t)=b?+2b?t+3b?t2+ … +kbt?1+ …                                                      (8.2.12)
由式(8.2.11)和式(8.2.12)的同次幂系数相等，可以得到
　　　　　　　　　　
　　　　　　　
从而得到
　　　　　　　　　　　　
因为指数函数  所以方程x(t)=ax(t) 的解为
x(t)=e“x(0)
进一步推广，若定义矩阵指数函数
　　　　　　　　　
为系统的状态转移矩阵，记为Φ(t),则齐次状态方程x(t)=Ax(t) 的解为 x(t)=ex(0)=Φ(t)x(O)
状态转移矩阵Φ(t)  表明了x(t)  是由x(O) 转移而来的。
2)拉普拉斯变换法
对方程x(t)=Ax(t)     两端取拉普拉斯变换



sx(s)―x(O)=Ax(s)
　　(sI―A)x(s)=x(O) x(s)=(sI-A)-1・x(0)
进一步取拉普拉斯反变换就可以得到系统的解
x(t)=L-1[(sI-A)-1]・x(0)
其状态转移矩阵为
Φ(t)=e=L1[(sI―A)-1]
例8.2.8 已知系统状态方程和初始条件为
　　　　　　　　　　　　　　　


试用拉普拉斯变换求解。

解

其中


则有




而




　　


A?=1,



　　　　

eAt=e,eA21=L1[(sI―A?)?1]

　　
　　　　　　　　　　　　
所以状态转移矩阵为
　　　　　　　　　　　　
3)凯莱―哈密顿定理法
定理8.2.1  设 n 阶矩阵A 的特征多项式为
f(λ)=|I-A|=λ”+an1λ”1+…+a1λ+a?
则有矩阵A 满足它的特征方程，即



f(A)=A”+an-1A”?1+…+a?A+a?I=0
从该定理可以得到如下两个推论：
推 论 1 矩 阵A 的 k(k≥n) 次幂可表示为A 的 n-1  阶多项式
　　　　　　　　　　　　　　　　
推论2 矩阵指数e 可表示为A 的 n-1  阶多项式，即
(8.2.13)
且各αm(t) 作为时间的函数是线性无关的。
由凯莱―哈密顿定理，矩阵A 满足它自己的特征方程，因此，在式(8.2.13)中用A 的特征值
λ;(i=1,2,…,k) 替 代A 后仍能满足
(8.2.14)
若λ;互不相等，则根据式(8.2.14),可写出各a;(t)所构成的n 元一次方程组为 e211=αo+α1λ1+α2λ2+…+αn-1λ”1
e^21=αo+a?λ2+α2λ2+…+αn-1λ2-1

en2=ao+a?λn+a?λ+…+αn-1λ”1
求解方程组可得系数 αo,a?,…,αk-1,     将其代入式(8.2.13)后即可得出e。
例8.2.9  对例8.2.8采用凯莱―哈密顿定理法求解。
解  矩阵的特征值为
λ1,2=1,λ3=2
对于λ?=2,有
e2=ao(t)+2α1(t)+4a?(t)
对于λ1,2=1,有
e2=ao(t)+a?(t)+az(t)
因为是二重特征值，故需补充方程
te2=a?(t)+2a(t)
从而联立求解，得
ao(t)=e2?―2te
a?(t)=3te-2e2+2e
a?(t)=e2-e―te
e=a?(t)I+a?(t)A+a(t)A2=
　　　　　　　　
　　　　　　　　



2. 状态转移矩阵的性质
　　　系统的状态转移矩阵是求解线性时不变系统状态方程的重点问题，掌握它的一些基本运算 性质对于求解状态转移矩阵非常有用。
性质1 Φ(O)=I
证明   (O)=e|=o=I
性质2 Φ(t)=AΦ(t)=Φ(t)A
证明
Ae=eA=AΦ(t)=Φ(t)A
性质3  Φ(t?±t?)=Φ(t?)Φ(±t?)=Φ(±t?)Φ(t?)
证明   Φ (t?±t?)=eAC1±2)=e1・e±A2=e±A2・e1=Φ(t?)Φ(±t?)=Φ(±t?)(t?)
性质4 Φ -1(t)=Φ (一t)
证明   -1    (t)=(e)-1=eA=Φ                ( 一t)
性 质 5 x(t?)=Φ(t?―t?)x(t?)
证明   x(t?)=Φ(t?)x(O),x(O)=Φ-1(t?)x(t?)=Φ                           ( 一t?)x(t?)
x(t?)=Φ(t?)x(O)=Φ(t?)Φ                 ( 一t?)x(t?)=Φ(t?―t?)x(t?)
性质6  Φ(t?―t?)Φ(t?―to)=Φ(t?―to)
证明   Φ(t?―t?)Φ(t?―to)=eA(L2-1)・e?(t?-5)=eAL2―to)=Φ(t?―to)
性 质 7  [ Φ(t)]=Φ(kt)
证明   [Φ (t)]=(e)k=e=Φ(kt)
性质8 若        则
e(A+B)t=eeR=ee
　　
　　　　　　　　　
　　　　　　　　　
同时
　　
　　　　　　　
则
　　　　　　　　　　　　　
　　　　　　　　　
因此，当且仅当AB=BA   时，有
e(A+B)t=ee=ee
例8.2.10 已知状态转移矩阵为 ,试求φ?1(t),A。



解  根据状态转移矩阵的运算性质，有
　　　　　　　　　　　　
　　　　　　　
3. 非齐次状态方程的解
非齐次状态方程描述了线性定常系统在控制作用下的运动，即
x(t)=Ax(t)+Bu(t)                                                                 (8.2.15)
求解非齐次状态方程的解主要有积分法和拉普拉斯变换法两种解法：
1)积分法
由式(8.2.15)得到
e^[x(t)―Ax(t)]=e^Bu(t)
由于
　　　　　　　　
积分可得
　　　　　　　　　　　　　　
则
(8.2.16)
式中：第一项为状态转移项，是系统对初始状态的响应，即零输入响应；第二项是系统对输入作用 的响应，即零状态响应。
通过变量代换，式(8.2.16)还可以表示为




若取to 作为初始时刻，则有






(8.2.17)

　　　　
2)拉普拉斯变换法
将式(8.2.15)两端取拉普拉斯变换
sX(s)―x(0)=AX(s)+BU(s)
X(s)=(sI-A)-1X(O)+(sI-A)?1BU(s)
上式取拉普拉斯反变换可得
　　　　　　　x(t)=L?1[(sI-A)-1]x(0)+L-1[(sI-A)?1BU(s)] 例8.2. 11 设系统状态方程为
　　　　　　　　　　　　　　　



设初始状态为x(0)=[x?(0)x?(O)]T,          求当u(t)=1(t)      时系统的解。
解  由 于u(t)=1(t),u(t―t)=1,             由式(8.2.17)可得
　　　　　　　　　　　　　　
采用拉普拉斯变换方法求系统的状态转移矩阵，即
　　　　　　　　　　　
　　　　　　　　　
　　　　　　　　　　　　　　　
　　　　　　　　
因此，有
　　　
故
　　　

8.2.5   系统的传递函数矩阵
　　对于单输入单输出系统，我们已经学习过传递函数建立的方法。对于多输入多输出系统，需 要进一步讨论传递函数矩阵。初始条件为零时，输出矢量的拉普拉斯变换式与输入矢量的拉普 拉斯变换式之间的传递关系称为传递函数矩阵，简称传递矩阵。
设初始条件为零，对线性定常系统的动态方程进行拉普拉斯变换，可以得到 sX(s)=AX(s)+BU(s)
Y(s)=CX(s)+DU(s)
进一步，有
X(s)=(sI-A)?1BU(s)
Y(s)=[C(sI-A)1B+D]U(s)=G(s)U(s)
则系统的传递函数矩阵(简称传递矩阵)定义为
G(s)=C(sI-A)?1B+D
例8.2.12 已知系统动态方程为
　　　　　　　　　　　　　　　　



y=[12]x+4u


试求系统的传递函数矩阵。
解  已 知





由 于

　　　　　　　　　　　　　　　　
　　　　　　　　　　　

故
G(s)=C(sI-A)- 1B+d=
　　　　　　　　　
8.2.6   线 性 系 统 状 态 空 间 模 型 的 线 性 变 换
　　　同一系统选取不同的状态变量便有不同形式的动态方程，对系统的状态空间模型进行(非奇 异)线性变换，如将A 矩阵对角化、约当化，将系统状态空间模型化为能控标准型、能观标准型或 对动态方程进行规范分解，便于揭示系统特性及分析和综合设计，且不会改变系统的性质。本小 节将给出一些常用的线性变换方法。
1. 非奇异线性变换定义与性质
设系统动态方程为
x(t)=Ax(t)+Bu(t)
y(t)=Cx(t)+Du(t)
取非奇异矩阵P, 做如下状态变化
x=Px
设变换后的动态方程为
文(t)=Ax(t)+Bu(t)
y(t)=x(t)+Du(t)
其 中
A=P?1AP,B=P?1B,C=CP,D=D
　　　待计算出所需结果之后，再引入反变换x=P-1x,  即可将新系统变回原来的状态空间中去， 获得最终结果。由于非奇异线性变换是等价变换，因此不会改变系统的固有性质，可以得到如下 性质：
性 质 1 线性变换前后系统传递函数矩阵不变。
证明 设系统变换后系统传递矩阵为G, 则
G=CP(sI―P?1AP)-1p- 1B+D=
CP(P-?1sIP-P-1AP)- 1P?1B+D=



CP[P-1(sI-A)P]-1P- 1B+D=
CPP-1(sI-A)-1PP- 1B+D=
C(sI-A)?1B+D=G
以上计算表明变换前后的系统传递矩阵相同。
性质2 线性变换前后系统特征值不变。
证明   AI-P-1AP|=|λP-1P-P-1AP|=|P-1λIP-P-1AP|=
|P-1(AI―A)P|=|P-1|λI―A||P|=
|P-1||P||λI-A|=|I|lλI―A|=|AI                     一A|
　以上计算表明变换前后的特征多项式相同，故特征值不变。由此可以推出，非奇异变换后，系统 的稳定性不变。
　　　性质3  若 Φ(t)为 x=Ax  的状态转移矩阵，则经非奇异线性变换x=Px  后的状态转移矩 阵为
Φ(t)=e=P-1eP=P-1φ(t)P
　　　
　　　　　　　　　
　　　　　　　　　
2. 几种常用的线性变换
情况1 化A 矩阵为对角型矩阵。
　　　(1)设A 矩阵为任意方阵，且有n 个互不相同实数特征根λ1,λ2,…,λn,则可由非奇异变换 可将其化为对角阵A, 即
　　　　　　　　　　　　　　
式中：P 由特征矢量p;(i=1,2,…,n)        组成，即
P=[p1        p?    …     pn]
且各特征矢量满足
Ap;=λiP;                                                              (8.2.18)
　　　( 2 ) 设A 矩阵为友矩阵，且有 n 个互不相同实数特征根λ1,λ2,…, λn,则可用范德蒙特 (Vandermode)  矩阵P 将A 矩阵对角化，即
　　　　　　



　　　( 3 ) 设A 矩阵为任意方阵，且有m 个相同的实数特征根(λ?=λ2=…=λm), 其 余n―m  个 特 征根为互异实数特征根，但在求解式(8.2.18)时，有m 个独立的特征矢量pi,p?, … ,pm,       则仍然 可以将A 矩阵化为对角阵A, 即
　　　　　　　　　　　　
且变换矩阵为
P=[P1         p?    Pm   Pm+1    …   pn]
式中：Pm+1,Pm+2,…,pn 是互异实数特征根λm+1,λm+2,…,λn对应的特征矢量。 例8.2. 13 试将状态方程
　　　　　　　　　　　　　　
化为对角标准形。
解  求A 矩阵的特征值
　　　　　　　　
可得
λ1=-1,λ2=―5
求对应不同特征值的特征矢量：
对于λ1=- 1,有
　　　　　　　　　　　　　
解得
　　　　　　　　　　　　　　　　　
对于λ2=―5,有
　　　　　　　　　　　　　
解得
　　　　　　　　　　　　　　　　　
构造变非奇异变换阵，即
　　　　　　　　　　　　　　　




　　　　　　　　　　　　　　　　　
则
　　　　　　　　　　　　　　　
　　　　　　　　　　　
可得原系统的对角标准型为
　　　　　　　　　　　　　　
情况2  化 A 矩阵为约当型矩阵。
　　　设A 矩阵有m 个相同的实数特征根(λ?=λ2=…=λm),其余n-m  个特征根为互异实数特 征根，但在求解式(8.2.18)时，重根只有一个独立的特征矢量 p?, 则只能将A 矩阵化为约当阵 J,  即
　　　　　　　　　　　　
且变换矩阵为
P=[p1        p?    pm      :     Pm+1 …     pn]
式 中：P?,pm+1,Pm+2,…,pn 分别是互异实数特征根λ1,λm+1,λm+2,…,λn 对应的特征矢量，而 p?, ps,…,pm   是广义特征矢量，满足
　　　　　　　　
例8.2.14 试将状态方程
　　　　　　　　　　　　



化为约当标准型。
解  求A 矩阵的特征值，即
　　　　　　　　　
λ1=1,λ2=λ3=3
求各特征值对应的特征矢量：
对于λ=1,有
(λI―A)v;=0
即
　　　　　　　　　　　　
对于λ=3,有
(λI―A)v';=0
即
　　　　　　　　　　　
(λI-A)v";=―v;
即
　　　　　　　　　　　
构非奇异变换阵P,  即
　　　　　　　　　　　　　
则
　　　　　　　　　　　　　　　　
　　　　　　　　　　
可得约当标准型为
　　　　　　　　　　　　　　




8.2.7   线性离散系统的状态空间模型
　　　和连续系统一样，离散系统也可以用状态空间法描述。在经典控制理论中，离散系统通常用 差分方程或脉冲传递函数来描述。线性离散系统的动态方程可以利用系统的差分方程建立，也 可以将线性连续系统动态方程离散化得到。
1. 由差分方程或传递函数建立动态方程
设单输入单输出线性定常离散系统的差分方程的一般形式为
y(k+n)+an-1y(k+n―1)+ …+a?y(k+1)+aoy(k)=
　　　　　　　　bnu(k+n)+bn-1u(k+n―1)+…+b?u(k+1)+bou(k) 对上式两端取Z 变换，并整理可得脉冲传递函数为
　　　　　　　　　　
上式与式(8.2.8)在形式上相同，故可将连续系统动态方程的建立方法用于离散系统。
　　考虑零初始条件，利用Z 反变换关系Z-1[X;(z)]=x;(k) 和Z 1[z   X;(z)]=x;(k+1),  可以 得到动态方程的矩阵一矢量形式为
　　　　　　
y(k)=[β             β    …βn-1]x(k)+bu(k)
并简记为
x(k+1)=Gx(k)+hu(k)
y(k)=cx(k)+du(k)
2.由连续系统离散化建立动态方程
已知线性定常连续系统状态方程x=Ax+Bu    在x(to)  及 u(t)  作用下的解为
　　　　　　　　　　　　

令to=kT, 则 x(to)=x(kT)=x(k);	令t=(k+1)T,  则 x(t)=x[(k+1)T]=x(k+1);	并假定在
t ∈[k,k+1]    区间内，u(t)=u(kT)=	常数，且采样时间间隔相等，则其解化为
　　　　　　
记
　　　　　　　　　　　　　　
采用变量代换可以得到
　　　　　　　　　　　　　　　　　



故离散化状态方程为
x(k+1)=Φ(T)x(k)+G(T)u(k)
式中：Φ(T)  与连续状态转移矩阵Φ(t) 的关系为
Φ(T)=Φ(t)|t=T
离散化输出方程仍为
y(k)=Cx(k)+Du(k)
例8.2.15 设线性定常连续时间系统的状态方程为
　　　　　　　　　　　　　
试将该连续系统的状态方程离散化(采样周期T=0.1s)。 解  计算系统的状态转移矩阵，即
　　　　　　　　　　　
　　　　　　　　　　　　　　

可得离散时间系统的系数矩阵，即
　　　　　　　　　　　　　　
将 T=0.1s 代入得
　　　　　　　　　　　　　　　　
　　　　　　　　　　
　　　　　　　　　　　　
　　　　　　　　　　　　
故系统离散化状态方程为
　　　　　　　　　　
3. 线性定常离散动态方程的解
　　　求解离散系统运动的方法主要有两种方法：Z 变换法和递推法，由于后者特别适合计算机计 算，且对非线性系统、时变系统都适用，因此，这里用递推法求解系统响应。
　令状态方程式(8.2.19)中的k=0,1,…,k―1, 可得到T,2T,…,kT  时刻的状态，即 k=0:      x(1)=Φ(T)x(O)+G(T)u(O)



k=1:       x(2)=Φ(T)x(1)+G(T)u(1)=
　　　　　　　①2(T)x(O)+Φ(T)G(T)u(O)+G(T)u(1) k=2:       x(3)=Φ(T)x(2)+G(T)u(2)=
①3(T)x(0)+Φ2(T)G(T)u(0)+Φ(T)G(T)u(1)+G(T)u(2)

k=k-1:           x(k)=Φ(T)x(k-1)+G(T)u(k-1)=
　　　　　　　　　　　
输出方程为
　　　　　
于是，线性定常离散系统的解为



8.3    线性系统的能控性和能观性

　　　能控性和能观测性是现代控制理论中两个重要的基本概念，由Kalman  于1960年提出。能 控性回答了系统所有状态变量的运动是否可以通过有限的控制点的输入来使其由任意的初态达 到任意设定的终态的问题；而能观性回答了系统所有的状态变量任意形式的运动是否可由有限 测量点的输出完全确定出来的问题。
观察如下系统：
　　　　　　　　
y=[1          1]x
其状态变量结构图如图8.3. 1所示。
从图中可以看到，x? 不受输入u 的控制，而x?  与输入u
有关，因而系统是不完全能控的；同时，系统输出y=x?+
x?, 因 而y 包含了x?   和x?  的信息，能够通过y 能观测到x1
和 x?, 即系统是能观测的。                                     图8.3.1 系统状态变量图
8.3.1   线 性 连 续 系 统 的 能 控 性
1. 能控性的定义
考虑连续定常系统
x=Ax+bu                                                                      (8.3.1)
　　　若存在无约束的分段连续控制函数u(t),   在有限时间间隔 t ∈[to,tf]    内，能使系统从任意初 态 x(t?)   转移至x(t;)=0,      则称该系统是状态完全能控的，简称系统是能控的。




2. 常用能控性判据
定理8.3.1(秩判据)对于系统式(8.3. 1),其状态完全能控的充分必要条件是能控性矩阵 S=[b          Ab           …A”?1b]
的秩为n。
证 明 系统式(8.3.1)的终态解为
　　　　　　　　　　　　　　　
定义任意的△x=x(t)―eAt;       一6)x(to),    可 得
　　　　　　　　　　　　　　　　　　　
利用凯莱―哈密顿定理的推论
　　　　　　　　　　　　　　　　　　　　
有
　　　　　　　　　　
令
　　　　　　　　　　　　　　　
考虑到um 是标量，则有







记






(8.3.2)

S?=[b          Ab           …A”?1b]
　　由于各αm(z) 之间线性无关，利用式(8.3.2)得到的um 是无约束的阶梯序列。根据解的存 在定理，其状态能控的充分必要条件为
rank       S=n
例8.3. 1 判断图8.3.2所示桥路系统的能控性。
解  选取状态变量x?=i,x?=uc,          可以得到系统的状态方程为




计算系统的能控性矩阵
　　　　　　　　　　　　　
当 R?R?≠R?R?      时 ，rank         S=2=n,由秩判据可得系统能控；




当 R?R?=R?R?,      即电桥处于平衡状态时，有

故系统不能控。显然，系统中状态x?  不能控。
　　例 8 .3.2   证明采用非奇异线性变换后系统的能控性 不变。
　　　证明 设线性变换为x=Px,    则变换后系统的能控性阵 的秩为



图8.3.2 电桥电路系统


rank	S=rank[P-1B(P?1AP)P-1B(P?1AP)2P-1B
　rank[P?1B      P?1AB      P?1A2B       …    P- 1A”?1B]= rankP-1[B        AB        A2B        …A”?1B]=	…(P?1AP)”1P1B]=


rank[B         AB         A2B         …A”?1B]=rankS
表明变换前后的能控性矩阵的秩相同，故采用非奇异线性变换，系统的能控性不变。
　　定理8.3.2(对角规范型判据)若系统状态方程的A 矩阵有n 个相异特征值λ1,λ2,…, λn, 且系统的对角规范型动态方程为

(8.3.3)


则系统完全能控的充分必要条件为：输入矩阵中不存在全零行。
　　　若系统状态方程的A 矩阵含有相同特征值，假定λ1为系统的二重特征值，且系统的约旦规 范型动态方程为


(8.3.4)


　式中，λ3,λ4,…, λn为系统的相异特征值，则系统完全能控的充分必要条件为：输入矩阵中与约当 块最后一行所对应的行不是全零行(与约当块其它行所对应的行允许是全零行);输入矩阵中与 相异特征值所对应的行不是全零行。
　　　展开式(8.3.3)后可以看到每个方程只含有一个状态变量，即互相解耦，因此只要每个方程 中含有一个控制分量，对应的状态变量便是能控的，这就意味着输入矩阵的每一行都必须是非零 行。同理，展开式(8.3.4)可见，x?,z?,…,xn      各方程的状态变量也是解耦的，输入矩阵中与相异 特征值所对应的行都必须是非零行，而x?  方程中既含x?  又含x?,  在 x?   受控条件下，即使x?  方 程中不存在任何控制分量，也能通过x?  间接控制x?。
8.3.2   输 出 能 控 性
若在有限时间间隔[to,t?]内，存在无约束分段连续控制函数u(t),t∈[to,t?],能使任意输出



y(t?)   转移到任意最终输出y(t?),    则称此系统是输出完全可控，简称输出能控。
考虑下列状态空间表达式所描述的线性定常系统
x=Ax+Bu
y=Cx+Du
式中：x∈R”,u∈R,y∈R“,A∈R”×n,B∈R”×r,C∈Rm×”,D∈Rm×。
可以证明，系统输出能控的充要条件为：当且仅当m×(n+1)r       维输出能控性矩阵 Q′=[CB:CAB:CA2B:…:CA”?1B:D]
的秩为m。
8.3.3   线 性 连 续 系 统 的 能 观 性
1. 能观性定义
　　对于系统式(8.3.1),若已知输入u(t)  及有限时间间隔t ∈[to,tf]      内测量到的输出y(t),    能 唯一确定初始状态x(t?),    则称系统是完全能观测的，简称系统能观测。
2. 常用能观性判据
定理8.3.3(秩判据) 对于多输入多输出连续定常系统
x(t)=A(t)x(t)+B(t)u(t)
y(t)=C(t)x(t)
其状态完全能观测的充分必要条件是能观性矩阵Q。的秩为n, 即
　　　　　　　　　　　　　　　
或
rankQT=rank[CT         ATCT    (AT)2C …        (AT)”1CT]=n
　　证明(1)先证必要性。采用反证法，不妨设u(t)=0,t∈[0,t?],            若 rank(Q?<n),         必 有 3x?≠0,      使 Qox?=0,      即
CA’x 。=0,i=0,1,2,…,n―1
则
y(t)=Cx(t)=Cex?
若取
　　　　　　　　　　
同样，在u(t)=0,t∈[0,t?] 与 y(t)=0 下，有不同x?, 故矛盾。
再证充分性。设Q。列满秩，可证对t?>0,    有
　　　　　　　　　　　　　　　　
进一步，有
　　　　　　　　　　　　
故



　　　　　　　　　　　　　　　　
综上所述，可得系统是完全能观的。
例8.3.3  判断系统
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　
的能观测性。

解  系统的观测矩阵 ,系统矩阵







,可得

　　　　　　　

　　　　　　　

从而系统的能观性矩阵为
　　　　　　　　　　　　　　
由于
　　　　　　　　　　　　　　　
满足能观性的充要条件，所以该系统是能观测的。
例8.3.4 证明采用非奇异线性变换后系统的能观测性不变。
证明 设线性变换为x=Px,   则变换后系统的能观性阵的秩为
rankQ=rank((CP)           (P-1AP)T(CP)T …            ((P-1AP)”-1)TCP)]= rank[PTCT  PTATCT     …     PT(A”1)TCT]=
rankPT[CT  ATCT    …(A”1)TCT]=
rank[CT     ATC    …    (A”?1)TCT]=rankQ



表明变换前后的能观性矩阵的秩相同，故采用非奇异线性变换，系统的能观测性不变。
　　　定理8.3.4(对角规范型判据)若系统状态方程的A 矩阵有n 个互不相同的特征值λ1,λ2,…, λn, 令u=0,    则系统的对角规范型动态方程为

(8.3.5)


则系统完全能观的充分必要条件为：输出矩阵不存在全零列。
　　　若系统状态方程的A 矩阵含有相同特征值，设λ1为系统的二重特征值，λ3,λ4,…, λn 为系统 的相异特征值，令u=0,   且系统的约旦规范型动态方程为


(8.3.6)


　则系统完全能观的充分必要条件为：输出矩阵中与约当块最前一列对应的列不是全零列(与约当 块其他列所对应的列允许是全零列);输出矩阵中与相异特征值所对应的列不是全零列。
　　　由式(8.3.5)可见，若C 矩阵第一列全零时，在y?,y?,…,y 。  诸分量中均不含x?(0),     则 x1  (0)不能观测，故若系统可观，输出矩阵中一定不存在全零列。同理，在式(8.3.6)中，当C 矩 阵 第一列不全为零时，则必有输出分量既含x?(0),    又 含 x?(0),    于 是C 矩阵第二列允许全零，不影 响系统的能观性。
8.3.4   状 态 空 间 表 达 式 的 能 控 和 能 观 标 准 型 转 化
1. 化为能控标准型
设单输入单输出系统状态方程为
x=Ax+bu
在8.2节已经学过系统状态方程的能控标准型，即
　　　　　　　　　
与该状态方程对应的能控性矩阵S 是一个右下三角阵，且其副对角线元素均为1,即
　　　　　　　



　　对于一个能控的系统，若系统的动态方程不是能控标准型时，可选择适当的线性变换P-1 将 原系统化为能控标准型。
令
x=P?1z
状态方程可化为
之 = PAP-1z+Pbu
要求


(8.3.7)


设变换矩阵为
P=[pT      p2       …     pT]T
根 据A 矩阵变换要求，变换矩阵P 矩阵应满足式(8.3.7),即
　　　　　　　　　　
展开上式可得
P?A=P?
P?A=P?
..
Pn-2A=Pn-1
Pn-1A=pn
PnA=―a?P?-a?P2―…-an2Pn-1-an-1Pn
整理得到变换矩阵
　　　　　　　　　　　　　　　　　　
另一方面，根据 b 矩阵变换要求，P 应满足式(8.3.7),即
　　　　　　　　　　　　　　　



P?[b     Ab    …    A”?1b]=[00             …     1]
故
P?=[00            …1][b            Ab            …A”1b]- 1
即表明p? 是能控性矩阵逆阵的最后一行。
总结：化系统为能控标准型方程的变换矩阵P 的求法：
(1)计算能控性矩阵
S=[b         Ab         …A”?1b]
(2)计算能控性矩阵的逆阵
　　　　　　　　　　　　　　　　　
(3)取出S- 1 的最后一行(即第n 行)构成p? 行矢量  P?=[sn?         …     sm]
(4)按下列方式构造P 矩阵
　　　　　　　　　　　　　　　　　　
　(5)P- 1    便是将一般能控状态方程可化为能控标准型状态方程的变换矩阵。 例8.3.5 将状态方程
　　　　　　　　　　　　　　　　
化为能控标准形。
解  该状态方程的能控性矩阵为
　　　　　　　　　　　　　　　　
求逆得
　　　　　　　　　　　　　　　　　
取出S- 1  的最后一行构成P? 行矢量
　　　　　　　　　　　　　　　　　　
因此得
　　　　　　　　　　　　　　　　　
从而得到P 为



　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　
因此，有
　　　　　　　
　　　　　　　　　　　　　
可得该状态方程的能控标准形为
　　　　　　　　　　　　　　　　
2. 对偶原理
　　　在动态方程建模、系统能控性和能观测性的判别、系统线性变换等问题上，应用对偶原理，往 往可以使问题得到简化。
设原系统为S?(A,B,C),      其动态方程分别为
x=Ax+Bu,y=Cx
则称系统S?(AT,C,BT)      为系统S?  的对偶系统，且满足
z=ATz+Cv,w=BTz
式中：x、z 均 为n 维状态矢量，u、w均 为p  维状态矢量，y、v均 为q 维状态矢量。
　　注意：原系统与对偶系统之间，输入和输出矢量的维数是互相交换的。当S?  为 S?  的对偶系 统时，S? 也 是S?  的对偶系统。不难验证：系统S?  的能控性矩阵与对偶系统S?  的能观测性矩阵 完全相同；系统S?  的能观测性矩阵与对偶系统S?  的能控性矩阵完全相同。
　　　对偶原理：如果系统S?  能控，则S?  必然能观测；如果系统S?  能观测，则S?  必然能控；反之 亦然。
3. 化为能观标准型
设单输入单输出系统动态方程为
x=Ax+bu,y=cx
若系统能观测，但系统不是能观标准型。
　　应用对偶原理，把能观测系统化为能观测标准型的问题，可以转化为将其对偶系统化为能控 标准型的问题。考虑其对偶系统的动态方程
之 =ATz+cTv,w=bTz



该系统一定能控，因此，可以利用化为能控标准型变换的方法，先将对偶系统化为能控标准型，然 后再利用对偶原理，便可得到原系统的能观测标准型。此外，也可直接按照如下步骤将系统化为 能观标准型：
(1)计算系统的能观测性矩阵SQ, 即
　　　　　　　　　　　　　　　　　　
(2)求SQ 的逆阵SQ1,且记为列矢量组
SQ1=[v1        V?     …    vn]
(3)取SQ1 的最后一列(第n 列),并按下列规则构造变换矩阵 P=[vn     Avn      …    A”?1vn]
(4)则能观标准型系统的各矩阵为
A 。=P-1AP,b 。=P-1b,c 。=cP
例8.3.6 将系统
　　　　　　　　　　　　　　　　
y=[-1           1]x
化为能观标准形。
解  给定系统的能观性矩阵为
　　　　　　　　　　　　　　　　
求逆
　　　　　　　　　　　　　　　　　
取SQ1 的最后一列，构造变换矩阵
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
可得
　　　　　　　　




　　　　　　　　　　　　　
　　　　　　　　　　　　
所以该状态方程的能观标准型为
　　　　　　　　　　　　　　　　
y=[0          1]x
8.3.5    线 性 定 常 系 统 的 规 范 分 解
　　从对系统的能控性和能观测性的分析研究中可以看出，系统不能控或不能观测时，并不意味 着系统的所有状态全部不能控或不能观测。在这种情况下可通过坐标变换的方法对状态空间进 行分解，将系统状态变量划分成能控能观测x 、 能控不能观测x 、 不能控能观测 xo、不能控不 能观测xc  四类，这个分解过程称为系统的规范分解。通过规范分解能明晰系统的结构特性和 传递特性，简化系统的分析与设计。这里仅介绍能控性和能观测性分解的方法，有关证明从略。
1. 能控性分解
给定如下系统，即
x=Ax+Bu
y=Cx                                                                        (8.3.8)
假定系统的能控性矩阵的秩为r(r<n), 从能控性矩阵中可以选出r 个线性无关列矢量，再
附加上任意n-r    个列矢量，构成非奇异阵的T1   变换矩阵，令
　　　　　　　　　　　　　　　　　　　
可将原系统变换成如下的形式，即
　　　　　　　　　　　　　　　　
(8.3.9)
式中：xe 为 r 维能控状态子矢量；x:为 n-r 维不能控状态子矢量，且
　　　　　　　　　　　　　　　　　　　
r 列  (n-r)       列              p 列
CT-1=[C?C?]q                 行
r 列  (n-r)       列
展开式(8.3.9)可得
x 。=A??x 。+A??x 。+B?u
x:=A?2x。



y=C?x 。+C?x.
将输出矢量进行分解，可得子系统状态方程。能控子系统状态方程为
x 。=A?x 。+A?2x 。+B?u
y?=C?xe
不能控子系统状态方程为
x:=A?2x。
y=C?x
　　　由 于u 仅通过能控子系统传递到输出，故u 至 y 之间的传递函数矩阵描述不能反映不能控 部分的特性。但是能控子系统的状态响应x。(t)及系统输出响应 y(t)均 与x。有关，不能控子系 统对整个系统的影响依然存在，如要求整个系统稳定，A?2应仅含稳定特征值。
例8.3.7  已知系统
　　　　　　　　　　　　　
y(t)=[0            1-2]x(t)
试对系统按能控性进行分解。
解  计算能控性矩阵的秩
　　　　　　　　　　　　
故系统不能控。从中选出前两个线性无关列，附加任意列矢量[00 1],构成非奇异变换矩 阵 T?1, 并计算变换后的各矩阵
　　　　　　　　　　
　　　　　　　
故系统的能控性结构分解为
　　　　　　　　　　　　
　　　　　　　　　　　　　　　
2. 能观性分解
　　　设系统式(8.3.8)能观测矩阵的秩为1,l<n,    从能观测性矩阵中选出l 个线性无关行矢量， 再附加上任意的n―l 个行矢量，构成非奇异的T 变换矩阵，令
　　　　　　　　　　　　　　　　　　　



可将系统变换成如下结构
　　　　　　　　　　　　　　　　
(8.3.10)
式中：x。为 l 维能观测状态子矢量；x。为(n―L)维不能观测状态子矢量，且
　　　　　　　　
L列  (n―l)    列              p 列
CT?1=[C?           0]q      行
l 列  (n―l)    列
展开式(8.3.10)可得
x 。=A?x 。+B?u
x 。=A21x 。+A22x 。+B?u
y=C?x。
能观测子系统动态方程为
x 。=A??x 。+B?u,y=C?x 。=y
不能观测子系统动态方程为
x 。=A?1x 。+A?2x 。+B?u,y?=0
例8.3.8 试将例8.3.7所示系统按能观测性进行分解。 解  计算能观测性矩阵的秩
　　　　　　　　
故不能观测，从中选择前两行线性无关行，再附加一行[001],构成非奇异变换矩阵
　　　　　　　　　　　　　　　　　
求逆可得
　　　　　　　　　　　　　　　　　　
从而系统按能观结构分解的表达式为

　　　　　　　　　　　



　　　　　　　　　　　　　　　

8.3.6   离 散 系 统 的 能 控 性 和 能 观 性
1. 离散系统的能控性及判据
对 n 阶单输入线性定常离散系统
x(k+1)=Φx(k)+gu(k)
y(k)=cx(k)+du(k)                                                               (8.3.11)
　　若在有限时间间隔内t∈[0,nT], 存在无约束的阶梯控制序列u(0),…,u(n―1), 能使系统 从任意初态x(O) 转移至终态x(n)=0,     则称该系统状态完全能控，简称能控。
对于系统式(8.3.11),其解表示为
　　　　　　　　　　　　　　
若取△x=x(n)    一Φ'x(0),    可 得
△x=①”?1gu(0)+①”2gu(1)+…+Φgu(n―1)=







称 n×n 阶方阵







(8.3.12)

S?=[g       Φg        …     ①”?1g]
为单输入离散系统的能控性矩阵。
　　　由线性方程组解的存在定理可知，对于非齐次线性方程式(8.3.12),当矩阵S?  的秩与增广 矩阵[S?:x(O)]       的秩相等时，方程组有唯一解。因此，在△x 为任意的情况下，要使方程组有解 的充分必要条件是：矩阵S?  满秩，即
rank          S?=n
上式称为离散系统的能控性判据。
　　　以上分析表明，状态能控性取决于Φ和g,  当 u(k)  不受约束时，能控系统的状态转移过程至  多 以n 个采样周期便可以完成，有时状态转移过程还可能少于n 个采样周期。当rankS?<n     时 ， 系统不能控，表示不存在能使任意x(O) 转移至任意x(n)  的控制。
例8 . 3 .9    设单输入线性定常散离系统状态方程为
　　　　　　　　　　　　
　试判断能控性；若初始状态x(0)=[2          1・0]T,    确定使x(3)=0      的控制序列 u(O),u(1),u(2); 研究使x(2)=0     的可能性。
解  由题意可知




　　　　　　　　　　　　　　
　　　　　　　　
故该系统能控。
先求出u(O),u(1),u(2),       再用递推法来求控制。令k=0,1,2,      可得状态序列
　　　　　　　　　　　　
　　　　　　　　　
　　　　　　
令 x(3)=0,     即解下列方程组
　　　　　　　　　　　　　　
其系数矩阵即能控性矩阵S?,  它的非奇异性可给出如下的解，即
　　　　　
若令x(2)=0,     即解下列方程组
　　　　　　　　　　　　　　　　
容易看出其系数矩阵的秩为2,但增广矩阵
　　　　　　　　　　　　　　　　　　
的秩为3,两个秩不等，方程组无解，表明不能在第二个采样周期内使系统从给定初始状态转移 至原点。若这两个秩相等时，则可用两步完成状态转移。
2. 离散系统的能观性
对于多输入多输出离散系统



x(k+1)=Φx(k)+Gu(k)
y(k)=Cx(k)+Du(k)                                                          (8.3.13)
若已知输入矢量序列u(0),…,u(n-1)        及有限采样周期内测量到的输出向量序列y(0),…,y
(n-1),     且能唯一确定任意初始状态矢量x(0),   则称系统是完全能观测的，简称系统能观测。
假定系统输入为0,则系统式(8.3.13)的解为
x(k)=Φx(0)
y(k)=CΦ*x(O)
将 y(k)展开为
y(0)=Cx(O)
y(1)=CΦx(O)
　　　　　　　　　　　　　　　　　　　　　
y(n―1)=CΦ”1x(0)
其矩阵―矢量形式为


(8.3.14)


称 nq×n 阶矩阵
　　　　　　　　　　　　　　　　　　
为线性定常离散系统的能观测性矩阵。
式(8.3.14)含有nq 个方程，若其中有n 个独立方程，便可唯一确定一组的x?(0),…,xn(O)。
　当独立方程个数多于n 时，解会出现矛盾；当独立方程个数少于n 时，便有无穷解。故能观测的 充分必要条件为
rank      QF=n
由 于rankQT=rankQ?,    故离散系统能观测性判据又可以表示为
rank      V=rank[CT      ΦCT    …(Φ)”-1CT]=n
例8.3.10  已知如下两个线性定常离散系统
x(k+1)=Φx(k)+gu(k)
y(k)=Cx(k)            i=1,2
其中

,C?=[0

试判断系统的能观测性，并给出能观测性的物理解释。



解  当 i=1   时，有
　　　　　
故系统能观测。由输出方程y(k)=x?(k)        可见，在第k 步便可由输出量确定状态变量x?(k)。 由于
y(k+1)=x?(k+1)=-2x?(k)                        十x?(k)
故在第(k+1)   步便可确定x?(k) 。 由 于
　　　　　　y(k+2)=x?(k+2)=―2x?(k+1)+x?(k+1)=4x?(k)+3x?(k) 故在第(k+2) 步便可确定x? (k)。
　　该系统为三阶系统，能观测意味着至多观测三步便能由y(k),y(k+1),y(k+2)            的输出测量 值来确定三个状态变量。
当 i=2   时，有
　　　　　　　　　
　　　　　　　　　　　
故系统不能观测。 由输出方程
　　　　　　　　　　　　　　　　　　

　　　　　　　　　　　

　　　　
　可看出三步的输出测量值中始终不含x?(k),   故 x?(k)  是不能观测的状态变量。只要有一个状态 变量不能观测，系统就不能观测。
8.4    李雅普诺夫稳定性分析

　　　一个自动控制系统要能正常工作，必须首先是一个稳定的系统，即当系统受到外界干扰时它 的平衡被破坏，但在外界干扰去掉以后，它仍有能力自动地恢复在平衡态下继续工作。系统的这 种性能，叫做稳定性。例如，电压自动调解系统中保持电机电压为恒定的能力、电机自动调速系 统中保持电机转速为一定的能力以及火箭飞行中保持航向为一定的能力等。具有稳定性的系统



称为稳定系统，不具有稳定性的系统称为不稳定系统。在经典控制理论中，我们学习过用代数判 据、奈奎斯特判据、对数频率判据、特征根判据来判断线性定常系统的稳定性，用相平面法来判断 二阶非线性系统的稳定性，但是这些稳定判据无法满足以多变量、非线性、时变为特征的现代控 制系统对稳定性分析的要求。
　　　1892年，俄国学者李雅普诺夫建立了基于状态空间描述的稳定性概念。他把分析系统稳定 性的方法归纳为两类，分别称为李雅普诺夫第一法和李雅普诺夫第二法。其中李雅普诺夫第一 法(亦称间接法)是解描述系统动力学的微分方程式，然后根据解的性质来判断系统的稳定性的 方法；李雅普诺夫第二法(亦称直接法)的特点是不必求系统的微分方程式或系统特征值，而是通 过定义一个叫做李雅普诺夫函数的标量函数，直接分析、判断系统的稳定性，而且给出的稳定信 息是非近似的。由于李雅普诺夫稳定性理论不仅可用来分析线性定常系统，还可用来研究时变 系统、非线性系统，甚至离散时间系统、离散事件动态系统、逻辑动力学系统等复杂动力学系统的 稳定性，因此在现代控制系统的分析与设计中，得到了广泛的应用与发展。
8.4.1   李 雅 普 诺 夫 意 义 下 的 稳 定 性
考虑零输入的非线性时变系统
x         =f(x,t)
式中：x 为 n 维状态矢量；t 为时间变量；f(x,t)      为线性或者非线性的n 维矢量函数，其展开式为 x;=f;(x?,x?,…,xn,t);i=1,2,…,n
假定方程的解为 x(t;xo,to),     其 中x。和 to分别为初始状态矢量和初始时刻，则系统的初始条件 为 x(to;xo,to)=xo。
定义8.4.1(平衡状态) 对于所有t,称满足
x 。=f(x?,t)=0
　的状态x。为系统的平衡状态或平衡点。平衡状态的各分量相对于时间不再发生变化，因此，若 已知状态方程，令x=0   所求得的解x,  便是系统的一种平衡状态。控制系统李雅普诺夫意义下 的稳定性是关于平衡状态的稳定性。
　　对于线性定常系统x=Ax,  其平衡状态满足Ax。=0。 当 A 为非奇异矩阵时，系统只有唯一 的零解，即存在一个位于状态空间原点的平衡状态。线性系统只有一个平衡状态，平衡状态的稳 定性能够表征整个系统的稳定性；当A 为奇异矩阵时，则系统存在无穷多个解，即无穷多个平衡 状态。非线性系统可能有一个或多个平衡状态。
　　　定义8.4.2(李雅普诺夫意义下的稳定性)  设系统初始状态x。位于平衡状态x。为球心、 半径为δ的闭球域S(δ)   内，即初始状态满足
|xo―x.l≤δ
　　　如果系统稳定，则状态方程的解x(t;xo,to)     在 t→∞  的过程中，都位于以x。为球心，任意小 的ε>0为半径的闭球域S(e)  内，即系统运动轨迹满足
　　　　　　　　　　　　　　　
则称该平衡状态x, 是李雅普诺夫意义下稳定的。它的平面几何表示如图8.4. 1(a)  所示，由于 |xo 一x。 表示状态空间中x。点 至x。点之间的距离，其数学表达式为
|x? ―x.l= √ (x10   一 x1e)2+…+(xn   一 xn)2



　　定义8.4.3(一致稳定性) 在系统满足李雅普诺夫意义下的稳定性的条件下，实数δ通常 与e、to都有关。若δ与to无关，则称系统的平衡状态是一致稳定的。应该注意到，定常系统的δ 与 t?无关，因此定常系统如果稳定，则一定是一致稳定的。
定义8.4.4(渐近稳定性) 若系统的平衡状态不仅具有李雅普诺夫意义下的稳定性，且有
　　　　　　　　　　　　　　　
　称此平衡状态是渐近稳定的。这时，从S(8) 出发的轨迹不仅不会超出S(e),且 当t→ ∞ 时收敛 于x。或其附近，其平面几何表示如8.4.1(b)  所示。经典控制理论中的稳定性定义与渐近稳定 性是对应的。
　　　定义8.4.5(大范围稳定性) 当初始条件扩展至整个状态空间，且平衡状态均具有渐近稳 定性时，称此平衡状态是大范围稳定的，或称为全局稳定的。此时，δ→ ∞,S(8)→∞。
　　　对于严格的线性系统，因为线性系统稳定性与初始条件无关，因此，如果它是渐近稳定的，则 必定是大范围稳定的。而非线性系统的稳定性一般与初始条件的大小密切相关，通常只能在小 范围内渐进稳定。
　　　定义8.4.6(不稳定性) 对于任意实数e>0   和δ>0,不论它们取得多么小，在S(8) 内总有 一 条从x。出发的轨迹超出S(e),   则称此平衡状态是不稳定的。其平面几何表示如图8.4.1(c) 所 示 。









(a)                                                    (b)                                                    (c)
图8.4.1 稳定性的平面几何表示
(a) 李雅普诺夫意义下的稳定性；(b) 渐近稳定性；(c) 不稳定性。

8.4.2   李 雅 普 诺 夫 第 一 法 ( 间 接 法 )
　　李雅普诺夫第一法(间接法)是利用状态方程的解的特性来判断系统稳定性的方法，它适用 于线性定常、线性时变及可线性化的非线性系统。这里仅研究线性定常系统的特征值判据。
定理8.4. 1 对于线性定常系统
x=Ax
系统渐近稳定的充分必要条件是：矩阵A 的全部特征值位于复平面左半部(特征值均为负实 部),即
Re(λ;)<0;i=1,2,…,n
　　证 明 假 定A 有相异特征值λ1,λ2,…, λn, 根据线性代数理论，存在非奇异线性变换x=Px (P 由特征值λ;对应的特征矢量构成，为一常数矩阵),可使A对角化，有



A=P1AP=diag(a?,λ2,…λn)
变换后状态方程的解为
x(t)=ex(0)=diag(ei…e,)x(0)
由 于
x=P-1x,x(O)=P?1x(O)
故原状态方程的解为
x(t)=PeP-1x(0)=ex(O)
有
e=PeP-1=Pdiag(e3i…en2)P-1
将上式展开，e 的每一元素都是e2,…,e   的线性组合，因而可写成矩阵多项式
　　　　　　　　　　　　　
故 x(t)  可以显式表出与λ;的关系，即
x(t)=ex(0)=[R?e?11+…+Rnen2]x(O)
　　　当上式成立时，对于任意x(0),   均有x(t)|∞→0,         系统渐近稳定。只要有一个特征值的实 部大于0,对于x(O)≠0,x(t)       便无限增长，系统不稳定。如果只有一个(或一对，且均不能是重 根)特征值的实部等于0,其余特征值实部均小于0,x(t)便含有常数项或三角函数项，则系统是 李雅普诺夫意义下稳定的。
例8.4. 1 用李雅普诺夫第一方法判定系统
　　　　　　　　　　　　　　　　　
在平衡状态的稳定性。
解  系统只有一个平衡点(0,0),计算矩阵的特征根，可得
s=―2±√3
　　　由于原系统为线性定常系统，且系统矩阵A 的全部特征值均为负实数，由定理8.4. 1可知， 系统在原点(0,0)附近大范围渐近稳定。
8.4.3   李 雅 普 诺 夫 第 二 法 ( 直 接 法 )
　　　根据物理学原理，若系统储存的能量(含动能与位能)随时间推移而衰减，系统迟早会到达平 衡状态。李亚普诺夫第二方法的基本思想就是用能量变化的观点分析系统的稳定性。若系统储 存的能量在运动过程中随时间的推移逐渐减少，则系统就能稳定；反之，若系统在运动过程中，不 断地从外界吸收能量，使其储能越来越大，系统就不能稳定。例如，日常生活中的单摆，当考虑空 气的阻尼，系统就是稳定的；如果在理想真空中，或者给它不断补充能量，系统就不稳定。可以用 一个标量函数表示系统的能量。根据能量的物理意义，能量函数应该总是一个正值函数，计以V  (x,t), 若不显含t, 则记以V(x)。 考虑到能量总大于0,故为V(x,t) 正定函数，而能量衰减特性 用 (x,t)      表示。李亚普诺夫第二方法就是根据(x,t)       的正负来判断系统的稳定性的。遗憾的 是至今仍未形成构造李雅普诺夫函数的通用方法，需要凭经验与技巧。实践表明，对于大多数系




统，可先尝试用二次型函数xTPx 作为李雅普诺夫函数。因为李雅普诺夫第二法是直接利用能 量函数而不是通过求解系统的微分方程确定系统的稳定与否，所以又称李雅普诺夫直接法，对各 种控制系统均适用。
1. 标量函数的定号性
　　(1)正定性。标量函数V(x)  对所有在域S 中非零状态(x≠0)    有 V(x)>0      且 V(0)=0,     称 V(x) 在域 S 内正定，如V(x)=x2+x2。
对于时变系统，标量函数V(x,t)    在 域S  中，对于所有非零状态，当t>to,V(x,t)>0,            且
V(0,t)=0,     则称V(x,t)   在域S 内正定。V(x,t)    的其他定号性提法类同。
　　　(2)正半定性。V(x)  在域S  内除了在原点及某些状态处有V(x)=0,     在其他状态处均有 V(x)>0,    则称V(x)  在域S  内正半定，如V(x)=(x?+2x?)2。
　　　(3)负定性。标量函数V(x) 对所有在域S 中非零x 有 V(x)<0    且 V(O)=0,   称 V(x)   在域 S 内负定，如V(x)=―(x2+x2)。
　　　(4)负半定性。V(x)  在域S  内除了在原点及某些状态处有V(x)=0,      在其他状态处均有 V(x)<0,     则 称V(x)  在域S  内负半定，如V(x)=-(x?+2x?)2             为负半定。
　(5)不定性。 V(x)  在域S内可正可负，则称V(x)  不定。如V(x)=x?x2     是不定的。 若采用二次型函数作为系统判稳的能量函数，可得
　　　　　　　　　　
其中，P 为对称矩阵，有 p;=pji 。 显然，满足V(x)=0,    其定号性可由赛尔维斯特准则判定。 当P 的各顺序主子行列式均大于零时，即
　　　　　　　　　　
P 为正定矩阵，则V(x) 正定。
当P 的各顺序主子行列式负、正相间时，即
　　　　　　　　　
P 为负定矩阵，则V(x)  负定。
若主子行列式含有等于0的情况，则V(x)  为正半定或负半定。
2. 李雅普诺夫第二法稳定性判据
设系统状态方程为
x=f(x,t)                                                                    (8.4.1)
满足 f(0,t)=0,       即把状态空间原点作为平衡状态，若系统在原点邻域存在一个对 x 具有连续一 阶偏导数的标量函数V(x,t),    则可以得到如下定理：
定理8.4.2 若系统式(8.4.1)的标量函数V(x,t) 正定，并且
(1)V(x,t)     负定，则原点是渐近稳定的；



(2)V(x,t) 负半定，且在非零状态不恒为0,则原点是渐近稳定的；
(3)V(x,t) 恒为零；则原点是李雅普诺夫意义下稳定的；
(4)V(x,t) 正定，则原点是不稳定的。
　　　必须注意：李雅普诺夫第二法稳定性判据定理所述条件都是充分条件，只要找到一个 V(x,t)   满足定理所述条件，便能很容易应用以上定理对原点的稳定性做出判断，同时，正定函数 V(x,t)   的选取也不是唯一的，如果V(x,t)   选取不当，导致V(x,t)    不定的结果，便无法判定系统 的稳定性，这就需要重新选取V(x,t),    这是应用李雅普诺夫稳定性理论的主要障碍。
例8.4.2 试用李雅普诺夫第二法判断非线性系统
x?=x?―x?(x2+x2),x?=―x?―x?(x2+x2)
的稳定性。
解  令x?=0    及 x?=0,    可以解得原点(x?=0,x?=0)        是系统的唯一平衡状态。
取李雅普诺夫函数为V(x)=(x2+x2),         则
V(x)=2x?x1+2x?x?
将状态方程代入有
V(x)=-2(x2+x2)2
显然，V(x,t)  负定，根据定理8.4.2,原点是渐近稳定的。又因为只有一个平衡状态，且V(x,t) 与t 无关，故系统是大范围一致渐近稳定。
例8.4.3 已知连续定常系统
x?=x?
x2=―x?―(1+x?)2x?
试用李雅普诺夫第二方法判断其在平衡点的稳定性。
解  易知(0,0)为其唯一的点。取V(x)=x2+x2>0,          可得
　　　　　　　　　　　　
　　　　　　　　　　　　　　　
―2x2(1+x?)2
　由上式可以看出，当x?  为任意值时，除了x?=0    或 x? 三 - 1 时(x)=0        以外，有V(x)=0 。  其余 情况下，(x)<0,       所以，V(x)  为负半定。
下面考察V(φ(t;xo,0))     是否恒等于0。
情况1 状态轨线φ(t;xo,0)=[x?(t),0]T,          则由于x?(t)=0,      可导出x2(t)=0     将其代入系
统的方程得
x?(t)=x?(t)=0
0=x?(t)=―(1+x?(t))2x?(t)―x?(t)=―x?(t)
这表明，除了点(x?=0,x?=0)            外，φ(t;xo,0)=[x?(t),0]              不是系统的受扰运动解。
　　情况2  φ(t;x,0)=[x? (t),―1],    则由x? (t)=-1   可导出i? (t)=0,  将其代入系统的方 程得
x?(t)=x?(t)                          三 - 1



0=x?(t)=-(1+x?(t))2x?(t)                      一 x?(t)=―x?(t)
　　　显然，这是一个矛盾的结果，表明φ(t;xo,0)=[x?(t),―1]T           也不是系统的受扰运动解。综 上分析可知
V(φ(t;xo,0))≠0
当 |x||=√x2+x2→∞            时，有V(x)=|x||2→∞ 。     因此，系统在原点是大范围渐近稳定的。
8.4.4   李雅普诺夫第二法在线性定常系统中的应用
1. 线性定常连续系统的渐进稳定性判据
对于线性定常系统
x=Ax
可取正定二次型函数V(x)  作为李雅普诺夫函数，即
V(x)=xTPx
考虑状态方程，可得
V(x)=xTPx+xTPx=xT(ATP+PA)x
令
ATP+PA=-Q
可得
V(x)=―xTQx
　　　根据李雅普诺夫第二法稳定性判定定理，只要Q 正定(即 (x)  负定),系统便是大范围一致 渐近稳定的。于是，线性定常连续系统渐近稳定的充分必要条件可表示为：
　　　给定一正定矩阵P, 存在满足式(8.4.1)的正定矩阵Q, 同 时xTPx 是该系统的一个李雅普诺 夫函数。
　　　实际应用中，先给定一个正定的P 矩阵，然后再去验证Q 矩阵是否正定来分析系统的稳定 性。但若P 选取不当，往往会导致Q 矩阵不定，造成判别过程多次重复进行。因此，往往采用先 指定正定的Q 矩阵(通常取单位阵或者对角阵),然后验证P 矩阵是否正定的方法，并得到如下 判定定理：
定理8.4.3  线性定常系统x=Ax  的原点平衡状态为渐近稳定的充要条件是：对于任意给
定的一个正定对称矩阵Q, 存在唯一的正定对称矩阵P 使式(8.4.2)成立。
　　　该定理为系统的渐近稳定性判断带来实用上的极大方便，对于系统是否为渐近稳定，只需进  行一次计算。只需取Q 矩阵为单位矩阵，由式(8.4.2)计算P 并校验其定号性，当P 矩阵正定  时，则系统渐近稳定；当P 矩阵负定时，则系统不稳定；当P 矩阵不定时，可断定为非渐近稳定， 再结合其他方法进一步去判断系统是李雅普诺夫意义下的稳定，还是不稳定。同时还可以得到  如下结论：
　　推论：若系统的任意状态轨迹在非零状态不存在(x)     恒为零时，Q 矩阵可选取为正半定的， 即允许单位矩阵中主对角线上部分元素为零(取法不是唯一的，只要既简单又能导出确定的平衡 状态的解即可),而解得的P 矩阵仍是正定的。
例8.4.4  判断系统




　　　　　　　　　　　　　　　　　
的稳定性。
解  令对称矩阵为
取正定实对称矩阵Q 为单位阵，则由ATP+PA=―I      得


解方程组

　　　　　　　　　　　　　

得
　　　　　　　　　　　　　　　
因为
　　　　　　　　　
所以P 是正定的，故系统在原点处是渐近稳定的。又因为              ,所以系统在原点处是
大范围渐近稳定的。
2. 线性定常离散系统的渐进稳定性判别
设线性定常离散系统状态方程为
x(k+1)=Φx(k)                                                                    (8.4.3)
式中：Φ为非奇异矩阵，原点是平衡状态。
取正定二次型函数
V[x(k)]=xT(k)Px(k)
以△V[x(k)] 代替V(x) 可得
　　　　　　　　　　　　　△V[x(k)]=V[x(k+1)]-V[x(k)] 结合状态方程式(8.4.3),有
△V[x(k)]=xT(k+1)Px(k+1)―xT(k)Px(k)=
　[Dx(k)]TPDx(k)      一xT(k)Px(k)= xT(k)[ΦTPφ-P]x(k)
令
ΦTP-P=-Q                                                                        (8.4.4)



于是有
△V[x(k)]=-xT(k)Qx(k)
式中：xT(k)Px(k)   即为系统的一个李雅普诺夫函数。
定理8.4.4  系统式(8.4.3)渐近稳定的充分必要条件是：给定任一正定对称矩阵Q      Q
=I),   存在正定对称矩阵P,  使式(8.4.4)成立。
式(8.4.4)称为离散系统的李雅普诺夫代数方程，通常取Q 为单位阵。
例8.4.5 设线性离散时间系统为
　　　　　　　　　　　　　
若系统在平衡点处是渐近稳定的，试确定m 值范围。
解  取Q=I,   由离散系统李雅普诺夫方程ΦPφ-P=-Q          可得
　　　　　

　　　
比较系数，解此矩阵方程得
　　　　　　　　　　　　　　　
原系统在原点是大范围渐近稳定，因此要求P>0,   得到
　　　　　　　　　　　　　　　　　　
解此不等式组，得到0<m<2。

8.5   线性定常系统的状态综合

　　　无论是在经典控制理论中，还是在现代控制理论中，反馈都是系统设计的主要方式。经典控 制理论用调整开环增益及引入串联和反馈校正装置来配置闭环极点，以改善系统性能。由于经



典控制理论是采用传递函数来描述系统的，因此，只能从输出引出信号作为反馈量。而现代控制 理论采用了系统内部的状态来描述系统，所以除了输出反馈外，还可以从系统的状态引出信号作 为反馈量，同时还能够利用状态反馈配置极点，提供更多的校正信息。但并不是所有的状态变量 在物理上都可测量，因此，状态反馈与状态观测器的设计便构成了现代控制系统综合设计的主要 内容。
8.5.1   两 种 常 用 反 馈 控 制 结 构
　　现代控制理论以状态空间为研究对象，在状态空间中的系统反馈分为状态反馈和输出反馈 两种。
1. 状态反馈
设有n 维线性定常系统
x=Ax+Bu
(8.5.1)
当系统的控制量取状态变量的线性函数
u=v   Kx                                                                       (8.5.2)
时及将状态矢量x 通过待定的状态反馈矩阵K 负反馈至控制输入处，就构成了线性直接状态反 馈，简称为状态反馈系统，其系统结构图如图8.5.1所示。
　　　　　　　　　　
图8.5.1  状态反馈至控制输入
将式(8.5.2)代入式(8.5.1)后，可得带有状态反馈的系统动态方程为
x=Ax+B(v―Kx)=(A―BK)x+Bv
y=Cx                                                                      (8.5.3)
式中：K  为 p×n      阶矩阵。显然，系统引入状态反馈后，只改变了系统矩阵及其特征值 λI―(A-BK)|,         而 B 、C矩阵均无改变。
2. 输出反馈
　　输出反馈有两种基本形式： 一种是将输出量反馈至控制输入处，如图8.5.2所示；另一种是 将输出量反馈至状态微分处，如图8.5.3所示。由于系统的状态量常常不能全部测量到，而系统 的输出量一般是可测量的，因此输出反馈工程上更易被使用。
　　
图8.5.2 输出反馈至控制输入处图              图8.5.3 输出反馈至状态微分处



1)输出反馈至控制输入处
对于系统式(8.5.1),控制量取为输出量的线性函数
u=v-Fy                                                                         (8.5.4)
　就构成了线性非动态输出反馈，常简称为输出反馈系统。其中v 为参考输入量，F 为实反馈增益 矩阵。
将式(8.5.4)代入式(8.5.1)后，可得带有输出反馈的系统动态方程为
x=Ax+B(v-Fy)=(A-BFC)x+Bv
y=Cx                                                                         (8.5.5)
2)输出反馈至状态微分处
带有输出反馈至状态微分处的系统动态方程为
x=Ax+Bu―Hy y=Cx
即
x=(A-HC)x+Bu y=Cx
式中：h 为 (n×1)   阶输出反馈阵。
　　　比较上述两种基本形式的反馈可以看出，状态反馈和输出反馈都能改变状态的系统矩阵。 由于输出反馈中的FC 相当于状态反馈中的K, 因而，一个输出反馈系统的性能一定有对应的状 态反馈与之等同，反之，却不一定能找到合适的F  矩阵来实现。同时，由于系统输出中所包含的 状态信息不是系统的全部信息，所以输出反馈只能看成是一种部分状态反馈。因此，在不增加补 偿器的条件下，输出反馈的效果不如状态反馈系统好。
8.5.2   反 馈 结 构 对 系 统 性 能 的 影 响
1. 对系统能控性和能观性的影响
定理8.5. 1 系统引入状态反馈后不改变原系统的能控性，但可能改变系统的能观性。
　　证明 设原系统能控，则可将原系统化为能控标准型结构，而状态反馈只改变友矩阵A 的 最后一行，即ao,a?,…,an-1      的值，而不会改变C 和 B,  因此，引入状态反馈后的系统仍是能控标 准型，即不改变系统的能控性。
又因为非奇异线性变换后，系统的传递函数矩阵不变，故假设原系统的传递函数矩阵为
　　　　　　　　
则带有状态反馈系统的传递矩阵为
　　　



　显然，G(s) 、G?(s)    的分子相同，即引入状态反馈前、后系统闭环零点不变。因此，当状态反馈系 统存在极点与零点对消时，系统的能观测性将会发生改变，原来能观测的系统可能变为不能观 测，原来不能观测的系统则可能变为能观测。只有当状态反馈系统的极点中不含原系统的闭环 零点时，状态反馈才能保持原有的能观测性。
　　　定理8.5.2 系 统引入输出至状态微分反馈不改变原系统的能观性，但可能改变系统的能 控性。
　　证明 用对偶定理来证明。若原系统为(A,B,C) 是能观测的，则其对偶系统(AT,CT,BT)  一 定能控。由定理可知，系统(AT,CT,BT)  引入状态反馈后的系统为(AT-CHT,CT,BT)        的可控性 不变，但可观测性可能改变。因而有
rank[C       ATCT    …     (AT)”1C]=
rank[C        (AT-C'HT)CT           …     (AT-CTHT)1C]=
rank[CT      (A-HC)TCT            …    ((A-HC)T)”1CT]
即原系统和引入状态反馈后系统的能控性矩阵的秩相同，因而，系统引入输出至状态微分反馈不 改变原系统的能观性。
又因为系统(AT,C,BT)     的能观性矩阵与系统(AT-CHT,CT,BT)        的能观性矩阵的秩有可
　能不同，因而，它们分别对应的原系统(A,B,C) 和系统(A-HC,B,C)    的能控性矩阵的秩也有可 能不同，即表明系统引入输出至状态微分反馈可能改变系统的能控性。证毕。
定理8.5.3  系统引入输出至输入的反馈不会改变原系统的能控性和能观测性。
　　证明 考虑式(8.5.3)和式(8.5.5),只取 FC=K,    则可将反馈视为状态反馈，按定理可知， 输出反馈不改变系统的可控性。另一方面，由于可以把系统(A 一BFC,B,C)    的能观性矩阵视为 由原系统(A,B,C)   的能观性矩阵经过初等变换得到，而初等变换不改变矩阵的秩，因而，系统引 入输出至输入的反馈也不会改变系统的能观测性。
2. 对系统稳定性的影响
　　　由于状态反馈和输出反馈都能改变状态的系统矩阵，因而，都有可能影响系统的稳定性。若 原系统不稳定，通过加入反馈，使得通过反馈构成的闭环系统成为稳定系统，称之为镇定。
对于线性定常系统
x=Ax+Bu
y=Cx
如果可以找到一个状态反馈
u=r―Kx
使得反馈系统
x=(A―BK)x+Br y=Cx
是渐近稳定的，即(A―BK)  的特征值均具有负实部，则称系统实现了状态反馈镇定。
定理8.5.4  当且仅当线性定常系统的不能控部分渐近稳定时，系统是状态反馈可镇定的。
证 明 当系统(A,B)  不完全能控时，可对系统进行结构分解，存在非奇异阵T, 使
　　　　　　　　　　　　　　



并且对任意K=[K?        K?],  使
　　　　　　　　
det(sI-A?+B?K?)det(sI―A?)
8.5.3   系统的极点配置
　　　由前所述，状态反馈与输出反馈都能够改变闭环系统的极点位置，因此，可以利用状态反馈 或输出反馈将系统的极点配置到所希望的位置，这就是系统的极点配置。
1. 极点可配置条件
定理8.5.5  利用状态反馈任意配置系统闭环极点的充分必要条件是被控系统能控。
证明 仅对单输入系统进行证明。
(1)先证明充分性。设单输入系统能控，采用x=P-1x,    将状态方程化为能控标准型
　　　
b=Pb=[00                …    01]T
在变换后的状态空间内，引入状态反馈阵k, 即
　　　　　　　　　　　　　　　　
式中：ko,k?,…,kn-1分别由x?,x?…,xn 引出反馈系数，故变换后的状态方程为 x=(A-bk)x+bv,y=cx
其中
　　　　　　　
可见，(A―bk,b)  仍为能控标准型，故引入状态反馈后，系统能控性不变。
容易得到上式的闭环特征方程为
λI-(A-bk)|=λ”+(an1+kn1)λ"?1+…+(a?+R?)λ+(ao+k?)=0
于是，适当选择ko,k?, … ,kn1,     可满足特征方程中n 个任意特征值的要求，因而闭环极点可任意 配置。
　　　(2)再证明必要性。假设系统不能控，则表明必有系统的状态变量与输入量u 无关，即引入 状态反馈时无法通过控制来影响不可控的极点。证毕。
定理8.5.6 用输出至状态微分的反馈任意配置闭环极点的充要条件是系统能观测。
证明 用对偶定理来证明。若(A,B,C)   能观测，则对偶系统(AT,CT,BT)  能控，由状态反馈



极点配置定理已知，(AT-CThT)   的特征值可任意配置，但(AT-CThT)   的特征值与(AT-CThT)T=
A―hc的特征值是相同的，故当且仅当(A,B,C)    能观测时，可以任意配置(A-hC)      的特征值。 证毕。
2. 极点配置方法
　　如果系统能控，被控系统特征方程的全部n 个系数都可独立任意设置，便获得了任意配置闭 环极点的效果。采用状态反馈任意配置系统极点时，主要是如何根据期望值设计相应的反馈矩 阵 k 。这里给出两种常用方法。
1)标准型变换法
　　　给定系统(A,B)   和一组期望的闭环极点{λ1,λ2,…,λn}, 要求确定反馈增益矩阵矢量k, 使得 闭环系统状态矩阵(A―bk)  的极点为{λ1,λ2,…,λn}。
(1)检验系统的能控性。
(2)计算A 矩阵的特征多项式，即
det[λI-A]=λ”+an1λ”?1+…+a1λ+ao
得到一组系数{ao,a?,…,an-1}。
(3)确定将原系统化为能控标准型的变换矩阵T。
(4)计算由期望闭环极点{λ1,λ2,…,λn} 所决定的希望特征多项式，即
　　　　　　　　(λ一λ1)(λ一λ2)…(λ一 λn)=λ”+bn-1λ”1+…+b?λ+b? 得到新的一组系数{b?,b?,…,bn-1}。
(5)计算满足要求的状态反馈增益矩阵
k=KT                        =[b?―ao,b?―a1,…,b-1-an1]T
2)系数比较法
　　在求解状态反馈阵时，并不一定要进行到能控标准型的变换，只需校验系统能控，计算特征 多 项 式 |XI―(A―bk)|    (其系数均为ko,k?,…,kn-1    的函数)并通过与具有希望特征值的特征多 项式系数{b?,b?,…,bn-1}     相比较，便可确定k 矩阵。
例8.5. 1 给定如下线性定常系统为
　　　　　　　　　　　　　　　
设计状态反馈u=―kx, 使得闭环系统的特征值为λ?=-2,λ2=- 1+j,λ?=-1―j。
解  容易检验系统是完全能控的，故满足可配置条件。
计算系统的特征多项式为
　　　　　　　　　
计算变换矩阵
　　　　　　　　



　　　　　　　　　　　　　　　　　　　
求逆
　　　　　　　　　　　　　　　
由闭环系统的期望特征值可得期望的特征多项式为
　　　　　
从而确定反馈增益阵k 为

186,-1220]

例8.5.2  系统传递函数为
　　　　　　　　　　　　　　　　　
试用状态反馈将闭环极点配置在―2,-1±j。
解  由系统传递函数可以写出其能控标准型实现
　　　　　　　　　　
设状态反馈矩阵为
k=[ko        k?   k?]
则状态反馈系统特征方程为
　　　　　　　　　λI-(A-bk)|=λ3+(3+k?)λ2+(2+k?)λ+ko=0 由期望闭环极点，可得期望的系统特征方程为
　　　　　　　　　(λ+2)(λ+1-j)(λ+1+j)=λ3+4λ2+6λ+4=0 比较两个特征方程，由同幂项系数相同可得
ko=4,k?=4,k?=1
因此，满足系统要求的状态反馈阵为 k=[44           1]。
8.5.4   全维状态观测器
　　状态反馈虽然能非常有效地改善系统的性能，但系统的状态变量并不是个个都易于量测的。 因此，需要寻求一种能产生系统状态的方法。由于系统的输出量一般是可测的，于是，如果利用 系统的输出，通过状态观测器重构系统的状态，然后就能够将状态估计值反馈至控制输入处来配  置系统极点。这种重构状态的方法称为状态估计；重构状态的系统叫做状态观测器。当重构状




态矢量的维数与系统状态的维数相同时，观测器称为全维状态观测器，否则称为降维观测器。
1. 全维状态观测器的构成方案
设被控系统动态方程为
x=Ax+Bu
y=Cx                                                                     (8.5.6)
构造一个结构与之相同但能够用计算机模拟实现的的被控系统
x=Ax+Bu
y=C
式中：x,y 分别为模拟系统的状态矢量及输出矢量。
　　　当模拟系统与受控对象的初始状态相同时，给定同一输入量，有x=x,    因此可用x 作为状态 反馈所需要的信息。但是，被控对象的初始状态一般可能不同，因此模拟系统中积分器的初始条 件设置只能预估值，这就会造成两个系统的初始状态总有差异，即使两个系统的A、B、C矩阵完 全一样，估计状态与实际状态也必然存在误差x―x,  因此无法实现真正的状态反馈。但是x―x
的 存 在 必 导 致 -y 的存在，而被控系统的输出量总是可以测量到的，如果将y-y     负反馈至x   处，并控制-y 尽快逼近至0,从而使x―x 也尽快逼近至0,便可以利用x 来形成状态反馈。按 以上原理构成的状态观测器并实现状态反馈的结构图如图8.5.4所示。
　　　　　　　　
图8.5.4 用全维状态观测器实现状态反馈原理
　　　图中，状态观测器有两个输入，即u 和y, 其输出为x, 观测器含有n 个积分器并对全部状态 变量作出估计。H 为观测器输出反馈矩阵，它把-y 负反馈至x 处，目的是配置观测器极点，提 高其动态性能，使x―x 尽快逼近于0,它是前面介绍过的一种输出反馈。
2. 全维状态观测器分析设计
由图8.5.4可得全维状态观测器动态方程为
x=Ac+Bu-H(y-y) y=C
故
x                 =Ax+Bu―HC(x-x)=



(A-HC)x+Bu+Hy                                                           (8.5.7)
式中：(A-HC)  称为观测器系统矩阵；H 为 n×q 维矩阵。
　　　为了保证状态反馈系统正常工作，重构的状态在任何x(to)与x(to)的初始条件下，都必须满 足
　　　　　　　　　　　　　　　　　　
由式(8.5.6)和式(8.5.7)可得状态估计误差为
x―x=(A―HC)(x―x)
解为
x-x=e(4             RC)(-%)[x(t?)―x(t?)]
显然，当x(to)=x(to)     时，恒有x(t)=x(t),        输出反馈不起作用；当x(to)≠x(to)      时，有x(t)≠x
(t),输出反馈便起作用，这时只要观测器(A―HC) 的特征值具有负实部，状态矢量误差总会按指 数规律衰减，且衰减速率取决于观测器的极点配置。
定理8.5.7 若被控系统(A,B,C) 能观测，则其状态可用形如
x=(A-HC)x+Bu+Hy
的全维观测器来给出状态估值，矩阵H 可按任意极点配置的需要来设计，以决定状态估计误差 衰减的速率。
　　　实际选择H 矩阵参数时，要注意防止数值过大导致饱和效应和噪声加剧等。通常希望观测 器的响应速度是状态反馈系统的响应速度的4倍～11倍为好。
例8.5.3 给定系统的状态空间表达式为
　　　　　　　　　　　　　　
y=[110]x
试设计全维状态观测器，将其极点配置在―3,―4,―5,并画出相应的结构图。 解 设计全维状态观测器
　
　　　　　　　　　　　
λ3+(H?+H?+3)λ2+(2H?―2H?+6)λ+(2H?+2H?―4H?+6)
观测器的期望特征多项式为
　　　　　　　　　a*(s)=(s+3)(s+4)(s+5)=s3+12s2+47s+60 与期望特征多项式比较系数得
　　　　　　　　　　　　　　　



解方程组得
　　　　　　　　　　　　　　　　
所设计的全维状态观测器的结构图如图8.5.5所示。
　　　　　　　
图8.5.5 用全维状态观测器实现状态反馈原理

8.5.5   分 离 特 性
　　　当采用全维状态观测器提供的状态估值x 代替真实状态x  来实现状态反馈，为保持系统期 望的特征值，其状态反馈阵K 是否需要重新设计?当观测器被引入系统以后，状态反馈系统部 分是否会改变已经设计好的观测器极点配置，其观测器输出反馈阵H 是否需要重新设计?这些 问题均需要对引入观测器的状态反馈系统作进一步的分析。如图8.5.4所示，整个系统是一个 2n 维的复合系统，其中
u=v―Kx
状态反馈子系统的动态方程为
x=Ax+Bu=Ax―BKx                 +Bv y=Cx
全维状态观测器子系统的动态方程为
　　　　　　　　x=Ax+Bu―H(y-y)=(A-BK-HC)x+HCx+Bv 故复合系统动态方程为
　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
由式(8.5.8)和式(8.5.9)可得
x-x=(A―HC)(x―x)
该式与u、v无关，即(x―x)   是不可控的。所以不管施加什么样的控制信号，状态误差总会衰减 到0。结合
x=Ax―BK+Bv=(A―BK)x+BK(x―x)+Bv



同样可以得到复合系统的另外一种形式，即
　　　　　　　　　　　
(8.5.10)
从式(8.5.10)可以导出复合系统传递函数矩阵为
　　　　　　　　　
利用分块矩阵求逆公式
　　　　　　　　　　　　　　
可得
G(s)=C[sI―(A―BK)]1B
上式右端正是引入真实状态x 作为反馈的状态反馈系统
x=Ax+B(v―Kx)=(A―BK)x+Bv
y=Cx
的传递函数矩阵。这就说明了复合系统与状态反馈子系统具有相同的传递特性，与观测器部分 无关，可用估值状态x 代替真实状态x 作为反馈。从2n 维复合系统导出了(n×n)    传递函数矩 阵，这是由于(x―x) 不能控造成的。
容易导出复合系统式(8.5.10)的特征值多项式满足关系式
　　　　　
该式表明，复合系统特征值是由状态反馈子系统和全维状态观测器的特征值组合而成的，且两部 分特征值相互独立，彼此不受影响，因而，状态反馈矩阵K 和输出反馈矩阵H  可以根据各自的要 求来独立进行设计，从而得到如下分离定理。
　　　定理8.5.8(分离定理)  若被控系统(A,B,C) 能控且能观测，用状态观测器估值形成状态 反馈时，其系统的极点配置和观测器设计可分别独立进行，即矩阵K 与 H  的设计可分别独立 进行。
8.6   状态空间分析法的设计实例

　　　例8.6. 1 卫星轨道控制系统：在没有干扰的情况下，卫星将沿着赤道圆轨道运行，但是由 于气动拉力等各种干扰总是会导致卫星偏离正常轨道，因此，卫星轨道控制系统要求设计一个合 适的控制器，驱动卫星推进器动作，从而保证在扰动存在下，卫星实际运行轨道依然能够与预定 轨道一致。只考虑卫星径向和法向推进器的控制能力，给定如下系统：
　　　绕地球上空463km 赤道圆轨道运行的卫星[16,27],其轨道角速度w=0.0011rad/s     (约为 90r/min),   则它在轨道平面中运行的动态方程可以表示为



　　　　　　　　　　　　
　式中：x 为卫星绕轨道运动的状态矢量；f,   为卫星推进器径向输入量；f,   为卫星推进器法向输 入量。
利 用MATLAB   软件分析如下问题：
问 题 1 若卫星法向推进器失效，即f?=0,    只有径向推进器工作，卫星是否能控?
解  编写如下radial.m   程序：
　　%This script computers the satellite controllability %with a radial thruster only
w=0.0011;
A=[0100;3*w2002*w;0001;0-2*w00];
br=[0;1;0;0];
Pc=ctrb(A,br);
n=det(Pc);
if  abs(n)<eps
disp('Satellite is uncontrollable with radial thruster only!')
else
disp('Satellite is controllable with radial thruster only!')
end
运 行m 程 序
》radial
Satellite is uncontrollable with radial thruster only!
　　　可见，由于系统的能控性矩阵Pc 的行列式为零，因此，当卫星法向推进器失效时，只有径向 推进器作用下，卫星是不能控的。
问 题 2 若卫星径向推进器失效，即f,=0,     只有法向推进器工作，卫星是否能控?
解  编写如下tangent.m    程序：
%This script computers the satellite controllability
%with a tangential thruster only
w=0.0011;
A=[0100;3*w2002*w;0001;0―2*w00];
bs=[0;0;0;1];
Pc=ctrb(A,bs);
n=det(Pc);
if  abs(n)<eps
disp('Satellite is uncontrollable with tangential thruster only!')
else
　　　　disp('Satellite is controllable with tangential thruster only!') end
运 行m 程 序
》tangent



Satellite is controllable with tangential thruster only!
可见，当卫星径向推进器失效时，只有法向推进器作用下，卫星是完全能控的。
　　例8.6.2 磁盘驱动读取系统：磁盘在每厘米宽度内有5000个磁道，而每个磁道的典型宽 度仅为lμm,   因此，磁盘驱动读取系统对磁头的定位精度以及磁头在各磁道间移动的动态过程 都有严格的指标要求。
　　忽略磁场电感影响，磁头驱动读取控制系统可用如图8.6. 1所示的二阶开环模型结构图 表示。
　　　　　　
图8.6.1 磁头控制系统的开环模型
若采用如图8.6.2所示的状态反馈控制器构成闭环控制系统：
(1)如何选择放大器增益K。和反馈系统K?, 使得二阶系统响应满足表8.6.1所列的性能指标。
　　　　　　
图8.6.2 具有两条状态变量反馈回路的闭环系统
表8.6. 1  磁盘驱动控制系统的设计要求和实际性能

性能指标	期望值	二阶模型响应	三阶模型响应
超调量	<5%	<2%	0%
调节时间/ms	<50	40.2	40.3
单位阶跃扰动的响应峰值	5.2×10-3	5.2×10-5	5.2×10-5
(2)若考虑磁场电感的响应(电感L=1mH),     则磁盘读取系统中的电机传递函数为
　　　　　　　　　　　　　　　　　　
试采用系统的三阶模型检验系统采用二阶模型时的设计结果。
　　　解(1)假定磁头位置和速度均为可测量的，由图8.6. 1可知，可以选择状态变量 x?(t)   为 磁头位置量y(t),x?(t)     为磁头运动速度量 j(t),    建立开环系统的二阶状态方程为
　　　　　　　　　　　　　　　
根据图8.6.2可知闭环系统的状态方程为
　　　　　　　　　　　
取 K?=1,    则闭环系统的特征方程为



s2+(20+5K?Ka)s+5K 。=0                                                                   (8.6.1)
　　根据表8.6. 1给出的设计指标，可以计算得到ξ>0.69,wn>88。  为了满足磁盘读取系统对 动态过程设计的严格要求，这里取ξ=0.90, ξwn=125,   则预期的不必换特征方程为
s2+2wns+w2=s2+250s+19290=0                                                                 (8.6.2)
令式(8.6.1)和式(8.6.2)的对应项系统相等，则有
5K 。=19290
20+5K?Ka=250
可得满足要求的放大器增益Ka=3858,   反馈增益K?=0.012 。  采 用MATLAB  仿真验证闭环系统的实 际响应，所得动态性能指标为表8.6.1中的第三列，这表明所设计的参数满足了系统设计要求。
　　　(2)考虑磁场电感影响，取 代 替Gm=5,   可以得到系统更为精确的三阶开环模 型，沿用(1)中二阶模型选取的参数，即 Ka=3858,K?=1,K?=0.012。
　　对闭环系统进行仿真计算，可以得到如表8.6. 1中第四列所示的指标，表明三阶闭环系统同 样满足了设计要求。对比表8.6. 1中的第三列和第四列可知，三阶系统的动态性能指标与二级 系统的性能指标相近，因此，采用二阶模型足以精确地描述磁盘驱动读取系统。

本  章  小  结

　　本章介绍了线性系统的状态空间分析与综合方法。首先介绍线性系统的状态空间描述，主 要掌握状态空间的基本概念、状态空间表达式的建立、状态空间表达式求解方法、状态转移矩阵  及其性质、传递函数阵；再分析了线性系统的可控性与可观性，主要掌握线性系统可控性与可观 性的基本概念、线性系统可控性与可观性判据、可控标准型与可观标准型；随后介绍了线性定常  系统的线性变换，主要掌握状态空间线性变换定义和性质、对偶原理和规范分解；并介绍了线性  定常系统的反馈结构及状态观测器设计，主要掌握传递函数的实现问题、状态反馈与输出反馈、 极点配置、状态观测器设计；尤其重要的是李雅普诺夫稳定性分析，必须掌握李雅普诺夫意义稳 定性的基本概念、李雅普诺夫第一法和第二法、线性定常系统稳定性分析。
课 后 练 习 题
8-1   试求图示的电网络中，以电感L? 、L?  上的支电流x? 、x?  作为状态变量的状态空间表达式。
这 里u 是恒流源的电流值，输出y 是 R?  上的支路电压。
　　　　　　　　　　　
8 - 1题图
8―2   已知系统的微分方程




(1)y+2“-3y+6y=u
(2)    2?y+3?y=?u?u
试列写出它们的状态空间表达式。
8-3   列写图示系统的状态空间表达式。
　　　　　　　　　　　　
8- 3题图
8-4   设系统微分方程为
y+6y+11y+6y=6u
试列写可控标准型和可观标准型表达式，并画出状态变量结构图。
8-5   已知下列传递函数，试用直接分解法建立其状态空间表达式，并画出状态变量图。
(1)  ;(2)
8―6  已知系统的传递函数为
　　　　　　　　　　　　　　　　　
试求可控标准型、可观标准型、对角线型动态方程。
8-7   试将下列状态方程化为对角标准型。
(1)
　　　(2)  8-8   计算下列矩阵的矩阵指数e。
　　;(2) ;(3) 8-9       已 知ad=bc, 试计算
　　　　　　　　　　　　　　　　　　
8-10   已知系统的状态方程为
　　　　　　　　　　　　　　　



　初始条件为x?(0)=1,x?(0)=0 。     试求系统的单位阶跃响应。 8-11    已知系统的状态转移矩阵为
　　　　　　　　　　　　
试求该系统的状态矩阵A。
8-12   已知系统的状态空间表达式为
　　　　　　　　　　
求其对应的传递函数。
8-13   设离散系统的差分方程为
y(k+2)+5y(k+1)+3y(k)=u(k+1)+2u(k)
求系统的状态空间表达式。
8-14   已知连续系统动态方程为
　　　　　　　　　　　　　　　　　
y=[10]x
取采样周期为T=1s,    试求离散化动态方程。
8-15   判断下列系统的能控性。
(1)
(2)
　　　(3)   8-16   系统状态方程为
　　　　　　　　　　　　　　　　
设系统状态可控，试求a、b。
8-17   图为防震平台(忽略平台质量),试讨论：
(1)系统完全能控性的条件；
　　　( 2 ) 当k?=k2=1,μ=2,μ2=4,x?(0)=8,x?(O)=-2                     时，求 u(t),   使 x?(4)=0,x?(4)=0。 8-18   判断下列系统的输出能控性。

(1)




　　　　　　　　　　　　　
8 - 1 7 题 图

　　　　　

(2)

　　　　
8-19   判断下列系统的能观测性。
(1)

(2)


(3)

8-20   确定使得以下系统可观测的a、b。
　　　　　　　　　　　　　　　
8-21   试确定当p 与q 为何值时下列系统可控，为何值时可观测。
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
8-22   将下列状态方程化为能控标准型。
　　　　　　　　　　　　　　



8―23    将下列状态方程和输出方程化为能观标准型。
　　　　　　　　　　　　　　　　　　
y=[-1            1]x
8-24   验证如下系统能控性，并进行结构分解。
　　　　　　　　　　　　　
y(t)=[1              -1    1]x(t)
8-25       验证8-24的能观性，并进行结构分解。
8―26  已知系统传递函数为
　　　　　　　　　　　　　　　　　
试求系统可控不可观测、可观测不可控、不可控不可观测的动态方程。
8-27      试用李雅普诺夫稳定性定理判断下列系统在平衡状态的稳定性。
　　　　　　　　　　　　　　　　
8―28  试用李雅普诺夫第二方法判断如下系统其在平衡状态的稳定性。
x?=―x?+x?
x?=2x?―3x?
8-29   设系统状态方程为
　　　　　　　　　　　
(1)当取Q=I   时，求P。
(2)若选Q 为正半定矩阵时，求Q 及对应的P。
(3)判断系统的稳定性。
8―30   给定系统的传递函数为
　　　　　　　　　　　　　　　　
　试确定状态反馈控制律，使闭环极点为―2,―4,―7。 8-31   给定系统的状态空间表达式为
　　　　　　　　　　　　　　　
y(t)=[2                -1]x(t)
设计一个具有特征值为―10,―10的全维状态观测器。



8-32   给定系统的传递函数为
　　　　　　　　　　　　　　　
试问能否用状态反馈将函数变为
　　　　　　　　　　　　　　　　







第 9 章 最优控制理论基础


本 章 提 要

　　　本章首先由几个最优控制实例引出最优控制问题的基本描述。泛函变分是最优控制理论的 数学基础，本章简要回顾了微积分基本知识，引入泛函与变分的概念，介绍了泛函极值问题的描 述与求解方法，并讨论了条件泛函极值在动态系统最优控制中的应用。随后，本章依次介绍了最 优控制的基本原理和常用方法，包括经典变分法、极小值原理、线性二次型最优控制问题和动态 规划，部分章节中还给出了MATLAB  在求解最优控制问题中的应用实例。

9.1  引   言

　　　最优控制理论是现代控制理论的重要组成，在航空航天和现代工业过程中均有广泛的应用。 例如，导弹、卫星等多变量复杂动态系统不仅要求良好的系统稳定性、快速性和准确性等常规控 制品质，通常还要求时间最少、燃料消耗最省等工程性能指标。这种工程应用上的实际需求极大 地刺激了最优控制的发展。1953年布绍(Bushaw) 研究了伺服系统的时间最优控制问题；1965 年拉塞尔(LaSalle) 发展了时间最优控制的理论，提出了著名的Bang-Bang 控制理论；1953年一  1957年，美国贝尔曼(Bellman)  创立了动态规划理论；1956年―1958年，苏联学者庞特里亚金 (Pontryagin)  提出极小值原理。动态规划和极小值原理均以现代变分理论为数学基础，是目前 最优控制理论中最有成效的两种方法。近年来，数字计算机的发展为最优控制的实现提供了有 力的手段，最优控制理论仍然是一个非常活跃、富有成果的学科领域之一。
9.2  最优控制问题导论
例9.2.1  登月舱软着陆 (Moon    Lander)控制。
　　　由于月球表面没有大气，登月舱软着陆问题是登月工程中一个关键技术。软着陆是对高度 控制系统提出的要求，即在保证登月舱轴线垂直于着陆点月面时，登月舱到达月球表面时的高度 和速度同时为0,而为了登月任务完成后登月舱顺利脱离月球，则又希望着陆过程燃料消耗 最少。
登月舱着陆过程中受力情况及相关变量如图9.2.1所示，其中：
h(t)――t时刻登月舱高度；
v(t)――t  时刻登月舱速度(v(t)=h(t));
m(t)――登月舱重量(随着燃料消耗登月舱重量是时变的);
u(t)――  降落发动机推力(m(t)=―ku(t),              k=  常数),假定推力容许范围为0≤u(t)
≤umax。



　　　根据牛顿定律，登月舱的运动方程为m(t)h(t)=u(t)-m(t)g 。      因此，登月舱整体运行状态 可用下式表示为
h(t)=v(t)
                           (9.2.1)
m(t)=―ku(t),k=               常数
式(9.2.1)的矢量表达式为
x(t)=f(x(t),u(t),t),x(t)=[h(t),v(t),m(t)]T                                                      (9.2.2)
假定在t=0   时刻，登月舱的初始高度、速度和重量分别为x(O)=x?=[ho,vo,m 。]T 。   根 据
软着陆的要求，目标状态为x(tf)=x?,=[0,0,m(tg)]。    因此，登月舱软着陆控制问题可描述 为：终端时间ty自由，寻求发动机推力的最优控制u*(t)(0≤t≤tf), 它应该满足控制约束 O≤u(t)≤1,     能使登月舱由初始状态x(O) 转移到终端状态 x(t),     并且使性能指标J=m(t;)
极大。
例 9 .2.2  导弹拦截(Missile Intercept)控制。
　　通常，针对空空导弹拦截问题提出的控制目标为控制导弹轨迹(Missile      Trajectory),在最短 时间内拦截到目标(Target)。现假定导弹垂直方向升力能够抵消自身重力，导弹与目标的运动 在同一平面，导弹推力与目标速度方向一致，目标常速、定航向飞行，如图9.2.2所示。
　　　　

图9.2.1 登月舱着陆示意图                     图9.2.2 导弹拦截控制示意图

在上述假定下，t 时刻目标的运动方程为

(9.2.3)


式中：vr 为目标线速度；(xT,yT) 为目标的位置坐标值；φT 为目标运行方向与横坐标夹角。
　　　假定导弹初始质量为Mo,t  时刻导弹质量为m(t),   导弹线速度为vM,位置坐标为(xM,ym), vM 与横坐标夹角为φM,导弹的状态方程为






(9.2.4)



　式中：β为导弹推进剂秒流量；Cβ为导弹纵向推力(C 为常数);Kav  为导弹的空气阻力；F 为导 弹的侧向推力。
　　式(9.2.3)和式(9.2.4)可合并，用导弹一目标的相对运动方程描述该系统，即定义相对坐标 变量x=xr―xM,y=yr-ym,          最终可得到系统的状态方程为




(9.2.5)




式中：状态量x?,x?…,x?      分别为x,y,VM,φM,m,vT;     控制量u1、u2 分别为导弹的纵向和侧向 推力。
因此，导弹拦截控制问题可描述为：终端时间ty 自由，寻求导弹推力最优控制律u*(t)=
[u(t)u2(t)](0≤t≤tf),                它应该满足控制约束0≤u;(t)≤ui_max(i=1,2),            使得导弹从发射
到击中目标时间最短，即
例9.2.3 再投资(Reinvestment)/消 费(Consumption) 比例控制。
　　企业经营目标一般为最大化可消费财富总值。通常，企业的产值一部分用于消费，另一部分 则用于再投资提高产能。为了实现企业经营目标，则要求控制再投资/消费的比例。假定x(t)    为某企业在t 时刻的总产值，设u(t)  为产值中用于再投资的比例，显然0≤u(t)≤1,     并假定产值 增长率与再投资额成正比，则企业产值模型为
x(t)=ku(t)x(t)
x(0)=xo                                                                    (9.2.6)
　　因此，企业的再投资/消费比例控制问题可描述为：在[0,tf]  规划时间内，寻求再投资/消费 比例控制规律 u*(t),       使 得 在 这 段 时 间 内 企 业 累 积 的 可 消 费 财 富 总 和 最 大 ， 即
　
根据本章后文中介绍的最优控制理论，最优的再投资/消费比例u*(t)  为
(9.2.7)
即在这段时间前期，企业将所有产值都用于投资再生产，然后企业可将后期的所有产值用于消



费，其中t   为切换时间。
由上面的例子可以看出，描述最优控制问题要包含下面4个要素：
　　　(1)被控系统的状态方程x(t)=f(x(t),u(t),t),                 其 中x(t)   为 n 维状态矢量，u(t)  为 m  维 控 制矢量，f(・)      为 n 维矢量函数。状态方程反映了系统在运动过程中应遵循的物理/化学规律， 受任何控制作用u(t)   驱动的系统状态x(t)   一定满足其状态方程的约束。
　　　(2)状态方程的边界条件。动态过程从 一 个状态转移到另 一 个状态，则在状态空间中形 成 一 条轨线。最优控制问题中，通常初始状态(to,x(to))      是已知的，但终端时间和终端状态 (tf,x(tf)) 则因问题而异。譬如，登月舱软着陆控制中t; 任 意 ，x(t) 中的高度和速度状态为0 (固定),质量状态不定；导弹拦截控制中要求 tf  极 小 ，x(tg)   中导弹目标相对位置为0(固定), 其他状态不定；而企业再投资/消费控制中，ty 固 定 ，x(tf)自由。本章介绍最优控制理论方法 时，终端时间t,  分为固定和自由两种情况。终端状态分为三种情况讨论：固定(x(tg)=xf,        即  状态空间中一个固定点)、约束(ψ(x(tg),tg)=0,  即状态空间中 一 个超曲面)和自由(状态空间 中任意位置)。
(3)性能指标J 。 性能指标的 一般形式为
(9.2.8)

上述指标包含两个部分：终端指标Φ[x(tg),t;] 和积分型指标 。终端指标 是对终端状态的要求，如火炮发射控制问题中要求弹着点散布度最小。积分指标是状态控制过 程中对控制品质的要求，如要求控制时间最短、能量消耗最小等。性能指标J  是 以 函 数u(t)   为 自变量的函数，函数的函数在数学上定义为泛函。欲使性能指标J 极大或极小，这是泛函极值 问题，将在9.3节中介绍。
　　　(4)控制作用的容许范围，u(t)∈Ω 。 实际控制问题中，大多数控制量受客观条件限制只能 在某个范围内取值，譬如，登月舱着陆过程中，降落发动机推力的取值范围为0≤u≤umax 。Ω  则 是控制量空间中的一个集合，称为容许控制域。在控制域Ω内取值的每一个控制量u(t)   都 是 容 许控制。
最优控制问题则可描述为：按一 定方法寻找容许控制 u(t)(u(t)∈Ω),          被 控 系 统 x(t)=
f(x(t),u(t),t)           受控制作用的驱动，其状态由初始状态(to,x(to))     转移到终端状态(t;,x(tg)),
并使性能指标J 达到极大或极小，即某种意义下的最优。
　　求解最优控制问题的常用方法有经典变分法、极小值原理、线性二次型最优控制、动态规划 等。本章作为状态空间分析方法(第8章)的后续内容，将侧重于介绍最优控制理论的基本原理 和常用方法，以及MATLAB    在求解最优控制问题中的仿真应用。
9.3         最优控制中的变分法

　　　变分法是求解泛函极值问题的经典方法。泛函是“函数的函数”,泛函极值问题和函数极值 问题非常相似。因此，本节首先简单回顾函数、导数、微分及函数极值等基本概念，进而引入泛函 和泛函变分法的介绍。




9.3.1   微积分基础
1. 函数
　　　函数y=f(x)  是一种特殊的映射，自变量集合中的每一个值x, 通过映射f( ・), 都有因变 量集合中确定的值y 与之对应。如果自变量在定义域内任取一个数值时，对应的函数值总是只 有一个，这种函数叫做单值函数，否则叫做多值函数。只有一个自变量的函数称为一元函数，有 多个自变量的函数称为多元函数。
2. 导数
　　设一元函数y=f(x) 自变量的增量为△x=x- xo, 则 x=xo+△ x,函数值也有相应的变化 量△y=f(xo+△x)  一f(x?)。若函数增量与自变量增量比的极限存在，则定义函数在x。处的导
数为                                      。一般地，定义
函数f(x) 的导函数。导数的物理意义是y 对x 的瞬时变化率，比如位移对时间的导数是速度、 电压对时间的导数是电流。导数的几何意义是曲线y=f(x) 在x。处的切线斜率，如图9.3.1所
示，即为k=tana=f(x?) 。    设函数f(x) 、g(x)     在 x 处可导，常用的求导法则有：函数和求导
(f±g)'=f±g′,             函数积求导(f・g)′=fg+fg′,                  函数商求导 等。若函数
形式比较复杂，则可应用复合函数求导法则，设y=f(u),u=g(x),           则 y'(x)=f(u)g'(x)。
3. 微分
　　设一元函数y=f(x)      在 点x。处可导，△x  是自变量x   的增量，若函数值变化量△y=    f(xo+  △x) 一f(x 。) 可表示为△y=A・△x+o(△x),       其 中o(△x) 为△x 的高阶无穷小，      为 △y的线性主部，则称函数f(x) 在x。处可微，A ・△r 称为函数f(x) 在x。处关于△x 的微分，记 作 dy, 即 dy=A・△x 。 当△x 足够小，通常把自变量x 的增量△x  称为自变量的微分，记作 dx,   即dx=△x,  那么,系数A 即为x。处斜率，A=f'(xo),      如图9.3.2所示。于是，函数y=f(x)      在 x。处的微分又可记作dy=f(xo)dx 。   函数的微分与自变量的微分之商正是该函数的导数，因 此，导数也叫做微商。


　　
图9.3.1 导数的几何意义



图9.3.2 微分的几何意义



4. 偏导数和全微分
设二元函数z=f(x,y)       在点(xo,yo)   的某邻域内有定义，当y  固定在yo,x  在 x。处有增量
△x,相应的函数增量为 f(xo+△x,yo)-f(xo,yo)。  如果极 在，则称此极限为函数z=f(x,y)  在点(xo,yo)处对△x 的偏导数，记  同理，可 定义函数z=f(x,y)      在 点(xo,yo)   处对△y 的偏导数，记为            函 数z=f(x,y)       在 (xo,yo) 处的全增量为△z=f(xo+△x,yo+△y)   一f(xo,yo)。由一元函数中微分和导数的关 系，若函数的全增量可表示为 ,p=√△x2+△y2,            则可定义函数 z=f(x,y) 在(xo,yo) 处的全微分为
                         (9.3.1)
5. 函数极值问题
　　连续可微一元函数 y=f(x)      在 x。处存在极值的必要条件是 f(x)=0 。   若其二阶导数  f"(x)>0,     则函数在x。处存在极小值；反过来，二阶导数f"(x)<0,      则函数在x。处存在极大值。 多元函数J=f(x?,x?,…,xn)          存在极值的必要条件为



(9.3.2)



其存在极小值的充分条件存在极大值的充分条件
　　　若自变量并非在其定义域中任意取值，而是满足一定约束条件，以二元函数z=f(x,y)       为 例，假定变量x,y  之间满足条件φ(x,y)=0 。  这种情况称为函数的条件极值，可用拉格朗日乘子 法求解这类条件极值问题。引入拉格朗日函数
H(x,y,λ)=f(x,y)+λφ(x,y)                                                           (9.3.3)
式中：λ是待定常数，称为拉格朗日乘子。
　　z=f(x,y)      的极值点不仅要满足自身的函数关系，还要满足约束条件φ(x,y)=0,       因此，必 然满足拉格朗日函数(式(9.3.3))。通过拉格朗日函数，条件极值问题转换为H(x,y,λ)     的无约 束函数极值问题，求极值的必要条件为


(9.3.4)




9.3.2   泛 函 与 变 分 法 基 本 概 念
　　　泛函可简单理解为“函数的函数”,它经常以定积分的形式出现，最优控制问题中的性能指标 (式(9.2.8))就是一个泛函。由式(9.3.2)可知，函数极值的必要条件是函数对其所有自变量的 一阶偏导数都为0,导数或微分在求函数极值时起着重要的作用。研究泛函极值问题时，泛函的 自变量是函数，被定义为宗量；自变量的微分概念被推广为宗量的变分，函数的微分概念被推广 为泛函的变分。因此，泛函极值问题中，变分起着重要的作用，求泛函极值的方法称为变分法。 变分法是处理泛函的方法，和数域中的微积分相对应。
1. 泛函的定义
　　设对自变量t,存在一类函数{x(t)}。 若对每一个函数x(t), 有 一个实数值J 与之对应，则 变 量J  称为依赖于函数x(t)   的泛函数，简称泛函，记为
J=J[x(t)]
　　粗略而言，泛函是以函数为自变量的函数，规定了函数x(t)   与数值J  的对应关系。其中，函 数 x(t)  称为泛函J  的宗量。
2. 泛函的连续性
若对任意给定e>0,    存在δ>0,当 |x(t)―x 。(t)|<δ,        有 |J[x(t)]     一J[x?(t)]|<e,            则 称
J[x(t)]     在 x?(t)   处是连续的。
3. 线性泛函
　　　满 足 齐 次 叠 加 性 质 的 泛 函 称 为 线 性 泛 函 ， 即 J[a・x(t)]=a・J[x(t)](a                           为 常 数),J[x(t)+y(t)]=J[x(t)]+J[y(t)]。
4.自变量函数(宗量)的变分
泛 函J[x(t)]      的宗量x(t)  的变分δx(t)   定义为 δx(t)=x(t)―x 。(t),          即两个函数之差。这
里 ，x(t)和 x? (t)是属于同一函数类{x(t)} 中两个不同的函数。
5. 泛函的变分
当宗量函数x(t)  有变分δx(t)  时，泛函的增量为
　　　　　　△J=J[x(t)+δx(t)]-J[x(t)]=L[x(t),δx(t)]+r[x(t),δx(t)]                                                      (9.3.5)  式中：L[x(t),&x(t)]        是泛函增量的线性主部；r[x(t),δx(t)]         是 δx(t)    的高阶无穷小。若
δx(t)→0,    定义δJ=L[x(t),δx(t)]           为泛函的变分，其中L[x(t),δx(t)]         是泛函J  对宗量x(t)   的
导数与宗量变分δx(t)   的乘积。泛函的变分也可称为泛函的微分。和函数的微分定义非常类
似，对于泛函 J[x(t)],        它 只 有 一 个 宗 量 x(t),        其 变 分 为 x(t);       ; 泛 函
J[x(t),x(t)]         有两个宗量x(t)  和 x(t),    则其变分为
　　　　　　　　　　
6. 泛函变分的规则
　　　由上文可知，泛函变分是一种线性映射，其运算规则类似于函数的各种线性运算。设L?  和 L?  是函数x  和x  以及变量t 的函数，常见的泛函运算规则有
(1)δ(L?+L?)=δ(L?)+δ(L?)
(2)δ(L?・L?)=L?・δ(L?)+L?・δ(L?)




　　
(4)
例9.3.1 试求泛函 ,x(t),t)dt     的变分。
解  泛 函J  有两个宗量x(t)  和x(t),   根据定义和泛函运算规则可得
　　　　　　　　　　　　　　　　
　　　　　　　　　　　
　　　　　　　　　　　
例9.3.2 试求泛函             的变分。
解  泛 函J  有一个宗量x(t),    根据定义可得
　　　　　　　　　　
　　　　　　　　　　　　　　　
7. 泛函的极值
　　对于泛函J[x(t)],     若任意一个与x?(t)   接近的函数x(t),    都 有J[x(t)]      一J[x 。(t)]≥0,      则 称泛函J[x(t)]    在 x 。(t)上达到了极小值，其中x?(t)   称为泛函J[x(t)]      的极小值函数或极小值 曲线。反之，若J[x(t)]     一J[x 。(t)]≤0,      则泛函J[x(t)]      在x?(t)   上达到了极大值，其中x 。(t)称 为泛函J[x(t)]     的极大值函数或极大值曲线。
　　　定理9.3.1(泛函极值的必要条件) 若可微泛函J[x(t)]在 x。(t)上达到了极小(大)值，则在 x(t)=x?(t)     上泛函的一阶变分为0,即 δJ=0  (证明需要用到泛函变分的标准求取方法，本章从实用 性考虑，略去了相关内容以及本定理的证明，但不会影响读者使用变分法解决最优控制问题)。
　　　为了判别是极大值还是极小值，要计算二阶变分δ2J。但在实际问题中很容易根据问题的 性质判别是极大值还是极小值，故一般不必计算δ2J。
9.3.3        泛函极值问题与欧拉方程
首先考虑自变量函数为一维(标量)函数的无约束泛函极值问题，后面将推广到高维(向量)
自变量函数的情况。
定理9.3.2(变分预备定理) 设 ζ(t)是[to,t,]区间上连续的n 维矢量函数，η(t)         n
维连续的矢量函数，且有η(to)=η (ty)=0 。  若满足 ,则ζ(t)=0,Vt∈ [to,tf]。
下面推导使泛函 ,x(t),t)dt      取极值时的容许曲线x(t)=x*(t)。
　　　由例9.3.1可知，,x(t),t)dt     的一阶变分为 理9.3.1可知，泛函极值存在的必要条件为



                    (9.3.6)
式中：被积函数的第二项利用分部积分
                (9.3.7)
将式(9.3.7)代入式(9.3.6)得

　　　　　　　　　　　                 (9.3.8) 由于 δx 是任意的，根据变分预备定理，欲使式(9.3.8)的第二项(积分项)等于0,必有
　　　　　　　　　　　　　　　　　　                           (9.3.9) 式(9.3.9)称为欧拉―拉格朗日方程，简称欧拉方程。
式(9.3.8)的第一项可重新写为
            (9.3.10)
式(9.3.10)为0的条件可分为4种情况讨论，如图9.3.3所示。
　　　　　　　
(a)                                                   (b)







(c)
图9.3.3 横截条件的不同情况示意图
　　　(1)两端固定。假定x(to)=xo,x(ts)=xf,              端点固定，则变分δx(to)=0,δx(tg)=0。 式(9.3.10)为0自然成立。
(2)始端固定，终端自由。假定x(t?)=xo,      始端固定，变分δx(t?)=0;x(tg)         可自由变化，



δx(tg)≠0 。  令式(9.3. 10)为0可得  ・z(t?)=0,           即
                            (9.3.11)
　　　(3)始端自由，终端固定。假定x(tg)=x,   终端固定，变分δx(tg)=0;x(to) 可自由变化， δx(t?)≠0 。  令式(9.3. 10)为0可得
                            (9.3.12)
(4)两端自由。此时，x(t?)  和 x(tf)   均可自由变化，δx(to)≠0,δx(tg)≠0 。    令式(9.3.10)为
0 可 得
(9.3.13)
　　　式(9.3.11)～式(9.3.13)称为横截条件，当边界条件全部给定时(两端固定),不需要横截条 件。由上面推导过程可知，欧拉方程将泛函求极值问题转化为一个时变二阶非线性微分方程求 解问题，而求解欧拉方程所需要的两点边界值由横截条件或边界条件提供。
　　　例9.3.3  已知 t,x(0)=0,     ,试求使泛函J  取极值的轨 迹 x*(t)。
解  这是固定端点问题，由题意可知to=0,   ,L=z2(t)-z2(t),                则
　　　　　　　　　　　　　
　　　　　　　　　　　　　
　　　　　　　　　　　　　
根据欧拉方
x+x=0
它的通解形式为
x=c?cost+c2sint
由边界条件 可确定c?=0,c?=2。
因此，极值轨迹x*(t)=2sint。
　　　例9.3.4  已 知 ,x(0)=0,x(1)=    自由，试求使泛函J 取极值的 轨 迹x*(t)。
　　　解 这是始端固定、终端自由的泛函极值问题，由题意可知 to=0,ty=1,L=x2(t)+ x3(t),    则



　　　　　　　　　　　　　　　
　　　　　　　　　　　　
　　　　　　　　　　　　　　　
根据欧拉方
2x(t)+3x2(t)=          常数
上式是x(t)  的一元二次方程，可知x(t)  是常数，则x(t)  是时间的线性函数，令 x(t)=At+B
由边界条件x(O)=0    可确定B=0 。 终端状态自由，由横截条件 得
　　　　　　　　　　　　　　
又因为x(t)=A,       代入上式得 A=0    或  A=0    时的极值轨迹为x*(t)=  0;
时的极值轨迹为               容易验证，x*(t)=0        时 ，J=0     对应局部极小值；
9 对应局部极大值。
当泛函自变量函数为n 维矢量函数时，上面所推导得到的欧拉方程以及横截条件同样适用。
考虑泛函 的极值问题，其中
　　　　　　　　　　　　　　
L(x(t),x(t),t)       是矢量函数的函数，泛函J  仍然是标量。 此时，泛函变分由式(9.3.8)改为



矢量型的欧拉方程为


其中




　　　　　　

　　　　


(9.3.14)


(9.3.15)



矢量型的横截条件为
　　　　　　　　　　　                   (9.3.16) 例9.3.5  已 知
1,试求使泛函J 取极值的轨迹x*(t)。
解  这是固定端点、含有两个自变量函数的泛函极值问题。此时的欧拉方程为
　　　　　　　　　　　　　　　　　
由题意可知to=0,   ,L=2x?x?+x2+x2,             则
　　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
由欧拉方程得
　　　　　　　　　　　　　　　　　　
对上面第一个方程求导两次，代入第二个方程消去x?, 得 x(4)―x?=0
它的通解形式为
x?=c?e+c?e1+c?e?+c?e?i
对x?  连续求导两次得
x?=c?e+c?e1―c?e2―c?ei
　　　




因此，极值轨线为





x?=sint,x?=―sint

9.3.4   条 件 泛 函 极 值 与 动 态 系 统 的 最 优 控 制 问 题
　　　前面讨论泛函极值问题时，对极值轨线x*(t)    没有任何约束条件。但在动态系统最优控制  问题中，状态轨迹不是任意的，而必须满足系统的状态方程，即极值轨线必须受状态方程的约束。
回顾前面最优控制问题的描述，动态系统的模型为
x(t)=f(x(t),u(t),t)                                                                  (9.3.17)



式中：x(t)  为 n 维状态矢量；u(t) 为 m 维控制矢量(本节中假定控制矢量不受限制);f(・)      是 n 维连续可微的矢量函数。采用式(9.2.8)的性能指标，可得
　　　　　　　　　　　　
式中：Φ[x(tf),tf]     是对终端时间和终端状态的要求 ,u(t),t]dt       是对[to,tf]   内状态轨 线和控制轨线的要求。现欲求出最优控制轨线u*(t)  以及满足状态方程的极值轨线x*(t),    使得 性能指标取极值。
　　考虑到实际最优控制问题中，初始时间to 和初始状态x(to)=x?     通常是已知的，终端情况随 实际问题有所不同。因此，下面将分别讨论不同情况下的最优控制问题：
(1)终端时间t,  给定，终端状态x(tg)   固定、约束或自由。
(2)终端时间tf 自由，终端状态x(tg)  约束。
1. 终端时间t 给定
1)终端状态固定
　　这是几种情况中最简单的一种，在此条件下推导出的所有结果很容易推广到终端状态x(tg) 约束或自由的情况。
将系统状态模型(式(9.3.17))写成等式约束方程的形式，即
f(x(t),u(t),t)―x(t)=0                                                          (9.3.18)
　　　和函数的条件极值情况类似，最优控制问题可视为以状态方程为等式约束的泛函极值问题。 显然，式(9.3.18)是对状态和控制轨线的约束，而不是对终端时间和终端状态的约束，因此构建  下面的增广泛函，即

Ja=φ[x(t),t;]+
　　　　　




(9.3.19)

式中：AT(t)=[λ?(t)λ?(t)…λn(t)]            为待定的n 维拉格朗日乘子矢量。因此，有约束条件的泛 函 J 的极值问题转化为无约束条件的增广泛函Ja  的极值问题。
在此，再引入一个标量函数
H(x(t),u(t),λ(t),t)=L[x(t),u(t),t]+λT(t)f(x(t),u(t),t)                                             (9.3.20)
　　　式(9.3.20)所定义的函数称为哈密顿函数，在最优控制中有重要的作用。将式(9.3.20)代 入式(9.3.19)得
      (9.3.21)
对式(9.3.21)积分号内第二项作分部积 ,得 Ja=Φ[x(tg),tf]-λT(t)x(t)|+
                            (9.3.22)
　　　欲寻求极值轨线u*(t)   和 x*(t)   使得泛函J  取极值，则需要计算式(9.3.22)所定义的增广 泛函Ja 的变分 δJa 。先考查Ja  的宗量，对于[x(to),t?] 、[x(tf),tf]           固定的情况，Ja  的宗量有
x(t)  和u(t),   宗量的变分为δx(t)  和δu(t),λ(t)     为待定乘子矢量并不是宗量。因此， δJa  为



　　　　　　　　　　　　
　　　　　　　　　            (9.3.23) 由泛函极值的必要条件，令δJa=0 及式(9.3.20)得到下面一组关系式，即
                     (9.3.24)
(状态方程)              (9.3.25)
　　　　　　　　　　　　　　                       (9.3.26) 满足式(9.3.24)～式(9.3.26)的状态轨线 x(t)  和控制轨线u(t)   即为使泛函取极值的最优
轨线x*(t)   和 u*(t) 。 式(9.3.24)和式(9.3.25)称为哈密顿正则方程。式(9.3.26)是控制方程， 表示最优控制u*(t)  使得哈密顿函数取驻值。这里需要再强调，只有当δu(t)  为任意时(即 u(t)    不受约束),才能得出上述方程。当实际问题中，控制作用u(t)受不等式约束且能在边界上取极 值时，不能用此控制方程求u*(t), 而用下一节介绍的极小值原理求解。求解2n 维哈密顿正则 方程需要2n 个边界条件。对于始端状态和终端状态均固定的情况，x(to)=x 。 和 x(tg)=x,      提  供了求解正则方程所需要的条件。
例9.3.6[卫星姿态最优控制问题(控制无约束，终端时间给定，终端状态固定)] 卫星的单
轴姿态可用状态方程 描述，欲在2个时间单位内将姿态从
　控制到 ,并使性能指标 达到极小，试求极值轨线x*(t)  和 极值控制律u*(t)。
　　解  由题意可知，t?=0,   ,tg=2,  ),Φ=0,,拉格朗 日乘子为λT(t)=[λ?(t)λ2(t)]。
首先构造哈密顿函数H(x,u,λ,t)=L(x,u,t)+λT(t)f(x,u,t),                     得
　　　　　　　　　　　　　　　　

由协态方                                  ,可得

λ?(t)=a,λ2(t)=―at+b
由控制方
u(t)=―λ2(t)=at―b
由状态方程



　　　　　　　　　　　
　　　由边界条件 ,解出a=3,b=3.5,  c=d   =1, 极值轨线x*(t) 和极值控 制律 u*(t)   分别为
x1(t)=0.5t3-1.75t2+t+1
x2(t)=1.5t2―3.5t+1
u*(t)=3t―3.5
2)终端状态受约束
　　　这种情况下的泛函极值问题存在两个约束条件，不仅要求状态x(t)和控制轨线u(t)满足状 态方程的约束f(x(t),u(t),t)―x(t)=0,  而且要求终端状态满足约束条件
ψ(x(t),tg)=0                                                                    (9.3.27)
　式中：ψ=[414 … ψp]T,n 维状态空间中终端状态约束条件的个数p<n。  针对状态方程和终端 约束方程分别引入两个拉格朗日乘子矢量，λT(t)=[λ?(t)λ2(t)…λ,(t)]                    和  γ(t)=
[r?(t)Y?(t)…γp(t)],              构建下面的增广泛函，即
Ja=Φ[x(tg),tf]+γ(t)・ψ(x(t),tf)+


　　　　　　　　
将哈密顿函数(式9.3.20)代入式(9.3.28)得
Ja=Φ[x(tg),tf]+γ(t)・ψ(x(tf),tg)+
　　　　　　　　　　　　　　
对式(9.3.29)积分号内第二项作分部积分得
Ja=Φ[x(tg),tf]+γ(t)・ψ(x(ty),tg)-λT(t)x(t)|+
　　　　　　　　　　　
将上式第三项展开，得到增广泛函表达式，即
Ja=φ[x(tf),t;]+γ(t)・ψ(x(tg),tg)-λT(tf)x(tf)+
　　　　　　　　　　　



(9.3.28)



(9.3.29)








(9.3.30)

　　有两组约束条件的泛函极值问题同样可转化为式(9.3.30)所定义的增广泛函Ja  的无约束 极值问题。欲求泛函Ja  的极值则需要计算泛函变分δJa,  并令 δJa=0    则可得到极值存在的必要 条件。先考察Ja  的宗量，Ja  中除了x(t)   和 u(t)  这两个宗量会产生变分δx(t)   和δu(t)  外 ，x(tg)    虽然受约束但同样是可变量(宗量),对应的变分为 δx(tg) 。 因此， δJa 为
　　　　　　　　
　　　　　　　　　　　
(9.3.31)



　　　比较式(9.3.23)和式(9.3.31),泛函变分 δJa 中增加了和终端状态有关的第一项，积分项没 有任何改变。因此，泛函极值存在的必要条件中，正则方程和控制方程同式(9.3.24)~ 式(9.3.26);但令δJa=0, 其第一项得
                    (9.3.32)
　　　式(9.3.32)为横截条件，它和始端状态x(to)=x。以及终端约束ψ(x(t;),t;)=0, 提供了求 解正则方程所需要的边界条件。
例9.3.7[卫星姿态最优控制问题(控制无约束、终端时间给定、终端状态受约束)] 卫星的
单轴姿态可用状态方程 描述，已知初始状态 ,要求在tf   =1时转移到目标集(终端约束x?(tg)+x?(tg)=1),          并使性能指标 达到极小， 试求极值轨线x*(t)   和极值控制律u*(t)。
解 由题意可知，to=0,   ,t=1,ψ=x?(1)+x?(1)-1,                        ),Φ=0,
,拉格朗日乘子分别为λT(t)=[λ?(t)λ2(t)]          和γ。
哈密顿函数为
　　　　　　　　　　　　　　　　
同例9.3.6,由正则方程和控制方程得
λ?(t)=a,λ2(t)=―at+b,u(t)=―λ2(t)=at―b
　　　　　　　　　　
由边界条件 ,解出c=d=0,     再根据终端约束x?(1)+x?(1)=1         得 4a―9b=6
由横截条件                        得
　　　　　　
即λ1(1)=λ? (1),因此得 ,最终可解出
极值轨线x*(t)   和极值控制律u*(t)   分别为
　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　




　　　　　　　　　　　　　　　　　
3)终端状态自由
　　终端状态自由和终端状态固定的情况比较类似，最后得到的增广泛函同式(9.3.22),将式 (9.3.22)第二项展开得到


Ja=Φ[x(tf),t;]-λT(tg)x(tg)+λT(t?)x(to)+
　　　　　　　　　　　　　




(9.3.33)

　　由 于x(tg)  可自由变化，因此Ja 有 x(t) 、u(t)    和 x(t)     三个宗量，对应变分 δx(t) 、δu(t)    和 δx(tg)。因此， δJa 为
　　　　　　　　
　　　　　　　　　　　
(9.3.34)
　　泛函极值存在的必要条件中，正则方程和控制方程仍同式(9.3.24)～式(9.3.26),横截条 件变为
                           (9.3.35)
例9.3.8[卫星姿态最优控制问题(控制无约束、终端时间给定、终端状态自由)] 卫星的单
轴姿态可用状态方程 描述，已知初始状态 ,要求在tg=2
时转移到 ,并使性能指标 达到极小，试求极值轨线x*(t)   和极值 控制律u*(t)。
　　解  由题意可知，to=0,   ,tg=2,  ,Φ=0, ,拉 格朗日乘子为λT(t)=[λ1(t)λ? (t)]。
哈密顿函数为
　　　　　　　　　　　　　　　　
同例9.3.6,由正则方程和控制方程得
λ1(t)=a,λ2(t)=―at+b,u(t)=―λ2(t)=at―b
　　　　　　　　　　　


由边界条件

由横截条件


,解出        由

得λ2(2)=0,得―2a+b=0,     最终可解出








极值轨线x*(t)   和极值控制律u*(t)  分别为
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
　　终端时间固定，终端状态分别固定、约束和自由的三种情况中，终端状态约束是最复杂的，其 他两种情况可视为是终端状态约束的特殊情况。下面整理利用变分法求解终端时间固定的最优 控制问题的基本步骤。
(1)构造哈密顿函数
H(x,u,λ,t)=L(x,u,t)+λT(t)f(x,u,t)
(2)求解正则方程和控制方程
　　　　　　　　　
(3)由边界条件和横截条件提供解方程的参数。
终端状态固定时：x(to)=xo,x(ty)=xf;
终端状态约束时：
终端状态自由时：x(t?)=x?
2. 终端时刻t;自由、终端状态x(ty)约束
　　　在实际工程问题中，经常碰到可变端点的变分问题。前文中介绍的导弹拦截控制问题就是 典型的可变终端的例子。为了完成导弹拦截任务，在某一时刻拦截器的运动曲线应该与导弹运 动曲线相交。假定导弹运动曲线已知为φ(t),  拦截器运动曲线为x(t),   要求t=t,     时 刻x(ty)=
φ(tf)。因此，导弹拦截控制问题可进一步描述为：寻找一条连续可微的极值轨线x*(t), 它从初 始端(to,xo)  到达给定曲线φ(t) 上的一点(t,φ(tf)),       该点处满足x(ty)=φ(tg),        并使性能指标 泛 函J 达到极值。其中tf是自由量，如图9.3.4所示。


　　
图9.3.4 导弹拦截问题的最优状态
轨线和最优终端时间示意图



图9.3.5 终端时间可变时的变分问题



　　针对终端时间t;自由的最优控制问题，下面研究终端状态受边界约束的情况，所有推导结 果可以延伸应用到其他可变端点情况。
假定终端状态x(tg)满足下面的约束方程组
ψ[x(tg),tf]=0                                                                  (9.3.36)
式 中：ψ=[ψ14… ψ  p]。 采用性能指标(式(9.2.8))
　　　　　　　　　　　　
引入拉格朗日乘子矢量λT=[λ1λ?… λn]和γT=[r1Y?…yp]。   构建如下的增广泛函


Ja=Φ[x(t;),t;]+γ(t)・ψ(x(t;),ty)+
　　　　　　　　
同样引入哈密顿函数
　　　　　H(x(t),u(t),λ(t),t)=L[x(t),u(t),t]+λT(t)f(x(t),u(t),t) 式(9.3.37)改写为
Ja=Φ[x(tf),tf]+γ(t)・ψ(x(tf),tg)+
　　　　　　　　　　　　　　




(9.3.37)






(9.3.38)

　　　和tf 固定时情况有所不同，现在Ja 的宗量除了x(t)和u(t),还有可变的终端时间ty 和终端 状 态x(ty),    相应的变分为δx(t) 、δu(t) 、δt;   和 δx(tf) 。 为了便于解释 δtf  和 δx(tg),   图9 . 3 . 5给 出标量函数x(t)   受终端条件x(ty)=ψ(tf)       约束的变分问题。其中，x*(t)    是极值曲线，x(t)    是 x*(t)    邻域的任一条容许曲线；(to,xo)    表示起始点， (ty,x(tf))      为可变终端点，ty=t+δtf,tj
为最优终端时刻(未知),δtf 为t; 的变分；δx(tg)表示对应终端时间t,的容许曲线x(t) 的变分， δx(tj)    表示容许曲线x(t)   的变分在t     时的值；ψ(t) 表示终端约束曲线，要求 x(tg)=ψ(tg) 。   由
图可知，它们存在如下的近似关系，即
δx(ty)≈δx(t)+x(tj)・δtg                                                                 (9.3.39)
　　　现在来计算式(9.3.38)定义的增广泛函Ja  的变分 δJa 。 由于式(9.3.38)中积分项的积分 上限是可变量tg,为了简化问题，将式(9.3.38)改写为
Ja=Φ[x(t),t]+γ(t)・ψ(x(tf),tf)+
　　　　　　　　　　　　　　　
(9.3.40)
式中：t;   是未知的最优终端时间。
式(9.3.40)第三项作分部积分，可得
　　　　　　　　
式(9.3.40)第四项由积分中值定理可得
　　　　　　　　　　



　　　　　　　　　　
H*・δt-λT(t)・x(tj)・δty
将式(9.3.39)代入上式得
　　　　　　　　　　
H*・δt;―λT(tj)・[δx(tg)―δx(t;)]
因此，式(9.3.40)可改写为
　　　　　　　　
　　　　　　　　　　　
　　　　　　　　　H*・δt;-λT(tj)・[δx(tg)―δx(t;)]                                                              (9.3.41) 由泛函变分定义得
　　　　　
　　　　　　　　
(9.3.42)
由泛函极值的必要条件定理，令δJ=0,     因δx(t) 、δu(t) 、δx(tg) 和δty  为任意量，故得下列关


系式
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　
(横截条件)
　　　　　　　　　　　(最优终端时间)     和t,  固定情况相比，多了可求解最优终端时间t;   的公式(9.3.47)。
例9.3.9  已知系统状态方程为x=u,    欲将系统从初始状态 x(O)=1




(9.3.43)
(9.3.44)
(9.3.45)
(9.3.46)
(9.3.47)

转移至终端状态

x(tf)=0,tg     自由，并使性能指标 达到最小，试求最优控制轨线u*(t)。
解  这 是t; 自由的最优控制问题。根据已知条件，t?=0,x(0)=1;ty           自由，终端约束条件
x(tf)=0, 即ψ=0;Φ= tj,,f=u,     拉格朗日乘子分别为λ和γ。
构造哈密顿函数
　　　　　　　　　　　　　　　



由正则方程和控制方程                                              得
λ=a,u=―a,x(t)=―at+b
　　　由初始条件x(O)=1    得 b=1;   由终端条件x(tf)=0     得 at;=1    (边界条件给定，不用横截条 件)。

由最优终端时间的条件



,艮1,将λ=a,u=-a


代入

得a=√2 。 进而得到
最优控制轨线为u=―√2,   最优状态轨迹为

9.4    极 小 值 原 理 及 其 应 用

9.4.1   经典变分法的局限
　　利用经典变分法求解最优控制问题时，泛函J  取极值的必要条件是在控制矢量u(t)  没有约 束、哈密顿函数H 对 u(t)  处处可微的情况下推导得到的。但是在实际工程问题中，控制作用通 常是有界的，如控制元件会饱和、驱动电机力矩受硬件制约、生产过程的生产能力有限制等。控 制作用的约束可用不等式来表示，即
u;(t)|≤M;i=1,2, …,m
这时，u(t)=[u?(t)u?(t)…um(t)]                  属于一个有界的闭集，即 u(t)∈Ω 。 当 u(t)  在边界上取值
时，其变分δu 就不是任意的，因可能不是最优解的必要条件。
　　　图9.4.1表示了相同有界闭集Ω内不同函数的极小值情况。图9.4.1(a) 中 对应 最优解u*;  图9.4. 1(b) 中，对应的解u+ 并非最优解，真正的最优解u* 是在Ω的左边 界；图9.4.1(c) 中 值，无法解出最优解，但这个函数在Ω内存在最优解u*,  即Ω的左 边界。另外，若性能指标为t (典型的燃料最优控制问题),则哈密顿函数对u(t)
的一阶偏导数并不连续，则无法应用变分法求解这类最优控制问题。为了克服经典变分法在求 解有控制约束的最优控制问题时的困难，1956年苏联数学家提出了极小值原理(早期亦称为极 大值原理)。下面将介绍连续系统的极小值原理，并简要介绍极小值原理的典型应用。
9.4.2   连续系统的极小值原理
下面直接给出连续定常系统的极小值原理，定理证明请参阅有关最优控制的专业书籍。
定理9.4.1[极小值原理] 系统状态方程为
x(t)=f(x(t),u(t),t)x(t)∈R”
边界条件为
x(t?)=xo,x(tf)         满足终端条件




　　　　　　　　　　　　　　　　
(a)                                        (b)                                        (c)
图9.4.1 相同有界闭集Ω内不同函数的极小值情况
控制矢量u(t)∈R”   可以是分段连续函数，但属于一个有界的闭集 u(t)∈Ω
性能指标为
　　　　　　　　　　　　


要求计算最优状态轨线x* 和控制轨线u*,  使得性能指标J  取极小值。
J 取极小值的必要条件是x(t) 、u(t)   以及拉格朗日乘子矢量λT(t)  满足下面方程：
(1)正则方程(同9.3节)
　　　　　　　　　　　　　　　
其中，哈密顿函数H(x(t),u(t),λ(t),t)=L[x(t),u(t),t]+λT(t)f(x(t),u(t),t)。
(2)哈密顿函数在u(t)=u*(t)      处取极小值，即
　　　　　　　　　
对所有t∈[to,tf],u(t)遍取Ω中所有点使H 取最小值的u(t)=u*(t)。
(3)始端边界条件和终端横截条件(同9.3节)
　　　　　　　　　
(4)终端时刻t   可变时，用来确定tg 的方程为
　　　　　　　　　　　　　　　　　
和经典变分法相比，唯一的区别在于用式(9.4.3)代替了原来的控制方







(9.4.1)
(9.4.2)



(9.4.3)



(9.4.4)


(9.4.5)

例9.4. 1 已知系统状态方程为x=x―u,    控制约束为0.5≤u(t)≤1,    初始状态为x(0)=
5,欲使性能指标 达到极小，试求最优控制轨线u*(t)   和最优状态轨 线x*(t)。
解  这是个控制有约束的最优控制问题，需要用极小值原理求解。根据题意，to=0,t=
1,x(O)=5,x(1)=         自由，φ=0,L=x+u,f=x―u,          拉格朗日乘子为λ,控制约束0.5≤u(t)≤1。
构造哈密顿函数



H=(x+u)           十λ(x-u)=(1+λ)x+(1-λ)u
　　哈密顿函数是u 的线性函数，极小值出现在边界。当(1― λ)>0,即λ<1时，H 是 u(t)的 增 函数，u(t)=0.5      时 H  取极小值；当(1- λ)<0,即λ>1时，H  是 u(t)   的减函数，u(t)=1     时 H  取 极小值。因此，有
　　　　　　　　　　　　　　　　
由协态方程 ,得λ+λ+1=0,λ(t)=ce?1―1。
　由横截条件 ,即λ(1)=0,得 c=e,   进而得λ(t)=e1-1。 最优控制轨线为
　　　　　　　　　　　　　　　
将 u*(t) 代入状态方程x=x―u  得
　　　　　　　　　　　　　
解得
　　　　　　　　　　　　　
　　　将初值条件x(0)=5     代入上式第一个方程，得c?=6;    以第一个方程的解在t=0.307     时的值 作为第二个方程的初值，得C?=6.37。 最优状态轨线为
　　　　　　　　　　　　
　　说明：控制律只取边界值，这种开关函数形式的控制，称为开关控制或 Bang-Bang     控制，在 实际控制问题中非常常见。
9.4.3   极 小 值 原 理 的 应 用
　　例9.4.2(登月舱软着陆控制) 假定登月舱质量为m(t),   高度为h(t),   垂直速度为 v(t),   降 落发动机推力为u(t),月球表面重力加速度为g, 不含燃料的登月舱质量为M, 初始燃料总质量 为 F 。 根据例9.2.1,登月舱状态方程为
h(t)=v(t),h(0)=ho
　　　　　　　　　　　　　　　
m(t)=―ku(t),k=                  常数，m(0)=mo=M+F
根据软着陆的要求，终端状态约束为
ψ1=h(tg)=0
42=v(tg)=0
假定推力容许范围为



0≤u(t)≤α
试确定最优控制 u*(t),    使登月舱由初始状态转移到目标集，并使登月舱燃料消耗最小，即 J=max(m(t;))       或 J=min(mo―m(tg))。
　　解  这是个ty自由，终端状态约束，控制受约束的最优控制问题。由已知条件可知，to 给 定 ，x(t?)=[ho vo m。],ty 自由，ψ=[ψ142],对应的拉格朗日乘子矢量为γ=[y1Y?]T; 性能指
　标是终端型指标，φ=mo-m(ty),L=0   ,对应的拉格朗日乘子 矢量λ=[λ1λ2 λ3]。
构造哈密顿函数为
　　　　　　　　　　　　
由协态方程 得
　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　
由横截条件

　　　　　　　　　　　　　
　　　　　　　　　　　　　　
　　　　　　　　　　　　　
将哈密顿函数整理为 u(t) 的函数
　　　　　　　　　　　　　　
由极小值原理，欲使H  取极小值，得
　　　　　　　　　　　　　　　
　　　上述结果表明，登月舱软着陆控制问题的最优控制律是Bang-Bang 控制形式，登月舱先处 于自由落体，到某一切换时刻，登月舱才受到降落发动机的制动，实现软着陆的同时，保证消耗燃 料最少。
　　　例 9.4.3(重积分系统最短时间控制问题) 系统状态方程为  已知初始状态 ,终端条件为 ,控制约束为|u(t)|≤1,      求使性能指标



极小的最优控制律u*(t)。
解 性能指标                  ,这类问题称为最短时间控制问题。由题意可知，
,Φ=0,L=1,       ,拉格朗日乘子为λT(t)=[λ1(t)λ2(t)]。
哈密顿函数为
H=1+λ?(t)x?(t)+λ2(t)u(t)
由协态方程 得
　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　
从中解出
λ1(t)=C?,λ2(t)=―c?t+c?
由哈密顿函数可知，H  是 u(t)  的线性函数，欲使 H 极小，最优控制为
　　　　　　　　　　　　　　　　　
由于λ2(t)=-c?t+c?,λ2(t)             是时间的线性函数，它在[to,tf]    段只有4种可能的形状，如图
9.4.2所示，因此对应的 u(t)  也只有4种序列：{- 1},{+1},{- 1,+1},{+1, ― 1}。即，当 λ2(t)是 t 的线性函数时，u(t)最多改变一次符号。
　　　　　　　　　
图9.4.2 u(t) 与λ2(t) 对应的4种形状



下面求 u(t)  分别取1和―1时的状态轨迹(也称为相轨迹)。 当 u(t)=1, 代入状态方程得
　　　　　　　　　　　　　　　
上式中消去中间变量t 可得到状态的相轨迹曲线方程
　　　　　　　　　　　　　
　　　由该相轨迹方程，不同的c 值可得到一簇曲线，如图9.4.3中实线所示。由于x?(t)   是 t  的 增函数，图中实线的箭头方向均向上。
当 u(t)=-1,  代入状态方程得
　　　　　　　　　　　　　　　
上式中消去中间变量t 可得到状态的相轨迹曲线方程
　　　　　　　　　　　　
　　由该相轨迹方程，不同的c '值也可得到一簇曲线，如图9.4.3中虚线所示。由于x?(t)   是 t 的减函数，图中虚线的箭头方向均向下。
　　　由终端状态要求 ,显然，满足约束条件的状态最优轨线分别是实线簇中进入原 点的γ+(半支曲线)以及虚线簇中进入原点的γ―(半支曲线),对应的曲线方程分别为
　　　　　　　　　　　　　　
γ+和γ一这两个半支通过原点的抛物线组合成曲线γ,称为开关线，其曲线方程为
　　　　　　　　　　　　　　　
　　　开关线将整个相平面分割为两个区域，γ左侧区域用R+   表示，γ右侧区域用R 一表示，如图 9.4.4所示。
　　　　　　　　　　　　　　
当初始状态(x10,x20)  为不同情况时，系统的最优控制和状态相轨迹讨论如下。
　　　( 1 ) 若(x10,x20) 在γ―上，则在u(t)=-1         作用下，状态沿着γ一转移至原点，最优控制为 u*(t)=-1,t∈[to,tf]。
　　　( 2 ) 若(X10,T20)在γ+上，则在u (t)=    +1 作用下，状态沿着γ+转移至原点，最优控制为 u*(t)=+1,t∈[to,tf]。





　　
图9.4.3 最短时间控制的相轨迹图




图9.4.4 开关线与最优相轨迹

　　　( 3 ) 若(x10,x20)  在开关线的左侧R+  区域内，如图9.4.4中的D 点，从D 点转移到原点，并 在转移过程中只允许u(t)   改变一次符号，唯一的控制路径如图所示。首先，在u(t)=+1        的 作 用 下，状态将沿着某实线转移至γ 一上某点(与开关线交点),切换控制为u(t)=―1,       然后沿着γ 一 转移至原点，最优控制为u*(t) ={+1,-1},t∈[to,tf]。
　　　( 4 ) 若(x10,x20)   在开关线的右侧R 一 区域内，如图9 .4 .4中的M  点，欲从M  点 转 移 到 原 点，首先在u(t)=-1   的作用下，状态将沿着某虚线转移至γ+上某点(与开关线交点),切换控 制 为u(t)=+1,        然后沿着γ+转移至原点，最优控制为u*(t)={―1,+1},t∈[to,tf]。
例9.4.4(重积分系统最少燃料控制问题)  系统状态方程为
已知初始状态 ,终端条件为 ,控制约束为 |u(t)|≤1,        求 使 性 能 指 标 极小的最优控制律u*(t)。
　　解  除了性能指标外，和例9.4.3非常类似。性能指标 是控制作用绝对值 的积分，通常代表动态系统的燃料消耗，因此这类问题亦称为最少燃料控制问题。
哈密顿函数和例9.4.3不同，即
H=|u(t)|+λ?(t)x?(t)+λ2(t)u(t)
由协态方程 得
λ?(t)=c?,λ2(t)=―c?t+c?
　　　考察哈密顿函数可知，欲寻求控制律u(t)   使 H  极小，等价于 结果分为下列4种情况：

u(t)=0
　u(t)=-sgn[λ2(t)] u(t)∈[0,1]
　　　　　　　　　　　　　


当| λ?(t)|<1
当| λ?(t)|>1 当λ?(t)=-1  当λ?(t)=+1


时 时 时 时



　　　由于λ2(t)  只能在孤立点上取±1,这两个孤立时刻u(t)  的值对性能指标J  的贡献可视为0, 忽略不计，因此，u(t)  只能取值0和±1。
和例9.4.3最短时间控制一样，当u(t)=1,    状态相轨迹曲线方程
　　　　　　　　　　　　　
如图9.4.5中实线所示。当u(t)=-1, 状态的相轨迹曲线方程
　　　　　　　　　　　　
如图9.4.5中虚线所示。
当u(t)=0    时，代入状态方程得
　　　　　　　　　　　　　　　　
　　状态相轨迹为水平线，如图9.4.5中点划线。当x?o>0   时，水平线方向向右；当x?0<0    时 ， 水平线方向向左。
若初始状态(x10,x2o)是第一象限的点A, 如图9.4.6所示，则可转移到原点的轨迹有下面几种。


　　
图9.4.5 最少燃料控制的控制量和相轨迹




图9.4.6 最少燃料控制的相轨迹

　　　(1)沿ABO 到达原点，对应控制序列为 u(t)={-1,0},t∈[to,tf] 。       这是最少燃料控制， 但在BO 段 ，x?=0,x?=0,       说明x?  到达原点的时间无穷大，不能满足ty 是给定值的要求。
　　　(2)沿ADO 到达原点，对应控制序列为u(t)={-1,+1},t∈[to,tf] 。       这是最短时间控制 的轨迹，到达原点的时间小于给定的t;―to 。 时间最短意味控制作用比较强，消耗的燃料通常不 会是最优。
　　　(3)沿ACEO  到达原点，其中C 点和E 点坐标待定(要满足给定的终端时间ty 的要求)。这 是最少燃料控制，系统先作加速运行，然后没有任何控制作用即作匀速运行，最后制动减速运行 到达原点。
例9.4.5(例9.2.3的经济系统最优控制问题) 已知企业的产值模型为 x(t)=ku(t)x(t)
x(0)=xo
式中：x(t)  为某企业在t 时刻的总产值，设u(t)  为产值中用于再投资的比例，显然，0≤u(t)≤1。
假定k=1,   欲在[0,tf] 规划时间内，寻求再投资/消费比例控制规律u*(t),    使得在这段时间内企




业累积的可消费财富总和最大，即
　　解  根据题意可知，to=0,x(O)=xo,tg       固定，x(tf)   自由。控制受约束，0≤u(t)≤1 。Φ=0, L=(1―u(t))・x(t),f=u(t)x(t),                   拉格朗日乘子λ(t)。
构造哈密顿函数
H=(1-u)・x+λux                            =x+(λ-1)xu
考查哈密顿函数，欲使
　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　
由协态方程 得
i(t)=-1-(λ-1)u
　　　由横截条件得λ(tf)=0, 因此当t→tf 时，λ(t)≤1, 此 时u(t)=0。 代入协态方程式得 i(t)=-1,λ(t)=c―t,             又因λ(t;)=0,c=ty,λ(t)=t;―t,             最优控制律为
　　　　　　　　　　　　　　　　
　　企业在切换时间t*=t-1         之前，应将全部产值都用于再投资，t*=t-1         之后可消费掉全 部产值，这样在整个[0,tf]  规划时间内累积的可消费财富总和最大。
9.5   线性二次型最优控制问题

　　　以经典变分法为基础的极小值原理在航空航天等诸多领域获得了成功的应用，但在处理非 线性问题以及闭环控制时仍存在诸多困难。极小值原理很难解出最优控制的解析表达式，因而 很难构成反馈控制(即将u(t)  表达为状态x(t)  的函数)。但是对于线性系统，若指标函数是二次 型形式，则可依据黎卡提方程(Riccati)的求解技巧，设计线性最优反馈控制器。这称为线性二次 型(Linear       Quadratic,LQ)最优控制问题，已在实际工程问题中得到了广泛的应用。本节将详细 推导终端时间有限时连续系统的状态调节器(Linear Quadratic Regulator,LQR)问题，然后简 要给出稳态时的状态调节器，最后给出倒立摆最优控制的MATLAB  仿真例子。
9.5.1   线性二次型问题
假设线性时变系统的状态空间表达式为
(9.5.1)
　式中：x(t) 为 n 维状态矢量；u(t)  为 m 维控制矢量(假定不受约束);y(t)  为 l  维输出矢量，通常 0<I≤m≤n 。A(t) 、B(t)       和 C(t) 分别是n×n 、n×m 、l×n     维时变矩阵，特殊情况下可以是常数 矩阵。
　　在工程问题中，通常希望设计系统使得系统输出y(t)  尽可能接近理想输出ya(t),   令误差矢 量e(t)为




e(t)=ya(t)-y(t)
欲寻找最优控制，使下面性能指标达到最小，即
　　　　　　　



(9.5.2)


(9.5.3)

式中：P 是 l×l    维对称半正定常数矩阵；Q(t)  是 l×l    维对称半正定矩阵；R(t)   是 m×m    对称正定 矩阵。为简化问题，可取P、Q(t)和R(t) 为对角矩阵。
下面讨论性能指标(式(9.5.3))中各项的物理意义。
　　　(1)终值项,表示控制结束后(ty  时刻)对系统终端跟踪误差的要求，当对终 端误差要求非常严格时，性能指标中会包括此项。
　　(2)误差积分项 ,表示系统在控制过程中([to,tf]    区间)动态跟踪误差 的累积和，反映了系统的控制效果。
　　(3)控制积分项 ,表示系统在整个控制过程中([to,tf]    区间)所消耗 的控制能量。
　　因此，使得性能指标(式(9.5.3))极小的物理意义是，用尽可能小的控制能量，获得尽可能好 的控制效果和终端精度。
9.5.2   线 性 系 统 状 态 调 节 器 问 题
在系统方程(式(9.5.1))和二次型指标(式(9.5.3))中，如果满足C(t)=I,ya(t)=0,           则有 e(t)=―x(t)
　　　　　　　      (9.5.4)  这时，线性二次型最优控制问题描述为：当系统受扰偏离平衡状态时(线性系统平衡状态为原 点),要求寻找最优控制量，使得系统的状态恢复到平衡状态附近，并使性能指标极小，这称为状 态调节器问题，即 LQR  问题。
1.ty 有限时的状态调节器问题
因系统(式(9.5.1))中假定u(t)  不受约束，故可应用经典变分法求解。构建哈密顿函数 H=L+λT(t)f=

　　　　　　　
最优解的必要条件是满足下面一系列方程：
协态方程
　　　　　　　　　　　　　
控制方程
　　　　　　　　　　　　　　
u(t)=-R=?1(t)BT(t)λ(t)


(9.5.5)



(9.5.6)



(9.5.7)



因 R(t)  是正定矩阵，R-1(t)    存在，故可根据上式得到最优控制u(t) 。 但上式中u(t)   是 λ(t)
的函数，欲构建反馈控制律，需得到u(t)  和 x(t)  的关系。 横截条件为
(9.5.8)
横截条件将终端时刻ty 上的λ(t)  和 x(t)  联系在一起。由于P  是常数矩阵，由式(9.5.8)可知 λ(t;)是 x(tg)的线性函数，因而可假定
λ(t)=K(t)x(t)                                                                     (9.5.9)
下面推导求解K(t)。
将式(9.5.9)代入式(9.5.7),再代入式(9.5.1),得
x(t)=A(t)x(t)―B(t)R=?1(t)BT(t)K(t)x(t)                                                 (9.5.10)
再由式(9.5.9)和式(9.5.6)得到
　　　　　　　　i(t)=K(t)x(t)+K(t)x(t)=-[Q(t)+AT(t)K(t)]x(t)                                                      (9.5.11) 由式(9.5.9)～式(9.5.11)得到
　　　　[K(t)+K(t)A(t)―K(t)B(t)R=1(t)B(t)K(t)+Q(t)+AT(t)K(t)]x(t)=0 上式对任意x(t)  都成立，则
K(t)=―K(t)A(t)―AT(t)K(t)+K(t)B(t)R?1(t)BT(t)K(t)-Q(t)                                        (9.5.12)
　式(9.5.12)是K(t)的非线性微分方程，称为黎卡提矩阵微分方程。式(9.5.8)提供了方程的边 界条件，即
K(tg)=P                                                                   (9.5.13)
可 从ty 至to 逆时间积分得到K(t) 。 由于黎卡提方程是非线性方程，很难得到解析解，通常将黎
卡提方程写成差分方程形式，然后用计算机程序迭代求解K(t) 。 最终可得到最优反馈控制
u(t)=―R?1(t)BT(t)K(t)x(t)=-G(t)x(t)                                                      (9.5.14)
　由式(9.5.12)可知，K(t) 和系统矩阵A(t) 、B(t)   以及性能指标中的加权矩阵R(t) 、Q(t)  有关，和  状 态x(t)  无关。因此在设计反馈控制器时，可离线求出K(t)  进而得到G(t),   在线闭环控制时， 只需调用对应时刻的G(t)  值即可获得控制律u(t) 。 最优反馈控制的结构如图9.5. 1所示。
　　　　　　　　　　
从上面的推导过程可知：
(1)控制是状态的反馈，u(t)=-G(t)x(t);




(2)求反馈增益矩阵的关键步骤就是求解黎卡提方程，这可离线进行；
(3)在线计算控制律的计算量很小，只需要作简单的乘法计算G(t)x(t)。
　　　另外，上述反馈控制器的设计并没有对系统的可控性及稳定性作任何要求。因为在有限时 间内，性能指标总是个有限值，最优解必然存在，但对于后面的稳态最优调节器问题则对系统可 控性及稳定性存在一定的要求。
关于K(t) 还需要作以下说明：
　　　(1)K(t)   是对称矩阵。由于P、Q和 R 均为对称矩阵，可将式(9.5.12)转置，再由微分方程 解的唯一性证明K(t) 的对称性。
　　(2)即使系统是定常的，即 A、B、P、Q 和 R 都为常数矩阵，由于K(t) 是微分方程 (式(9.5.12))的解，它是时变的。
例9.5.1(重积分系统，最优二次型状态调节器) 设系统状态方程为
　　　　　　　　　　　　　　
已知初始状态,求使性能指标 dt 极小的最优控制律u*(t)。 解  由题意可知
　　　　　　　
假定 ,由K(t)的对称性，k?1=k12。 上述参数代入黎卡提方程(式(9.5.12))得到
　　　　　　　　
　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　
上式两边对应元素相等得
k?=-1+ki?
k12=―ki+k??k?2  k?2=―2k12+k22
由边界条件K(ts)=P     得
k1?(tf)=k12(tg)=k22(tg)=0
　　　由 tf 至t。逆时间积分上面的非线性微分方程组可求得k1?(t) 、k12(t)和 k?2(t) 。 因而，最优 控制为
　　　　　　　



―k12(t)x?(t)―k?2(t)x?(t)


　　　　　　　　　　　　
(a)

1
x?(1)



　　　　　　　t       t x?(1)
(b)                                                                       (c)
图9 . 5 .2 ki(t) 、k??(t) 、k?2(t) 、x?(t) 、x?(t)   和u(t) 的时间曲线
　　　由图9.5.2可见，虽然系统是定常系统，但反馈系数k??(t)   和 k?2(t)  都是时变的。当tf  比 过 渡时间大很多时，k1?(t) 和 k?2(t)  只有在接近tf  时才有明显动态变化，初始时刻时的值近似为常 数，如图9.5.3所示。
　　　　　　　　　　　　　
图9.5.3 t; 很大时k?(t) 、k1?(t)  和k22(t)的时间曲线




实际上，当t→∞    时 ，k(t) 、k1?(t) 、k?2(t)     趋于0,则黎卡提微分方程变为代数方程
0=-1+ki?
0=―k1+k1?k?2
0=-2k12+k22
从中可解出k(t) 、k1?(t)    和 k?2(t)  的稳态值分别为 √2、1和 √2。于是，最优控制律简化为
u(t)=―x?(t)―√2x?(t)
这样的反馈控制器在工程中非常容易实现，且基本满足最优性能指标的要求。
2. 稳态时(tg→∞) 的状态调节器问题
考虑线性定常系统
x(t)=Ax(t)+Bu(t)                                                                 (9.5.15)
式中：x(t)  为 n 维状态矢量；u(t) 为 m 维控制矢量(假定不受约束);A 和 B 分 别 是n×n 、n×m    维 常数矩阵。假定系统是可控的或至少是可稳的(即不可控状态是渐近稳定的),性能指标为
(9.5.16)

式中：Q 是 n×n    维常数对称正定矩阵，或为半正定矩阵且(A,Q)     为能观测矩阵；R 是 m×m     维 常数对称正定矩阵。使性能指标(式(9.5.16))极小的最优控制u*(t)   存在且唯一，即
u*(t)=―R?1BTKx(t)=―Gx(t)                                                      (9.5.17)
　式 中 ：G 为 m×n   维常数矩阵，称为反馈增益矩阵；K 为 n×n    维正定对称矩阵，满足下面的矩阵 黎卡提代数方程
―KA-ATK+KBR?1BTK-Q=0                                                      (9.5.18)
　　　与有限时间的状态调节器公式(9.5. 12)相比，令黎卡提矩阵微分方程(式(9.5. 12))中 K(t)=0,     并将时变矩阵换为常数矩阵得到黎卡提代数方程，即可得到上述结果。
9.5.3   倒 立 摆 的 最 优 控 制 问 题
例9.5.2(倒立摆最优控制) 考虑图9.5.4所示的倒立摆系统。
系统参数说明如下：
M―― 小车质量，            0.5kg;
m―― 倒立摆质量，           0.2kg;
b――小车摩擦力，           0.1(N/m);
l―― 倒立摆质心到支点长度，0.3m;
I――  倒立摆转动惯量，       0.006kg・m2;
g――重力加速度，           9.8N/kg;
x―― 小车坐标位置；
0 ― 倒立摆与垂线之间夹角；
F―― 水平方向施加到小车的作用力。
在平衡点处线性化后得倒立摆的状态方程为




　　　
　　　　　　　　　　　　　　　　
式中：u=F,    代入参数后得到
　　　　　　　　　　
　　　　　　　　　　　　　　　　
欲对系统进行最优状态反馈设计，极小化性能指标为
　　　　　　　　　　　　　
　　解  首先，设定性能指标中的Q 和 R 矩 阵 。Q 和R  矩阵是用来设定性能指标中不同状态以 及不同输入矢量之间的权重。可先简单设定Q=CC     和R=1,    当动态性能不满足要求时，可适 当修改Q 和R 矩阵。
　　编 写MATLAB  程序， M=0.5;
m=0.2;
b=0.1;
i=0.006;
g=9.8;
1=0.3;

p=i*(M+m)+M*m*12;
A=[0               1      0     0;
0―(i+m*12)*b/p(m^2*g*12)/p0;

0―(m*1*b)/p           m*g*1*(M+m)/p0];
B=[0;(i+m*12)/p;0;m*1/p];
C=[1000;
0010];
D=[0;0];




x=1;
y=1;
Q=[x000;
0000;
00y0;
0000];
R=1;
G=lqr(A,B,Q,R)%MATLAB             提 供lqr 命令，可直接计算二次型状态反馈增益矩阵 Ac=[(A-B*G)];                  %闭 环系统矩阵
Bc=[B];
Cc=[C];
Dc=[D];

T=0:0.01:5;
U=zeros(size(T));%        调节器问题，假定外部输入为0
x0=[0.100.10];               %初始状态，小车初始位置偏移0.1m, 倒立摆夹角偏移0.1rad [Y,X]=lsim(Ac,Bc,Cc,Dc,U,T,x0);%               闭环系统仿真
plot(T,Y)
legend( '小车’,'倒立摆)
执行上面程序，得到如下结果和图9 . 5 . 5所示的响应曲线。
G=
―1.0000      ―1.6567      18.6854      3.4594
　　由图9 . 5 . 5可以看出，动态响应性能指标中，超调在可接受范围内，但调节时间过长。因为 在性能指标中，Q 和 R  比重相当，即系统对控制能耗和控制效果的要求各占 一 半，若试图改善控

制效果，则可提高Q  阵元素数值，如x=100,y=100,
G=
　　―10.0000      ―8.0284   输出响应如图9 . 5 . 6所示。
0.15 0.1 0.05 0
-0.05 -0.1
-0.15
-0.2
时间
图9.5.5


相应的状态反馈增益为

7.0198

0.1
― 小车
----倒立摆
0.08 0.06
0.04 0.02
0
-0.02
-0.040              2      3      4      5
时间
图9.5.6 倒立摆控制系统的输出响应(改进后)



　　由图9.5.6可知，控制效果明显改善，但反馈增益变大，意味着控制作用变强，消耗能量变 大。实际工程中，可根据控制要求及经验选定权重矩阵。

9.6    动  态  规  划

　　　动态规划(Dynamic         Programming,DP)是美国学者贝尔曼于1957年提出，用于求解离散系 统最优控制问题的一种迭代计算方法。它与极小值原理并称为最优控制的两大基石。本节将简 单介绍动态规划的基本原理，以及离散时间系统最优控制问题的动态规划理论。
9.6.1   动 态 规 划 基 本 思 想
　　前面章节中介绍的最优控制问题，通常要寻找最优控制轨线u*(t),    使得泛函形式的性能指 标极小，如
　　　　　　　　　　　　　　　　
若将定积分写成无穷序列和的极限
　　　　　　　　　
　最优控制问题则可描述为，在每个时间间隔△t;  中寻找u(t;),   使得上面性能指标J  极小，即寻找 最优控制序列{u(t;)} 。 自动控制中，u*(t)   称为最优控制律；社会经济系统中，{u(t;)}   称为最优 决策序列，上述离散泛函极值问题又称为多段决策过程。连续系统最优控制即是无限多段决策 过程。动态规划就是求解多段决策问题的得力工具。
为了直观说明动态规划方法，首先介绍一个多段决策过程的典型例子――最短路径问题。 例9.6. 1 (最短路径问题)
　　从 A 地 到E  地要铺设一条管道，其中需经过三级中间站，两点之间的连线上的数字表示距 离，如图9.6.1所示，试选择一条铺设路线使总距离最短。
　　　　　　　
图9.6.1 管线铺设路线图
　　　由图可见，从A 地 到E  地存在若干不同的可达路径，相连站点之间距离已标注在图中，为使 A-E    点总距离最短，要在四个阶段A-B 、B-C 、C    一D 、D-E    中作出四次决策。该问题若用常 规的从前往后的穷举法计算是很繁琐的。
动态规划法是一种逆序计算方法，从终端E 开始，逆向递推至A 为止。动态规划法的理论



依据是最优性原理。对最佳路径(最佳决策过程)所经过的各个阶段，其中每个阶段始点到全过 程终点的路径，必定是该阶段始点到全过程终点的一切可能路径中的最佳路径(最优决策),这就 是贝尔曼提出的著名的最优化原理。简而言之， 一个最优策略的子策略必然也是最优的。因 此，动态规划将多阶段最优决策问题化为(从终端起)单一阶段的最优决策问题。
　　利用动态规划思想求解例9.6.1的具体过程描述如下。整个计算过程分四个阶段，从最后 一个阶段开始。
第四阶段(D-E):D       到 E  有2条路径达，显然有J?(D?)=5,J?(D?)=2,              那么,在假定A 一
D 之间已经走最短路径的前提下，从D 出发到E 的最短路径为D? →E, 最短距离为J? (D?)=2。
第三阶段(C―D):C    到 D 共有6条路径。先考虑从C?  出发的情况，显然若从C?  出发到达
　E 的最短距离是即最短路径为C?→D?→ E; 再 考 虑 从 C?   出 发 的 情 况 ， 从 C?    出 发 到 达 E   的 最 短 距 离 是 J?(C?)=min
即最短路径为C?→D?→E 。 同样，可算出C?  出发的最
和最短路径C?→D?→E。
第二阶段(B-C):B      到 C  共有9条路径。和前面类似，可得到

出发的最短路径为

B?→C?→D?→E
,从B? 出发的最短路径为 B?→C?→D?→E
出发的最短路径为 B?→C?→D?→E
第一阶段(A-B):A       到 B  共有3条路径。
,从A 出发的最短路径为 A→B?→C?→D?→E
　　通过上述倒推步骤，最终得到从A 到 E  的最短路径为A→B?→C?→D?→E,      经过该路径的 最短铺设距离为J*=J?(A)=19。
　　　上述求解步骤中，每个阶段的问题及采用的方法都非常类似，归纳上述用动态规划法求解最 短路径问题时，采用的递推方程的一般形式为
N=1,2,3



J?=d(x,E)                                                                  (9.6.1)
式中：N 为当前阶段；x 为当前节点；Sn(x) 是 和x 相连接的下一级节点；Jn(x) 为距离函数(或 称代价函数)。
9.6.2   动态规划法求解离散最优控制问题
式(9.6.1)实际上是动态规划的递推方程的一个特例。设N 级决策过程的状态方程为 x(k+1)=f(x(k),u(k),k)                   k=0,1,…,N-1
x(0)=x?                                                                    (9.6.2)
　式中，k 表示多级决策过程的阶段变量；N 为决策过程的总阶段个数；x(k) 为 n 维状态矢量；u(k) 为m 维控制矢量；f(・)     为 n 维矢量函数。性能指标(代价函数)为
(9.6.3)
　　上述离散系统(式(9.6.2))的最优控制问题可描述为：寻求最优控制序列(或最优决策序列) {u*(0),u*(1),…,u*(N―1)},  使性能指标(式(9.6.3))达到极小值。
　　一般情况，将始于x(O) 的最优性能表示为J*[x(0),0],       将始于决策过程中第k 阶段的最优 性能表示为J*[x(k),k]。 正如例9.6.1中动态规划的具体步骤中所给出的那样，J*[x(0),0]  问题可嵌入到J*[x(k),k]     问题的求解过程中，以便将多级决策问题化为多个单级决策过程，这 就是嵌入原理。因而，下面主要研究单级决策问题的求解，即
                   (9.6.4)
单级决策问题中系统状态方程(式(9.6.2))可改写为
x(j+1)=f(x(j),u(j),j)j=k,k+1,…,N-1                                                            (9.6.5)
那么,始于第k 级决策过程中任一容许状态x(k)  的最优性能为

　　　　　　    (9.6.6) 即第k 级的最优性能指标由两部分组成：一部分是第k 级的局部性能指标；另一部分是第 k+1  级到第N 级的最优性能指标总和。因而，式(9.6.6)是最优性能指标的递推方程，它由最后一级 开始，逆向递推，最终获得从初始时刻和状态[x(0),0]     出发的最优决策序列{u*(0),u*(1), … ,
u*(N-1)}     和最优性能指标J*[x(0),0]。
例9.6.2 已知系统状态方程为
x(k+1)=2x(k)+u(k) x(O)=1
试求最优控制序列{u*(0),u*(1),u*(2)},           使 )取最小值。 解 这是3级最优决策问题。
(1)k=2     时，初态为x(2),   单步最优问题是求u*(2),   使
　　　　　　　　　　　　　　




显然，欲使得上式最小的最优决策u(2)=0, 那么,第3级最优性能指标为 J*[x(2),2]=x2(2)
(2)k=1     时，初态为x(1),   单步最优问题是求u*(1),    使
　　　　　　　　　
　　　　　　　　　　　　　　　
由系统状态方程知x(2)=2x(1)+u(1),          上面性能指标改写为
　　　　　　　　　
　　　　　　　　　　　　　　　
欲使上式最小，令其一阶导数为0,得到
　　　　　　　　　　　
2u(1)+2[2x(1)+u(1)]=0 u*(1)=―x(1)
最优性能指标为
J*[x(1),1]=3x2(1)
(3)k=0     时，初态为x(O),  单步最优问题是求u*(0),   使
　　　　　　　　　
　　　　　　　　　　　　　　　
由系统状态方程知x(1)=2x(0)+u(O),         上面性能指标改写为
　　　　　　　　　　　
　　　　　　　　　　
同样可解出
　　　　　　　　　　　　　　　　　
　　将初值条件x(O)=1,    代入上面得到的最优控制序列为 ,最优性能 指标为J[x(0),0]=4。
　　说明：动态规划求解最优控制问题中：(1)对系统的动态方程形式并没有作限制，动态系统可 以是非线性的、时变的；(2)每个阶段的性能指标L[x(k),u(k),k] 也可以是时变的；(3)对控制有 约束的情况也同样适用。

本 章  小 结

　　　本章首先简要介绍了最优化与最优控制问题的基本概念。最优控制问题的描述包括：被控 系统的状态方程；状态方程的边界条件；性能指标；控制的容许范围。求解最优控制问题的常用 方法有经典变分法、极(大)小值原理、线性二次型最优控制、动态规划等。对于动态系统，当控制



　无约束时，采用经典变分法；当控制有约束时，采用极小值原理或动态规划。对于线性系统且性 能指标是二次型形式的，则可采用线性二次型最优控制问题求解。
　　函数的函数叫做泛函。变分法是研究泛函极值的经典方法。9.3节首先介绍了无约束条件 泛函极值问题的求解方法，推导了欧拉方程及横截条件。最优控制问题中的性能指标是一个泛 函，因此求解动态系统的最优控制即为一个求取有约束条件的泛函极值问题。9.3节中分别讨 论了终端时间t;固定/自由、终端状态x(tg)固定/约束/自由等不同条件组合下的最优控制问 题，推导了正则方程和控制方程以及求解方程必需的横截条件和边界条件。
　　　极小值原理是对经典变分法的扩展，当控制变量 u(t)  有约束、哈密顿函数 H  对控制变量 u(t)  不可微时，要使用极小值原理。极小值原理有丰富的应用成果，成功解决了最短时间控制问 题、最少燃料控制问题等。
　　　对于线性系统，若性能指标函数为状态变量和控制变量的二次型函数，这种动态系统的最优 问题称为线性二次型最优控制问题。本章主要介绍了连续系统的状态调节器问题，推导得到线 性最优反馈控制律，并结合 MATLAB   给出了倒立摆系统的最优二次型求解实例。
　　本章最后以最短路径问题为实例简单介绍了动态规划的基本概念、最优性原理以及动态规 划法求解离散最优控制问题的基本步骤。
课后练习题
9-1   已 知 ,x(0  )=0,x(1)=1,           试求使泛函J  取极值的轨迹x*(t),      并 判 别泛函极值的性质(极大/极小值)。
9-2                               x=―x+u,x(O)=3,x(2)=0,求 u*(t)    使 为最小。
9-3   ,x?(2)=0,        求 u*(t)    使 为 最 小 。
9-4                              x=u,x(0)=1,x(t;)=0,求t    及u*(t)    亻
为最小。
9-5                       x=u,x(0)=1,求 t;   及 u*(t)     使 t 为最小。
9―6                                  x=―0.1x+u,x(0)=xo,0≤u≤1,求 u*(t)    使 为极大。
9-7                                   x=-x+u,x(0)=1,|ul≤1,求 u*(t)    使J=j(x-―u)dt                为极小。
9-8                                     x=x-u,x(0)=5,0≤u≤2,求 u'(t)     使  为极大。
9-9                            x=-2x+u,x(0)=1,求 u*(t)    使 极小，其中t    固定。
9-10                             x(k                             +1)=x(k)+0.1(x2(k)+u(k)),x(0)=3,求 u*(0),u*(1)         使 J     =
　







参 考 文 献


[1]李友善. 自动控制原理[M]. 第3版.北京：国防工业出版社，2009.
[2]王划一，杨西侠. 自动控制原理[M].   第2版.北京：国防工业出版社，2009.
[3]谢克明. 自动控制原理[M].    第2版.北京：电子工业出版社，2009.
[4]周献中，盛安冬，姜斌. 自动化导论[M].     北京：科学出版社，2009.
[5]陈复扬，姜斌. 自适应控制与应用[M].     北京：国防工业出版社，2009.
[6]姜长生，等.线性系统理论与设计(中英文版)[M].     北京：科学出版社，2008.
[7]王宏禹，邱天爽.线性时变离散系统[M].     北 京：国防工业出版社，2008.
[8]吴受章.最优控制理论与应用[M].    北京：机械工业出版社，2008.
[9]胡寿松. 自动控制原理[M].     第5版.北京：科学出版社，2007.
[10]窦曰轩. 自动控制原理[M].     北京：机械工业出版社，2007
[11]杨一栋.直升机飞行控制[M].    北京：国防工业出版社，2007.
[12]Bateson,Robert    N.Introduction     to    control     system    technology[M]. 北京：机械工业出版社，2006.
[13]李国勇，等.最优控制理论及参数优化[M].     北京：国防工业出版社，2006.
[14]张洪钺，王青.最优控制理论与应用[M].     北京：高等教育出版社，2006.
[15]多尔夫 RC,   毕晓普RH.    现代控制系统[M].     第10版.北京：科学出版社，2005.
[16]胡寿松，王执铨，胡维礼.最优控制理论与系统[M].     北京：科学出版社，2005.
[17]龚德恩.离散控制系统理论引论[M].    北京：中国铁道出版社，2004.
[18]Richard   Dorf   C,Robert    Bishop   H. 现代控制系统[M].     谢红卫，等译.北京：高等教育出版社，2001.
[19]Driels     M.  线性控制系统工程[M].    北京：清华大学出版社，2000.
[20]薛定宇.控制系统计算机辅助设计[M].     北京：清华大学出版社，1996.
[21]孟宪蔷.控制工程基础[M].    北京：航空工业出版社，1993.
[22]戴忠达. 自动控制理论基础[M].     北京：清华大学出版社，1991.
[23]郑大钟.线性系统理论[M].    北京：清华大学出版社，1990.
[24]吴麒. 自动控制原理[M].  北京：清华大学出版社，1990.
[25]胡寿松. 自动控制原理习题集[M].     北京：科学出版社，1990.
[26]孙虎章. 自动控制原理[M].     北京：中央广播电视大学出版社，1984.
[27]王照林，等.现代控制理论基础[M].     北京：国防工业出版社，1980.
[28]孟颖琪，张斌，等.汽轮机调节系统的自激振荡和管道油流谐振[J].  东方电气评论，1992,6(3):178-183.